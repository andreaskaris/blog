
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Andreas Karis' blog about anything Kubernetes, OpenShift, Linux and Networking">
      
      
      
        <link rel="canonical" href="https://andreaskaris.github.io/blog/coding/operator-sdk-reconciliation/">
      
      
        <link rel="prev" href="../">
      
      
        <link rel="next" href="../vimrc/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.14">
    
    
      
        <title>Controller Reconciliation - Andreas Karis Blog</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.113286f1.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="pink">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Andreas Karis Blog" class="md-header__button md-logo" aria-label="Andreas Karis Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Andreas Karis Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Controller Reconciliation
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../ceph/" class="md-tabs__link">
        Ceph
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../linux/" class="md-tabs__link">
        Linux
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../networking/" class="md-tabs__link">
        Networking
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../openshift/" class="md-tabs__link">
        OpenShift and Kubernetes
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../openstack/" class="md-tabs__link">
        OpenStack
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        Coding
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
  
    
    <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner">
          

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Andreas Karis Blog" class="md-nav__button md-logo" aria-label="Andreas Karis Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Andreas Karis Blog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../ceph/">Ceph</a>
          
            <label for="__nav_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Ceph
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ceph/ceph-manual-test/" class="md-nav__link">
        Ceph manual test with qemu
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../linux/">Linux</a>
          
            <label for="__nav_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/cgroups/" class="md-nav__link">
        cgroups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/containers/" class="md-nav__link">
        Containers in Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/hugepages/" class="md-nav__link">
        Hugepages
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/ipxe-boot-environment/" class="md-nav__link">
        iPXE boot environment on Fedora
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/java-idrac-issues/" class="md-nav__link">
        Java Idrac Issues
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/meson/" class="md-nav__link">
        meson
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/namespaces/" class="md-nav__link">
        namespaces
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/old_java_version_with_xorgs_in_container/" class="md-nav__link">
        Old Java inside a container with xorgs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/get-process-cgroup-info-and-limits/" class="md-nav__link">
        Retrieving process cgroup resource usage and limit info
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/libvirt-uefi-without-secureboot/" class="md-nav__link">
        RHEL Booting a virtual machine with UEFI but without secure boot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/setting-journalctl-limits/" class="md-nav__link">
        Setting journalctl limits
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../networking/">Networking</a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Networking
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/accept-source-routing/" class="md-nav__link">
        Accept Source Routing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/arp_and_the_neighbor_table/" class="md-nav__link">
        ARP and the Neighbor table
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/bpf-and-tcpdump/" class="md-nav__link">
        BPF and tcpdump
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/bonding_in_linux/" class="md-nav__link">
        Bonding in Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/juniper_x520/" class="md-nav__link">
        Configure Juniper switch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/haproxy-and-h2c/" class="md-nav__link">
        haproxy and HTTP/2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/install-openvswitch-on-rocky/" class="md-nav__link">
        Install Open vSwitch on Rocky Linux 8
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/geneve_tunneling/" class="md-nav__link">
        Geneve tunneling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/netlink/" class="md-nav__link">
        Netlink
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/ovn_standalone_on_fedora/" class="md-nav__link">
        OVN standalone on Fedora
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/ovs_recirculation/" class="md-nav__link">
        OVS packet recirculation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/ovs-vxlan-tunnels-and-dscp/" class="md-nav__link">
        OVS VXLAN tunnels and DSCP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/ovs_with_gdb/" class="md-nav__link">
        OVS with GDB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/packet-tracing-with-ovn/" class="md-nav__link">
        Packet tracing with OVN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/sctp/" class="md-nav__link">
        SCTP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/useful-commands/" class="md-nav__link">
        Useful commands
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/wireguard/" class="md-nav__link">
        Wireguard
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../openshift/">OpenShift and Kubernetes</a>
          
            <label for="__nav_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          OpenShift and Kubernetes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/alertmanager/" class="md-nav__link">
        AlertManager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/analyzing-cni/" class="md-nav__link">
        Analyzing CNI calls
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/ocp-custom-release-image/" class="md-nav__link">
        Building custom release images for OpenShift
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/cpu-manager-with-custom-machine-config-pool/" class="md-nav__link">
        CPU manager with custom MachineConfigPool
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/crio-conmon-runc/" class="md-nav__link">
        Crio vs conmon vs runc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/etcd_perf/" class="md-nav__link">
        Etcd Performance tests
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/get-vs-list-api-calls/" class="md-nav__link">
        Get vs List API Calls
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/openshift_httpbin_tshark_sidecar/" class="md-nav__link">
        Httpbin tshark sidecar container
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/kubernetes_cluster/" class="md-nav__link">
        Hints for installing kubernetes on Fedora
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/HPA/" class="md-nav__link">
        Horizontal Pod Autoscaler
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/how_rhcos_updates_work/" class="md-nav__link">
        How RHCOS updates work
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/ocp4-infra-nodes-with-machineset-without-worker-label/" class="md-nav__link">
        Infra nodes with MachineSets without worker label
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/ingresscontroller_router_sharding_ocp_on_osp/" class="md-nav__link">
        Ingress Controller Sharding OCP on OSP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/ingress-controller-sharding-on-separate-vip/" class="md-nav__link">
        Ingress Controller Sharding on separate VIP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/openshift_mirror_registry/" class="md-nav__link">
        Installing a cluster with a mirror registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/istio-1.6-on-ocp.4.x/" class="md-nav__link">
        Istio 1.6 on OpenShift 4.x
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/kata/" class="md-nav__link">
        kata containers and the kata operatora
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/ovn-kind-hybrid-overlay/" class="md-nav__link">
        Kind with OVN Kubernetes Hybrid Overlay
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/kind-with-private-registry/" class="md-nav__link">
        Kind with private registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/list_docker_registry_containers/" class="md-nav__link">
        List container images in registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/mounting-container-image/" class="md-nav__link">
        Mount a container image
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openstack/install_openshift_on_openstack/" class="md-nav__link">
        OpenShift on OpenStack
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/patch-service-loadbalancer-ingress-ip/" class="md-nav__link">
        Patch status.loadBalancer.ingress IP manually
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/private-registry/" class="md-nav__link">
        Private container registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/proxy-ocp-4.5/" class="md-nav__link">
        Proxy OCP 4.5
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/scc/" class="md-nav__link">
        Security Context Constraints (SCC)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/openshift-scc-with-mutating-webhooks/" class="md-nav__link">
        SCCs and mutating webhooks - a lesson learned
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/fix-selinux-labels-coreos/" class="md-nav__link">
        SElinux labels fix
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/sctp/" class="md-nav__link">
        SCTP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/openshift_troubleshooting_etcd_state/" class="md-nav__link">
        Troubleshooting etcd state
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/useful-ocp-commands/" class="md-nav__link">
        Useful commands for OpenShift
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/useful-ocp-sdn-commands/" class="md-nav__link">
        Useful commands for OpenShift SDN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/troubleshooting_openshift_on_openstack_worker_creation/" class="md-nav__link">
        Troubleshooting OpenShift on OpenStack worker creation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../openstack/">OpenStack</a>
          
            <label for="__nav_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          OpenStack
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openstack/reattach_to_running_deployment/" class="md-nav__link">
        Reattach to running deployment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openstack/using_clouds_yaml/" class="md-nav__link">
        Using clouds.yaml
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" checked>
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../">Coding</a>
          
            <label for="__nav_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Coding
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Controller Reconciliation
      </a>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../vimrc/" class="md-nav__link">
        My vimrc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../golang-ip-conversion/" class="md-nav__link">
        Golang IP address conversion
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
        </div>
      </div>
    </div>
  
  
    
    <!--
    <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner">
          

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
</nav>
        </div>
      </div>
    </div>
    -->
  

          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Controller Reconciliation</h1>

<h2 id="reconciliation-with-the-operator-sdk">Reconciliation with the Operator SDK</h2>
<p>In the Operator SDK, controllers implement the <a href="https://github.com/kubernetes-sigs/controller-runtime/blob/43331a6c8f823b497660b368deb4311ae2030206/pkg/reconcile/reconcile.go#L89">Reconciler</a> interface. </p>
<p>Meaning that every controller will have a <code class="highlight">Reconcile</code> method.
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>Typically, reconcile is triggered by a Controller in response to cluster Events (e.g. Creating, Updating,
Deleting Kubernetes objects) or external Events (GitHub Webhooks, polling external sources, etc).`
</code></pre></div></td></tr></table></div></p>
<blockquote>
<p><a href="https://github.com/kubernetes-sigs/controller-runtime/blob/43331a6c8f823b497660b368deb4311ae2030206/pkg/reconcile/reconcile.go#L59">https://github.com/kubernetes-sigs/controller-runtime/blob/43331a6c8f823b497660b368deb4311ae2030206/pkg/reconcile/reconcile.go#L59</a></p>
</blockquote>
<p>Simple example:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@kind ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="err">$</span><span class="n">GOPATH</span><span class="o">/</span><span class="n">src</span><span class="w"> </span>
<span class="o">[</span><span class="n">root@kind src</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">mkdir</span><span class="w"> </span><span class="n">example</span><span class="o">-</span><span class="n">operator</span>
<span class="o">[</span><span class="n">root@kind src</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">cd</span><span class="w"> </span><span class="n">example</span><span class="o">-</span><span class="n">operator</span><span class="o">/</span>
<span class="o">[</span><span class="n">root@kind example-operator</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">operator</span><span class="o">-</span><span class="n">sdk</span><span class="w"> </span><span class="n">init</span><span class="w"> </span><span class="o">--</span><span class="k">domain</span><span class="o">=</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="o">--</span><span class="n">repo</span><span class="o">=</span><span class="n">github</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">andreaskaris</span><span class="o">/</span><span class="n">example</span><span class="o">-</span><span class="n">operator</span>
<span class="n">Writing</span><span class="w"> </span><span class="n">scaffold</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">edit</span><span class="p">...</span>
<span class="k">Get</span><span class="w"> </span><span class="n">controller</span><span class="w"> </span><span class="nl">runtime</span><span class="p">:</span>
<span class="err">$</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">sigs</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">controller</span><span class="o">-</span><span class="n">runtime</span><span class="nv">@v0</span><span class="mf">.6.3</span>
<span class="k">Update</span><span class="w"> </span><span class="k">go</span><span class="p">.</span><span class="k">mod</span><span class="err">:</span>
<span class="err">$</span><span class="w"> </span><span class="k">go</span><span class="w"> </span><span class="k">mod</span><span class="w"> </span><span class="n">tidy</span>
<span class="n">Running</span><span class="w"> </span><span class="nl">make</span><span class="p">:</span>
<span class="err">$</span><span class="w"> </span><span class="n">make</span>
<span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="k">go</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">controller</span><span class="o">-</span><span class="n">gen</span><span class="w"> </span><span class="k">object</span><span class="err">:</span><span class="n">headerFile</span><span class="o">=</span><span class="ss">&quot;hack/boilerplate.go.txt&quot;</span><span class="w"> </span><span class="n">paths</span><span class="o">=</span><span class="ss">&quot;./...&quot;</span>
<span class="k">go</span><span class="w"> </span><span class="n">fmt</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="p">...</span>
<span class="k">go</span><span class="w"> </span><span class="n">vet</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="p">...</span>
<span class="k">go</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">bin</span><span class="o">/</span><span class="n">manager</span><span class="w"> </span><span class="n">main</span><span class="p">.</span><span class="k">go</span>
<span class="k">Next</span><span class="err">:</span><span class="w"> </span><span class="n">define</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="k">with</span><span class="err">:</span>
<span class="err">$</span><span class="w"> </span><span class="n">operator</span><span class="o">-</span><span class="n">sdk</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="n">api</span>
<span class="o">[</span><span class="n">root@kind example-operator</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">operator</span><span class="o">-</span><span class="n">sdk</span><span class="w"> </span><span class="k">create</span><span class="w"> </span><span class="n">api</span><span class="w"> </span><span class="o">--</span><span class="k">group</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="o">--</span><span class="n">version</span><span class="w"> </span><span class="n">v1alpha1</span><span class="w"> </span><span class="o">--</span><span class="n">kind</span><span class="w"> </span><span class="n">Example</span><span class="w"> </span><span class="o">--</span><span class="n">resource</span><span class="o">=</span><span class="k">true</span><span class="w"> </span><span class="o">--</span><span class="n">controller</span><span class="o">=</span><span class="k">true</span>
<span class="n">Writing</span><span class="w"> </span><span class="n">scaffold</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">you</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">edit</span><span class="p">...</span>
<span class="n">api</span><span class="o">/</span><span class="n">v1alpha1</span><span class="o">/</span><span class="n">example_types</span><span class="p">.</span><span class="k">go</span>
<span class="n">controllers</span><span class="o">/</span><span class="n">example_controller</span><span class="p">.</span><span class="k">go</span>
<span class="n">Running</span><span class="w"> </span><span class="nl">make</span><span class="p">:</span>
<span class="err">$</span><span class="w"> </span><span class="n">make</span>
<span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="k">go</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">controller</span><span class="o">-</span><span class="n">gen</span><span class="w"> </span><span class="k">object</span><span class="err">:</span><span class="n">headerFile</span><span class="o">=</span><span class="ss">&quot;hack/boilerplate.go.txt&quot;</span><span class="w"> </span><span class="n">paths</span><span class="o">=</span><span class="ss">&quot;./...&quot;</span>
<span class="k">go</span><span class="w"> </span><span class="n">fmt</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="p">...</span>
<span class="k">go</span><span class="w"> </span><span class="n">vet</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="p">...</span>
<span class="k">go</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">bin</span><span class="o">/</span><span class="n">manager</span><span class="w"> </span><span class="n">main</span><span class="p">.</span><span class="k">go</span>
</code></pre></div></td></tr></table></div></p>
<p>The Example controller will be rendered with:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="nd">@kind</span> <span class="n">example</span><span class="o">-</span><span class="n">operator</span><span class="p">]</span><span class="c1"># cat controllers/example_controller.go </span>
<span class="o">/*</span>
<span class="n">Copyright</span> <span class="mf">2020.</span>

<span class="n">Licensed</span> <span class="n">under</span> <span class="n">the</span> <span class="n">Apache</span> <span class="n">License</span><span class="p">,</span> <span class="n">Version</span> <span class="mf">2.0</span> <span class="p">(</span><span class="n">the</span> <span class="s2">&quot;License&quot;</span><span class="p">);</span>
<span class="n">you</span> <span class="n">may</span> <span class="ow">not</span> <span class="n">use</span> <span class="n">this</span> <span class="n">file</span> <span class="k">except</span> <span class="ow">in</span> <span class="n">compliance</span> <span class="k">with</span> <span class="n">the</span> <span class="n">License</span><span class="o">.</span>
<span class="n">You</span> <span class="n">may</span> <span class="n">obtain</span> <span class="n">a</span> <span class="n">copy</span> <span class="n">of</span> <span class="n">the</span> <span class="n">License</span> <span class="n">at</span>

    <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="o">.</span><span class="n">apache</span><span class="o">.</span><span class="n">org</span><span class="o">/</span><span class="n">licenses</span><span class="o">/</span><span class="n">LICENSE</span><span class="o">-</span><span class="mf">2.0</span>

<span class="n">Unless</span> <span class="n">required</span> <span class="n">by</span> <span class="n">applicable</span> <span class="n">law</span> <span class="ow">or</span> <span class="n">agreed</span> <span class="n">to</span> <span class="ow">in</span> <span class="n">writing</span><span class="p">,</span> <span class="n">software</span>
<span class="n">distributed</span> <span class="n">under</span> <span class="n">the</span> <span class="n">License</span> <span class="ow">is</span> <span class="n">distributed</span> <span class="n">on</span> <span class="n">an</span> <span class="s2">&quot;AS IS&quot;</span> <span class="n">BASIS</span><span class="p">,</span>
<span class="n">WITHOUT</span> <span class="n">WARRANTIES</span> <span class="n">OR</span> <span class="n">CONDITIONS</span> <span class="n">OF</span> <span class="n">ANY</span> <span class="n">KIND</span><span class="p">,</span> <span class="n">either</span> <span class="n">express</span> <span class="ow">or</span> <span class="n">implied</span><span class="o">.</span>
<span class="n">See</span> <span class="n">the</span> <span class="n">License</span> <span class="k">for</span> <span class="n">the</span> <span class="n">specific</span> <span class="n">language</span> <span class="n">governing</span> <span class="n">permissions</span> <span class="ow">and</span>
<span class="n">limitations</span> <span class="n">under</span> <span class="n">the</span> <span class="n">License</span><span class="o">.</span>
<span class="o">*/</span>

<span class="n">package</span> <span class="n">controllers</span>

<span class="kn">import</span> <span class="p">(</span>
    <span class="s2">&quot;context&quot;</span>

    <span class="s2">&quot;github.com/go-logr/logr&quot;</span>
    <span class="s2">&quot;k8s.io/apimachinery/pkg/runtime&quot;</span>
    <span class="n">ctrl</span> <span class="s2">&quot;sigs.k8s.io/controller-runtime&quot;</span>
    <span class="s2">&quot;sigs.k8s.io/controller-runtime/pkg/client&quot;</span>

    <span class="n">examplev1alpha1</span> <span class="s2">&quot;github.com/andreaskaris/example-operator/api/v1alpha1&quot;</span>
<span class="p">)</span>

<span class="o">//</span> <span class="n">ExampleReconciler</span> <span class="n">reconciles</span> <span class="n">a</span> <span class="n">Example</span> <span class="nb">object</span>
<span class="nb">type</span> <span class="n">ExampleReconciler</span> <span class="n">struct</span> <span class="p">{</span>
    <span class="n">client</span><span class="o">.</span><span class="n">Client</span>
    <span class="n">Log</span>    <span class="n">logr</span><span class="o">.</span><span class="n">Logger</span>
    <span class="n">Scheme</span> <span class="o">*</span><span class="n">runtime</span><span class="o">.</span><span class="n">Scheme</span>
<span class="p">}</span>

<span class="o">//</span> <span class="o">+</span><span class="n">kubebuilder</span><span class="p">:</span><span class="n">rbac</span><span class="p">:</span><span class="n">groups</span><span class="o">=</span><span class="n">example</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="n">resources</span><span class="o">=</span><span class="n">examples</span><span class="p">,</span><span class="n">verbs</span><span class="o">=</span><span class="n">get</span><span class="p">;</span><span class="nb">list</span><span class="p">;</span><span class="n">watch</span><span class="p">;</span><span class="n">create</span><span class="p">;</span><span class="n">update</span><span class="p">;</span><span class="n">patch</span><span class="p">;</span><span class="n">delete</span>
<span class="o">//</span> <span class="o">+</span><span class="n">kubebuilder</span><span class="p">:</span><span class="n">rbac</span><span class="p">:</span><span class="n">groups</span><span class="o">=</span><span class="n">example</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="n">resources</span><span class="o">=</span><span class="n">examples</span><span class="o">/</span><span class="n">status</span><span class="p">,</span><span class="n">verbs</span><span class="o">=</span><span class="n">get</span><span class="p">;</span><span class="n">update</span><span class="p">;</span><span class="n">patch</span>

<span class="n">func</span> <span class="p">(</span><span class="n">r</span> <span class="o">*</span><span class="n">ExampleReconciler</span><span class="p">)</span> <span class="n">Reconcile</span><span class="p">(</span><span class="n">req</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">Request</span><span class="p">)</span> <span class="p">(</span><span class="n">ctrl</span><span class="o">.</span><span class="n">Result</span><span class="p">,</span> <span class="n">error</span><span class="p">)</span> <span class="p">{</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">Background</span><span class="p">()</span>
    <span class="n">_</span> <span class="o">=</span> <span class="n">r</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">WithValues</span><span class="p">(</span><span class="s2">&quot;example&quot;</span><span class="p">,</span> <span class="n">req</span><span class="o">.</span><span class="n">NamespacedName</span><span class="p">)</span>

    <span class="o">//</span> <span class="n">your</span> <span class="n">logic</span> <span class="n">here</span>

    <span class="k">return</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">Result</span><span class="p">{},</span> <span class="n">nil</span>
<span class="p">}</span>

<span class="n">func</span> <span class="p">(</span><span class="n">r</span> <span class="o">*</span><span class="n">ExampleReconciler</span><span class="p">)</span> <span class="n">SetupWithManager</span><span class="p">(</span><span class="n">mgr</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">Manager</span><span class="p">)</span> <span class="n">error</span> <span class="p">{</span>
    <span class="k">return</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">NewControllerManagedBy</span><span class="p">(</span><span class="n">mgr</span><span class="p">)</span><span class="o">.</span>
        <span class="n">For</span><span class="p">(</span><span class="o">&amp;</span><span class="n">examplev1alpha1</span><span class="o">.</span><span class="n">Example</span><span class="p">{})</span><span class="o">.</span>
        <span class="n">Complete</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<p>Reconciliation logic goes into <code class="highlight">Reconcile</code>. The <code class="highlight">Reconcile</code> method is handed both a <code class="highlight">context.Context</code> and a <code class="highlight">reconcile.Request</code>:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// Request contains the information necessary to reconcile a Kubernetes object.  This includes the</span>
<span class="c1">// information to uniquely identify the object - its Name and Namespace.  It does NOT contain information about</span>
<span class="c1">// any specific Event or the object contents itself.</span>
<span class="nb">type</span><span class="w"> </span><span class="n">Request</span><span class="w"> </span><span class="nb">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// NamespacedName is the name and namespace of the object to reconcile.</span>
<span class="w">    </span><span class="n">types</span><span class="p">.</span><span class="n">NamespacedName</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<blockquote>
<p><a href="https://github.com/kubernetes-sigs/controller-runtime/blob/43331a6c8f823b497660b368deb4311ae2030206/pkg/reconcile/reconcile.go#L44">https://github.com/kubernetes-sigs/controller-runtime/blob/43331a6c8f823b497660b368deb4311ae2030206/pkg/reconcile/reconcile.go#L44</a></p>
</blockquote>
<h3 id="excursion-into-some-background">Excursion into some background</h3>
<p>You can safely skip this section and continue with the next one ;-)</p>
<h4 id="about-the-client-interface">About the client interface</h4>
<p>When retrieving objects from the API, we refer to the <code class="highlight">context</code>:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">        </span><span class="c1">// retrieve sosreport CRD</span>
<span class="w">        </span><span class="n">example</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">examplev1alpha1</span><span class="p">.</span><span class="n">Example</span><span class="p">{}</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="p">:=</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">Get</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">.</span><span class="n">NamespacedName</span><span class="p">,</span><span class="w"> </span><span class="n">example</span><span class="p">);</span><span class="w"> </span><span class="n">err</span><span class="w"> </span>!<span class="p">=</span><span class="w"> </span><span class="n">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="nb">log</span><span class="p">.</span><span class="n">Error</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Failed to get Example custom resource&quot;</span><span class="p">)</span>
<span class="w">                </span><span class="k">return</span><span class="w"> </span><span class="n">ctrl</span><span class="p">.</span><span class="n">Result</span><span class="p">{},</span><span class="w"> </span><span class="n">err</span>
<span class="w">        </span><span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">Package</span><span class="w"> </span><span class="n">context</span><span class="w"> </span><span class="n">defines</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Context</span><span class="w"> </span><span class="n">type</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">carries</span><span class="w"> </span><span class="n">deadlines</span><span class="p">,</span><span class="w"> </span><span class="n">cancellation</span><span class="w"> </span><span class="n">signals</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">request</span><span class="o">-</span><span class="n">scoped</span><span class="w"> </span><span class="n">values</span><span class="w"> </span><span class="n">across</span><span class="w"> </span><span class="n">API</span><span class="w"> </span><span class="n">boundaries</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">between</span><span class="w"> </span><span class="n">processes</span><span class="o">.</span><span class="w"> </span>
</code></pre></div></td></tr></table></div>
<blockquote>
<p><a href="https://golang.org/pkg/context">https://golang.org/pkg/context</a></p>
</blockquote>
<p>The controller's reconciler struct inherits its methods from the Client interface:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// ExampleReconciler reconciles a Example object</span>
<span class="nb">type</span><span class="w"> </span><span class="n">ExampleReconciler</span><span class="w"> </span><span class="nb">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">client</span><span class="p">.</span><span class="n">Client</span>
<span class="w">        </span><span class="n">Log</span><span class="w">    </span><span class="n">logr</span><span class="p">.</span><span class="n">Logger</span>
<span class="w">        </span><span class="n">Scheme</span><span class="w"> </span><span class="o">*</span><span class="n">runtime</span><span class="p">.</span><span class="n">Scheme</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code>type Client interface {
    Reader
    Writer
    StatusClient

    // Scheme returns the scheme this client is using.
    Scheme() *runtime.Scheme
    // RESTMapper returns the rest this client is using.
    RESTMapper() meta.RESTMapper
}
</code></pre></div></td></tr></table></div>
<blockquote>
<p><a href="https://godoc.org/sigs.k8s.io/controller-runtime/pkg/client#Client">https://godoc.org/sigs.k8s.io/controller-runtime/pkg/client#Client</a></p>
</blockquote>
<p>For example, the <code class="highlight">Get</code> and <code class="highlight">List</code> methods are inherited from <code class="highlight">Reader</code>:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nv">type</span><span class="w"> </span><span class="nv">Reader</span><span class="w"> </span><span class="nv">interface</span><span class="w"> </span>{
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">Get</span><span class="w"> </span><span class="nv">retrieves</span><span class="w"> </span><span class="nv">an</span><span class="w"> </span><span class="nv">obj</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">given</span><span class="w"> </span><span class="nv">object</span><span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="nv">from</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">Kubernetes</span><span class="w"> </span><span class="nv">Cluster</span>.
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">obj</span><span class="w"> </span><span class="nv">must</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">struct</span><span class="w"> </span><span class="nv">pointer</span><span class="w"> </span><span class="nv">so</span><span class="w"> </span><span class="nv">that</span><span class="w"> </span><span class="nv">obj</span><span class="w"> </span><span class="nv">can</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">updated</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">response</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">returned</span><span class="w"> </span><span class="nv">by</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">Server</span>.
<span class="w">    </span><span class="nv">Get</span><span class="ss">(</span><span class="nv">ctx</span><span class="w"> </span><span class="nv">context</span>.<span class="nv">Context</span>,<span class="w"> </span><span class="nv">key</span><span class="w"> </span><span class="nv">ObjectKey</span>,<span class="w"> </span><span class="nv">obj</span><span class="w"> </span><span class="nv">Object</span><span class="ss">)</span><span class="w"> </span><span class="nv">error</span>

<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">List</span><span class="w"> </span><span class="nv">retrieves</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">objects</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">given</span><span class="w"> </span><span class="nv">namespace</span><span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="nv">options</span>.<span class="w"> </span><span class="nv">On</span><span class="w"> </span><span class="nv">a</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nv">successful</span><span class="w"> </span><span class="nv">call</span>,<span class="w"> </span><span class="nv">Items</span><span class="w"> </span><span class="nv">field</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="nv">will</span><span class="w"> </span><span class="nv">be</span><span class="w"> </span><span class="nv">populated</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">the</span>
<span class="w">    </span><span class="o">//</span><span class="w"> </span><span class="nb">result</span><span class="w"> </span><span class="nv">returned</span><span class="w"> </span><span class="nv">from</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">server</span>.
<span class="w">    </span><span class="nv">List</span><span class="ss">(</span><span class="nv">ctx</span><span class="w"> </span><span class="nv">context</span>.<span class="nv">Context</span>,<span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="nv">ObjectList</span>,<span class="w"> </span><span class="nv">opts</span><span class="w"> </span>...<span class="nv">ListOption</span><span class="ss">)</span><span class="w"> </span><span class="nv">error</span>
}
</code></pre></div></td></tr></table></div></p>
<blockquote>
<p><a href="https://godoc.org/sigs.k8s.io/controller-runtime/pkg/client#Reader">https://godoc.org/sigs.k8s.io/controller-runtime/pkg/client#Reader</a></p>
</blockquote>
<p>The <code class="highlight">Get</code> method for the client is implemented here:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">func</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">*</span><span class="n">client</span><span class="p">)</span><span class="w"> </span><span class="n">Get</span><span class="p">(</span><span class="n">ctx</span><span class="w"> </span><span class="n">context</span><span class="o">.</span><span class="n">Context</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">ObjectKey</span><span class="p">,</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="nb nb-Type">Object</span><span class="p">)</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">switch</span><span class="w"> </span><span class="n">obj</span><span class="o">.</span><span class="p">(</span><span class="n">type</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">case</span><span class="w"> </span><span class="o">*</span><span class="n">unstructured</span><span class="o">.</span><span class="n">Unstructured</span><span class="p">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">c</span><span class="o">.</span><span class="n">unstructuredClient</span><span class="o">.</span><span class="n">Get</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span>
<span class="w">    </span><span class="n">case</span><span class="w"> </span><span class="o">*</span><span class="n">metav1</span><span class="o">.</span><span class="n">PartialObjectMetadata</span><span class="p">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">c</span><span class="o">.</span><span class="n">metadataClient</span><span class="o">.</span><span class="n">Get</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span>
<span class="w">    </span><span class="n">default</span><span class="p">:</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">c</span><span class="o">.</span><span class="n">typedClient</span><span class="o">.</span><span class="n">Get</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="p">,</span><span class="w"> </span><span class="n">obj</span><span class="p">)</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<blockquote>
<p><a href="https://github.com/kubernetes-sigs/controller-runtime/blob/43331a6c8f823b497660b368deb4311ae2030206/pkg/client/client.go#L204">https://github.com/kubernetes-sigs/controller-runtime/blob/43331a6c8f823b497660b368deb4311ae2030206/pkg/client/client.go#L204</a></p>
</blockquote>
<p><code class="highlight">typeClient</code> then reads as follows:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="k">Get</span><span class="w"> </span><span class="k">implements</span><span class="w"> </span><span class="n">client</span><span class="p">.</span><span class="n">Client</span>
<span class="n">func</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">*</span><span class="n">typedClient</span><span class="p">)</span><span class="w"> </span><span class="k">Get</span><span class="p">(</span><span class="n">ctx</span><span class="w"> </span><span class="n">context</span><span class="p">.</span><span class="n">Context</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="n">ObjectKey</span><span class="p">,</span><span class="w"> </span><span class="n">obj</span><span class="w"> </span><span class="kt">Object</span><span class="p">)</span><span class="w"> </span><span class="k">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">r</span><span class="p">,</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">c</span><span class="p">.</span><span class="n">cache</span><span class="p">.</span><span class="n">getResource</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="p">!</span><span class="o">=</span><span class="w"> </span><span class="n">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">err</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">Get</span><span class="p">().</span>
<span class="w">        </span><span class="n">NamespaceIfScoped</span><span class="p">(</span><span class="n">key</span><span class="p">.</span><span class="n">Namespace</span><span class="p">,</span><span class="w"> </span><span class="n">r</span><span class="p">.</span><span class="n">isNamespaced</span><span class="p">()).</span>
<span class="w">        </span><span class="n">Resource</span><span class="p">(</span><span class="n">r</span><span class="p">.</span><span class="n">resource</span><span class="p">()).</span>
<span class="w">        </span><span class="n">Name</span><span class="p">(</span><span class="n">key</span><span class="p">.</span><span class="n">Name</span><span class="p">).</span><span class="n">Do</span><span class="p">(</span><span class="n">ctx</span><span class="p">).</span><span class="n">Into</span><span class="p">(</span><span class="n">obj</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<blockquote>
<p><a href="https://github.com/kubernetes-sigs/controller-runtime/blob/4462fd4ebb88171af826622c1d6b73383aaf2cdf/pkg/client/typed_client.go#L135">https://github.com/kubernetes-sigs/controller-runtime/blob/4462fd4ebb88171af826622c1d6b73383aaf2cdf/pkg/client/typed_client.go#L135</a></p>
</blockquote>
<p>We could go further down the rabbit hole, but:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="n">getResource</span><span class="w"> </span><span class="n">returns</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">meta</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">object</span><span class="o">.</span>
<span class="o">//</span><span class="w"> </span><span class="n">If</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">object</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">list</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">represents</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">item</span><span class="s1">&#39;s type instead.</span>
<span class="k">func</span><span class="w"> </span><span class="p">(</span><span class="n">c</span><span class="w"> </span><span class="o">*</span><span class="n">clientCache</span><span class="p">)</span><span class="w"> </span><span class="n">getResource</span><span class="p">(</span><span class="n">obj</span><span class="w"> </span><span class="n">runtime</span><span class="o">.</span><span class="n">Object</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">resourceMeta</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</code></pre></div></td></tr></table></div></p>
<blockquote>
<p><a href="https://github.com/kubernetes-sigs/controller-runtime/blob/e2261d96d733bbd8b26e1c61b138c12a2408026c/pkg/client/client_cache.go#L73">https://github.com/kubernetes-sigs/controller-runtime/blob/e2261d96d733bbd8b26e1c61b138c12a2408026c/pkg/client/client_cache.go#L73</a></p>
</blockquote>
<p><code class="highlight">resourceMeta</code> implements rest.Interface from <code class="highlight"><span class="ss">&quot;k8s.io/client-go/rest&quot;</span></code>:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="c1">// resourceMeta caches state for a Kubernetes type.</span>
<span class="nb">type</span><span class="w"> </span><span class="n">resourceMeta</span><span class="w"> </span><span class="nb">struct</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// client is the rest client used to talk to the apiserver</span>
<span class="w">    </span><span class="n">rest</span><span class="p">.</span><span class="n">Interface</span>
<span class="w">    </span><span class="c1">// gvk is the GroupVersionKind of the resourceMeta</span>
<span class="w">    </span><span class="n">gvk</span><span class="w"> </span><span class="n">schema</span><span class="p">.</span><span class="n">GroupVersionKind</span>
<span class="w">    </span><span class="c1">// mapping is the rest mapping</span>
<span class="w">    </span><span class="n">mapping</span><span class="w"> </span><span class="o">*</span><span class="n">meta</span><span class="p">.</span><span class="n">RESTMapping</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<blockquote>
<p><a href="https://github.com/kubernetes-sigs/controller-runtime/blob/e2261d96d733bbd8b26e1c61b138c12a2408026c/pkg/client/client_cache.go#L123">https://github.com/kubernetes-sigs/controller-runtime/blob/e2261d96d733bbd8b26e1c61b138c12a2408026c/pkg/client/client_cache.go#L123</a></p>
</blockquote>
<p>So, <code class="highlight">r.Get()</code> will return a <code class="highlight">Request</code> of type <code class="highlight">HTTP</code> <code class="highlight">GET</code>: <a href="https://godoc.org/k8s.io/client-go/rest#Interface">https://godoc.org/k8s.io/client-go/rest#Interface</a></p>
<p><code class="highlight">r.Get().NamespaceIfScoped(key.Namespace, r.isNamespaced())</code>  will set the namespace if the object's <code class="highlight">kind</code> is namespaced (GET <resource>/[ns/<namespace>/]): <a href="https://godoc.org/k8s.io/client-go/rest#Request.NamespaceIfScoped">https://godoc.org/k8s.io/client-go/rest#Request.NamespaceIfScoped</a></p>
<p><code class="highlight">r.Get().NamespaceIfScoped(key.Namespace, r.isNamespaced()).Resource(r.resource())</code> sets the resource to access (GET <resource>/[ns/<namespace>/]<name>): <a href="https://godoc.org/k8s.io/client-go/rest#Request.Resource">https://godoc.org/k8s.io/client-go/rest#Request.Resource</a></p>
<p><code class="highlight">r.Get().NamespaceIfScoped(key.Namespace, r.isNamespaced()).Resource(r.resource()).Name(key.Name)</code> sets the name of a resource to access (GET <resource>/[ns/<namespace>/]<name>): <a href="https://godoc.org/k8s.io/client-go/rest#Request.Name">https://godoc.org/k8s.io/client-go/rest#Request.Name</a></p>
<p><code class="highlight"><span class="nv">r</span>.<span class="nv">Get</span><span class="ss">()</span>.<span class="nv">NamespaceIfScoped</span><span class="ss">(</span><span class="nv">key</span>.<span class="nv">Namespace</span>,<span class="w"> </span><span class="nv">r</span>.<span class="nv">isNamespaced</span><span class="ss">())</span>.<span class="nv">Resource</span><span class="ss">(</span><span class="nv">r</span>.<span class="nv">resource</span><span class="ss">())</span>.<span class="nv">Name</span><span class="ss">(</span><span class="nv">key</span>.<span class="nv">Name</span><span class="ss">)</span>.<span class="k">Do</span><span class="ss">(</span><span class="nv">ctx</span><span class="ss">)</span></code> formats and executes the request. Returns a Result object for easy response processing: <a href="https://godoc.org/k8s.io/client-go/rest#Request.Do">https://godoc.org/k8s.io/client-go/rest#Request.Do</a></p>
<p><code class="highlight"><span class="nv">r</span>.<span class="nv">Get</span><span class="ss">()</span>.<span class="nv">NamespaceIfScoped</span><span class="ss">(</span><span class="nv">key</span>.<span class="nv">Namespace</span>,<span class="w"> </span><span class="nv">r</span>.<span class="nv">isNamespaced</span><span class="ss">())</span>.<span class="nv">Resource</span><span class="ss">(</span><span class="nv">r</span>.<span class="nv">resource</span><span class="ss">())</span>.<span class="nv">Name</span><span class="ss">(</span><span class="nv">key</span>.<span class="nv">Name</span><span class="ss">)</span>.<span class="k">Do</span><span class="ss">(</span><span class="nv">ctx</span><span class="ss">)</span>.<span class="nv">Into</span><span class="ss">(</span><span class="nv">obj</span><span class="ss">)</span></code> converts the <code class="highlight">Result</code> object by writing the result into the object. Once this is successfully done, <code class="highlight">obj</code> will now contain what was retrieved by running the query.</p>
<h4 id="context-contexttodo-contextbackground">context, context.TODO(), context.Background()</h4>
<p>I have to do some further research, but:</p>
<ul>
<li><a href="https://essential-go.programming-books.io/context-todo-vs-context-background-d5224e27ff724a33a79cb4e03a5eb333">https://essential-go.programming-books.io/context-todo-vs-context-background-d5224e27ff724a33a79cb4e03a5eb333</a></li>
<li><a href="https://developer.mongodb.com/community/forums/t/go-why-context-todo-and-not-context-background/5009/2">https://developer.mongodb.com/community/forums/t/go-why-context-todo-and-not-context-background/5009/2</a></li>
<li><a href="https://ddcode.net/2019/05/11/is-golangs-context-background-and-context-todo-the-same-behavior/">https://ddcode.net/2019/05/11/is-golangs-context-background-and-context-todo-the-same-behavior/</a></li>
</ul>
<h3 id="working-with-reconcile">Working with <code class="highlight">Reconcile</code></h3>
<h4 id="what-triggers-reconcile-and-what-information-is-passed-to-the-method">What triggers <code class="highlight">Reconcile</code> and what information is passed to the method?</h4>
<p>Let's modify the <code class="highlight">Reconcile</code> method to log whenever it is triggered and to capture the contents of the req object.
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">//</span><span class="w"> </span><span class="o">+</span><span class="n">kubebuilder</span><span class="p">:</span><span class="n">rbac</span><span class="p">:</span><span class="n">groups</span><span class="o">=</span><span class="n">example</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="n">resources</span><span class="o">=</span><span class="n">examples</span><span class="p">,</span><span class="n">verbs</span><span class="o">=</span><span class="n">get</span><span class="p">;</span><span class="n">list</span><span class="p">;</span><span class="n">watch</span><span class="p">;</span><span class="n">create</span><span class="p">;</span><span class="n">update</span><span class="p">;</span><span class="n">patch</span><span class="p">;</span><span class="n">delete</span>
<span class="o">//</span><span class="w"> </span><span class="o">+</span><span class="n">kubebuilder</span><span class="p">:</span><span class="n">rbac</span><span class="p">:</span><span class="n">groups</span><span class="o">=</span><span class="n">example</span><span class="o">.</span><span class="n">example</span><span class="o">.</span><span class="n">com</span><span class="p">,</span><span class="n">resources</span><span class="o">=</span><span class="n">examples</span><span class="o">/</span><span class="n">status</span><span class="p">,</span><span class="n">verbs</span><span class="o">=</span><span class="n">get</span><span class="p">;</span><span class="n">update</span><span class="p">;</span><span class="n">patch</span>

<span class="k">func</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">*</span><span class="n">ExampleReconciler</span><span class="p">)</span><span class="w"> </span><span class="n">Reconcile</span><span class="p">(</span><span class="n">req</span><span class="w"> </span><span class="n">ctrl</span><span class="o">.</span><span class="n">Request</span><span class="p">)</span><span class="w"> </span><span class="p">(</span><span class="n">ctrl</span><span class="o">.</span><span class="n">Result</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">context</span><span class="o">.</span><span class="n">Background</span><span class="p">()</span>
<span class="w">        </span><span class="nb">log</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">r</span><span class="o">.</span><span class="n">Log</span><span class="o">.</span><span class="n">WithValues</span><span class="p">(</span><span class="s2">&quot;example&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">req</span><span class="p">)</span><span class="w"> </span><span class="o">//</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">variables</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">shown</span><span class="w"> </span><span class="n">whenever</span><span class="w"> </span><span class="nb">log</span><span class="w"> </span><span class="nb">prints</span>
<span class="w">        </span><span class="nb">log</span><span class="o">.</span><span class="n">Info</span><span class="p">(</span><span class="s2">&quot;Reconciler triggered with req:&quot;</span><span class="p">)</span>

<span class="w">        </span><span class="o">//</span><span class="w"> </span><span class="n">your</span><span class="w"> </span><span class="n">logic</span><span class="w"> </span><span class="n">here</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ctrl</span><span class="o">.</span><span class="n">Result</span><span class="p">{},</span><span class="w"> </span><span class="n">nil</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<p>Compile, install:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@kind example-operator</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">generate</span>
<span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="k">go</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">controller</span><span class="o">-</span><span class="n">gen</span><span class="w"> </span><span class="k">object</span><span class="err">:</span><span class="n">headerFile</span><span class="o">=</span><span class="ss">&quot;hack/boilerplate.go.txt&quot;</span><span class="w"> </span><span class="n">paths</span><span class="o">=</span><span class="ss">&quot;./...&quot;</span>
<span class="o">[</span><span class="n">root@kind example-operator</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">manifests</span>
<span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="k">go</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">controller</span><span class="o">-</span><span class="n">gen</span><span class="w"> </span><span class="ss">&quot;crd:trivialVersions=true&quot;</span><span class="w"> </span><span class="nl">rbac</span><span class="p">:</span><span class="n">roleName</span><span class="o">=</span><span class="n">manager</span><span class="o">-</span><span class="k">role</span><span class="w"> </span><span class="n">webhook</span><span class="w"> </span><span class="n">paths</span><span class="o">=</span><span class="ss">&quot;./...&quot;</span><span class="w"> </span><span class="k">output</span><span class="err">:</span><span class="nl">crd</span><span class="p">:</span><span class="nl">artifacts</span><span class="p">:</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="o">/</span><span class="n">crd</span><span class="o">/</span><span class="n">bases</span>
<span class="o">[</span><span class="n">root@kind example-operator</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">manifests</span>
<span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="k">go</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">controller</span><span class="o">-</span><span class="n">gen</span><span class="w"> </span><span class="ss">&quot;crd:trivialVersions=true&quot;</span><span class="w"> </span><span class="nl">rbac</span><span class="p">:</span><span class="n">roleName</span><span class="o">=</span><span class="n">manager</span><span class="o">-</span><span class="k">role</span><span class="w"> </span><span class="n">webhook</span><span class="w"> </span><span class="n">paths</span><span class="o">=</span><span class="ss">&quot;./...&quot;</span><span class="w"> </span><span class="k">output</span><span class="err">:</span><span class="nl">crd</span><span class="p">:</span><span class="nl">artifacts</span><span class="p">:</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="o">/</span><span class="n">crd</span><span class="o">/</span><span class="n">bases</span>
<span class="o">[</span><span class="n">root@kind example-operator</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">install</span>
<span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="k">go</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">controller</span><span class="o">-</span><span class="n">gen</span><span class="w"> </span><span class="ss">&quot;crd:trivialVersions=true&quot;</span><span class="w"> </span><span class="nl">rbac</span><span class="p">:</span><span class="n">roleName</span><span class="o">=</span><span class="n">manager</span><span class="o">-</span><span class="k">role</span><span class="w"> </span><span class="n">webhook</span><span class="w"> </span><span class="n">paths</span><span class="o">=</span><span class="ss">&quot;./...&quot;</span><span class="w"> </span><span class="k">output</span><span class="err">:</span><span class="nl">crd</span><span class="p">:</span><span class="nl">artifacts</span><span class="p">:</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="o">/</span><span class="n">crd</span><span class="o">/</span><span class="n">bases</span>
<span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="k">go</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">kustomize</span><span class="w"> </span><span class="n">build</span><span class="w"> </span><span class="n">config</span><span class="o">/</span><span class="n">crd</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">kubectl</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="o">-</span>
<span class="nl">Warning</span><span class="p">:</span><span class="w"> </span><span class="n">apiextensions</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1beta1</span><span class="w"> </span><span class="n">CustomResourceDefinition</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">deprecated</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">v1</span><span class="mf">.16</span><span class="o">+</span><span class="p">,</span><span class="w"> </span><span class="n">unavailable</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">v1</span><span class="mf">.22</span><span class="o">+</span><span class="p">;</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="n">apiextensions</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1</span><span class="w"> </span><span class="n">CustomResourceDefinition</span>
<span class="n">customresourcedefinition</span><span class="p">.</span><span class="n">apiextensions</span><span class="p">.</span><span class="n">k8s</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">examples</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="w"> </span><span class="n">created</span>
</code></pre></div></td></tr></table></div></p>
<p>And run locally:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@kind example-operator</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">ENABLE_WEBHOOKS</span><span class="o">=</span><span class="k">false</span>
<span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="k">go</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">controller</span><span class="o">-</span><span class="n">gen</span><span class="w"> </span><span class="k">object</span><span class="err">:</span><span class="n">headerFile</span><span class="o">=</span><span class="ss">&quot;hack/boilerplate.go.txt&quot;</span><span class="w"> </span><span class="n">paths</span><span class="o">=</span><span class="ss">&quot;./...&quot;</span>
<span class="k">go</span><span class="w"> </span><span class="n">fmt</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="p">...</span>
<span class="k">go</span><span class="w"> </span><span class="n">vet</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="p">...</span>
<span class="o">/</span><span class="n">root</span><span class="o">/</span><span class="k">go</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">controller</span><span class="o">-</span><span class="n">gen</span><span class="w"> </span><span class="ss">&quot;crd:trivialVersions=true&quot;</span><span class="w"> </span><span class="nl">rbac</span><span class="p">:</span><span class="n">roleName</span><span class="o">=</span><span class="n">manager</span><span class="o">-</span><span class="k">role</span><span class="w"> </span><span class="n">webhook</span><span class="w"> </span><span class="n">paths</span><span class="o">=</span><span class="ss">&quot;./...&quot;</span><span class="w"> </span><span class="k">output</span><span class="err">:</span><span class="nl">crd</span><span class="p">:</span><span class="nl">artifacts</span><span class="p">:</span><span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="o">/</span><span class="n">crd</span><span class="o">/</span><span class="n">bases</span>
<span class="k">go</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">main</span><span class="p">.</span><span class="k">go</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span><span class="nl">T14</span><span class="p">:</span><span class="mi">52</span><span class="err">:</span><span class="mf">01.520</span><span class="o">-</span><span class="mi">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="n">controller</span><span class="o">-</span><span class="n">runtime</span><span class="p">.</span><span class="n">metrics</span><span class="w">  </span><span class="n">metrics</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">starting</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">listen</span><span class="w">    </span><span class="err">{</span><span class="ss">&quot;addr&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;:8080&quot;</span><span class="err">}</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span><span class="nl">T14</span><span class="p">:</span><span class="mi">52</span><span class="err">:</span><span class="mf">01.522</span><span class="o">-</span><span class="mi">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="n">setup</span><span class="w">   </span><span class="n">starting</span><span class="w"> </span><span class="n">manager</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span><span class="nl">T14</span><span class="p">:</span><span class="mi">52</span><span class="err">:</span><span class="mf">01.524</span><span class="o">-</span><span class="mi">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="n">controller</span><span class="o">-</span><span class="n">runtime</span><span class="p">.</span><span class="n">manager</span><span class="w">  </span><span class="n">starting</span><span class="w"> </span><span class="n">metrics</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="err">{</span><span class="ss">&quot;path&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;/metrics&quot;</span><span class="err">}</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span><span class="nl">T14</span><span class="p">:</span><span class="mi">52</span><span class="err">:</span><span class="mf">01.524</span><span class="o">-</span><span class="mi">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="n">controller</span><span class="w">  </span><span class="n">Starting</span><span class="w"> </span><span class="n">EventSource</span><span class="w">    </span><span class="err">{</span><span class="ss">&quot;reconcilerGroup&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;example.example.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;reconcilerKind&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;Example&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;controller&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;example&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;source&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;kind source: /, Kind=&quot;</span><span class="err">}</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span><span class="nl">T14</span><span class="p">:</span><span class="mi">52</span><span class="err">:</span><span class="mf">01.625</span><span class="o">-</span><span class="mi">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="n">controller</span><span class="w">  </span><span class="n">Starting</span><span class="w"> </span><span class="n">Controller</span><span class="w"> </span><span class="err">{</span><span class="ss">&quot;reconcilerGroup&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;example.example.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;reconcilerKind&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;Example&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;controller&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;example&quot;</span><span class="err">}</span>
<span class="mi">2020</span><span class="o">-</span><span class="mi">11</span><span class="o">-</span><span class="mi">30</span><span class="nl">T14</span><span class="p">:</span><span class="mi">52</span><span class="err">:</span><span class="mf">01.625</span><span class="o">-</span><span class="mi">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="n">controller</span><span class="w">  </span><span class="n">Starting</span><span class="w"> </span><span class="n">workers</span><span class="w">    </span><span class="err">{</span><span class="ss">&quot;reconcilerGroup&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;example.example.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;reconcilerKind&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;Example&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;controller&quot;</span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;example&quot;</span><span class="p">,</span><span class="w"> </span><span class="ss">&quot;worker count&quot;</span><span class="err">:</span><span class="w"> </span><span class="mi">1</span><span class="err">}</span>
</code></pre></div></td></tr></table></div></p>
<p>So far, the reconciler has not been triggered. So how can we trigger it? In comes the <code class="highlight">SetupWithManager</code> method:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">func</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">*</span><span class="n">ExampleReconciler</span><span class="p">)</span><span class="w"> </span><span class="n">SetupWithManager</span><span class="p">(</span><span class="n">mgr</span><span class="w"> </span><span class="n">ctrl</span><span class="o">.</span><span class="n">Manager</span><span class="p">)</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ctrl</span><span class="o">.</span><span class="n">NewControllerManagedBy</span><span class="p">(</span><span class="n">mgr</span><span class="p">)</span><span class="o">.</span>
<span class="w">                </span><span class="n">For</span><span class="p">(</span><span class="o">&amp;</span><span class="n">examplev1alpha1</span><span class="o">.</span><span class="n">Example</span><span class="p">{})</span><span class="o">.</span>
<span class="w">                </span><span class="n">Complete</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<p>We'll go into more details a bit later, but this triggers execution of <code class="highlight">Reconcile</code> of this controller whenever a Create, Update, Delete happens to an <code class="highlight">Example</code> Custom Resource:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@kind example-operator</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="n">config</span><span class="o">/</span><span class="n">samples</span><span class="o">/</span><span class="n">example_v1alpha1_example_namespace_test1</span><span class="p">.</span><span class="n">yaml</span>
<span class="nl">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">v1alpha1</span>
<span class="nl">kind</span><span class="p">:</span><span class="w"> </span><span class="n">Example</span>
<span class="nl">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">example</span><span class="o">-</span><span class="n">sample</span>
<span class="w">  </span><span class="nl">namespace</span><span class="p">:</span><span class="w"> </span><span class="n">test1</span>
<span class="nl">spec</span><span class="p">:</span>
<span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="k">Add</span><span class="w"> </span><span class="n">fields</span><span class="w"> </span><span class="n">here</span>
<span class="w">  </span><span class="nl">foo</span><span class="p">:</span><span class="w"> </span><span class="n">bar</span>
<span class="o">[</span><span class="n">root@kind example-operator</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="n">config</span><span class="o">/</span><span class="n">samples</span><span class="o">/</span><span class="n">example_v1alpha1_example_namespace_test2</span><span class="p">.</span><span class="n">yaml</span>
<span class="nl">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">v1alpha1</span>
<span class="nl">kind</span><span class="p">:</span><span class="w"> </span><span class="n">Example</span>
<span class="nl">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">example</span><span class="o">-</span><span class="n">sample2</span>
<span class="w">  </span><span class="nl">namespace</span><span class="p">:</span><span class="w"> </span><span class="n">test2</span>
<span class="nl">spec</span><span class="p">:</span>
<span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="k">Add</span><span class="w"> </span><span class="n">fields</span><span class="w"> </span><span class="n">here</span>
<span class="w">  </span><span class="nl">foo</span><span class="p">:</span><span class="w"> </span><span class="n">bar</span>
</code></pre></div></td></tr></table></div></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@kind example-operator</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">config</span><span class="o">/</span><span class="n">samples</span><span class="o">/</span><span class="n">example_v1alpha1_example_namespace_test1</span><span class="p">.</span><span class="n">yaml</span>
<span class="n">example</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">-</span><span class="n">sample</span><span class="w"> </span><span class="n">created</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="mf">2020</span><span class="o">-</span><span class="mf">11</span><span class="o">-</span><span class="mf">30</span><span class="n">T15</span><span class="p">:</span><span class="mf">07</span><span class="p">:</span><span class="mf">29.201</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="kr">cont</span><span class="n">rollers</span><span class="mf">.</span><span class="n">Example</span><span class="w"> </span><span class="n">Reconciler</span><span class="w"> </span><span class="n">triggered</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">req</span><span class="p">:</span><span class="w">  </span><span class="err">{</span><span class="s">&quot;example&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1/example-sample&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">11</span><span class="o">-</span><span class="mf">30</span><span class="n">T15</span><span class="p">:</span><span class="mf">07</span><span class="p">:</span><span class="mf">29.201</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">DEBUG</span><span class="w">   </span><span class="kr">cont</span><span class="n">roller</span><span class="w">  </span><span class="n">Successfully</span><span class="w"> </span><span class="n">Reconciled</span><span class="w"> </span><span class="err">{</span><span class="s">&quot;reconcilerGroup&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example.example.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;reconcilerKind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;controller&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example-sample&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;namespace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1&quot;</span><span class="err">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@kind example-operator</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">config</span><span class="o">/</span><span class="n">samples</span><span class="o">/</span><span class="n">example_v1alpha1_example_namespace_test2</span><span class="p">.</span><span class="n">yaml</span>
<span class="n">example</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">example</span><span class="o">-</span><span class="n">sample</span><span class="w"> </span><span class="n">created</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="mf">2020</span><span class="o">-</span><span class="mf">11</span><span class="o">-</span><span class="mf">30</span><span class="n">T15</span><span class="p">:</span><span class="mf">08</span><span class="p">:</span><span class="mf">36.354</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="kr">cont</span><span class="n">rollers</span><span class="mf">.</span><span class="n">Example</span><span class="w"> </span><span class="n">Reconciler</span><span class="w"> </span><span class="n">triggered</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">req</span><span class="p">:</span><span class="w">  </span><span class="err">{</span><span class="s">&quot;example&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test2/example-sample2&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">11</span><span class="o">-</span><span class="mf">30</span><span class="n">T15</span><span class="p">:</span><span class="mf">08</span><span class="p">:</span><span class="mf">36.354</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">DEBUG</span><span class="w">   </span><span class="kr">cont</span><span class="n">roller</span><span class="w">  </span><span class="n">Successfully</span><span class="w"> </span><span class="n">Reconciled</span><span class="w"> </span><span class="err">{</span><span class="s">&quot;reconcilerGroup&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example.example.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;reconcilerKind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;controller&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example-sample2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;namespace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test2&quot;</span><span class="err">}</span>
</code></pre></div></td></tr></table></div>
<p>Whenever something happens to an object of type <code class="highlight">&amp;examplev1alpha1.Example{}</code>, this controller's <code class="highlight">Reconcile</code> will be triggered. The only information that it will be passed is a <code class="highlight">controllerruntime.Request</code> which is an alias to <code class="highlight">reconcile.Request</code> and inherits from <code class="highlight">types.NamespacedName</code>: <a href="https://godoc.org/sigs.k8s.io/controller-runtime/pkg/reconcile#Request">https://godoc.org/sigs.k8s.io/controller-runtime/pkg/reconcile#Request</a> and <a href="https://github.com/kubernetes-sigs/controller-runtime/blob/43331a6c8f823b497660b368deb4311ae2030206/alias.go#L39">https://github.com/kubernetes-sigs/controller-runtime/blob/43331a6c8f823b497660b368deb4311ae2030206/alias.go#L39</a> and <a href="https://github.com/kubernetes/apimachinery/blob/master/pkg/types/namespacedname.go#L37">https://github.com/kubernetes/apimachinery/blob/master/pkg/types/namespacedname.go#L37</a></p>
<h4 id="triggering-the-reconciler">Triggering the reconciler</h4>
<p>The <code class="highlight">SetupWithManager</code> method determines when the reconciler is triggered:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="p">(</span>
<span class="p">(</span><span class="o">...</span><span class="p">)</span>
        <span class="p">(</span><span class="o">...</span><span class="p">)</span><span class="n">ctrl</span> <span class="s2">&quot;sigs.k8s.io/controller-runtime&quot;</span>
<span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="p">)</span>
<span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">func</span> <span class="p">(</span><span class="n">r</span> <span class="o">*</span><span class="n">ExampleReconciler</span><span class="p">)</span> <span class="n">SetupWithManager</span><span class="p">(</span><span class="n">mgr</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">Manager</span><span class="p">)</span> <span class="n">error</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">NewControllerManagedBy</span><span class="p">(</span><span class="n">mgr</span><span class="p">)</span><span class="o">.</span>
                <span class="n">For</span><span class="p">(</span><span class="o">&amp;</span><span class="n">examplev1alpha1</span><span class="o">.</span><span class="n">Example</span><span class="p">{})</span><span class="o">.</span>
                <span class="n">Complete</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="p">}</span>
<span class="p">(</span><span class="o">...</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
<p><code class="highlight">NewControllerManagedBy</code> is an alias to <code class="highlight">builder.ControllerManagedBy</code>: <a href="https://godoc.org/sigs.k8s.io/controller-runtime">https://godoc.org/sigs.k8s.io/controller-runtime</a> and <a href="https://godoc.org/sigs.k8s.io/controller-runtime/pkg/builder#ControllerManagedBy">https://godoc.org/sigs.k8s.io/controller-runtime/pkg/builder#ControllerManagedBy</a></p>
<h5 id="for">For</h5>
<p>The <code class="highlight">Builder</code>'s <code class="highlight"><span class="k">For</span></code> method tells the controller to watch all objects of this specifi custom resourse. It will then pass a <code class="highlight"><span class="n">NamespacedName</span></code> via a <code class="highlight">Request</code> to the reconciler. The <code class="highlight"><span class="k">For</span></code> method is documented in: <a href="https://godoc.org/sigs.k8s.io/controller-runtime/pkg/builder#Builder.For">https://godoc.org/sigs.k8s.io/controller-runtime/pkg/builder#Builder.For</a></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">func</span><span class="w"> </span><span class="p">(</span><span class="o">*</span><span class="n">Builder</span><span class="p">)</span><span class="w"> </span><span class="n">For</span>

<span class="k">func</span><span class="w"> </span><span class="p">(</span><span class="n">blder</span><span class="w"> </span><span class="o">*</span><span class="n">Builder</span><span class="p">)</span><span class="w"> </span><span class="n">For</span><span class="p">(</span><span class="n">object</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="n">Object</span><span class="p">,</span><span class="w"> </span><span class="n">opts</span><span class="w"> </span><span class="o">...</span><span class="n">ForOption</span><span class="p">)</span><span class="w"> </span><span class="o">*</span><span class="n">Builder</span>

<span class="n">For</span><span class="w"> </span><span class="n">defines</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">type</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="nb nb-Type">Object</span><span class="w"> </span><span class="n">being</span><span class="w"> </span><span class="o">*</span><span class="n">reconciled</span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">configures</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ControllerManagedBy</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">respond</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">create</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">delete</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">update</span><span class="w"> </span><span class="n">events</span><span class="w"> </span><span class="n">by</span><span class="w"> </span><span class="o">*</span><span class="n">reconciling</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">object</span><span class="o">*.</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">equivalent</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">calling</span><span class="w"> </span><span class="n">Watches</span><span class="p">(</span><span class="o">&amp;</span><span class="n">source</span><span class="o">.</span><span class="n">Kind</span><span class="p">{</span><span class="n">Type</span><span class="p">:</span><span class="w"> </span><span class="n">apiType</span><span class="p">},</span><span class="w"> </span><span class="o">&amp;</span><span class="n">handler</span><span class="o">.</span><span class="n">EnqueueRequestForObject</span><span class="p">{})</span><span class="w"> </span>
</code></pre></div></td></tr></table></div>
<p>This means that one could rewrite the <code class="highlight">SetupWithManager</code> method as:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">func</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">*</span><span class="n">ExampleReconciler</span><span class="p">)</span><span class="w"> </span><span class="n">SetupWithManager</span><span class="p">(</span><span class="n">mgr</span><span class="w"> </span><span class="n">ctrl</span><span class="o">.</span><span class="n">Manager</span><span class="p">)</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ctrl</span><span class="o">.</span><span class="n">NewControllerManagedBy</span><span class="p">(</span><span class="n">mgr</span><span class="p">)</span><span class="o">.</span>
<span class="w">                </span><span class="n">Watches</span><span class="p">(</span><span class="o">&amp;</span><span class="n">source</span><span class="o">.</span><span class="n">Kind</span><span class="p">{</span><span class="n">Type</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="n">examplev1alpha1</span><span class="o">.</span><span class="n">Example</span><span class="p">{}},</span><span class="w"> </span><span class="o">&amp;</span><span class="n">handler</span><span class="o">.</span><span class="n">EnqueueRequestForObject</span><span class="p">{})</span><span class="o">.</span>
<span class="w">                </span><span class="n">Complete</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<p>This doesn't quite work. something is missing here [TBD]</p>
<h5 id="owns">Owns</h5>
<p>If we want to watch objects of other types that were created by an instance of our CRD, then we use <code class="highlight">Owns()</code>.</p>
<p>Add the following to the imports list:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>        appsv1 &quot;k8s.io/api/apps/v1&quot;
        batchv1 &quot;k8s.io/api/batch/v1&quot;
</code></pre></div></td></tr></table></div></p>
<p>Then, change the <code class="highlight">SetupWithManager</code> method to:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">func</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">*</span><span class="n">ExampleReconciler</span><span class="p">)</span><span class="w"> </span><span class="n">SetupWithManager</span><span class="p">(</span><span class="n">mgr</span><span class="w"> </span><span class="n">ctrl</span><span class="o">.</span><span class="n">Manager</span><span class="p">)</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ctrl</span><span class="o">.</span><span class="n">NewControllerManagedBy</span><span class="p">(</span><span class="n">mgr</span><span class="p">)</span><span class="o">.</span>
<span class="w">                </span><span class="n">For</span><span class="p">(</span><span class="o">&amp;</span><span class="n">examplev1alpha1</span><span class="o">.</span><span class="n">Example</span><span class="p">{})</span><span class="o">.</span>
<span class="w">                </span><span class="n">Owns</span><span class="p">(</span><span class="o">&amp;</span><span class="n">appsv1</span><span class="o">.</span><span class="n">Deployment</span><span class="p">{})</span><span class="o">.</span>
<span class="w">                </span><span class="n">Owns</span><span class="p">(</span><span class="o">&amp;</span><span class="n">batchv1</span><span class="o">.</span><span class="n">Job</span><span class="p">{})</span><span class="o">.</span>
<span class="w">                </span><span class="n">Complete</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<p>Now, spawn a new <code class="highlight">Example</code> object:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@kind example-operator</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="n">config</span><span class="o">/</span><span class="n">samples</span><span class="o">/</span><span class="n">example_v1alpha1_example_namespace_test1</span><span class="p">.</span><span class="n">yaml</span>
<span class="nl">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">v1alpha1</span>
<span class="nl">kind</span><span class="p">:</span><span class="w"> </span><span class="n">Example</span>
<span class="nl">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">example</span><span class="o">-</span><span class="n">sample</span>
<span class="w">  </span><span class="nl">namespace</span><span class="p">:</span><span class="w"> </span><span class="n">test1</span>
<span class="nl">spec</span><span class="p">:</span>
<span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="k">Add</span><span class="w"> </span><span class="n">fields</span><span class="w"> </span><span class="n">here</span>
<span class="w">  </span><span class="nl">foo</span><span class="p">:</span><span class="w"> </span><span class="n">bar</span>
<span class="n">oc</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">config</span><span class="o">/</span><span class="n">samples</span><span class="o">/</span><span class="n">example_v1alpha1_example_namespace_test1</span><span class="p">.</span><span class="n">yaml</span>
</code></pre></div></td></tr></table></div></p>
<p>As expected, the reconcile loop gets triggered for this object.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code>uid=$(oc get example -n test1 -o json example-sample | jq -r &#39;.metadata.uid&#39;)
apiversion=$(oc get example -n test1 -o json example-sample | jq -r &#39;.apiVersion&#39;)
kind=$(oc get example -n test1 -o json example-sample | jq -r &#39;.kind&#39;)
namespace=$(oc get example -n test1 -o json example-sample | jq -r &#39;.metadata.namespace&#39;)
name=$(oc get example -n test1 -o json example-sample | jq -r &#39;.metadata.name&#39;)
</code></pre></div></td></tr></table></div>
<p>Then, spawn a deployment and set the test1/example-sample CR as the owner:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code>cat &lt;&lt; EOF | oc apply -f -
apiVersion: apps/v1
kind: Deployment
metadata:
  name: fedora-deployment
  namespace: $namespace
  labels:
    app: fedora-deployment
  ownerReferences:
  - kind: $kind
    apiVersion: $apiversion
    name: $name
    uid: $uid
    controller: true
spec:
  replicas: 1
  selector:
    matchLabels:
      app: fedora-pod
  template:
    metadata:
      labels:
        app: fedora-pod
    spec:
      containers:
      - name: fedora
        image: fedora
        command:
          - sleep
          - infinity
        imagePullPolicy: IfNotPresent
EOF
</code></pre></div></td></tr></table></div></p>
<p>This will trigger a run of the Reconciler:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T03</span><span class="p">:</span><span class="mf">23</span><span class="p">:</span><span class="mf">14.431</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="kr">cont</span><span class="n">rollers</span><span class="mf">.</span><span class="n">Example</span><span class="w"> </span><span class="n">Reconciler</span><span class="w"> </span><span class="n">triggered</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">req</span><span class="p">:</span><span class="w">  </span><span class="err">{</span><span class="s">&quot;example&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1/example-sample&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T03</span><span class="p">:</span><span class="mf">23</span><span class="p">:</span><span class="mf">14.431</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">DEBUG</span><span class="w">   </span><span class="kr">cont</span><span class="n">roller</span><span class="w">  </span><span class="n">Successfully</span><span class="w"> </span><span class="n">Reconciled</span><span class="w"> </span><span class="err">{</span><span class="s">&quot;reconcilerGroup&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example.example.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;reconcilerKind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;controller&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example-sample&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;namespace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T03</span><span class="p">:</span><span class="mf">23</span><span class="p">:</span><span class="mf">14.440</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="kr">cont</span><span class="n">rollers</span><span class="mf">.</span><span class="n">Example</span><span class="w"> </span><span class="n">Reconciler</span><span class="w"> </span><span class="n">triggered</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">req</span><span class="p">:</span><span class="w">  </span><span class="err">{</span><span class="s">&quot;example&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1/example-sample&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T03</span><span class="p">:</span><span class="mf">23</span><span class="p">:</span><span class="mf">14.440</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">DEBUG</span><span class="w">   </span><span class="kr">cont</span><span class="n">roller</span><span class="w">  </span><span class="n">Successfully</span><span class="w"> </span><span class="n">Reconciled</span><span class="w"> </span><span class="err">{</span><span class="s">&quot;reconcilerGroup&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example.example.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;reconcilerKind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;controller&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example-sample&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;namespace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T03</span><span class="p">:</span><span class="mf">23</span><span class="p">:</span><span class="mf">14.457</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="kr">cont</span><span class="n">rollers</span><span class="mf">.</span><span class="n">Example</span><span class="w"> </span><span class="n">Reconciler</span><span class="w"> </span><span class="n">triggered</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">req</span><span class="p">:</span><span class="w">  </span><span class="err">{</span><span class="s">&quot;example&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1/example-sample&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T03</span><span class="p">:</span><span class="mf">23</span><span class="p">:</span><span class="mf">14.457</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">DEBUG</span><span class="w">   </span><span class="kr">cont</span><span class="n">roller</span><span class="w">  </span><span class="n">Successfully</span><span class="w"> </span><span class="n">Reconciled</span><span class="w"> </span><span class="err">{</span><span class="s">&quot;reconcilerGroup&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example.example.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;reconcilerKind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;controller&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example-sample&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;namespace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T03</span><span class="p">:</span><span class="mf">23</span><span class="p">:</span><span class="mf">14.479</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="kr">cont</span><span class="n">rollers</span><span class="mf">.</span><span class="n">Example</span><span class="w"> </span><span class="n">Reconciler</span><span class="w"> </span><span class="n">triggered</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">req</span><span class="p">:</span><span class="w">  </span><span class="err">{</span><span class="s">&quot;example&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1/example-sample&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T03</span><span class="p">:</span><span class="mf">23</span><span class="p">:</span><span class="mf">14.479</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">DEBUG</span><span class="w">   </span><span class="kr">cont</span><span class="n">roller</span><span class="w">  </span><span class="n">Successfully</span><span class="w"> </span><span class="n">Reconciled</span><span class="w"> </span><span class="err">{</span><span class="s">&quot;reconcilerGroup&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example.example.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;reconcilerKind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;controller&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example-sample&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;namespace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T03</span><span class="p">:</span><span class="mf">23</span><span class="p">:</span><span class="mf">15.621</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="kr">cont</span><span class="n">rollers</span><span class="mf">.</span><span class="n">Example</span><span class="w"> </span><span class="n">Reconciler</span><span class="w"> </span><span class="n">triggered</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">req</span><span class="p">:</span><span class="w">  </span><span class="err">{</span><span class="s">&quot;example&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1/example-sample&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T03</span><span class="p">:</span><span class="mf">23</span><span class="p">:</span><span class="mf">15.621</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">DEBUG</span><span class="w">   </span><span class="kr">cont</span><span class="n">roller</span><span class="w">  </span><span class="n">Successfully</span><span class="w"> </span><span class="n">Reconciled</span><span class="w"> </span><span class="err">{</span><span class="s">&quot;reconcilerGroup&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example.example.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;reconcilerKind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;controller&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example-sample&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;namespace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1&quot;</span><span class="err">}</span>
</code></pre></div></td></tr></table></div></p>
<p>And if we scale the deployment, for example:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@kind example-operator</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="n">scale</span><span class="w"> </span><span class="o">--</span><span class="n">replicas</span><span class="o">=</span><span class="mi">2</span><span class="w"> </span><span class="n">deployment</span><span class="w"> </span><span class="n">fedora</span><span class="o">-</span><span class="n">deployment</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="n">test1</span>
<span class="n">deployment</span><span class="p">.</span><span class="n">apps</span><span class="o">/</span><span class="n">fedora</span><span class="o">-</span><span class="n">deployment</span><span class="w"> </span><span class="n">scaled</span>
</code></pre></div></td></tr></table></div></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T03</span><span class="p">:</span><span class="mf">26</span><span class="p">:</span><span class="mf">47.860</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="kr">cont</span><span class="n">rollers</span><span class="mf">.</span><span class="n">Example</span><span class="w"> </span><span class="n">Reconciler</span><span class="w"> </span><span class="n">triggered</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">req</span><span class="p">:</span><span class="w">  </span><span class="err">{</span><span class="s">&quot;example&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1/example-sample&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T03</span><span class="p">:</span><span class="mf">26</span><span class="p">:</span><span class="mf">47.860</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">DEBUG</span><span class="w">   </span><span class="kr">cont</span><span class="n">roller</span><span class="w">  </span><span class="n">Successfully</span><span class="w"> </span><span class="n">Reconciled</span><span class="w"> </span><span class="err">{</span><span class="s">&quot;reconcilerGroup&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example.example.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;reconcilerKind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;controller&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example-sample&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;namespace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T03</span><span class="p">:</span><span class="mf">26</span><span class="p">:</span><span class="mf">47.876</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="kr">cont</span><span class="n">rollers</span><span class="mf">.</span><span class="n">Example</span><span class="w"> </span><span class="n">Reconciler</span><span class="w"> </span><span class="n">triggered</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">req</span><span class="p">:</span><span class="w">  </span><span class="err">{</span><span class="s">&quot;example&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1/example-sample&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T03</span><span class="p">:</span><span class="mf">26</span><span class="p">:</span><span class="mf">47.877</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">DEBUG</span><span class="w">   </span><span class="kr">cont</span><span class="n">roller</span><span class="w">  </span><span class="n">Successfully</span><span class="w"> </span><span class="n">Reconciled</span><span class="w"> </span><span class="err">{</span><span class="s">&quot;reconcilerGroup&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example.example.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;reconcilerKind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;controller&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example-sample&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;namespace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T03</span><span class="p">:</span><span class="mf">26</span><span class="p">:</span><span class="mf">47.888</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="kr">cont</span><span class="n">rollers</span><span class="mf">.</span><span class="n">Example</span><span class="w"> </span><span class="n">Reconciler</span><span class="w"> </span><span class="n">triggered</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">req</span><span class="p">:</span><span class="w">  </span><span class="err">{</span><span class="s">&quot;example&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1/example-sample&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T03</span><span class="p">:</span><span class="mf">26</span><span class="p">:</span><span class="mf">47.888</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">DEBUG</span><span class="w">   </span><span class="kr">cont</span><span class="n">roller</span><span class="w">  </span><span class="n">Successfully</span><span class="w"> </span><span class="n">Reconciled</span><span class="w"> </span><span class="err">{</span><span class="s">&quot;reconcilerGroup&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example.example.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;reconcilerKind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;controller&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example-sample&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;namespace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T03</span><span class="p">:</span><span class="mf">26</span><span class="p">:</span><span class="mf">47.909</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="kr">cont</span><span class="n">rollers</span><span class="mf">.</span><span class="n">Example</span><span class="w"> </span><span class="n">Reconciler</span><span class="w"> </span><span class="n">triggered</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">req</span><span class="p">:</span><span class="w">  </span><span class="err">{</span><span class="s">&quot;example&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1/example-sample&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T03</span><span class="p">:</span><span class="mf">26</span><span class="p">:</span><span class="mf">47.909</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">DEBUG</span><span class="w">   </span><span class="kr">cont</span><span class="n">roller</span><span class="w">  </span><span class="n">Successfully</span><span class="w"> </span><span class="n">Reconciled</span><span class="w"> </span><span class="err">{</span><span class="s">&quot;reconcilerGroup&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example.example.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;reconcilerKind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;controller&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example-sample&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;namespace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T03</span><span class="p">:</span><span class="mf">26</span><span class="p">:</span><span class="mf">49.645</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="kr">cont</span><span class="n">rollers</span><span class="mf">.</span><span class="n">Example</span><span class="w"> </span><span class="n">Reconciler</span><span class="w"> </span><span class="n">triggered</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">req</span><span class="p">:</span><span class="w">  </span><span class="err">{</span><span class="s">&quot;example&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1/example-sample&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T03</span><span class="p">:</span><span class="mf">26</span><span class="p">:</span><span class="mf">49.646</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">DEBUG</span><span class="w">   </span><span class="kr">cont</span><span class="n">roller</span><span class="w">  </span><span class="n">Successfully</span><span class="w"> </span><span class="n">Reconciled</span><span class="w"> </span><span class="err">{</span><span class="s">&quot;reconcilerGroup&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example.example.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;reconcilerKind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;controller&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example-sample&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;namespace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1&quot;</span><span class="err">}</span>
</code></pre></div></td></tr></table></div>
<p>The <code class="highlight">Owns</code> method can be rewritten with the <code class="highlight">Watches</code> method (see the next section for further details). The following example behaves exactly the same as the earlier code:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="kn">import</span> <span class="p">(</span>
        <span class="p">(</span><span class="o">...</span><span class="p">)</span>
        <span class="n">appsv1</span> <span class="s2">&quot;k8s.io/api/apps/v1&quot;</span>
        <span class="n">batchv1</span> <span class="s2">&quot;k8s.io/api/batch/v1&quot;</span>
    <span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="p">)</span>
<span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">func</span> <span class="p">(</span><span class="n">r</span> <span class="o">*</span><span class="n">ExampleReconciler</span><span class="p">)</span> <span class="n">SetupWithManager</span><span class="p">(</span><span class="n">mgr</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">Manager</span><span class="p">)</span> <span class="n">error</span> <span class="p">{</span>
        <span class="k">return</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">NewControllerManagedBy</span><span class="p">(</span><span class="n">mgr</span><span class="p">)</span><span class="o">.</span>
                <span class="n">For</span><span class="p">(</span><span class="o">&amp;</span><span class="n">examplev1alpha1</span><span class="o">.</span><span class="n">Example</span><span class="p">{})</span><span class="o">.</span>
                <span class="n">Watches</span><span class="p">(</span><span class="o">&amp;</span><span class="n">source</span><span class="o">.</span><span class="n">Kind</span><span class="p">{</span>
                        <span class="n">Type</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">appsv1</span><span class="o">.</span><span class="n">Deployment</span><span class="p">{}},</span>
                        <span class="o">&amp;</span><span class="n">handler</span><span class="o">.</span><span class="n">EnqueueRequestForOwner</span><span class="p">{</span>
                                <span class="n">OwnerType</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">examplev1alpha1</span><span class="o">.</span><span class="n">Example</span><span class="p">{},</span>
                                <span class="n">IsController</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                        <span class="p">})</span><span class="o">.</span>
                <span class="n">Watches</span><span class="p">(</span><span class="o">&amp;</span><span class="n">source</span><span class="o">.</span><span class="n">Kind</span><span class="p">{</span>
                        <span class="n">Type</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">batchv1</span><span class="o">.</span><span class="n">Job</span><span class="p">{}},</span>
                        <span class="o">&amp;</span><span class="n">handler</span><span class="o">.</span><span class="n">EnqueueRequestForOwner</span><span class="p">{</span>
                                <span class="n">OwnerType</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">examplev1alpha1</span><span class="o">.</span><span class="n">Example</span><span class="p">{},</span>
                                <span class="n">IsController</span><span class="p">:</span> <span class="n">true</span><span class="p">,</span>
                        <span class="p">})</span><span class="o">.</span>
                <span class="n">Complete</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<h5 id="watches-for-independent-resources">Watches for independent resources</h5>
<p>If you want to monitor other custom resources which are not owned by this Controller, that's also possible. For some theory on this, see <a href="https://godoc.org/sigs.k8s.io/controller-runtime/pkg/handler">https://godoc.org/sigs.k8s.io/controller-runtime/pkg/handler</a>.</p>
<h6 id="watching-for-changes-to-nodes">Watching for changes to Nodes</h6>
<p>For example, let's monitor updates to <code class="highlight">Node</code>s. If any node in the cluster is updated, then we are going to inform all of the <code class="highlight">Example</code> Custom Resources.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="kn">import</span> <span class="p">(</span>
<span class="p">(</span><span class="o">...</span><span class="p">)</span>
        <span class="n">corev1</span> <span class="s2">&quot;k8s.io/api/core/v1&quot;</span>
        <span class="s2">&quot;k8s.io/apimachinery/pkg/types&quot;</span>
        <span class="s2">&quot;sigs.k8s.io/controller-runtime/pkg/reconcile&quot;</span> 
<span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="p">)</span>
<span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">func</span> <span class="p">(</span><span class="n">r</span> <span class="o">*</span><span class="n">ExampleReconciler</span><span class="p">)</span> <span class="n">SetupWithManager</span><span class="p">(</span><span class="n">mgr</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">Manager</span><span class="p">)</span> <span class="n">error</span> <span class="p">{</span>
        <span class="n">mapFn</span> <span class="o">:=</span> <span class="n">handler</span><span class="o">.</span><span class="n">ToRequestsFunc</span><span class="p">(</span>
                <span class="n">func</span><span class="p">(</span><span class="n">a</span> <span class="n">handler</span><span class="o">.</span><span class="n">MapObject</span><span class="p">)</span> <span class="p">[]</span><span class="n">reconcile</span><span class="o">.</span><span class="n">Request</span> <span class="p">{</span>
                        <span class="n">client</span> <span class="o">:=</span> <span class="n">mgr</span><span class="o">.</span><span class="n">GetClient</span><span class="p">()</span>
                        <span class="n">log</span> <span class="o">:=</span> <span class="n">mgr</span><span class="o">.</span><span class="n">GetLogger</span><span class="p">()</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">Info</span><span class="p">(</span><span class="s2">&quot;Detected update to resource&quot;</span><span class="p">,</span>
                                <span class="s2">&quot;Kind&quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">Object</span><span class="o">.</span><span class="n">GetObjectKind</span><span class="p">(),</span>
                                <span class="s2">&quot;NameSpace&quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">Meta</span><span class="o">.</span><span class="n">GetNamespace</span><span class="p">(),</span>
                                <span class="s2">&quot;Name&quot;</span><span class="p">,</span> <span class="n">a</span><span class="o">.</span><span class="n">Meta</span><span class="o">.</span><span class="n">GetName</span><span class="p">())</span>

                        <span class="n">log</span><span class="o">.</span><span class="n">Info</span><span class="p">(</span><span class="s2">&quot;Retrieving all Example CRs&quot;</span><span class="p">)</span>
                        <span class="n">exampleList</span> <span class="o">:=</span> <span class="o">&amp;</span><span class="n">examplev1alpha1</span><span class="o">.</span><span class="n">ExampleList</span><span class="p">{}</span>
                        <span class="n">err</span> <span class="o">:=</span> <span class="n">client</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">Background</span><span class="p">(),</span> <span class="n">exampleList</span><span class="p">)</span>
                        <span class="k">if</span> <span class="n">err</span> <span class="o">!=</span> <span class="n">nil</span> <span class="p">{</span>
                                <span class="n">log</span><span class="o">.</span><span class="n">Info</span><span class="p">(</span><span class="s2">&quot;Err, returning empty []reconcile.Request</span><span class="si">{}</span><span class="s2">&quot;</span><span class="p">)</span>
                                <span class="k">return</span> <span class="p">[]</span><span class="n">reconcile</span><span class="o">.</span><span class="n">Request</span><span class="p">{}</span>
                        <span class="p">}</span>
                        <span class="n">var</span> <span class="n">reconcileRequests</span> <span class="p">[]</span><span class="n">reconcile</span><span class="o">.</span><span class="n">Request</span>
                        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">example</span> <span class="o">:=</span> <span class="nb">range</span> <span class="n">exampleList</span><span class="o">.</span><span class="n">Items</span> <span class="p">{</span>
                                <span class="n">log</span><span class="o">.</span><span class="n">Info</span><span class="p">(</span><span class="s2">&quot;Sending reconcile request to example custom resource&quot;</span><span class="p">,</span>
                                        <span class="s2">&quot;Name&quot;</span><span class="p">,</span>
                                        <span class="n">example</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span>
                                <span class="n">reconcileRequests</span> <span class="o">=</span> <span class="n">append</span><span class="p">(</span><span class="n">reconcileRequests</span><span class="p">,</span> <span class="n">reconcile</span><span class="o">.</span><span class="n">Request</span><span class="p">{</span>
                                        <span class="n">NamespacedName</span><span class="p">:</span> <span class="n">types</span><span class="o">.</span><span class="n">NamespacedName</span><span class="p">{</span>
                                                <span class="n">Name</span><span class="p">:</span>      <span class="n">example</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span>
                                                <span class="n">Namespace</span><span class="p">:</span> <span class="n">example</span><span class="o">.</span><span class="n">Namespace</span><span class="p">,</span>
                                        <span class="p">},</span>
                                <span class="p">})</span>
                        <span class="p">}</span>
                        <span class="k">return</span> <span class="n">reconcileRequests</span>
                <span class="p">})</span>


        <span class="k">return</span> <span class="n">ctrl</span><span class="o">.</span><span class="n">NewControllerManagedBy</span><span class="p">(</span><span class="n">mgr</span><span class="p">)</span><span class="o">.</span>
                <span class="n">For</span><span class="p">(</span><span class="o">&amp;</span><span class="n">examplev1alpha1</span><span class="o">.</span><span class="n">Example</span><span class="p">{})</span><span class="o">.</span>
                <span class="n">Watches</span><span class="p">(</span><span class="o">&amp;</span><span class="n">source</span><span class="o">.</span><span class="n">Kind</span><span class="p">{</span><span class="n">Type</span><span class="p">:</span> <span class="o">&amp;</span><span class="n">corev1</span><span class="o">.</span><span class="n">Node</span><span class="p">{}},</span>
                        <span class="o">&amp;</span><span class="n">handler</span><span class="o">.</span><span class="n">EnqueueRequestsFromMapFunc</span><span class="p">{</span><span class="n">ToRequests</span><span class="p">:</span> <span class="n">mapFn</span><span class="p">})</span><span class="o">.</span>
                <span class="n">Complete</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@kind example-operator</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="n">annotate</span><span class="w">  </span><span class="n">node</span><span class="w"> </span><span class="n">kind</span><span class="o">-</span><span class="n">control</span><span class="o">-</span><span class="n">plane</span><span class="w"> </span><span class="n">foo</span><span class="o">=</span><span class="n">bar</span>
<span class="n">node</span><span class="o">/</span><span class="n">kind</span><span class="o">-</span><span class="n">control</span><span class="o">-</span><span class="n">plane</span><span class="w"> </span><span class="n">annotated</span>
<span class="o">[</span><span class="n">root@kind example-operator</span><span class="o">]</span><span class="err">#</span><span class="w"> </span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T04</span><span class="p">:</span><span class="mf">11</span><span class="p">:</span><span class="mf">37.062</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="n">Detected</span><span class="w"> </span><span class="n">update</span><span class="w"> </span><span class="kr">to</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="err">{</span><span class="s">&quot;Kind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&amp;TypeMeta{Kind:,APIVersion:,}&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NameSpace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;kind-control-plane&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T04</span><span class="p">:</span><span class="mf">11</span><span class="p">:</span><span class="mf">37.062</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="n">Retrieving</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">Example</span><span class="w"> </span><span class="n">CRs</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T04</span><span class="p">:</span><span class="mf">11</span><span class="p">:</span><span class="mf">37.062</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="n">Sending</span><span class="w"> </span><span class="n">reconcile</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="kr">to</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">resource</span><span class="w">    </span><span class="err">{</span><span class="s">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example-sample&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T04</span><span class="p">:</span><span class="mf">11</span><span class="p">:</span><span class="mf">37.062</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="n">Detected</span><span class="w"> </span><span class="n">update</span><span class="w"> </span><span class="kr">to</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="err">{</span><span class="s">&quot;Kind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&amp;TypeMeta{Kind:,APIVersion:,}&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NameSpace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;kind-control-plane&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T04</span><span class="p">:</span><span class="mf">11</span><span class="p">:</span><span class="mf">37.062</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="n">Retrieving</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">Example</span><span class="w"> </span><span class="n">CRs</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T04</span><span class="p">:</span><span class="mf">11</span><span class="p">:</span><span class="mf">37.062</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="n">Sending</span><span class="w"> </span><span class="n">reconcile</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="kr">to</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">resource</span><span class="w">    </span><span class="err">{</span><span class="s">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example-sample&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T04</span><span class="p">:</span><span class="mf">11</span><span class="p">:</span><span class="mf">37.062</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="kr">cont</span><span class="n">rollers</span><span class="mf">.</span><span class="n">Example</span><span class="w"> </span><span class="n">Reconciler</span><span class="w"> </span><span class="n">triggered</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">req</span><span class="p">:</span><span class="w">  </span><span class="err">{</span><span class="s">&quot;example&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1/example-sample&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T04</span><span class="p">:</span><span class="mf">11</span><span class="p">:</span><span class="mf">37.062</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">DEBUG</span><span class="w">   </span><span class="kr">cont</span><span class="n">roller</span><span class="w">  </span><span class="n">Successfully</span><span class="w"> </span><span class="n">Reconciled</span><span class="w"> </span><span class="err">{</span><span class="s">&quot;reconcilerGroup&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example.example.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;reconcilerKind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;controller&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example-sample&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;namespace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1&quot;</span><span class="err">}</span>
</code></pre></div></td></tr></table></div>
<h6 id="watching-for-changes-to-other-custom-resources">Watching for changes to other Custom Resources</h6>
<p>Let's create a new custom resource, <code class="highlight">ExampleInstance</code>:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code>operator-sdk create api --group example --version v1alpha1 --kind ExampleInstance --resource=true --controller=false
make generate
make manifests
make install
</code></pre></div></td></tr></table></div></p>
<p>We need to make an important change to <code class="highlight">mapFn</code>. Given that we are working with a namespaced Custom Resource, we need to make sure that we only trigger the reconciler when the namespace of the <code class="highlight">Example</code> and <code class="highlight">ExampleInstance</code> resources are the same:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="w">                        </span><span class="k">for</span><span class="w"> </span><span class="nv">_</span><span class="p">,</span><span class="w"> </span><span class="nv">example</span><span class="w"> </span><span class="o">:=</span><span class="w"> </span><span class="nv">range</span><span class="w"> </span><span class="nv">exampleList</span><span class="o">.</span><span class="nv">Items</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="k">if</span><span class="w"> </span><span class="nv">a</span><span class="o">.</span><span class="nv">Meta</span><span class="o">.</span><span class="nf">GetNamespace</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="nv">example</span><span class="o">.</span><span class="nv">Namespace</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                        </span><span class="nv">continue</span>
<span class="w">                                </span><span class="p">}</span>
<span class="p">(</span><span class="o">...</span><span class="p">)</span>
</code></pre></div></td></tr></table></div></p>
<p>Our method would look like this:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">func</span><span class="w"> </span><span class="p">(</span><span class="n">r</span><span class="w"> </span><span class="o">*</span><span class="n">ExampleReconciler</span><span class="p">)</span><span class="w"> </span><span class="n">SetupWithManager</span><span class="p">(</span><span class="n">mgr</span><span class="w"> </span><span class="n">ctrl</span><span class="o">.</span><span class="n">Manager</span><span class="p">)</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">mapFn</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">handler</span><span class="o">.</span><span class="n">ToRequestsFunc</span><span class="p">(</span>
<span class="w">                </span><span class="k">func</span><span class="p">(</span><span class="n">a</span><span class="w"> </span><span class="n">handler</span><span class="o">.</span><span class="n">MapObject</span><span class="p">)</span><span class="w"> </span><span class="p">[]</span><span class="n">reconcile</span><span class="o">.</span><span class="n">Request</span><span class="w"> </span><span class="p">{</span>
<span class="w">                        </span><span class="n">client</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">mgr</span><span class="o">.</span><span class="n">GetClient</span><span class="p">()</span>
<span class="w">                        </span><span class="nb">log</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">mgr</span><span class="o">.</span><span class="n">GetLogger</span><span class="p">()</span>
<span class="w">                        </span><span class="nb">log</span><span class="o">.</span><span class="n">Info</span><span class="p">(</span><span class="s2">&quot;Detected update to resource&quot;</span><span class="p">,</span>
<span class="w">                                </span><span class="s2">&quot;Kind&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="o">.</span><span class="n">Object</span><span class="o">.</span><span class="n">GetObjectKind</span><span class="p">(),</span>
<span class="w">                                </span><span class="s2">&quot;NameSpace&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="o">.</span><span class="n">Meta</span><span class="o">.</span><span class="n">GetNamespace</span><span class="p">(),</span>
<span class="w">                                </span><span class="s2">&quot;Name&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">a</span><span class="o">.</span><span class="n">Meta</span><span class="o">.</span><span class="n">GetName</span><span class="p">())</span>

<span class="w">                        </span><span class="nb">log</span><span class="o">.</span><span class="n">Info</span><span class="p">(</span><span class="s2">&quot;Retrieving all Example CRs&quot;</span><span class="p">)</span>
<span class="w">                        </span><span class="n">exampleList</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="o">&amp;</span><span class="n">examplev1alpha1</span><span class="o">.</span><span class="n">ExampleList</span><span class="p">{}</span>
<span class="w">                        </span><span class="n">err</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="n">client</span><span class="o">.</span><span class="n">List</span><span class="p">(</span><span class="n">context</span><span class="o">.</span><span class="n">Background</span><span class="p">(),</span><span class="w"> </span><span class="n">exampleList</span><span class="p">)</span>
<span class="w">                        </span><span class="k">if</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">nil</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="nb">log</span><span class="o">.</span><span class="n">Info</span><span class="p">(</span><span class="s2">&quot;Err, returning empty []reconcile.Request{}&quot;</span><span class="p">)</span>
<span class="w">                                </span><span class="k">return</span><span class="w"> </span><span class="p">[]</span><span class="n">reconcile</span><span class="o">.</span><span class="n">Request</span><span class="p">{}</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                        </span><span class="k">var</span><span class="w"> </span><span class="n">reconcileRequests</span><span class="w"> </span><span class="p">[]</span><span class="n">reconcile</span><span class="o">.</span><span class="n">Request</span>
<span class="w">                        </span><span class="k">for</span><span class="w"> </span><span class="n">_</span><span class="p">,</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="p">:</span><span class="o">=</span><span class="w"> </span><span class="nb">range</span><span class="w"> </span><span class="n">exampleList</span><span class="o">.</span><span class="n">Items</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                </span><span class="k">if</span><span class="w"> </span><span class="n">a</span><span class="o">.</span><span class="n">Meta</span><span class="o">.</span><span class="n">GetNamespace</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">example</span><span class="o">.</span><span class="n">Namespace</span><span class="w"> </span><span class="p">{</span>
<span class="w">                                        </span><span class="k">continue</span>
<span class="w">                                </span><span class="p">}</span>
<span class="w">                                </span><span class="nb">log</span><span class="o">.</span><span class="n">Info</span><span class="p">(</span><span class="s2">&quot;Sending reconcile request to example custom resource&quot;</span><span class="p">,</span>
<span class="w">                                        </span><span class="s2">&quot;Name&quot;</span><span class="p">,</span>
<span class="w">                                        </span><span class="n">example</span><span class="o">.</span><span class="n">Name</span><span class="p">)</span>
<span class="w">                                </span><span class="n">reconcileRequests</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">append</span><span class="p">(</span><span class="n">reconcileRequests</span><span class="p">,</span><span class="w"> </span><span class="n">reconcile</span><span class="o">.</span><span class="n">Request</span><span class="p">{</span>
<span class="w">                                        </span><span class="n">NamespacedName</span><span class="p">:</span><span class="w"> </span><span class="n">types</span><span class="o">.</span><span class="n">NamespacedName</span><span class="p">{</span>
<span class="w">                                                </span><span class="n">Name</span><span class="p">:</span><span class="w">      </span><span class="n">example</span><span class="o">.</span><span class="n">Name</span><span class="p">,</span>
<span class="w">                                                </span><span class="n">Namespace</span><span class="p">:</span><span class="w"> </span><span class="n">example</span><span class="o">.</span><span class="n">Namespace</span><span class="p">,</span>
<span class="w">                                        </span><span class="p">},</span>
<span class="w">                                </span><span class="p">})</span>
<span class="w">                        </span><span class="p">}</span>
<span class="w">                        </span><span class="k">return</span><span class="w"> </span><span class="n">reconcileRequests</span>
<span class="w">                </span><span class="p">})</span>

<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">ctrl</span><span class="o">.</span><span class="n">NewControllerManagedBy</span><span class="p">(</span><span class="n">mgr</span><span class="p">)</span><span class="o">.</span>
<span class="w">                </span><span class="n">For</span><span class="p">(</span><span class="o">&amp;</span><span class="n">examplev1alpha1</span><span class="o">.</span><span class="n">Example</span><span class="p">{})</span><span class="o">.</span>
<span class="w">                </span><span class="n">Watches</span><span class="p">(</span><span class="o">&amp;</span><span class="n">source</span><span class="o">.</span><span class="n">Kind</span><span class="p">{</span><span class="n">Type</span><span class="p">:</span><span class="w"> </span><span class="o">&amp;</span><span class="n">examplev1alpha1</span><span class="o">.</span><span class="n">ExampleInstance</span><span class="p">{}},</span>
<span class="w">                        </span><span class="o">&amp;</span><span class="n">handler</span><span class="o">.</span><span class="n">EnqueueRequestsFromMapFunc</span><span class="p">{</span><span class="n">ToRequests</span><span class="p">:</span><span class="w"> </span><span class="n">mapFn</span><span class="p">})</span><span class="o">.</span>
<span class="w">                </span><span class="n">Complete</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
<span class="p">}</span>
</code></pre></div></td></tr></table></div></p>
<p>Now, if we test this, we can see that the reconciler is only triggered if the Namespace is correct:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@kind example-operator</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="n">config</span><span class="o">/</span><span class="n">samples</span><span class="o">/</span><span class="n">example_v1alpha1_exampleinstance2</span><span class="p">.</span><span class="n">yaml</span>
<span class="nl">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">v1alpha1</span>
<span class="nl">kind</span><span class="p">:</span><span class="w"> </span><span class="n">ExampleInstance</span>
<span class="nl">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">exampleinstance</span><span class="o">-</span><span class="n">sample</span>
<span class="w">  </span><span class="nl">namespace</span><span class="p">:</span><span class="w"> </span><span class="n">test2</span>
<span class="nl">spec</span><span class="p">:</span>
<span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="k">Add</span><span class="w"> </span><span class="n">fields</span><span class="w"> </span><span class="n">here</span>
<span class="w">  </span><span class="nl">foo</span><span class="p">:</span><span class="w"> </span><span class="n">bar</span>
<span class="o">[</span><span class="n">root@kind example-operator</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">config</span><span class="o">/</span><span class="n">samples</span><span class="o">/</span><span class="n">example_v1alpha1_exampleinstance2</span><span class="p">.</span><span class="n">yaml</span>
<span class="n">exampleinstance</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">exampleinstance</span><span class="o">-</span><span class="n">sample</span><span class="w"> </span><span class="n">created</span>
</code></pre></div></td></tr></table></div></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T04</span><span class="p">:</span><span class="mf">25</span><span class="p">:</span><span class="mf">59.924</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="n">Detected</span><span class="w"> </span><span class="n">update</span><span class="w"> </span><span class="kr">to</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="err">{</span><span class="s">&quot;Kind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&amp;TypeMeta{Kind:,APIVersion:,}&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NameSpace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test2&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;exampleinstance-sample&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T04</span><span class="p">:</span><span class="mf">25</span><span class="p">:</span><span class="mf">59.924</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="n">Retrieving</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">Example</span><span class="w"> </span><span class="n">CRs</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@kind example-operator</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">cat</span><span class="w"> </span><span class="n">config</span><span class="o">/</span><span class="n">samples</span><span class="o">/</span><span class="n">example_v1alpha1_exampleinstance</span><span class="p">.</span><span class="n">yaml</span>
<span class="nl">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="n">example</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">v1alpha1</span>
<span class="nl">kind</span><span class="p">:</span><span class="w"> </span><span class="n">ExampleInstance</span>
<span class="nl">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">exampleinstance</span><span class="o">-</span><span class="n">sample</span>
<span class="w">  </span><span class="nl">namespace</span><span class="p">:</span><span class="w"> </span><span class="n">test1</span>
<span class="nl">spec</span><span class="p">:</span>
<span class="w">  </span><span class="err">#</span><span class="w"> </span><span class="k">Add</span><span class="w"> </span><span class="n">fields</span><span class="w"> </span><span class="n">here</span>
<span class="w">  </span><span class="nl">foo</span><span class="p">:</span><span class="w"> </span><span class="n">bar</span>
<span class="o">[</span><span class="n">root@kind example-operator</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">config</span><span class="o">/</span><span class="n">samples</span><span class="o">/</span><span class="n">example_v1alpha1_exampleinstance</span><span class="p">.</span><span class="n">yaml</span>
<span class="n">exampleinstance</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span><span class="o">/</span><span class="n">exampleinstance</span><span class="o">-</span><span class="n">sample</span><span class="w"> </span><span class="n">created</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T04</span><span class="p">:</span><span class="mf">27</span><span class="p">:</span><span class="mf">01.639</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="n">Detected</span><span class="w"> </span><span class="n">update</span><span class="w"> </span><span class="kr">to</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="err">{</span><span class="s">&quot;Kind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&amp;TypeMeta{Kind:,APIVersion:,}&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;NameSpace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;exampleinstance-sample&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T04</span><span class="p">:</span><span class="mf">27</span><span class="p">:</span><span class="mf">01.639</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="n">Retrieving</span><span class="w"> </span><span class="n">all</span><span class="w"> </span><span class="n">Example</span><span class="w"> </span><span class="n">CRs</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T04</span><span class="p">:</span><span class="mf">27</span><span class="p">:</span><span class="mf">01.639</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="n">Sending</span><span class="w"> </span><span class="n">reconcile</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="kr">to</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="n">custom</span><span class="w"> </span><span class="n">resource</span><span class="w">    </span><span class="err">{</span><span class="s">&quot;Name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example-sample&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T04</span><span class="p">:</span><span class="mf">27</span><span class="p">:</span><span class="mf">01.639</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">INFO</span><span class="w">    </span><span class="kr">cont</span><span class="n">rollers</span><span class="mf">.</span><span class="n">Example</span><span class="w"> </span><span class="n">Reconciler</span><span class="w"> </span><span class="n">triggered</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">req</span><span class="p">:</span><span class="w">  </span><span class="err">{</span><span class="s">&quot;example&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1/example-sample&quot;</span><span class="err">}</span>
<span class="mf">2020</span><span class="o">-</span><span class="mf">12</span><span class="o">-</span><span class="mf">03</span><span class="n">T04</span><span class="p">:</span><span class="mf">27</span><span class="p">:</span><span class="mf">01.639</span><span class="o">-</span><span class="mf">0500</span><span class="w">    </span><span class="n">DEBUG</span><span class="w">   </span><span class="kr">cont</span><span class="n">roller</span><span class="w">  </span><span class="n">Successfully</span><span class="w"> </span><span class="n">Reconciled</span><span class="w"> </span><span class="err">{</span><span class="s">&quot;reconcilerGroup&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example.example.com&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;reconcilerKind&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;controller&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example-sample&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;namespace&quot;</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test1&quot;</span><span class="err">}</span>
</code></pre></div></td></tr></table></div>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">February 24, 2023</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.prune", "navigation.top", "navigation.path", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.2a6f1dda.min.js"></script>
      
    
  </body>
</html>