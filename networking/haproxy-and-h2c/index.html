
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Andreas Karis' blog about anything Kubernetes, OpenShift, Linux and Networking">
      
      
      
        <link rel="canonical" href="https://andreaskaris.github.io/blog/networking/haproxy-and-h2c/">
      
      
        <link rel="prev" href="../ovn-interconnection/">
      
      
        <link rel="next" href="../install-openvswitch-on-rocky/">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../../feed_rss_updated.xml">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.5.3, mkdocs-material-9.5.3">
    
    
      
        <title>haproxy and HTTP/2 - Andreas Karis Blog</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.50c56a3b.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <!-- RSS Feed -->
  <link rel="alternate" type="application/rss+xml" title="RSS feed of created content" href="https://andreaskaris.github.io/blog/feed_rss_created.xml">
  <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="https://andreaskaris.github.io/blog/feed_rss_updated.xml">

  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="pink">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Andreas Karis Blog" class="md-header__button md-logo" aria-label="Andreas Karis Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Andreas Karis Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              haproxy and HTTP/2
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../ceph/" class="md-tabs__link">
          
  
    
  
  Ceph

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../linux/" class="md-tabs__link">
          
  
    
  
  Linux

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  Networking

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../openshift/" class="md-tabs__link">
          
  
    
  
  OpenShift and Kubernetes

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../openstack/" class="md-tabs__link">
          
  
    
  
  OpenStack

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../coding/" class="md-tabs__link">
          
  
    
  
  Coding

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
  
    
    <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner">
          


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Andreas Karis Blog" class="md-nav__button md-logo" aria-label="Andreas Karis Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Andreas Karis Blog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../ceph/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Ceph
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2" id="__nav_2_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Ceph
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../ceph/ceph-manual-test/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ceph manual test with qemu
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../linux/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Linux
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3" id="__nav_3_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Linux
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/cgroups/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    cgroups
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/containers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Containers in Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/hugepages/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hugepages
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/ipxe-boot-environment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    iPXE boot environment on Fedora
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/java-idrac-issues/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java Idrac Issues
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/meson/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    meson
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/namespaces/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    namespaces
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/old_java_version_with_xorgs_in_container/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Old Java inside a container with xorgs
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/protect-lenovo-battery/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Protect Lenovo laptop battery
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/org-gnome-shell-overrides/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Workaround for org.gnome.shell.overrides not installed
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/get-process-cgroup-info-and-limits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Retrieving process cgroup resource usage and limit info
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/libvirt-uefi-without-secureboot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RHEL Booting a virtual machine with UEFI but without secure boot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/setting-journalctl-limits/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setting journalctl limits
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/cgroups_cpu_quota/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using cgroups for CFS bandwidth control
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/udev-ethtool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    udev rules to apply ethtool settings
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/selinux-cheatsheet/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SELinux Cheat Sheet
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Networking
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Networking
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../accept-source-routing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accept Source Routing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../arp_and_the_neighbor_table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ARP and the Neighbor table
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bpf-and-tcpdump/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BPF and tcpdump
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bonding_in_linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bonding in Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../juniper_x520/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure Juniper switch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ovn-interconnection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hands-on with OVN Interconnection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    haproxy and HTTP/2
  </span>
  

      </a>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../install-openvswitch-on-rocky/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install Open vSwitch on Rocky Linux 8
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geneve_tunneling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geneve tunneling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../netlink/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Netlink
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../netlink-address-fields/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Netlink and MAC addresses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ovn_standalone_on_fedora/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OVN standalone on Fedora
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ovs_recirculation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OVS packet recirculation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ovs-vxlan-tunnels-and-dscp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OVS VXLAN tunnels and DSCP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ovs_with_gdb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OVS with GDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../packet-tracing-with-ovn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Packet tracing with OVN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sctp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SCTP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../useful-commands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Useful commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wireguard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wireguard
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../openshift/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    OpenShift and Kubernetes
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            OpenShift and Kubernetes
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/alertmanager/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    AlertManager
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/analyzing-cni/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Analyzing CNI calls
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/ocp-custom-release-image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Building custom release images for OpenShift
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/cpu-manager-with-custom-machine-config-pool/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CPU manager with custom MachineConfigPool
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/cpu-isolation-in-openshift/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    CPU isolation in Red Hat OpenShift Container Platform
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/crio-conmon-runc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Crio vs conmon vs runc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/dedicated-service-monitors/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DedicatedServiceMonitors in OpenShift Monitoring
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/etcd_perf/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Etcd Performance tests
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/get-vs-list-api-calls/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Get vs List API Calls
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/openshift_httpbin_tshark_sidecar/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Httpbin tshark sidecar container
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/kubernetes_cluster/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hints for installing kubernetes on Fedora
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/HPA/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Horizontal Pod Autoscaler
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/how_rhcos_updates_work/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How RHCOS updates work
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/kubelet-filesystems/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    How kubelet monitors filesystems
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/ocp4-infra-nodes-with-machineset-without-worker-label/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Infra nodes with MachineSets without worker label
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/ingresscontroller_router_sharding_ocp_on_osp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ingress Controller Sharding OCP on OSP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/ingress-controller-sharding-on-separate-vip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Ingress Controller Sharding on separate VIP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/openshift_mirror_registry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Installing a cluster with a mirror registry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/istio-1.6-on-ocp.4.x/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Istio 1.6 on OpenShift 4.x
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/kata/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kata containers and the kata operatora
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/kernel-ml-on-openshift/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    kernel-ml on OpenShift
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/ovn-kind-hybrid-overlay/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kind with OVN Kubernetes Hybrid Overlay
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/kind-with-private-registry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kind with private registry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/list_docker_registry_containers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    List container images in registry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/mounting-container-image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Mount a container image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openstack/install_openshift_on_openstack/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenShift on OpenStack
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/openshift-with-multipath/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OpenShift with iSCSI multipath
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/patch-service-loadbalancer-ingress-ip/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Patch status.loadBalancer.ingress IP manually
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/private-registry/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Private container registry
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/proxy-ocp-4.5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Proxy OCP 4.5
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/rpm-ostree-failed-to-find-image/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    rpm-ostreed failed to find image
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/seccomp-defaults-ocp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Seccomp defaults in Red Hat OpenShift Container Platform
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/scc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Security Context Constraints (SCC)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/openshift-scc-with-mutating-webhooks/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SCCs and mutating webhooks - a lesson learned
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/fix-selinux-labels-coreos/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SElinux labels fix
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sctp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SCTP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/openshift_troubleshooting_etcd_state/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting etcd state
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/useful-ocp-commands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Useful commands for OpenShift
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/useful-ocp-sdn-commands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Useful commands for OpenShift SDN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/troubleshooting_openshift_on_openstack_worker_creation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Troubleshooting OpenShift on OpenStack worker creation
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../openstack/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    OpenStack
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_6" id="__nav_6_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            OpenStack
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openstack/reattach_to_running_deployment/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reattach to running deployment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../openstack/using_clouds_yaml/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Using clouds.yaml
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
    
    
      
      
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../coding/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Coding
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_7" id="__nav_7_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            Coding
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../coding/operator-sdk-reconciliation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Controller Reconciliation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../coding/vimrc/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    My vimrc
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../coding/golang-ip-conversion/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Golang IP address conversion
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
        </div>
      </div>
    </div>
  
  
    
    <!--
    <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner">
          

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
</nav>
        </div>
      </div>
    </div>
    -->
  

          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>haproxy and HTTP/2</h1>

<h2 id="haproxy-and-http2-with-a-focus-on-h2c">haproxy and HTTP2 with a focus on h2c</h2>
<p>This blog article focuses on haproxy's capabilities when it comes to protocol upgrades from HTTP/1.1 to HTTP/2 - all in the context of connection termination on the haproxy side. 
All tests will create one TCP connection from the client to the haproxy frontend and another TCP connection from the haproxy backend to the backend server.</p>
<p>haproxy can support HTTP/2 via encrypted as well as via clear text connections. For encrypted connections, haproxy allows protocol negotiation with ALPN (Application-Layer Protocol Negotiation).</p>
<ul>
<li>https://en.wikipedia.org/wiki/Application-Layer_Protocol_Negotiation</li>
</ul>
<p>ALPN is a TLS protocol extension. Thus, this feature requires TLS connections from the client to the haproxy frontend and from the haproxy backend to the backend server.</p>
<p>haproxy does not support the <code class="highlight"><span class="n">Upgrade</span><span class="o">:</span><span class="w"> </span><span class="n">h2c</span></code> statement. Hence, it is possible to establish either HTTP/1.1 or HTTP/2 connections, but clear text connections cannot be upgraded from HTTP/1.1 to HTTP/2.</p>
<h3 id="some-theory-h2-vs-h2c">Some theory - h2 vs h2c</h3>
<p>For the differences between HTTP/2 and h2c, see RFC 7540:</p>
<ul>
<li>https://tools.ietf.org/html/rfc7540#section-3.1</li>
<li>https://tools.ietf.org/html/rfc7540#section-3.2
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="mf">3.1</span><span class="p">.</span><span class="w">  </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="n">Version</span><span class="w"> </span><span class="n">Identification</span>

<span class="w">   </span><span class="n">The</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">defined</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">document</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">identifiers</span><span class="p">.</span>

<span class="w">   </span><span class="n">o</span><span class="w">  </span><span class="n">The</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="ss">&quot;h2&quot;</span><span class="w"> </span><span class="n">identifies</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="n">uses</span>
<span class="w">      </span><span class="n">Transport</span><span class="w"> </span><span class="n">Layer</span><span class="w"> </span><span class="n">Security</span><span class="w"> </span><span class="p">(</span><span class="n">TLS</span><span class="p">)</span><span class="w"> </span><span class="o">[</span><span class="n">TLS12</span><span class="o">]</span><span class="p">.</span><span class="w">  </span><span class="n">This</span><span class="w"> </span><span class="n">identifier</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">used</span>
<span class="w">      </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="n">application</span><span class="o">-</span><span class="n">layer</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">negotiation</span><span class="w"> </span><span class="p">(</span><span class="n">ALPN</span><span class="p">)</span><span class="w"> </span><span class="n">extension</span>
<span class="w">      </span><span class="o">[</span><span class="n">TLS-ALPN</span><span class="o">]</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="ow">any</span><span class="w"> </span><span class="n">place</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="k">over</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="k">is</span>
<span class="w">      </span><span class="n">identified</span><span class="p">.</span>

<span class="w">      </span><span class="n">The</span><span class="w"> </span><span class="ss">&quot;h2&quot;</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">serialized</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">ALPN</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">identifier</span><span class="w"> </span><span class="k">as</span>
<span class="w">      </span><span class="n">the</span><span class="w"> </span><span class="n">two</span><span class="o">-</span><span class="n">octet</span><span class="w"> </span><span class="k">sequence</span><span class="err">:</span><span class="w"> </span><span class="mh">0x68</span><span class="p">,</span><span class="w"> </span><span class="mh">0x32</span><span class="p">.</span>

<span class="w">   </span><span class="n">o</span><span class="w">  </span><span class="n">The</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="ss">&quot;h2c&quot;</span><span class="w"> </span><span class="n">identifies</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="k">over</span>
<span class="w">      </span><span class="n">cleartext</span><span class="w"> </span><span class="n">TCP</span><span class="p">.</span><span class="w">  </span><span class="n">This</span><span class="w"> </span><span class="n">identifier</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span><span class="w"> </span><span class="n">Upgrade</span>
<span class="w">      </span><span class="n">header</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="ow">any</span><span class="w"> </span><span class="n">place</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="k">over</span><span class="w"> </span><span class="n">TCP</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">identified</span><span class="p">.</span>

<span class="w">      </span><span class="n">The</span><span class="w"> </span><span class="ss">&quot;h2c&quot;</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">reserved</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ALPN</span><span class="w"> </span><span class="n">identifier</span><span class="w"> </span><span class="nf">space</span><span class="w"> </span><span class="n">but</span>
<span class="w">      </span><span class="n">describes</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="n">TLS</span><span class="p">.</span>

<span class="w">   </span><span class="n">Negotiating</span><span class="w"> </span><span class="ss">&quot;h2&quot;</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="ss">&quot;h2c&quot;</span><span class="w"> </span><span class="n">implies</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">transport</span><span class="p">,</span><span class="w"> </span><span class="n">security</span><span class="p">,</span>
<span class="w">   </span><span class="n">framing</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">message</span><span class="w"> </span><span class="n">semantics</span><span class="w"> </span><span class="n">described</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">document</span><span class="p">.</span>

<span class="mf">3.2</span><span class="p">.</span><span class="w">  </span><span class="n">Starting</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="ss">&quot;http&quot;</span><span class="w"> </span><span class="n">URIs</span>

<span class="w">   </span><span class="n">A</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">makes</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="ss">&quot;http&quot;</span><span class="w"> </span><span class="n">URI</span><span class="w"> </span><span class="k">without</span><span class="w"> </span><span class="k">prior</span>
<span class="w">   </span><span class="n">knowledge</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="n">hop</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">HTTP</span>
<span class="w">   </span><span class="n">Upgrade</span><span class="w"> </span><span class="n">mechanism</span><span class="w"> </span><span class="p">(</span><span class="k">Section</span><span class="w"> </span><span class="mf">6.7</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="o">[</span><span class="n">RFC7230</span><span class="o">]</span><span class="p">).</span><span class="w">  </span><span class="n">The</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="k">by</span>
<span class="w">   </span><span class="n">making</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">includes</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">Upgrade</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="k">with</span>
<span class="w">   </span><span class="n">the</span><span class="w"> </span><span class="ss">&quot;h2c&quot;</span><span class="w"> </span><span class="n">token</span><span class="p">.</span><span class="w">  </span><span class="n">Such</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">MUST</span><span class="w"> </span><span class="k">include</span><span class="w"> </span><span class="n">exactly</span><span class="w"> </span><span class="n">one</span>
<span class="w">   </span><span class="n">HTTP2</span><span class="o">-</span><span class="n">Settings</span><span class="w"> </span><span class="p">(</span><span class="k">Section</span><span class="w"> </span><span class="mf">3.2.1</span><span class="p">)</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">field</span><span class="p">.</span>

<span class="w">   </span><span class="k">For</span><span class="w"> </span><span class="nl">example</span><span class="p">:</span>

<span class="w">     </span><span class="k">GET</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="w">     </span><span class="k">Host</span><span class="err">:</span><span class="w"> </span><span class="n">server</span><span class="p">.</span><span class="n">example</span><span class="p">.</span><span class="n">com</span>
<span class="w">     </span><span class="k">Connection</span><span class="err">:</span><span class="w"> </span><span class="n">Upgrade</span><span class="p">,</span><span class="w"> </span><span class="n">HTTP2</span><span class="o">-</span><span class="n">Settings</span>
<span class="w">     </span><span class="nl">Upgrade</span><span class="p">:</span><span class="w"> </span><span class="n">h2c</span>
<span class="w">     </span><span class="n">HTTP2</span><span class="o">-</span><span class="nl">Settings</span><span class="p">:</span><span class="w"> </span><span class="o">&lt;</span><span class="n">base64url</span><span class="w"> </span><span class="n">encoding</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="n">SETTINGS</span><span class="w"> </span><span class="n">payload</span><span class="o">&gt;</span>

<span class="w">   </span><span class="n">Requests</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">payload</span><span class="w"> </span><span class="n">body</span><span class="w"> </span><span class="n">MUST</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="n">entirety</span>
<span class="w">   </span><span class="k">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">send</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="n">frames</span><span class="p">.</span><span class="w">  </span><span class="n">This</span><span class="w"> </span><span class="n">means</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">large</span>
<span class="w">   </span><span class="n">request</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">block</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">connection</span><span class="w"> </span><span class="n">until</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">completely</span>
<span class="w">   </span><span class="n">sent</span><span class="p">.</span>

<span class="w">   </span><span class="k">If</span><span class="w"> </span><span class="n">concurrency</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">initial</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">subsequent</span><span class="w"> </span><span class="n">requests</span><span class="w"> </span><span class="k">is</span>
<span class="w">   </span><span class="n">important</span><span class="p">,</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">OPTIONS</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">perform</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">upgrade</span><span class="w"> </span><span class="k">to</span>
<span class="w">   </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">cost</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="nf">round</span><span class="w"> </span><span class="n">trip</span><span class="p">.</span>



<span class="n">Belshe</span><span class="p">,</span><span class="w"> </span><span class="n">et</span><span class="w"> </span><span class="n">al</span><span class="p">.</span><span class="w">               </span><span class="n">Standards</span><span class="w"> </span><span class="n">Track</span><span class="w">                    </span><span class="o">[</span><span class="n">Page 8</span><span class="o">]</span>


<span class="n">RFC</span><span class="w"> </span><span class="mi">7540</span><span class="w">                         </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w">                         </span><span class="n">May</span><span class="w"> </span><span class="mi">2015</span>


<span class="w">   </span><span class="n">A</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">respond</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="k">as</span>
<span class="w">   </span><span class="n">though</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">Upgrade</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">were</span><span class="w"> </span><span class="nl">absent</span><span class="p">:</span>

<span class="w">     </span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="n">OK</span>
<span class="w">     </span><span class="n">Content</span><span class="o">-</span><span class="nl">Length</span><span class="p">:</span><span class="w"> </span><span class="mi">243</span>
<span class="w">     </span><span class="n">Content</span><span class="o">-</span><span class="nl">Type</span><span class="p">:</span><span class="w"> </span><span class="nc">text</span><span class="o">/</span><span class="n">html</span>

<span class="w">     </span><span class="p">...</span>

<span class="w">   </span><span class="n">A</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">MUST</span><span class="w"> </span><span class="k">ignore</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="ss">&quot;h2&quot;</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">Upgrade</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">field</span><span class="p">.</span>
<span class="w">   </span><span class="n">Presence</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">token</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="ss">&quot;h2&quot;</span><span class="w"> </span><span class="n">implies</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="k">over</span><span class="w"> </span><span class="n">TLS</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="k">is</span>
<span class="w">   </span><span class="n">instead</span><span class="w"> </span><span class="n">negotiated</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">described</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">Section</span><span class="w"> </span><span class="mf">3.3</span><span class="p">.</span>

<span class="w">   </span><span class="n">A</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">supports</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="n">accepts</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">upgrade</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="mi">101</span>
<span class="w">   </span><span class="p">(</span><span class="n">Switching</span><span class="w"> </span><span class="n">Protocols</span><span class="p">)</span><span class="w"> </span><span class="n">response</span><span class="p">.</span><span class="w">  </span><span class="k">After</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">empty</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">terminates</span>
<span class="w">   </span><span class="n">the</span><span class="w"> </span><span class="mi">101</span><span class="w"> </span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="k">begin</span><span class="w"> </span><span class="n">sending</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="n">frames</span><span class="p">.</span><span class="w">  </span><span class="n">These</span>
<span class="w">   </span><span class="n">frames</span><span class="w"> </span><span class="n">MUST</span><span class="w"> </span><span class="k">include</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">initiated</span><span class="w"> </span><span class="n">the</span>
<span class="w">   </span><span class="n">upgrade</span><span class="p">.</span>

<span class="w">   </span><span class="k">For</span><span class="w"> </span><span class="nl">example</span><span class="p">:</span>

<span class="w">     </span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span><span class="w"> </span><span class="mi">101</span><span class="w"> </span><span class="n">Switching</span><span class="w"> </span><span class="n">Protocols</span>
<span class="w">     </span><span class="k">Connection</span><span class="err">:</span><span class="w"> </span><span class="n">Upgrade</span>
<span class="w">     </span><span class="nl">Upgrade</span><span class="p">:</span><span class="w"> </span><span class="n">h2c</span>

<span class="w">     </span><span class="err">[</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="k">connection</span><span class="w"> </span><span class="p">...</span>

<span class="w">   </span><span class="n">The</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="n">frame</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">MUST</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="k">connection</span>
<span class="w">   </span><span class="n">preface</span><span class="w"> </span><span class="p">(</span><span class="k">Section</span><span class="w"> </span><span class="mf">3.5</span><span class="p">)</span><span class="w"> </span><span class="n">consisting</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">SETTINGS</span><span class="w"> </span><span class="n">frame</span><span class="w"> </span><span class="p">(</span><span class="k">Section</span><span class="w"> </span><span class="mf">6.5</span><span class="p">).</span>
<span class="w">   </span><span class="n">Upon</span><span class="w"> </span><span class="n">receiving</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="mi">101</span><span class="w"> </span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">MUST</span><span class="w"> </span><span class="n">send</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">connection</span>
<span class="w">   </span><span class="n">preface</span><span class="w"> </span><span class="p">(</span><span class="k">Section</span><span class="w"> </span><span class="mf">3.5</span><span class="p">),</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">includes</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">SETTINGS</span><span class="w"> </span><span class="n">frame</span><span class="p">.</span>

<span class="w">   </span><span class="n">The</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">sent</span><span class="w"> </span><span class="k">prior</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">upgrade</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">assigned</span><span class="w"> </span><span class="n">a</span>
<span class="w">   </span><span class="n">stream</span><span class="w"> </span><span class="n">identifier</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="n">see</span><span class="w"> </span><span class="k">Section</span><span class="w"> </span><span class="mf">5.1.1</span><span class="p">)</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">priority</span>
<span class="w">   </span><span class="k">values</span><span class="w"> </span><span class="p">(</span><span class="k">Section</span><span class="w"> </span><span class="mf">5.3.5</span><span class="p">).</span><span class="w">  </span><span class="n">Stream</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">implicitly</span><span class="w"> </span><span class="ss">&quot;half-closed&quot;</span><span class="w"> </span><span class="k">from</span>
<span class="w">   </span><span class="n">the</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">toward</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="p">(</span><span class="n">see</span><span class="w"> </span><span class="k">Section</span><span class="w"> </span><span class="mf">5.1</span><span class="p">),</span><span class="w"> </span><span class="n">since</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">request</span><span class="w"> </span><span class="k">is</span>
<span class="w">   </span><span class="n">completed</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="w">  </span><span class="k">After</span><span class="w"> </span><span class="n">commencing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">2</span>
<span class="w">   </span><span class="k">connection</span><span class="p">,</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">response</span><span class="p">.</span>
</code></pre></div></td></tr></table></div></li>
</ul>
<h3 id="upgrade-h2c-with-haproxy">Upgrade h2c with haproxy</h3>
<p>Haproxy - protocol upgrades from HTTP/1.1 to HTTP/2 via <code class="highlight"><span class="n">Upgrade</span><span class="o">:</span><span class="w"> </span><span class="n">h2c</span></code> is not possible with haproxy. For negotiation of the protocol, haproxy only supports ALPN. </p>
<p>Otherwise the protocol must be forced to either HTTP/1.1 or HTTP/2. For example, on the frontend, it is possible to not select a protocol. A client can then either initiate an HTTP/1.1 connection or an HTTP/2 connection, but it cannot upgrade from HTTP/1.1 to HTTP/2. (see <code class="highlight">POC</code> for further details)</p>
<p>On the backend side, it is the same. You can either force the backend proto via <code class="highlight">proto h2</code> to be HTTP/2. Or you can use HTTP/1.1. For negotiation of the protocol, you must use ALPN on the backend.</p>
<p>Refer to the documentation: http://cbonte.github.io/haproxy-dconv/2.4/configuration.html
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nv">alpn</span><span class="w"> </span><span class="o">&lt;</span><span class="nv">alpn</span><span class="o">&gt;</span><span class="w">  </span><span class="nv">defines</span><span class="w"> </span><span class="nv">which</span><span class="w"> </span><span class="nv">protocols</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">advertise</span><span class="w"> </span><span class="nv">with</span><span class="w"> </span><span class="nv">ALPN</span>.<span class="w"> </span><span class="nv">The</span><span class="w"> </span><span class="nv">protocol</span>
<span class="w">             </span><span class="nv">list</span><span class="w"> </span><span class="nv">consists</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">comma</span><span class="o">-</span><span class="nv">delimited</span><span class="w"> </span><span class="nv">list</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">protocol</span><span class="w"> </span><span class="nv">names</span>,
<span class="w">             </span><span class="k">for</span><span class="w"> </span><span class="nv">instance</span>:<span class="w"> </span><span class="s2">&quot;http/1.1,http/1.0&quot;</span><span class="w"> </span><span class="ss">(</span><span class="nv">without</span><span class="w"> </span><span class="nv">quotes</span><span class="ss">)</span>.
<span class="w">             </span><span class="k">If</span><span class="w"> </span><span class="nv">it</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">not</span><span class="w"> </span><span class="nv">set</span>,<span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">server</span><span class="w"> </span><span class="nv">ALPN</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">used</span>.
</code></pre></div></td></tr></table></div></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nx">alpn</span><span class="w"> </span><span class="p">&lt;</span><span class="nx">protocols</span><span class="p">&gt;</span>

<span class="nx">This</span><span class="w"> </span><span class="nx">enables</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">TLS</span><span class="w"> </span><span class="nx">ALPN</span><span class="w"> </span><span class="nx">extension</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">advertises</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">specified</span><span class="w"> </span><span class="nx">protocol</span>
<span class="nx">list</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nx">supported</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">top</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">ALPN</span><span class="p">.</span><span class="w"> </span><span class="nx">The</span><span class="w"> </span><span class="nx">protocol</span><span class="w"> </span><span class="nx">list</span><span class="w"> </span><span class="nx">consists</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">comma</span><span class="o">-</span>
<span class="nx">delimited</span><span class="w"> </span><span class="nx">list</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">protocol</span><span class="w"> </span><span class="nx">names</span><span class="p">,</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">instance</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http/1.1,http/1.0&quot;</span><span class="w"> </span><span class="p">(</span><span class="nx">without</span>
<span class="nx">quotes</span><span class="p">).</span><span class="w"> </span><span class="nx">This</span><span class="w"> </span><span class="nx">requires</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">SSL</span><span class="w"> </span><span class="kn">library</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">built</span><span class="w"> </span><span class="nx">with</span><span class="w"> </span><span class="nx">support</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">TLS</span>
<span class="nx">extensions</span><span class="w"> </span><span class="nx">enabled</span><span class="w"> </span><span class="p">(</span><span class="nx">check</span><span class="w"> </span><span class="nx">with</span><span class="w"> </span><span class="nx">haproxy</span><span class="w"> </span><span class="o">-</span><span class="nx">vv</span><span class="p">).</span><span class="w"> </span><span class="nx">The</span><span class="w"> </span><span class="nx">ALPN</span><span class="w"> </span><span class="nx">extension</span><span class="w"> </span><span class="nx">replaces</span><span class="w"> </span><span class="nx">the</span>
<span class="nx">initial</span><span class="w"> </span><span class="nx">NPN</span><span class="w"> </span><span class="nx">extension</span><span class="p">.</span><span class="w"> </span><span class="nx">ALPN</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">required</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">enable</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">an</span><span class="w"> </span><span class="nx">HTTP</span><span class="w"> </span><span class="nx">frontend</span><span class="p">.</span>
<span class="nx">Versions</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">OpenSSL</span><span class="w"> </span><span class="nx">prior</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="m m-Double">1.0.2</span><span class="w"> </span><span class="nx">didn</span><span class="err">&#39;</span><span class="nx">t</span><span class="w"> </span><span class="nx">support</span><span class="w"> </span><span class="nx">ALPN</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">only</span><span class="w"> </span><span class="nx">supposed</span><span class="w"> </span><span class="nx">the</span>
<span class="nx">now</span><span class="w"> </span><span class="nx">obsolete</span><span class="w"> </span><span class="nx">NPN</span><span class="w"> </span><span class="nx">extension</span><span class="p">.</span><span class="w"> </span><span class="nx">At</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">time</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">writing</span><span class="w"> </span><span class="nx">this</span><span class="p">,</span><span class="w"> </span><span class="nx">most</span><span class="w"> </span><span class="nx">browsers</span><span class="w"> </span><span class="nx">still</span>
<span class="nx">support</span><span class="w"> </span><span class="nx">both</span><span class="w"> </span><span class="nx">ALPN</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">NPN</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="nx">so</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">fallback</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">NPN</span><span class="w"> </span><span class="nx">may</span><span class="w"> </span><span class="nx">still</span><span class="w"> </span><span class="nx">work</span><span class="w"> </span><span class="k">for</span>
<span class="nx">a</span><span class="w"> </span><span class="k">while</span><span class="p">.</span><span class="w"> </span><span class="nx">But</span><span class="w"> </span><span class="nx">ALPN</span><span class="w"> </span><span class="nx">must</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">used</span><span class="w"> </span><span class="nx">whenever</span><span class="w"> </span><span class="nx">possible</span><span class="p">.</span><span class="w"> </span><span class="nx">If</span><span class="w"> </span><span class="nx">both</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="m m-Double">1.1</span>
<span class="nx">are</span><span class="w"> </span><span class="nx">expected</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">supported</span><span class="p">,</span><span class="w"> </span><span class="nx">both</span><span class="w"> </span><span class="nx">versions</span><span class="w"> </span><span class="nx">can</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">advertised</span><span class="p">,</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">order</span><span class="w"> </span><span class="nx">of</span>
<span class="nx">preference</span><span class="p">,</span><span class="w"> </span><span class="k">like</span><span class="w"> </span><span class="nx">below</span><span class="w"> </span><span class="p">:</span>

<span class="w">     </span><span class="nx">bind</span><span class="w"> </span><span class="p">:</span><span class="mi">443</span><span class="w"> </span><span class="nx">ssl</span><span class="w"> </span><span class="nx">crt</span><span class="w"> </span><span class="nx">pub</span><span class="p">.</span><span class="nx">pem</span><span class="w"> </span><span class="nx">alpn</span><span class="w"> </span><span class="nx">h2</span><span class="p">,</span><span class="nx">http</span><span class="o">/</span><span class="m m-Double">1.1</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nv">proto</span><span class="w"> </span><span class="o">&lt;</span><span class="nv">name</span><span class="o">&gt;</span>

<span class="nv">Forces</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">multiplexer</span><span class="err">&#39;s protocol to use for the incoming connections. It</span>
<span class="err">must be compatible with the mode of the frontend (TCP or HTTP). It must also</span>
<span class="err">be usable on the frontend side. The list of available protocols is reported</span>
<span class="err">in haproxy -vv.</span>
<span class="nv">Idea</span><span class="w"> </span><span class="nv">behind</span><span class="w"> </span><span class="nv">this</span><span class="w"> </span><span class="nv">option</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">bypass</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">selection</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">best</span><span class="w"> </span><span class="nv">multiplexer</span><span class="err">&#39;s</span>
<span class="err">protocol for all connections instantiated from this listening socket. For</span>
<span class="err">instance, it is possible to force the http/2 on clear TCP by specifying &quot;proto</span>
<span class="err">h2&quot; on the bind line.</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="mi">@26</span><span class="n">b317c91a20</span><span class="w"> </span><span class="o">/</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="n">haproxy</span><span class="w"> </span><span class="o">-</span><span class="n">vv</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="o">-</span><span class="n">A5</span>
<span class="n">Available</span><span class="w"> </span><span class="n">multiplexer</span><span class="w"> </span><span class="n">protocols</span><span class="w"> </span><span class="o">:</span>
<span class="p">(</span><span class="n">protocols</span><span class="w"> </span><span class="n">marked</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="o">&lt;</span><span class="k">default</span><span class="o">&gt;</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="err">&#39;</span><span class="n">proto</span><span class="err">&#39;</span><span class="w"> </span><span class="n">keyword</span><span class="p">)</span>
<span class="w">            </span><span class="nl">fcgi</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="n">HTTP</span><span class="w">       </span><span class="n">side</span><span class="o">=</span><span class="n">BE</span><span class="w">        </span><span class="n">mux</span><span class="o">=</span><span class="n">FCGI</span>
<span class="w">       </span><span class="o">&lt;</span><span class="k">default</span><span class="o">&gt;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="n">HTTP</span><span class="w">       </span><span class="n">side</span><span class="o">=</span><span class="n">FE</span><span class="o">|</span><span class="n">BE</span><span class="w">     </span><span class="n">mux</span><span class="o">=</span><span class="n">H1</span>
<span class="w">              </span><span class="nl">h2</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="n">HTTP</span><span class="w">       </span><span class="n">side</span><span class="o">=</span><span class="n">FE</span><span class="o">|</span><span class="n">BE</span><span class="w">     </span><span class="n">mux</span><span class="o">=</span><span class="n">H2</span>
<span class="w">       </span><span class="o">&lt;</span><span class="k">default</span><span class="o">&gt;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="n">TCP</span><span class="w">        </span><span class="n">side</span><span class="o">=</span><span class="n">FE</span><span class="o">|</span><span class="n">BE</span><span class="w">     </span><span class="n">mux</span><span class="o">=</span><span class="n">PASS</span>
</code></pre></div></td></tr></table></div>
<p>Version for tests in POC:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@ef82916a0181 /</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">haproxy</span><span class="w"> </span><span class="o">-</span><span class="n">v</span>
<span class="n">HA</span><span class="o">-</span><span class="n">Proxy</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">2.2.9</span><span class="o">-</span><span class="n">a947cc2</span><span class="w"> </span><span class="mi">2021</span><span class="o">/</span><span class="mi">02</span><span class="o">/</span><span class="mi">06</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="nl">https</span><span class="p">:</span><span class="o">//</span><span class="n">haproxy</span><span class="p">.</span><span class="n">org</span><span class="o">/</span>
<span class="nl">Status</span><span class="p">:</span><span class="w"> </span><span class="n">long</span><span class="o">-</span><span class="n">term</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="n">branch</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">stop</span><span class="w"> </span><span class="n">receiving</span><span class="w"> </span><span class="n">fixes</span><span class="w"> </span><span class="n">around</span><span class="w"> </span><span class="n">Q2</span><span class="w"> </span><span class="mf">2025.</span>
<span class="n">Known</span><span class="w"> </span><span class="nl">bugs</span><span class="p">:</span><span class="w"> </span><span class="nl">http</span><span class="p">:</span><span class="o">//</span><span class="n">www</span><span class="p">.</span><span class="n">haproxy</span><span class="p">.</span><span class="n">org</span><span class="o">/</span><span class="n">bugs</span><span class="o">/</span><span class="n">bugs</span><span class="o">-</span><span class="mf">2.2.9</span><span class="p">.</span><span class="n">html</span>
<span class="n">Running</span><span class="w"> </span><span class="k">on</span><span class="err">:</span><span class="w"> </span><span class="n">Linux</span><span class="w"> </span><span class="mf">4.18.0</span><span class="o">-</span><span class="mf">240.1.1</span><span class="p">.</span><span class="n">el8_3</span><span class="p">.</span><span class="n">x86_64</span><span class="w"> </span><span class="n">#1</span><span class="w"> </span><span class="n">SMP</span><span class="w"> </span><span class="n">Fri</span><span class="w"> </span><span class="n">Oct</span><span class="w"> </span><span class="mi">16</span><span class="w"> </span><span class="mi">13</span><span class="err">:</span><span class="mi">36</span><span class="err">:</span><span class="mi">46</span><span class="w"> </span><span class="n">EDT</span><span class="w"> </span><span class="mi">2020</span><span class="w"> </span><span class="n">x86_64</span>
</code></pre></div></td></tr></table></div></p>
<p>The tested haproxy version [0] can only negotiate the HTTP version via ALPN and this requires the use of TLS and thus of encrypted connections. This applies to both frontend and backend connections. 
Thus, if haproxy uses ALPN on both the frontend and the backend, any higher level tool that configures haproxy (such as the <code class="highlight">openshift-router</code> binary inside the OpenShift router pods) does not have to worry and can simply rely on ALPN protocol negotiation to find the correct protocol for the client and for the backend server.
The <code class="highlight"><span class="n">Upgrade</span><span class="o">:</span><span class="w"> </span><span class="n">h2c</span></code> statement does not seem to be supported with haproxy. I could not find official sources for this, but my tests and research on the web point towards this.
On unencrypted frontends, haproxy can be configured to accept HTTP/1.1 and HTTP/2 connections by omitting the <code class="highlight">proto</code> parameter, but this will work only if the client directly chooses either of the 2 protocols. On the frontend, upgrade attempts from HTTP/1.1 to HTTP/2 will fail. HTTP/2 can be forced via <code class="highlight">proto h2</code>. I did not verify if it is possible to force HTTP/1.1 on the frontend.
On the backend, haproxy does not offer any way to negotiate the protocol. Administrators or tools must choose either HTTP/1.1 by omitting <code class="highlight">proto</code> or HTTP/2 by setting <code class="highlight">proto h2</code>.</p>
<h3 id="poc">POC</h3>
<h4 id="poc-reproducer">POC reproducer</h4>
<p>I used https://github.com/andreaskaris/http2-poc for the POC setup and my testings</p>
<h4 id="httpd-basaeline">HTTPD basaeline</h4>
<p>With the correct configuration, httpd supports the <code class="highlight"><span class="n">Upgrade</span><span class="o">:</span><span class="w"> </span><span class="n">h2c</span></code> statement:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nt">&lt;VirtualHost</span><span class="w"> </span><span class="err">*:$H2C_PORT</span><span class="nt">&gt;</span>
DocumentRoot<span class="w"> </span>/var/www/html2
ServerName<span class="w"> </span>www.h2c.example.org
Protocols<span class="w"> </span>h2c
<span class="nt">&lt;/VirtualHost&gt;</span>
</code></pre></div></td></tr></table></div></p>
<p>In that case, either of the 3 following tests works with httpd:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span>
<span class="normal">89</span>
<span class="normal">90</span>
<span class="normal">91</span>
<span class="normal">92</span>
<span class="normal">93</span>
<span class="normal">94</span>
<span class="normal">95</span>
<span class="normal">96</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">kind</span><span class="w"> </span><span class="nx">haproxy</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">curl</span><span class="w"> </span><span class="nx">http</span><span class="p">:</span><span class="c1">//localhost:8081 -v</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Rebuilt</span><span class="w"> </span><span class="nx">URL</span><span class="w"> </span><span class="nx">to</span><span class="p">:</span><span class="w"> </span><span class="nx">http</span><span class="p">:</span><span class="c1">//localhost:8081/</span>
<span class="o">*</span><span class="w">   </span><span class="nx">Trying</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="o">...</span>
<span class="o">*</span><span class="w"> </span><span class="nx">TCP_NODELAY</span><span class="w"> </span><span class="nx">set</span>
<span class="o">*</span><span class="w"> </span><span class="nx">connect</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="nx">failed</span><span class="p">:</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="nx">refused</span>
<span class="o">*</span><span class="w">   </span><span class="nx">Trying</span><span class="w"> </span><span class="m m-Double">127.0.0.1</span><span class="o">...</span>
<span class="o">*</span><span class="w"> </span><span class="nx">TCP_NODELAY</span><span class="w"> </span><span class="nx">set</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connected</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">localhost</span><span class="w"> </span><span class="p">(</span><span class="m m-Double">127.0.0.1</span><span class="p">)</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="p">(</span><span class="err">#</span><span class="mi">0</span><span class="p">)</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">GET</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="m m-Double">1.1</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">Host</span><span class="p">:</span><span class="w"> </span><span class="nx">localhost</span><span class="p">:</span><span class="mi">8081</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">User</span><span class="o">-</span><span class="nx">Agent</span><span class="p">:</span><span class="w"> </span><span class="nx">curl</span><span class="o">/</span><span class="m m-Double">7.61.1</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">Accept</span><span class="p">:</span><span class="w"> </span><span class="o">*</span><span class="cm">/*</span>
<span class="cm">&gt; </span>
<span class="cm">&lt; HTTP/1.1 200 OK</span>
<span class="cm">&lt; Date: Mon, 08 Mar 2021 19:58:09 GMT</span>
<span class="cm">&lt; Server: Apache/2.4.46 (Fedora) OpenSSL/1.1.1j</span>
<span class="cm">&lt; Upgrade: h2c</span>
<span class="cm">&lt; Connection: Upgrade</span>
<span class="cm">&lt; Last-Modified: Mon, 08 Mar 2021 18:34:18 GMT</span>
<span class="cm">&lt; ETag: &quot;16-5bd0aae785e80&quot;</span>
<span class="cm">&lt; Accept-Ranges: bytes</span>
<span class="cm">&lt; Content-Length: 22</span>
<span class="cm">&lt; Content-Type: text/html; charset=UTF-8</span>
<span class="cm">&lt; </span>
<span class="cm">HTTP/2 insecure (h2c)</span>
<span class="cm">* Connection #0 to host localhost left intact</span>

<span class="cm">---</span>

<span class="cm">[root@kind http2-haproxy]# curl --http2 http://localhost:8081 -v</span>
<span class="cm">* Rebuilt URL to: http://localhost:8081/</span>
<span class="cm">*   Trying ::1...</span>
<span class="cm">* TCP_NODELAY set</span>
<span class="cm">* connect to ::1 port 8081 failed: Connection refused</span>
<span class="cm">*   Trying 127.0.0.1...</span>
<span class="cm">* TCP_NODELAY set</span>
<span class="cm">* Connected to localhost (127.0.0.1) port 8081 (#0)</span>
<span class="cm">&gt; GET / HTTP/1.1</span>
<span class="cm">&gt; Host: localhost:8081</span>
<span class="cm">&gt; User-Agent: curl/7.61.1</span>
<span class="cm">&gt; Accept: */</span><span class="o">*</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">Connection</span><span class="p">:</span><span class="w"> </span><span class="nx">Upgrade</span><span class="p">,</span><span class="w"> </span><span class="nx">HTTP2</span><span class="o">-</span><span class="nx">Settings</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">Upgrade</span><span class="p">:</span><span class="w"> </span><span class="nx">h2c</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">HTTP2</span><span class="o">-</span><span class="nx">Settings</span><span class="p">:</span><span class="w"> </span><span class="nx">AAMAAABkAARAAAAAAAIAAAAA</span>
<span class="p">&gt;</span><span class="w"> </span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="m m-Double">1.1</span><span class="w"> </span><span class="mi">101</span><span class="w"> </span><span class="nx">Switching</span><span class="w"> </span><span class="nx">Protocols</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">Upgrade</span><span class="p">:</span><span class="w"> </span><span class="nx">h2c</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">Connection</span><span class="p">:</span><span class="w"> </span><span class="nx">Upgrade</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Received</span><span class="w"> </span><span class="mi">101</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Using</span><span class="w"> </span><span class="nx">HTTP2</span><span class="p">,</span><span class="w"> </span><span class="nx">server</span><span class="w"> </span><span class="nx">supports</span><span class="w"> </span><span class="nx">multi</span><span class="o">-</span><span class="nx">use</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="nx">changed</span><span class="w"> </span><span class="p">(</span><span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="nx">confirmed</span><span class="p">)</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Copying</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">stream</span><span class="w"> </span><span class="nx">buffer</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="nx">buffer</span><span class="w"> </span><span class="nx">after</span><span class="w"> </span><span class="nx">upgrade</span><span class="p">:</span><span class="w"> </span><span class="nx">len</span><span class="p">=</span><span class="mi">0</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="nx">changed</span><span class="w"> </span><span class="p">(</span><span class="nx">MAX_CONCURRENT_STREAMS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">100</span><span class="p">)!</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="nx">Sun</span><span class="p">,</span><span class="w"> </span><span class="mi">00</span><span class="w"> </span><span class="nx">Jan</span><span class="w"> </span><span class="mi">1900</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="w"> </span><span class="nx">GMT</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">server</span><span class="p">:</span><span class="w"> </span><span class="nx">Apache</span><span class="o">/</span><span class="m m-Double">2.4.46</span><span class="w"> </span><span class="p">(</span><span class="nx">Fedora</span><span class="p">)</span><span class="w"> </span><span class="nx">OpenSSL</span><span class="o">/</span><span class="m m-Double">1.1.1</span><span class="nx">j</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">last</span><span class="o">-</span><span class="nx">modified</span><span class="p">:</span><span class="w"> </span><span class="nx">Mon</span><span class="p">,</span><span class="w"> </span><span class="mi">08</span><span class="w"> </span><span class="nx">Mar</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="mi">18</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">18</span><span class="w"> </span><span class="nx">GMT</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">etag</span><span class="p">:</span><span class="w"> </span><span class="nx">W</span><span class="o">/</span><span class="s">&quot;16-5bd0aae785e80&quot;</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">accept</span><span class="o">-</span><span class="nx">ranges</span><span class="p">:</span><span class="w"> </span><span class="nx">bytes</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">content</span><span class="o">-</span><span class="nx">length</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">content</span><span class="o">-</span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">text</span><span class="o">/</span><span class="nx">html</span><span class="p">;</span><span class="w"> </span><span class="nx">charset</span><span class="p">=</span><span class="nx">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="p">&lt;</span><span class="w"> </span>
<span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="nx">insecure</span><span class="w"> </span><span class="p">(</span><span class="nx">h2c</span><span class="p">)</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="err">#</span><span class="mi">0</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">host</span><span class="w"> </span><span class="nx">localhost</span><span class="w"> </span><span class="nx">left</span><span class="w"> </span><span class="nx">intact</span>

<span class="o">---</span>

<span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">kind</span><span class="w"> </span><span class="nx">http2</span><span class="o">-</span><span class="nx">haproxy</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">curl</span><span class="w"> </span><span class="o">--</span><span class="nx">http2</span><span class="o">-</span><span class="nx">prior</span><span class="o">-</span><span class="nx">knowledge</span><span class="w"> </span><span class="nx">http</span><span class="p">:</span><span class="c1">//localhost:8081 -v</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Rebuilt</span><span class="w"> </span><span class="nx">URL</span><span class="w"> </span><span class="nx">to</span><span class="p">:</span><span class="w"> </span><span class="nx">http</span><span class="p">:</span><span class="c1">//localhost:8081/</span>
<span class="o">*</span><span class="w">   </span><span class="nx">Trying</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="o">...</span>
<span class="o">*</span><span class="w"> </span><span class="nx">TCP_NODELAY</span><span class="w"> </span><span class="nx">set</span>
<span class="o">*</span><span class="w"> </span><span class="nx">connect</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="nx">failed</span><span class="p">:</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="nx">refused</span>
<span class="o">*</span><span class="w">   </span><span class="nx">Trying</span><span class="w"> </span><span class="m m-Double">127.0.0.1</span><span class="o">...</span>
<span class="o">*</span><span class="w"> </span><span class="nx">TCP_NODELAY</span><span class="w"> </span><span class="nx">set</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connected</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">localhost</span><span class="w"> </span><span class="p">(</span><span class="m m-Double">127.0.0.1</span><span class="p">)</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="p">(</span><span class="err">#</span><span class="mi">0</span><span class="p">)</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Using</span><span class="w"> </span><span class="nx">HTTP2</span><span class="p">,</span><span class="w"> </span><span class="nx">server</span><span class="w"> </span><span class="nx">supports</span><span class="w"> </span><span class="nx">multi</span><span class="o">-</span><span class="nx">use</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="nx">changed</span><span class="w"> </span><span class="p">(</span><span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="nx">confirmed</span><span class="p">)</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Copying</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">stream</span><span class="w"> </span><span class="nx">buffer</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="nx">buffer</span><span class="w"> </span><span class="nx">after</span><span class="w"> </span><span class="nx">upgrade</span><span class="p">:</span><span class="w"> </span><span class="nx">len</span><span class="p">=</span><span class="mi">0</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Using</span><span class="w"> </span><span class="nx">Stream</span><span class="w"> </span><span class="nx">ID</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="nx">easy</span><span class="w"> </span><span class="nx">handle</span><span class="w"> </span><span class="mh">0x55d307eec480</span><span class="p">)</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">GET</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">Host</span><span class="p">:</span><span class="w"> </span><span class="nx">localhost</span><span class="p">:</span><span class="mi">8081</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">User</span><span class="o">-</span><span class="nx">Agent</span><span class="p">:</span><span class="w"> </span><span class="nx">curl</span><span class="o">/</span><span class="m m-Double">7.61.1</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">Accept</span><span class="p">:</span><span class="w"> </span><span class="o">*/*</span>
<span class="p">&gt;</span><span class="w"> </span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="nx">changed</span><span class="w"> </span><span class="p">(</span><span class="nx">MAX_CONCURRENT_STREAMS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">100</span><span class="p">)!</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="nx">Mon</span><span class="p">,</span><span class="w"> </span><span class="mi">08</span><span class="w"> </span><span class="nx">Mar</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="mi">19</span><span class="p">:</span><span class="mi">18</span><span class="p">:</span><span class="mi">38</span><span class="w"> </span><span class="nx">GMT</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">server</span><span class="p">:</span><span class="w"> </span><span class="nx">Apache</span><span class="o">/</span><span class="m m-Double">2.4.46</span><span class="w"> </span><span class="p">(</span><span class="nx">Fedora</span><span class="p">)</span><span class="w"> </span><span class="nx">OpenSSL</span><span class="o">/</span><span class="m m-Double">1.1.1</span><span class="nx">j</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">last</span><span class="o">-</span><span class="nx">modified</span><span class="p">:</span><span class="w"> </span><span class="nx">Mon</span><span class="p">,</span><span class="w"> </span><span class="mi">08</span><span class="w"> </span><span class="nx">Mar</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="mi">18</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">18</span><span class="w"> </span><span class="nx">GMT</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">etag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;16-5bd0aae785e80&quot;</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">accept</span><span class="o">-</span><span class="nx">ranges</span><span class="p">:</span><span class="w"> </span><span class="nx">bytes</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">content</span><span class="o">-</span><span class="nx">length</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">content</span><span class="o">-</span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">text</span><span class="o">/</span><span class="nx">html</span><span class="p">;</span><span class="w"> </span><span class="nx">charset</span><span class="p">=</span><span class="nx">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="p">&lt;</span><span class="w"> </span>
<span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="nx">insecure</span><span class="w"> </span><span class="p">(</span><span class="nx">h2c</span><span class="p">)</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="err">#</span><span class="mi">0</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">host</span><span class="w"> </span><span class="nx">localhost</span><span class="w"> </span><span class="nx">left</span><span class="w"> </span><span class="nx">intact</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="testing-the-haproxy-frontend-side">Testing the haproxy frontend side</h4>
<p>The problem with haproxy is that it cannot upgrade an unencrypted frontend HTTP/1.1 connection to HTTP/2 --- the Upgrade: h2c statement does not work.</p>
<p>According to https://discourse.haproxy.org/t/converting-http-2-h2c-without-tls-to-http-1-1/2176/10 , upgrading from HTTP/1.1 to HTTP/2 on the frontend is only possible in haproxy with ALPN.</p>
<p>Also see https://www.haproxy.com/blog/haproxy-1-9-has-arrived/ and https://www.haproxy.com/blog/haproxy-2-0-and-beyond/#end-to-end-http-2</p>
<h5 id="testing-to-force-h2http11-in-that-order">Testing to force h2,http/1.1 in that order</h5>
<p>Something like this does not work:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code>frontend fe_h2c
    mode http
    bind *:8084 proto h2,http/1.1
    default_backend be_h2c

backend be_h2c
    mode http
    server server1 10.88.0.123:8081 proto h2
</code></pre></div></td></tr></table></div></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>kill -USR2 8
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">WARNING</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">191543</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">Reexecuting</span><span class="w"> </span><span class="n">Master</span><span class="w"> </span><span class="n">process</span>
<span class="o">[</span><span class="n">NOTICE</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">191543</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">haproxy</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="mf">2.2.9</span><span class="o">-</span><span class="n">a947cc2</span>
<span class="o">[</span><span class="n">NOTICE</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">191543</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="k">path</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">executable</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="n">sbin</span><span class="o">/</span><span class="n">haproxy</span>
<span class="o">[</span><span class="n">ALERT</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">191543</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">parsing</span><span class="w"> </span><span class="o">[</span><span class="n">/etc/haproxy/haproxy.cfg:47</span><span class="o">]</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="s1">&#39;bind *:8084&#39;</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="s1">&#39;proto&#39;</span><span class="w"> </span><span class="err">:</span><span class="w">  </span><span class="k">unknown</span><span class="w"> </span><span class="n">MUX</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="s1">&#39;h2,http/1.1&#39;</span>
<span class="o">[</span><span class="n">ALERT</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">191543</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">Error</span><span class="p">(</span><span class="n">s</span><span class="p">)</span><span class="w"> </span><span class="k">found</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">haproxy</span><span class="o">/</span><span class="n">haproxy</span><span class="p">.</span><span class="n">cfg</span>
<span class="o">[</span><span class="n">ALERT</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">191543</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">Fatal</span><span class="w"> </span><span class="n">errors</span><span class="w"> </span><span class="k">found</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">configuration</span><span class="p">.</span>
<span class="o">[</span><span class="n">WARNING</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">191543</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">Reexecuting</span><span class="w"> </span><span class="n">Master</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">waitpid</span><span class="w"> </span><span class="n">mode</span>
<span class="o">[</span><span class="n">WARNING</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">191543</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">Reexecuting</span><span class="w"> </span><span class="n">Master</span><span class="w"> </span><span class="n">process</span>
</code></pre></div></td></tr></table></div>
<p>The documentation also clarifies this in the <code class="highlight">proto</code> section:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="mi">@26</span><span class="n">b317c91a20</span><span class="w"> </span><span class="o">/</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="n">haproxy</span><span class="w"> </span><span class="o">-</span><span class="n">vv</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="n">proto</span><span class="w"> </span><span class="o">-</span><span class="n">A5</span>
<span class="n">Available</span><span class="w"> </span><span class="n">multiplexer</span><span class="w"> </span><span class="n">protocols</span><span class="w"> </span><span class="o">:</span>
<span class="p">(</span><span class="n">protocols</span><span class="w"> </span><span class="n">marked</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="o">&lt;</span><span class="k">default</span><span class="o">&gt;</span><span class="w"> </span><span class="n">cannot</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">specified</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="err">&#39;</span><span class="n">proto</span><span class="err">&#39;</span><span class="w"> </span><span class="n">keyword</span><span class="p">)</span>
<span class="w">            </span><span class="nl">fcgi</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="n">HTTP</span><span class="w">       </span><span class="n">side</span><span class="o">=</span><span class="n">BE</span><span class="w">        </span><span class="n">mux</span><span class="o">=</span><span class="n">FCGI</span>
<span class="w">       </span><span class="o">&lt;</span><span class="k">default</span><span class="o">&gt;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="n">HTTP</span><span class="w">       </span><span class="n">side</span><span class="o">=</span><span class="n">FE</span><span class="o">|</span><span class="n">BE</span><span class="w">     </span><span class="n">mux</span><span class="o">=</span><span class="n">H1</span>
<span class="w">              </span><span class="nl">h2</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="n">HTTP</span><span class="w">       </span><span class="n">side</span><span class="o">=</span><span class="n">FE</span><span class="o">|</span><span class="n">BE</span><span class="w">     </span><span class="n">mux</span><span class="o">=</span><span class="n">H2</span>
<span class="w">       </span><span class="o">&lt;</span><span class="k">default</span><span class="o">&gt;</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="n">mode</span><span class="o">=</span><span class="n">TCP</span><span class="w">        </span><span class="n">side</span><span class="o">=</span><span class="n">FE</span><span class="o">|</span><span class="n">BE</span><span class="w">     </span><span class="n">mux</span><span class="o">=</span><span class="n">PASS</span>
</code></pre></div></td></tr></table></div></p>
<h5 id="forcing-only-http2">Forcing only HTTP/2</h5>
<p>Whereas the following works but will only allow HTTP/2:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code>frontend fe_h2c
    mode http
    bind *:8084 proto h2
    default_backend be_h2c

backend be_h2c
    mode http
    server server1 10.88.0.123:8081 proto h2
</code></pre></div></td></tr></table></div></p>
<p>But a connection upgrade is not possible as HTTP/1.1 is disabled:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">kind</span><span class="w"> </span><span class="nx">haproxy</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">curl</span><span class="w"> </span><span class="nx">http</span><span class="p">:</span><span class="c1">//localhost:8084 -v</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Rebuilt</span><span class="w"> </span><span class="nx">URL</span><span class="w"> </span><span class="nx">to</span><span class="p">:</span><span class="w"> </span><span class="nx">http</span><span class="p">:</span><span class="c1">//localhost:8084/</span>
<span class="o">*</span><span class="w">   </span><span class="nx">Trying</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="o">...</span>
<span class="o">*</span><span class="w"> </span><span class="nx">TCP_NODELAY</span><span class="w"> </span><span class="nx">set</span>
<span class="o">*</span><span class="w"> </span><span class="nx">connect</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="mi">8084</span><span class="w"> </span><span class="nx">failed</span><span class="p">:</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="nx">refused</span>
<span class="o">*</span><span class="w">   </span><span class="nx">Trying</span><span class="w"> </span><span class="m m-Double">127.0.0.1</span><span class="o">...</span>
<span class="o">*</span><span class="w"> </span><span class="nx">TCP_NODELAY</span><span class="w"> </span><span class="nx">set</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connected</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">localhost</span><span class="w"> </span><span class="p">(</span><span class="m m-Double">127.0.0.1</span><span class="p">)</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="mi">8084</span><span class="w"> </span><span class="p">(</span><span class="err">#</span><span class="mi">0</span><span class="p">)</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">GET</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="m m-Double">1.1</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">Host</span><span class="p">:</span><span class="w"> </span><span class="nx">localhost</span><span class="p">:</span><span class="mi">8084</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">User</span><span class="o">-</span><span class="nx">Agent</span><span class="p">:</span><span class="w"> </span><span class="nx">curl</span><span class="o">/</span><span class="m m-Double">7.61.1</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">Accept</span><span class="p">:</span><span class="w"> </span><span class="o">*</span><span class="cm">/*</span>
<span class="cm">&gt; </span>
<span class="cm">* Empty reply from server</span>
<span class="cm">* Connection #0 to host localhost left intact</span>
<span class="cm">curl: (52) Empty reply from server</span>

<span class="cm">---</span>

<span class="cm">[root@kind http2-haproxy]# curl --http2 http://localhost:8084 -v</span>
<span class="cm">* Rebuilt URL to: http://localhost:8084/</span>
<span class="cm">*   Trying ::1...</span>
<span class="cm">* TCP_NODELAY set</span>
<span class="cm">* connect to ::1 port 8084 failed: Connection refused</span>
<span class="cm">*   Trying 127.0.0.1...</span>
<span class="cm">* TCP_NODELAY set</span>
<span class="cm">* Connected to localhost (127.0.0.1) port 8084 (#0)</span>
<span class="cm">&gt; GET / HTTP/1.1</span>
<span class="cm">&gt; Host: localhost:8084</span>
<span class="cm">&gt; User-Agent: curl/7.61.1</span>
<span class="cm">&gt; Accept: */</span><span class="o">*</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">Connection</span><span class="p">:</span><span class="w"> </span><span class="nx">Upgrade</span><span class="p">,</span><span class="w"> </span><span class="nx">HTTP2</span><span class="o">-</span><span class="nx">Settings</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">Upgrade</span><span class="p">:</span><span class="w"> </span><span class="nx">h2c</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">HTTP2</span><span class="o">-</span><span class="nx">Settings</span><span class="p">:</span><span class="w"> </span><span class="nx">AAMAAABkAARAAAAAAAIAAAAA</span>
<span class="p">&gt;</span><span class="w"> </span>
<span class="o">*</span><span class="w"> </span><span class="nx">Empty</span><span class="w"> </span><span class="nx">reply</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">server</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="err">#</span><span class="mi">0</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">host</span><span class="w"> </span><span class="nx">localhost</span><span class="w"> </span><span class="nx">left</span><span class="w"> </span><span class="nx">intact</span>
<span class="nx">curl</span><span class="p">:</span><span class="w"> </span><span class="p">(</span><span class="mi">52</span><span class="p">)</span><span class="w"> </span><span class="nx">Empty</span><span class="w"> </span><span class="nx">reply</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">server</span>

<span class="o">---</span>

<span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">kind</span><span class="w"> </span><span class="nx">http2</span><span class="o">-</span><span class="nx">haproxy</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">curl</span><span class="w"> </span><span class="o">--</span><span class="nx">http2</span><span class="o">-</span><span class="nx">prior</span><span class="o">-</span><span class="nx">knowledge</span><span class="w"> </span><span class="nx">http</span><span class="p">:</span><span class="c1">//localhost:8084 -v</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Rebuilt</span><span class="w"> </span><span class="nx">URL</span><span class="w"> </span><span class="nx">to</span><span class="p">:</span><span class="w"> </span><span class="nx">http</span><span class="p">:</span><span class="c1">//localhost:8084/</span>
<span class="o">*</span><span class="w">   </span><span class="nx">Trying</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="o">...</span>
<span class="o">*</span><span class="w"> </span><span class="nx">TCP_NODELAY</span><span class="w"> </span><span class="nx">set</span>
<span class="o">*</span><span class="w"> </span><span class="nx">connect</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="mi">8084</span><span class="w"> </span><span class="nx">failed</span><span class="p">:</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="nx">refused</span>
<span class="o">*</span><span class="w">   </span><span class="nx">Trying</span><span class="w"> </span><span class="m m-Double">127.0.0.1</span><span class="o">...</span>
<span class="o">*</span><span class="w"> </span><span class="nx">TCP_NODELAY</span><span class="w"> </span><span class="nx">set</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connected</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">localhost</span><span class="w"> </span><span class="p">(</span><span class="m m-Double">127.0.0.1</span><span class="p">)</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="mi">8084</span><span class="w"> </span><span class="p">(</span><span class="err">#</span><span class="mi">0</span><span class="p">)</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Using</span><span class="w"> </span><span class="nx">HTTP2</span><span class="p">,</span><span class="w"> </span><span class="nx">server</span><span class="w"> </span><span class="nx">supports</span><span class="w"> </span><span class="nx">multi</span><span class="o">-</span><span class="nx">use</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="nx">changed</span><span class="w"> </span><span class="p">(</span><span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="nx">confirmed</span><span class="p">)</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Copying</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">stream</span><span class="w"> </span><span class="nx">buffer</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="nx">buffer</span><span class="w"> </span><span class="nx">after</span><span class="w"> </span><span class="nx">upgrade</span><span class="p">:</span><span class="w"> </span><span class="nx">len</span><span class="p">=</span><span class="mi">0</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Using</span><span class="w"> </span><span class="nx">Stream</span><span class="w"> </span><span class="nx">ID</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="nx">easy</span><span class="w"> </span><span class="nx">handle</span><span class="w"> </span><span class="mh">0x563681d13480</span><span class="p">)</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">GET</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">Host</span><span class="p">:</span><span class="w"> </span><span class="nx">localhost</span><span class="p">:</span><span class="mi">8084</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">User</span><span class="o">-</span><span class="nx">Agent</span><span class="p">:</span><span class="w"> </span><span class="nx">curl</span><span class="o">/</span><span class="m m-Double">7.61.1</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">Accept</span><span class="p">:</span><span class="w"> </span><span class="o">*/*</span>
<span class="p">&gt;</span><span class="w"> </span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="nx">changed</span><span class="w"> </span><span class="p">(</span><span class="nx">MAX_CONCURRENT_STREAMS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">100</span><span class="p">)!</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="nx">Mon</span><span class="p">,</span><span class="w"> </span><span class="mi">08</span><span class="w"> </span><span class="nx">Mar</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="mi">19</span><span class="p">:</span><span class="mi">17</span><span class="p">:</span><span class="mi">15</span><span class="w"> </span><span class="nx">GMT</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">server</span><span class="p">:</span><span class="w"> </span><span class="nx">Apache</span><span class="o">/</span><span class="m m-Double">2.4.46</span><span class="w"> </span><span class="p">(</span><span class="nx">Fedora</span><span class="p">)</span><span class="w"> </span><span class="nx">OpenSSL</span><span class="o">/</span><span class="m m-Double">1.1.1</span><span class="nx">j</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">last</span><span class="o">-</span><span class="nx">modified</span><span class="p">:</span><span class="w"> </span><span class="nx">Mon</span><span class="p">,</span><span class="w"> </span><span class="mi">08</span><span class="w"> </span><span class="nx">Mar</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="mi">18</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">18</span><span class="w"> </span><span class="nx">GMT</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">etag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;16-5bd0aae785e80&quot;</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">accept</span><span class="o">-</span><span class="nx">ranges</span><span class="p">:</span><span class="w"> </span><span class="nx">bytes</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">content</span><span class="o">-</span><span class="nx">length</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">content</span><span class="o">-</span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">text</span><span class="o">/</span><span class="nx">html</span><span class="p">;</span><span class="w"> </span><span class="nx">charset</span><span class="p">=</span><span class="nx">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="p">&lt;</span><span class="w"> </span>
<span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="nx">insecure</span><span class="w"> </span><span class="p">(</span><span class="nx">h2c</span><span class="p">)</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="err">#</span><span class="mi">0</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">host</span><span class="w"> </span><span class="nx">localhost</span><span class="w"> </span><span class="nx">left</span><span class="w"> </span><span class="nx">intact</span>
</code></pre></div></td></tr></table></div></p>
<h5 id="permitting-either-http11-or-http2-on-the-frontend-no-upgrade">Permitting either HTTP/1.1 or HTTP/2 on the frontend, no upgrade</h5>
<p>On the other hand, the following works for HTTP/1.1 and HTTP/2, but not for upgrades from 1.1 to HTTP/2 via upgrade h2c:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code>frontend fe_h2c 
    mode http 
    bind *:8084 # proto h2
    default_backend be_h2c 

backend be_h2c 
    mode http 
    server server1 10.88.0.123:8081 proto h2 
</code></pre></div></td></tr></table></div></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>kill -USR2 8
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">WARNING</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">192956</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">Reexecuting</span><span class="w"> </span><span class="n">Master</span><span class="w"> </span><span class="n">process</span>
<span class="o">[</span><span class="n">WARNING</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">192956</span><span class="w"> </span><span class="p">(</span><span class="mi">138</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">Stopping</span><span class="w"> </span><span class="n">frontend</span><span class="w"> </span><span class="k">GLOBAL</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">ms</span><span class="p">.</span>
<span class="o">[</span><span class="n">WARNING</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">192956</span><span class="w"> </span><span class="p">(</span><span class="mi">138</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">Stopping</span><span class="w"> </span><span class="n">frontend</span><span class="w"> </span><span class="n">fe_http1</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">ms</span><span class="p">.</span>
<span class="o">[</span><span class="n">WARNING</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">192956</span><span class="w"> </span><span class="p">(</span><span class="mi">138</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">Stopping</span><span class="w"> </span><span class="n">backend</span><span class="w"> </span><span class="n">be_http1</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">ms</span><span class="p">.</span>
<span class="o">[</span><span class="n">WARNING</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">192956</span><span class="w"> </span><span class="p">(</span><span class="mi">138</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">Stopping</span><span class="w"> </span><span class="n">frontend</span><span class="w"> </span><span class="n">fe_h2c</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">ms</span><span class="p">.</span>
<span class="o">[</span><span class="n">WARNING</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">192956</span><span class="w"> </span><span class="p">(</span><span class="mi">138</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">Stopping</span><span class="w"> </span><span class="n">backend</span><span class="w"> </span><span class="n">be_h2c</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">ms</span><span class="p">.</span>
<span class="o">[</span><span class="n">WARNING</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">192956</span><span class="w"> </span><span class="p">(</span><span class="mi">138</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">Stopping</span><span class="w"> </span><span class="n">frontend</span><span class="w"> </span><span class="n">fe_h2</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">ms</span><span class="p">.</span>
<span class="o">[</span><span class="n">WARNING</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">192956</span><span class="w"> </span><span class="p">(</span><span class="mi">138</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">Stopping</span><span class="w"> </span><span class="n">backend</span><span class="w"> </span><span class="n">be_h2</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">ms</span><span class="p">.</span>
<span class="o">[</span><span class="n">NOTICE</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">192956</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="k">New</span><span class="w"> </span><span class="n">worker</span><span class="w"> </span><span class="n">#1</span><span class="w"> </span><span class="p">(</span><span class="mi">143</span><span class="p">)</span><span class="w"> </span><span class="n">forked</span>
<span class="o">[</span><span class="n">WARNING</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">192956</span><span class="w"> </span><span class="p">(</span><span class="mi">138</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">Proxy</span><span class="w"> </span><span class="k">GLOBAL</span><span class="w"> </span><span class="n">stopped</span><span class="w"> </span><span class="p">(</span><span class="n">cumulated</span><span class="w"> </span><span class="nl">conns</span><span class="p">:</span><span class="w"> </span><span class="nl">FE</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nl">BE</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">).</span>
<span class="o">[</span><span class="n">WARNING</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">192956</span><span class="w"> </span><span class="p">(</span><span class="mi">138</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">Proxy</span><span class="w"> </span><span class="n">fe_http1</span><span class="w"> </span><span class="n">stopped</span><span class="w"> </span><span class="p">(</span><span class="n">cumulated</span><span class="w"> </span><span class="nl">conns</span><span class="p">:</span><span class="w"> </span><span class="nl">FE</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nl">BE</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">).</span>
<span class="o">[</span><span class="n">WARNING</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">192956</span><span class="w"> </span><span class="p">(</span><span class="mi">138</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">Proxy</span><span class="w"> </span><span class="n">be_http1</span><span class="w"> </span><span class="n">stopped</span><span class="w"> </span><span class="p">(</span><span class="n">cumulated</span><span class="w"> </span><span class="nl">conns</span><span class="p">:</span><span class="w"> </span><span class="nl">FE</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nl">BE</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">).</span>
<span class="o">[</span><span class="n">WARNING</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">192956</span><span class="w"> </span><span class="p">(</span><span class="mi">138</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">Proxy</span><span class="w"> </span><span class="n">fe_h2c</span><span class="w"> </span><span class="n">stopped</span><span class="w"> </span><span class="p">(</span><span class="n">cumulated</span><span class="w"> </span><span class="nl">conns</span><span class="p">:</span><span class="w"> </span><span class="nl">FE</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nl">BE</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">).</span>
<span class="o">[</span><span class="n">WARNING</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">192956</span><span class="w"> </span><span class="p">(</span><span class="mi">138</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">Proxy</span><span class="w"> </span><span class="n">be_h2c</span><span class="w"> </span><span class="n">stopped</span><span class="w"> </span><span class="p">(</span><span class="n">cumulated</span><span class="w"> </span><span class="nl">conns</span><span class="p">:</span><span class="w"> </span><span class="nl">FE</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nl">BE</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">).</span>
<span class="o">[</span><span class="n">WARNING</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">192956</span><span class="w"> </span><span class="p">(</span><span class="mi">138</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">Proxy</span><span class="w"> </span><span class="n">fe_h2</span><span class="w"> </span><span class="n">stopped</span><span class="w"> </span><span class="p">(</span><span class="n">cumulated</span><span class="w"> </span><span class="nl">conns</span><span class="p">:</span><span class="w"> </span><span class="nl">FE</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nl">BE</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">).</span>
<span class="o">[</span><span class="n">WARNING</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">192956</span><span class="w"> </span><span class="p">(</span><span class="mi">138</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">Proxy</span><span class="w"> </span><span class="n">be_h2</span><span class="w"> </span><span class="n">stopped</span><span class="w"> </span><span class="p">(</span><span class="n">cumulated</span><span class="w"> </span><span class="nl">conns</span><span class="p">:</span><span class="w"> </span><span class="nl">FE</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nl">BE</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">).</span>
<span class="o">[</span><span class="n">WARNING</span><span class="o">]</span><span class="w"> </span><span class="mi">066</span><span class="o">/</span><span class="mi">192956</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="w"> </span><span class="err">:</span><span class="w"> </span><span class="n">Former</span><span class="w"> </span><span class="n">worker</span><span class="w"> </span><span class="n">#1</span><span class="w"> </span><span class="p">(</span><span class="mi">138</span><span class="p">)</span><span class="w"> </span><span class="n">exited</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="p">(</span><span class="k">Exit</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">kind</span><span class="w"> </span><span class="nx">http2</span><span class="o">-</span><span class="nx">haproxy</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">curl</span><span class="w">  </span><span class="nx">http</span><span class="p">:</span><span class="c1">//localhost:8084 -v</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Rebuilt</span><span class="w"> </span><span class="nx">URL</span><span class="w"> </span><span class="nx">to</span><span class="p">:</span><span class="w"> </span><span class="nx">http</span><span class="p">:</span><span class="c1">//localhost:8084/</span>
<span class="o">*</span><span class="w">   </span><span class="nx">Trying</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="o">...</span>
<span class="o">*</span><span class="w"> </span><span class="nx">TCP_NODELAY</span><span class="w"> </span><span class="nx">set</span>
<span class="o">*</span><span class="w"> </span><span class="nx">connect</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="mi">8084</span><span class="w"> </span><span class="nx">failed</span><span class="p">:</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="nx">refused</span>
<span class="o">*</span><span class="w">   </span><span class="nx">Trying</span><span class="w"> </span><span class="m m-Double">127.0.0.1</span><span class="o">...</span>
<span class="o">*</span><span class="w"> </span><span class="nx">TCP_NODELAY</span><span class="w"> </span><span class="nx">set</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connected</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">localhost</span><span class="w"> </span><span class="p">(</span><span class="m m-Double">127.0.0.1</span><span class="p">)</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="mi">8084</span><span class="w"> </span><span class="p">(</span><span class="err">#</span><span class="mi">0</span><span class="p">)</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">GET</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="m m-Double">1.1</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">Host</span><span class="p">:</span><span class="w"> </span><span class="nx">localhost</span><span class="p">:</span><span class="mi">8084</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">User</span><span class="o">-</span><span class="nx">Agent</span><span class="p">:</span><span class="w"> </span><span class="nx">curl</span><span class="o">/</span><span class="m m-Double">7.61.1</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">Accept</span><span class="p">:</span><span class="w"> </span><span class="o">*</span><span class="cm">/*</span>
<span class="cm">&gt; </span>
<span class="cm">&lt; HTTP/1.1 200 </span>
<span class="cm">&lt; date: Mon, 08 Mar 2021 19:28:19 GMT</span>
<span class="cm">&lt; server: Apache/2.4.46 (Fedora) OpenSSL/1.1.1j</span>
<span class="cm">&lt; last-modified: Mon, 08 Mar 2021 18:34:18 GMT</span>
<span class="cm">&lt; etag: &quot;16-5bd0aae785e80&quot;</span>
<span class="cm">&lt; accept-ranges: bytes</span>
<span class="cm">&lt; content-length: 22</span>
<span class="cm">&lt; content-type: text/html; charset=UTF-8</span>
<span class="cm">&lt; </span>
<span class="cm">HTTP/2 insecure (h2c)</span>
<span class="cm">* Connection #0 to host localhost left intact</span>

<span class="cm">---</span>

<span class="cm">[root@kind http2-haproxy]# curl --http2  http://localhost:8084 -v</span>
<span class="cm">* Rebuilt URL to: http://localhost:8084/</span>
<span class="cm">*   Trying ::1...</span>
<span class="cm">* TCP_NODELAY set</span>
<span class="cm">* connect to ::1 port 8084 failed: Connection refused</span>
<span class="cm">*   Trying 127.0.0.1...</span>
<span class="cm">* TCP_NODELAY set</span>
<span class="cm">* Connected to localhost (127.0.0.1) port 8084 (#0)</span>
<span class="cm">&gt; GET / HTTP/1.1</span>
<span class="cm">&gt; Host: localhost:8084</span>
<span class="cm">&gt; User-Agent: curl/7.61.1</span>
<span class="cm">&gt; Accept: */</span><span class="o">*</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">Connection</span><span class="p">:</span><span class="w"> </span><span class="nx">Upgrade</span><span class="p">,</span><span class="w"> </span><span class="nx">HTTP2</span><span class="o">-</span><span class="nx">Settings</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">Upgrade</span><span class="p">:</span><span class="w"> </span><span class="nx">h2c</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">HTTP2</span><span class="o">-</span><span class="nx">Settings</span><span class="p">:</span><span class="w"> </span><span class="nx">AAMAAABkAARAAAAAAAIAAAAA</span>
<span class="p">&gt;</span><span class="w"> </span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="m m-Double">1.1</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="nx">Mon</span><span class="p">,</span><span class="w"> </span><span class="mi">08</span><span class="w"> </span><span class="nx">Mar</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">24</span><span class="w"> </span><span class="nx">GMT</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">server</span><span class="p">:</span><span class="w"> </span><span class="nx">Apache</span><span class="o">/</span><span class="m m-Double">2.4.46</span><span class="w"> </span><span class="p">(</span><span class="nx">Fedora</span><span class="p">)</span><span class="w"> </span><span class="nx">OpenSSL</span><span class="o">/</span><span class="m m-Double">1.1.1</span><span class="nx">j</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">last</span><span class="o">-</span><span class="nx">modified</span><span class="p">:</span><span class="w"> </span><span class="nx">Mon</span><span class="p">,</span><span class="w"> </span><span class="mi">08</span><span class="w"> </span><span class="nx">Mar</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="mi">18</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">18</span><span class="w"> </span><span class="nx">GMT</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">etag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;16-5bd0aae785e80&quot;</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">accept</span><span class="o">-</span><span class="nx">ranges</span><span class="p">:</span><span class="w"> </span><span class="nx">bytes</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">content</span><span class="o">-</span><span class="nx">length</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">content</span><span class="o">-</span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">text</span><span class="o">/</span><span class="nx">html</span><span class="p">;</span><span class="w"> </span><span class="nx">charset</span><span class="p">=</span><span class="nx">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="p">&lt;</span><span class="w"> </span>
<span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="nx">insecure</span><span class="w"> </span><span class="p">(</span><span class="nx">h2c</span><span class="p">)</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="err">#</span><span class="mi">0</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">host</span><span class="w"> </span><span class="nx">localhost</span><span class="w"> </span><span class="nx">left</span><span class="w"> </span><span class="nx">intact</span>

<span class="o">---</span>

<span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">kind</span><span class="w"> </span><span class="nx">http2</span><span class="o">-</span><span class="nx">haproxy</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">curl</span><span class="w"> </span><span class="o">--</span><span class="nx">http2</span><span class="o">-</span><span class="nx">prior</span><span class="o">-</span><span class="nx">knowledge</span><span class="w"> </span><span class="nx">http</span><span class="p">:</span><span class="c1">//localhost:8084 -v</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Rebuilt</span><span class="w"> </span><span class="nx">URL</span><span class="w"> </span><span class="nx">to</span><span class="p">:</span><span class="w"> </span><span class="nx">http</span><span class="p">:</span><span class="c1">//localhost:8084/</span>
<span class="o">*</span><span class="w">   </span><span class="nx">Trying</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="o">...</span>
<span class="o">*</span><span class="w"> </span><span class="nx">TCP_NODELAY</span><span class="w"> </span><span class="nx">set</span>
<span class="o">*</span><span class="w"> </span><span class="nx">connect</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="mi">8084</span><span class="w"> </span><span class="nx">failed</span><span class="p">:</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="nx">refused</span>
<span class="o">*</span><span class="w">   </span><span class="nx">Trying</span><span class="w"> </span><span class="m m-Double">127.0.0.1</span><span class="o">...</span>
<span class="o">*</span><span class="w"> </span><span class="nx">TCP_NODELAY</span><span class="w"> </span><span class="nx">set</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connected</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">localhost</span><span class="w"> </span><span class="p">(</span><span class="m m-Double">127.0.0.1</span><span class="p">)</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="mi">8084</span><span class="w"> </span><span class="p">(</span><span class="err">#</span><span class="mi">0</span><span class="p">)</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Using</span><span class="w"> </span><span class="nx">HTTP2</span><span class="p">,</span><span class="w"> </span><span class="nx">server</span><span class="w"> </span><span class="nx">supports</span><span class="w"> </span><span class="nx">multi</span><span class="o">-</span><span class="nx">use</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="nx">changed</span><span class="w"> </span><span class="p">(</span><span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="nx">confirmed</span><span class="p">)</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Copying</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">stream</span><span class="w"> </span><span class="nx">buffer</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="nx">buffer</span><span class="w"> </span><span class="nx">after</span><span class="w"> </span><span class="nx">upgrade</span><span class="p">:</span><span class="w"> </span><span class="nx">len</span><span class="p">=</span><span class="mi">0</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Using</span><span class="w"> </span><span class="nx">Stream</span><span class="w"> </span><span class="nx">ID</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="nx">easy</span><span class="w"> </span><span class="nx">handle</span><span class="w"> </span><span class="mh">0x55899a161480</span><span class="p">)</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">GET</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">Host</span><span class="p">:</span><span class="w"> </span><span class="nx">localhost</span><span class="p">:</span><span class="mi">8084</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">User</span><span class="o">-</span><span class="nx">Agent</span><span class="p">:</span><span class="w"> </span><span class="nx">curl</span><span class="o">/</span><span class="m m-Double">7.61.1</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">Accept</span><span class="p">:</span><span class="w"> </span><span class="o">*/*</span>
<span class="p">&gt;</span><span class="w"> </span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="nx">changed</span><span class="w"> </span><span class="p">(</span><span class="nx">MAX_CONCURRENT_STREAMS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">100</span><span class="p">)!</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="nx">Mon</span><span class="p">,</span><span class="w"> </span><span class="mi">08</span><span class="w"> </span><span class="nx">Mar</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="mi">19</span><span class="p">:</span><span class="mi">28</span><span class="p">:</span><span class="mi">28</span><span class="w"> </span><span class="nx">GMT</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">server</span><span class="p">:</span><span class="w"> </span><span class="nx">Apache</span><span class="o">/</span><span class="m m-Double">2.4.46</span><span class="w"> </span><span class="p">(</span><span class="nx">Fedora</span><span class="p">)</span><span class="w"> </span><span class="nx">OpenSSL</span><span class="o">/</span><span class="m m-Double">1.1.1</span><span class="nx">j</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">last</span><span class="o">-</span><span class="nx">modified</span><span class="p">:</span><span class="w"> </span><span class="nx">Mon</span><span class="p">,</span><span class="w"> </span><span class="mi">08</span><span class="w"> </span><span class="nx">Mar</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="mi">18</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">18</span><span class="w"> </span><span class="nx">GMT</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">etag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;16-5bd0aae785e80&quot;</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">accept</span><span class="o">-</span><span class="nx">ranges</span><span class="p">:</span><span class="w"> </span><span class="nx">bytes</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">content</span><span class="o">-</span><span class="nx">length</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">content</span><span class="o">-</span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">text</span><span class="o">/</span><span class="nx">html</span><span class="p">;</span><span class="w"> </span><span class="nx">charset</span><span class="p">=</span><span class="nx">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="p">&lt;</span><span class="w"> </span>
<span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="nx">insecure</span><span class="w"> </span><span class="p">(</span><span class="nx">h2c</span><span class="p">)</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="err">#</span><span class="mi">0</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">host</span><span class="w"> </span><span class="nx">localhost</span><span class="w"> </span><span class="nx">left</span><span class="w"> </span><span class="nx">intact</span>
</code></pre></div></td></tr></table></div>
<h4 id="testing-the-haproxy-backend-side">Testing the haproxy backend side</h4>
<p>On the backend side, it is the same. You can either force the backend proto via <code class="highlight">proto h2</code> to be HTTP/2. Or you can use HTTP/1.1. For negotiation of the protocol, you must use ALPN on the backend.</p>
<p>haproxy cannot upgrade an unencrypted backend HTTP/1.1 connection to HTTP/2 --- the Upgrade: h2c statement is not a functionality that haproxy provides.</p>
<p>According to https://discourse.haproxy.org/t/converting-http-2-h2c-without-tls-to-http-1-1/2176/10 , upgrading from HTTP/1.1 to HTTP/2 on the frontend is only possible in haproxy with ALPN.</p>
<p>Also see https://www.haproxy.com/blog/haproxy-1-9-has-arrived/ and https://www.haproxy.com/blog/haproxy-2-0-and-beyond/#end-to-end-http-2</p>
<p>In order to verify this, I installed wireshark inside the haproxy pod, ran a live capture of the backend traffic with:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code> tshark -i eth0 host 10.88.0.123 -O http
</code></pre></div></td></tr></table></div></p>
<p>And then, I ran curl against the frontend.</p>
<h4 id="baseline-http-only-virtual-server">Baseline, HTTP only virtual server</h4>
<p>This is the frontend and backend configuration:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code>frontend fe_http1 
    mode http 
    bind *:8083
    default_backend be_http1 

backend be_http1 
    mode http 
    server server1 10.88.0.123:8080
</code></pre></div></td></tr></table></div></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>curl http://localhost:8083 -v
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">(...)</span>
<span class="n">Hypertext</span><span class="w"> </span><span class="n">Transfer</span><span class="w"> </span><span class="n">Protocol</span>
<span class="w">    </span><span class="n">GET</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">n</span>
<span class="w">        </span><span class="p">[</span><span class="n">Expert</span><span class="w"> </span><span class="n">Info</span><span class="w"> </span><span class="p">(</span><span class="n">Chat</span><span class="o">/</span><span class="n">Sequence</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">GET</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">n</span><span class="p">]</span>
<span class="w">            </span><span class="p">[</span><span class="n">GET</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">n</span><span class="p">]</span>
<span class="w">            </span><span class="p">[</span><span class="n">Severity</span><span class="w"> </span><span class="n">level</span><span class="o">:</span><span class="w"> </span><span class="n">Chat</span><span class="p">]</span>
<span class="w">            </span><span class="p">[</span><span class="n">Group</span><span class="o">:</span><span class="w"> </span><span class="n">Sequence</span><span class="p">]</span>
<span class="w">        </span><span class="n">Request</span><span class="w"> </span><span class="n">Method</span><span class="o">:</span><span class="w"> </span><span class="n">GET</span>
<span class="w">        </span><span class="n">Request</span><span class="w"> </span><span class="n">URI</span><span class="o">:</span><span class="w"> </span><span class="o">/</span>
<span class="w">        </span><span class="n">Request</span><span class="w"> </span><span class="n">Version</span><span class="o">:</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="w">    </span><span class="nl">host</span><span class="p">:</span><span class="w"> </span><span class="n">localhost</span><span class="o">:</span><span class="mi">8083</span><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">n</span>
<span class="w">    </span><span class="n">user</span><span class="o">-</span><span class="n">agent</span><span class="o">:</span><span class="w"> </span><span class="n">curl</span><span class="o">/</span><span class="mf">7.61.1</span><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">n</span>
<span class="w">    </span><span class="nl">accept</span><span class="p">:</span><span class="w"> </span><span class="o">*</span><span class="cm">/*\r\n</span>
<span class="cm">    x-forwarded-for: 10.88.0.1\r\n</span>
<span class="cm">    connection: close\r\n</span>
<span class="cm">    \r\n</span>
<span class="cm">    [Full request URI: http://localhost:8083/]</span>
<span class="cm">    [HTTP request 1/1]</span>
<span class="cm">(...)</span>
<span class="cm">Hypertext Transfer Protocol</span>
<span class="cm">    HTTP/1.1 200 OK\r\n</span>
<span class="cm">        [Expert Info (Chat/Sequence): HTTP/1.1 200 OK\r\n]</span>
<span class="cm">            [HTTP/1.1 200 OK\r\n]</span>
<span class="cm">            [Severity level: Chat]</span>
<span class="cm">            [Group: Sequence]</span>
<span class="cm">        Response Version: HTTP/1.1</span>
<span class="cm">        Status Code: 200</span>
<span class="cm">        [Status Code Description: OK]</span>
<span class="cm">        Response Phrase: OK</span>
<span class="cm">    Date: Tue, 09 Mar 2021 10:17:50 GMT\r\n</span>
<span class="cm">    Server: Apache/2.4.46 (Fedora) OpenSSL/1.1.1j\r\n</span>
<span class="cm">    Last-Modified: Mon, 08 Mar 2021 18:34:18 GMT\r\n</span>
<span class="cm">    ETag: &quot;c-5bd0aae785e80&quot;\r\n</span>
<span class="cm">    Accept-Ranges: bytes\r\n</span>
<span class="cm">    Content-Length: 12\r\n</span>
<span class="cm">        [Content length: 12]</span>
<span class="cm">    Connection: close\r\n</span>
<span class="cm">    Content-Type: text/html; charset=UTF-8\r\n</span>
<span class="cm">    \r\n</span>
<span class="cm">    [HTTP response 1/1]</span>
<span class="cm">    [Time since request: 0.001789907 seconds]</span>
<span class="cm">    [Request in frame: 7]</span>
<span class="cm">    [Request URI: http://localhost:8083/]</span>
<span class="cm">    File Data: 12 bytes</span>
<span class="cm">Line-based text data: text/html (1 lines)</span>
<span class="cm">(...)</span>
</code></pre></div></td></tr></table></div>
<h4 id="baseline-http2-virtual-server-unencrypted">Baseline, HTTP/2 virtual server, unencrypted</h4>
<p>We have 2 scenarios here. Both force clear text HTTP/2 on the backend.</p>
<p>In order to capture traffic, we need to change the tshark command to:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>tshark -i eth0 -d tcp.port==8081,http -O http -O http2 host 10.88.0.123
</code></pre></div></td></tr></table></div></p>
<blockquote>
<p>It's important to tell Wireshark that we expect to see http over port 8081 (<code class="highlight">-d tcp.port==8081,http</code>). This will tell tshark to interpret everything via port 8081 as HTTP(2).</p>
</blockquote>
<h4 id="forcing-http2-on-the-frontend">Forcing HTTP/2 on the frontend</h4>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code>frontend fe_h2c 
    mode http 
    bind *:8084 proto h2 
    default_backend be_h2c 

backend be_h2c 
    mode http 
    server server1 10.88.0.123:8081 proto h2
</code></pre></div></td></tr></table></div>
<p>In this case, no backend connection is initiatied if one runs:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>curl http://localhost:8084 -v
</code></pre></div></td></tr></table></div></p>
<p>Neither with:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>curl --http2 http://localhost:8084 -v
</code></pre></div></td></tr></table></div></p>
<p>However, when one forces http2 from the start with ...
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>curl --http2-prior-knowledge http://localhost:8084 -v
</code></pre></div></td></tr></table></div></p>
<p>... then one can see HTTP/2 on the backend:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">(...)</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="n">Port</span><span class="o">:</span><span class="w"> </span><span class="mi">47652</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="n">Port</span><span class="o">:</span><span class="w"> </span><span class="mi">8081</span><span class="p">,</span><span class="w"> </span><span class="n">Seq</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Ack</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Len</span><span class="o">:</span><span class="w"> </span><span class="mi">45</span>
<span class="n">HyperText</span><span class="w"> </span><span class="n">Transfer</span><span class="w"> </span><span class="n">Protocol</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="nl">Stream</span><span class="p">:</span><span class="w"> </span><span class="n">Magic</span>
<span class="w">        </span><span class="nl">Magic</span><span class="p">:</span><span class="w"> </span><span class="n">PRI</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mf">2.0</span><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">n</span><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">nSM</span><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">n</span><span class="err">\</span><span class="n">r</span><span class="err">\</span><span class="n">n</span>
<span class="w">    </span><span class="nl">Stream</span><span class="p">:</span><span class="w"> </span><span class="n">SETTINGS</span><span class="p">,</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="n">ID</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Length</span><span class="w"> </span><span class="mi">12</span>
<span class="w">        </span><span class="nl">Length</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span>
<span class="w">        </span><span class="nl">Type</span><span class="p">:</span><span class="w"> </span><span class="n">SETTINGS</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="w">        </span><span class="nl">Flags</span><span class="p">:</span><span class="w"> </span><span class="mh">0x00</span>
<span class="w">            </span><span class="mo">0000</span><span class="w"> </span><span class="mf">000.</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Unused</span><span class="o">:</span><span class="w"> </span><span class="mh">0x00</span>
<span class="w">            </span><span class="p">....</span><span class="w"> </span><span class="p">..</span><span class="mf">.0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ACK</span><span class="o">:</span><span class="w"> </span><span class="n">False</span>
<span class="w">        </span><span class="mf">0.</span><span class="p">..</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reserved</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0</span>
<span class="w">        </span><span class="mf">.000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="n">Identifier</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">Settings</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Enable</span><span class="w"> </span><span class="n">PUSH</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span>
<span class="w">            </span><span class="n">Settings</span><span class="w"> </span><span class="n">Identifier</span><span class="o">:</span><span class="w"> </span><span class="n">Enable</span><span class="w"> </span><span class="n">PUSH</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">            </span><span class="n">Enable</span><span class="w"> </span><span class="n">PUSH</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">Settings</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Max</span><span class="w"> </span><span class="n">concurrent</span><span class="w"> </span><span class="n">streams</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">100</span>
<span class="w">            </span><span class="n">Settings</span><span class="w"> </span><span class="n">Identifier</span><span class="o">:</span><span class="w"> </span><span class="n">Max</span><span class="w"> </span><span class="n">concurrent</span><span class="w"> </span><span class="n">streams</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="w">            </span><span class="n">Max</span><span class="w"> </span><span class="n">concurrent</span><span class="w"> </span><span class="n">streams</span><span class="o">:</span><span class="w"> </span><span class="mi">100</span>
<span class="p">(...)</span>
<span class="n">HyperText</span><span class="w"> </span><span class="n">Transfer</span><span class="w"> </span><span class="n">Protocol</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="nl">Stream</span><span class="p">:</span><span class="w"> </span><span class="n">SETTINGS</span><span class="p">,</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="n">ID</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Length</span><span class="w"> </span><span class="mi">6</span>
<span class="w">        </span><span class="nl">Length</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span>
<span class="w">        </span><span class="nl">Type</span><span class="p">:</span><span class="w"> </span><span class="n">SETTINGS</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="w">        </span><span class="nl">Flags</span><span class="p">:</span><span class="w"> </span><span class="mh">0x00</span>
<span class="w">            </span><span class="mo">0000</span><span class="w"> </span><span class="mf">000.</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Unused</span><span class="o">:</span><span class="w"> </span><span class="mh">0x00</span>
<span class="w">            </span><span class="p">....</span><span class="w"> </span><span class="p">..</span><span class="mf">.0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ACK</span><span class="o">:</span><span class="w"> </span><span class="n">False</span>
<span class="w">        </span><span class="mf">0.</span><span class="p">..</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reserved</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0</span>
<span class="w">        </span><span class="mf">.000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="n">Identifier</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="n">Settings</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Max</span><span class="w"> </span><span class="n">concurrent</span><span class="w"> </span><span class="n">streams</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">100</span>
<span class="w">            </span><span class="n">Settings</span><span class="w"> </span><span class="n">Identifier</span><span class="o">:</span><span class="w"> </span><span class="n">Max</span><span class="w"> </span><span class="n">concurrent</span><span class="w"> </span><span class="n">streams</span><span class="w"> </span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="w">            </span><span class="n">Max</span><span class="w"> </span><span class="n">concurrent</span><span class="w"> </span><span class="n">streams</span><span class="o">:</span><span class="w"> </span><span class="mi">100</span>
<span class="w">    </span><span class="nl">Stream</span><span class="p">:</span><span class="w"> </span><span class="n">SETTINGS</span><span class="p">,</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="n">ID</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Length</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="nl">Length</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="nl">Type</span><span class="p">:</span><span class="w"> </span><span class="n">SETTINGS</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="w">        </span><span class="nl">Flags</span><span class="p">:</span><span class="w"> </span><span class="mh">0x01</span><span class="p">,</span><span class="w"> </span><span class="n">ACK</span>
<span class="w">            </span><span class="mo">0000</span><span class="w"> </span><span class="mf">000.</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Unused</span><span class="o">:</span><span class="w"> </span><span class="mh">0x00</span>
<span class="w">            </span><span class="p">....</span><span class="w"> </span><span class="p">..</span><span class="mf">.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ACK</span><span class="o">:</span><span class="w"> </span><span class="n">True</span>
<span class="w">        </span><span class="mf">0.</span><span class="p">..</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reserved</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0</span>
<span class="w">        </span><span class="mf">.000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="n">Identifier</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span>
<span class="w">    </span><span class="nl">Stream</span><span class="p">:</span><span class="w"> </span><span class="n">WINDOW_UPDATE</span><span class="p">,</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="n">ID</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Length</span><span class="w"> </span><span class="mi">4</span>
<span class="w">        </span><span class="nl">Length</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span>
<span class="w">        </span><span class="nl">Type</span><span class="p">:</span><span class="w"> </span><span class="n">WINDOW_UPDATE</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="w">        </span><span class="nl">Flags</span><span class="p">:</span><span class="w"> </span><span class="mh">0x00</span>
<span class="w">            </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Unused</span><span class="o">:</span><span class="w"> </span><span class="mh">0x00</span>
<span class="w">        </span><span class="mf">0.</span><span class="p">..</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reserved</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0</span>
<span class="w">        </span><span class="mf">.000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="n">Identifier</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="mf">0.</span><span class="p">..</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reserved</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0</span>
<span class="w">        </span><span class="mf">.111</span><span class="w"> </span><span class="mi">1111</span><span class="w"> </span><span class="mi">1111</span><span class="w"> </span><span class="mi">1111</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Window</span><span class="w"> </span><span class="n">Size</span><span class="w"> </span><span class="n">Increment</span><span class="o">:</span><span class="w"> </span><span class="mi">2147418112</span>
<span class="p">(...)</span>
<span class="n">HyperText</span><span class="w"> </span><span class="n">Transfer</span><span class="w"> </span><span class="n">Protocol</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="nl">Stream</span><span class="p">:</span><span class="w"> </span><span class="n">SETTINGS</span><span class="p">,</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="n">ID</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Length</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="nl">Length</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="nl">Type</span><span class="p">:</span><span class="w"> </span><span class="n">SETTINGS</span><span class="w"> </span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="w">        </span><span class="nl">Flags</span><span class="p">:</span><span class="w"> </span><span class="mh">0x01</span><span class="p">,</span><span class="w"> </span><span class="n">ACK</span>
<span class="w">            </span><span class="mo">0000</span><span class="w"> </span><span class="mf">000.</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Unused</span><span class="o">:</span><span class="w"> </span><span class="mh">0x00</span>
<span class="w">            </span><span class="p">....</span><span class="w"> </span><span class="p">..</span><span class="mf">.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ACK</span><span class="o">:</span><span class="w"> </span><span class="n">True</span>
<span class="w">        </span><span class="mf">0.</span><span class="p">..</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reserved</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0</span>
<span class="w">        </span><span class="mf">.000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="n">Identifier</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span>
<span class="p">(...)</span>
<span class="n">HyperText</span><span class="w"> </span><span class="n">Transfer</span><span class="w"> </span><span class="n">Protocol</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="nl">Stream</span><span class="p">:</span><span class="w"> </span><span class="n">HEADERS</span><span class="p">,</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="n">ID</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Length</span><span class="w"> </span><span class="mi">64</span><span class="p">,</span><span class="w"> </span><span class="n">GET</span><span class="w"> </span><span class="o">/</span>
<span class="w">        </span><span class="nl">Length</span><span class="p">:</span><span class="w"> </span><span class="mi">64</span>
<span class="w">        </span><span class="nl">Type</span><span class="p">:</span><span class="w"> </span><span class="n">HEADERS</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="nl">Flags</span><span class="p">:</span><span class="w"> </span><span class="mh">0x05</span><span class="p">,</span><span class="w"> </span><span class="n">End</span><span class="w"> </span><span class="n">Headers</span><span class="p">,</span><span class="w"> </span><span class="n">End</span><span class="w"> </span><span class="n">Stream</span>
<span class="w">            </span><span class="mf">00.0</span><span class="w"> </span><span class="p">.</span><span class="mf">.0</span><span class="p">.</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Unused</span><span class="o">:</span><span class="w"> </span><span class="mh">0x00</span>
<span class="w">            </span><span class="p">.</span><span class="mf">.0</span><span class="p">.</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Priority</span><span class="o">:</span><span class="w"> </span><span class="n">False</span>
<span class="w">            </span><span class="p">....</span><span class="w"> </span><span class="mf">0.</span><span class="p">..</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Padded</span><span class="o">:</span><span class="w"> </span><span class="n">False</span>
<span class="w">            </span><span class="p">....</span><span class="w"> </span><span class="mf">.1</span><span class="p">..</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">End</span><span class="w"> </span><span class="n">Headers</span><span class="o">:</span><span class="w"> </span><span class="n">True</span>
<span class="w">            </span><span class="p">....</span><span class="w"> </span><span class="p">..</span><span class="mf">.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">End</span><span class="w"> </span><span class="n">Stream</span><span class="o">:</span><span class="w"> </span><span class="n">True</span>
<span class="w">        </span><span class="mf">0.</span><span class="p">..</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reserved</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0</span>
<span class="w">        </span><span class="mf">.000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0001</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="n">Identifier</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="p">[</span><span class="n">Pad</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span>
<span class="w">        </span><span class="n">Header</span><span class="w"> </span><span class="n">Block</span><span class="w"> </span><span class="n">Fragment</span><span class="o">:</span><span class="w"> </span><span class="mf">8286410e6</span><span class="n">c6f63616c686f73743a38303834847a0b6375726c2f372e36312e3153032a2f</span><span class="err">…</span>
<span class="w">        </span><span class="p">[</span><span class="n">Header</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">161</span><span class="p">]</span>
<span class="w">        </span><span class="p">[</span><span class="n">Header</span><span class="w"> </span><span class="n">Count</span><span class="o">:</span><span class="w"> </span><span class="mi">7</span><span class="p">]</span>
<span class="w">        </span><span class="nl">Header</span><span class="p">:</span><span class="w"> </span><span class="o">:</span><span class="n">method</span><span class="o">:</span><span class="w"> </span><span class="n">GET</span>
<span class="w">            </span><span class="n">Name</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">7</span>
<span class="w">            </span><span class="nl">Name</span><span class="p">:</span><span class="w"> </span><span class="o">:</span><span class="n">method</span>
<span class="w">            </span><span class="n">Value</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span>
<span class="w">            </span><span class="nl">Value</span><span class="p">:</span><span class="w"> </span><span class="n">GET</span>
<span class="w">            </span><span class="o">:</span><span class="n">method</span><span class="o">:</span><span class="w"> </span><span class="n">GET</span>
<span class="w">            </span><span class="p">[</span><span class="n">Unescaped</span><span class="o">:</span><span class="w"> </span><span class="n">GET</span><span class="p">]</span>
<span class="w">            </span><span class="nl">Representation</span><span class="p">:</span><span class="w"> </span><span class="n">Indexed</span><span class="w"> </span><span class="n">Header</span><span class="w"> </span><span class="n">Field</span>
<span class="w">            </span><span class="nl">Index</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>
<span class="w">        </span><span class="nl">Header</span><span class="p">:</span><span class="w"> </span><span class="o">:</span><span class="n">scheme</span><span class="o">:</span><span class="w"> </span><span class="n">http</span>
<span class="w">            </span><span class="n">Name</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">7</span>
<span class="w">            </span><span class="nl">Name</span><span class="p">:</span><span class="w"> </span><span class="o">:</span><span class="n">scheme</span>
<span class="w">            </span><span class="n">Value</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">4</span>
<span class="w">            </span><span class="nl">Value</span><span class="p">:</span><span class="w"> </span><span class="n">http</span>
<span class="w">            </span><span class="o">:</span><span class="n">scheme</span><span class="o">:</span><span class="w"> </span><span class="n">http</span>
<span class="w">            </span><span class="p">[</span><span class="n">Unescaped</span><span class="o">:</span><span class="w"> </span><span class="n">http</span><span class="p">]</span>
<span class="w">            </span><span class="nl">Representation</span><span class="p">:</span><span class="w"> </span><span class="n">Indexed</span><span class="w"> </span><span class="n">Header</span><span class="w"> </span><span class="n">Field</span>
<span class="w">            </span><span class="nl">Index</span><span class="p">:</span><span class="w"> </span><span class="mi">6</span>
<span class="w">        </span><span class="nl">Header</span><span class="p">:</span><span class="w"> </span><span class="o">:</span><span class="n">authority</span><span class="o">:</span><span class="w"> </span><span class="n">localhost</span><span class="o">:</span><span class="mi">8084</span>
<span class="w">            </span><span class="n">Name</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">10</span>
<span class="w">            </span><span class="nl">Name</span><span class="p">:</span><span class="w"> </span><span class="o">:</span><span class="n">authority</span>
<span class="w">            </span><span class="n">Value</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">14</span>
<span class="w">            </span><span class="nl">Value</span><span class="p">:</span><span class="w"> </span><span class="n">localhost</span><span class="o">:</span><span class="mi">8084</span>
<span class="w">            </span><span class="o">:</span><span class="n">authority</span><span class="o">:</span><span class="w"> </span><span class="n">localhost</span><span class="o">:</span><span class="mi">8084</span>
<span class="w">            </span><span class="p">[</span><span class="n">Unescaped</span><span class="o">:</span><span class="w"> </span><span class="n">localhost</span><span class="o">:</span><span class="mi">8084</span><span class="p">]</span>
<span class="w">            </span><span class="nl">Representation</span><span class="p">:</span><span class="w"> </span><span class="n">Literal</span><span class="w"> </span><span class="n">Header</span><span class="w"> </span><span class="n">Field</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">Incremental</span><span class="w"> </span><span class="n">Indexing</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Indexed</span><span class="w"> </span><span class="n">Name</span>
<span class="w">            </span><span class="nl">Index</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="nl">Header</span><span class="p">:</span><span class="w"> </span><span class="o">:</span><span class="n">path</span><span class="o">:</span><span class="w"> </span><span class="o">/</span>
<span class="w">            </span><span class="n">Name</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">5</span>
<span class="w">            </span><span class="nl">Name</span><span class="p">:</span><span class="w"> </span><span class="o">:</span><span class="n">path</span>
<span class="w">            </span><span class="n">Value</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">            </span><span class="nl">Value</span><span class="p">:</span><span class="w"> </span><span class="o">/</span>
<span class="w">            </span><span class="o">:</span><span class="n">path</span><span class="o">:</span><span class="w"> </span><span class="o">/</span>
<span class="w">            </span><span class="p">[</span><span class="n">Unescaped</span><span class="o">:</span><span class="w"> </span><span class="o">/</span><span class="p">]</span>
<span class="w">            </span><span class="nl">Representation</span><span class="p">:</span><span class="w"> </span><span class="n">Indexed</span><span class="w"> </span><span class="n">Header</span><span class="w"> </span><span class="n">Field</span>
<span class="w">            </span><span class="nl">Index</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span>
<span class="w">        </span><span class="nl">Header</span><span class="p">:</span><span class="w"> </span><span class="n">user</span><span class="o">-</span><span class="n">agent</span><span class="o">:</span><span class="w"> </span><span class="n">curl</span><span class="o">/</span><span class="mf">7.61.1</span>
<span class="w">            </span><span class="n">Name</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">10</span>
<span class="w">            </span><span class="nl">Name</span><span class="p">:</span><span class="w"> </span><span class="n">user</span><span class="o">-</span><span class="n">agent</span>
<span class="w">            </span><span class="n">Value</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">11</span>
<span class="w">            </span><span class="nl">Value</span><span class="p">:</span><span class="w"> </span><span class="n">curl</span><span class="o">/</span><span class="mf">7.61.1</span>
<span class="w">            </span><span class="n">user</span><span class="o">-</span><span class="n">agent</span><span class="o">:</span><span class="w"> </span><span class="n">curl</span><span class="o">/</span><span class="mf">7.61.1</span>
<span class="w">            </span><span class="p">[</span><span class="n">Unescaped</span><span class="o">:</span><span class="w"> </span><span class="n">curl</span><span class="o">/</span><span class="mf">7.61.1</span><span class="p">]</span>
<span class="w">            </span><span class="nl">Representation</span><span class="p">:</span><span class="w"> </span><span class="n">Literal</span><span class="w"> </span><span class="n">Header</span><span class="w"> </span><span class="n">Field</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">Incremental</span><span class="w"> </span><span class="n">Indexing</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Indexed</span><span class="w"> </span><span class="n">Name</span>
<span class="w">            </span><span class="nl">Index</span><span class="p">:</span><span class="w"> </span><span class="mi">58</span>
<span class="w">        </span><span class="nl">Header</span><span class="p">:</span><span class="w"> </span><span class="n">accept</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="cm">/*</span>
<span class="cm">            Name Length: 6</span>
<span class="cm">            Name: accept</span>
<span class="cm">            Value Length: 3</span>
<span class="cm">            Value: */</span><span class="o">*</span>
<span class="w">            </span><span class="nl">accept</span><span class="p">:</span><span class="w"> </span><span class="o">*</span><span class="cm">/*</span>
<span class="cm">            [Unescaped: */</span><span class="o">*</span><span class="p">]</span>
<span class="w">            </span><span class="nl">Representation</span><span class="p">:</span><span class="w"> </span><span class="n">Literal</span><span class="w"> </span><span class="n">Header</span><span class="w"> </span><span class="n">Field</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">Incremental</span><span class="w"> </span><span class="n">Indexing</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Indexed</span><span class="w"> </span><span class="n">Name</span>
<span class="w">            </span><span class="nl">Index</span><span class="p">:</span><span class="w"> </span><span class="mi">19</span>
<span class="w">        </span><span class="nl">Header</span><span class="p">:</span><span class="w"> </span><span class="n">x</span><span class="o">-</span><span class="n">forwarded</span><span class="o">-</span><span class="k">for</span><span class="o">:</span><span class="w"> </span><span class="mf">10.88.0.1</span>
<span class="w">            </span><span class="n">Name</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">15</span>
<span class="w">            </span><span class="nl">Name</span><span class="p">:</span><span class="w"> </span><span class="n">x</span><span class="o">-</span><span class="n">forwarded</span><span class="o">-</span><span class="k">for</span>
<span class="w">            </span><span class="n">Value</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">9</span>
<span class="w">            </span><span class="nl">Value</span><span class="p">:</span><span class="w"> </span><span class="mf">10.88.0.1</span>
<span class="w">            </span><span class="p">[</span><span class="n">Unescaped</span><span class="o">:</span><span class="w"> </span><span class="mf">10.88.0.1</span><span class="p">]</span>
<span class="w">            </span><span class="nl">Representation</span><span class="p">:</span><span class="w"> </span><span class="n">Literal</span><span class="w"> </span><span class="n">Header</span><span class="w"> </span><span class="n">Field</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">Indexing</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">New</span><span class="w"> </span><span class="n">Name</span>
<span class="p">(...)</span>
<span class="n">HyperText</span><span class="w"> </span><span class="n">Transfer</span><span class="w"> </span><span class="n">Protocol</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="nl">Stream</span><span class="p">:</span><span class="w"> </span><span class="n">HEADERS</span><span class="p">,</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="n">ID</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Length</span><span class="w"> </span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="n">OK</span>
<span class="w">        </span><span class="nl">Length</span><span class="p">:</span><span class="w"> </span><span class="mi">128</span>
<span class="w">        </span><span class="nl">Type</span><span class="p">:</span><span class="w"> </span><span class="n">HEADERS</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="nl">Flags</span><span class="p">:</span><span class="w"> </span><span class="mh">0x04</span><span class="p">,</span><span class="w"> </span><span class="n">End</span><span class="w"> </span><span class="n">Headers</span>
<span class="w">            </span><span class="mf">00.0</span><span class="w"> </span><span class="p">.</span><span class="mf">.0</span><span class="p">.</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Unused</span><span class="o">:</span><span class="w"> </span><span class="mh">0x00</span>
<span class="w">            </span><span class="p">.</span><span class="mf">.0</span><span class="p">.</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Priority</span><span class="o">:</span><span class="w"> </span><span class="n">False</span>
<span class="w">            </span><span class="p">....</span><span class="w"> </span><span class="mf">0.</span><span class="p">..</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Padded</span><span class="o">:</span><span class="w"> </span><span class="n">False</span>
<span class="w">            </span><span class="p">....</span><span class="w"> </span><span class="mf">.1</span><span class="p">..</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">End</span><span class="w"> </span><span class="n">Headers</span><span class="o">:</span><span class="w"> </span><span class="n">True</span>
<span class="w">            </span><span class="p">....</span><span class="w"> </span><span class="p">..</span><span class="mf">.0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">End</span><span class="w"> </span><span class="n">Stream</span><span class="o">:</span><span class="w"> </span><span class="n">False</span>
<span class="w">        </span><span class="mf">0.</span><span class="p">..</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reserved</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0</span>
<span class="w">        </span><span class="mf">.000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0001</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="n">Identifier</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="p">[</span><span class="n">Pad</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span>
<span class="w">        </span><span class="n">Header</span><span class="w"> </span><span class="n">Block</span><span class="w"> </span><span class="n">Fragment</span><span class="o">:</span><span class="w"> </span><span class="mi">886196</span><span class="n">df697e9403ea681d8a08020a810dc035700253168dff769d86b19272b025da5da7</span><span class="err">…</span>
<span class="w">        </span><span class="p">[</span><span class="n">Header</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">284</span><span class="p">]</span>
<span class="w">        </span><span class="p">[</span><span class="n">Header</span><span class="w"> </span><span class="n">Count</span><span class="o">:</span><span class="w"> </span><span class="mi">8</span><span class="p">]</span>
<span class="w">        </span><span class="nl">Header</span><span class="p">:</span><span class="w"> </span><span class="o">:</span><span class="n">status</span><span class="o">:</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="n">OK</span>
<span class="w">            </span><span class="n">Name</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">7</span>
<span class="w">            </span><span class="nl">Name</span><span class="p">:</span><span class="w"> </span><span class="o">:</span><span class="n">status</span>
<span class="w">            </span><span class="n">Value</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span>
<span class="w">            </span><span class="nl">Value</span><span class="p">:</span><span class="w"> </span><span class="mi">200</span>
<span class="w">            </span><span class="o">:</span><span class="n">status</span><span class="o">:</span><span class="w"> </span><span class="mi">200</span>
<span class="w">            </span><span class="p">[</span><span class="n">Unescaped</span><span class="o">:</span><span class="w"> </span><span class="mi">200</span><span class="p">]</span>
<span class="w">            </span><span class="nl">Representation</span><span class="p">:</span><span class="w"> </span><span class="n">Indexed</span><span class="w"> </span><span class="n">Header</span><span class="w"> </span><span class="n">Field</span>
<span class="w">            </span><span class="nl">Index</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">        </span><span class="nl">Header</span><span class="p">:</span><span class="w"> </span><span class="n">date</span><span class="o">:</span><span class="w"> </span><span class="n">Tue</span><span class="p">,</span><span class="w"> </span><span class="mi">09</span><span class="w"> </span><span class="n">Mar</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="mi">11</span><span class="o">:</span><span class="mo">04</span><span class="o">:</span><span class="mo">02</span><span class="w"> </span><span class="n">GMT</span>
<span class="w">            </span><span class="n">Name</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">4</span>
<span class="w">            </span><span class="nl">Name</span><span class="p">:</span><span class="w"> </span><span class="n">date</span>
<span class="w">            </span><span class="n">Value</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">29</span>
<span class="w">            </span><span class="nl">Value</span><span class="p">:</span><span class="w"> </span><span class="n">Tue</span><span class="p">,</span><span class="w"> </span><span class="mi">09</span><span class="w"> </span><span class="n">Mar</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="mi">11</span><span class="o">:</span><span class="mo">04</span><span class="o">:</span><span class="mo">02</span><span class="w"> </span><span class="n">GMT</span>
<span class="w">            </span><span class="nl">date</span><span class="p">:</span><span class="w"> </span><span class="n">Tue</span><span class="p">,</span><span class="w"> </span><span class="mi">09</span><span class="w"> </span><span class="n">Mar</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="mi">11</span><span class="o">:</span><span class="mo">04</span><span class="o">:</span><span class="mo">02</span><span class="w"> </span><span class="n">GMT</span>
<span class="w">            </span><span class="p">[</span><span class="n">Unescaped</span><span class="o">:</span><span class="w"> </span><span class="n">Tue</span><span class="p">,</span><span class="w"> </span><span class="mi">09</span><span class="w"> </span><span class="n">Mar</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="mi">11</span><span class="o">:</span><span class="mo">04</span><span class="o">:</span><span class="mo">02</span><span class="w"> </span><span class="n">GMT</span><span class="p">]</span>
<span class="w">            </span><span class="nl">Representation</span><span class="p">:</span><span class="w"> </span><span class="n">Literal</span><span class="w"> </span><span class="n">Header</span><span class="w"> </span><span class="n">Field</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">Incremental</span><span class="w"> </span><span class="n">Indexing</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Indexed</span><span class="w"> </span><span class="n">Name</span>
<span class="w">            </span><span class="nl">Index</span><span class="p">:</span><span class="w"> </span><span class="mi">33</span>
<span class="w">        </span><span class="nl">Header</span><span class="p">:</span><span class="w"> </span><span class="n">server</span><span class="o">:</span><span class="w"> </span><span class="n">Apache</span><span class="o">/</span><span class="mf">2.4.46</span><span class="w"> </span><span class="p">(</span><span class="n">Fedora</span><span class="p">)</span><span class="w"> </span><span class="n">OpenSSL</span><span class="o">/</span><span class="mf">1.1.1</span><span class="n">j</span>
<span class="w">            </span><span class="n">Name</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">6</span>
<span class="w">            </span><span class="nl">Name</span><span class="p">:</span><span class="w"> </span><span class="n">server</span>
<span class="w">            </span><span class="n">Value</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">37</span>
<span class="w">            </span><span class="nl">Value</span><span class="p">:</span><span class="w"> </span><span class="n">Apache</span><span class="o">/</span><span class="mf">2.4.46</span><span class="w"> </span><span class="p">(</span><span class="n">Fedora</span><span class="p">)</span><span class="w"> </span><span class="n">OpenSSL</span><span class="o">/</span><span class="mf">1.1.1</span><span class="n">j</span>
<span class="w">            </span><span class="nl">server</span><span class="p">:</span><span class="w"> </span><span class="n">Apache</span><span class="o">/</span><span class="mf">2.4.46</span><span class="w"> </span><span class="p">(</span><span class="n">Fedora</span><span class="p">)</span><span class="w"> </span><span class="n">OpenSSL</span><span class="o">/</span><span class="mf">1.1.1</span><span class="n">j</span>
<span class="w">            </span><span class="p">[</span><span class="n">Unescaped</span><span class="o">:</span><span class="w"> </span><span class="n">Apache</span><span class="o">/</span><span class="mf">2.4.46</span><span class="w"> </span><span class="p">(</span><span class="n">Fedora</span><span class="p">)</span><span class="w"> </span><span class="n">OpenSSL</span><span class="o">/</span><span class="mf">1.1.1</span><span class="n">j</span><span class="p">]</span>
<span class="w">            </span><span class="nl">Representation</span><span class="p">:</span><span class="w"> </span><span class="n">Literal</span><span class="w"> </span><span class="n">Header</span><span class="w"> </span><span class="n">Field</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">Incremental</span><span class="w"> </span><span class="n">Indexing</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Indexed</span><span class="w"> </span><span class="n">Name</span>
<span class="w">            </span><span class="nl">Index</span><span class="p">:</span><span class="w"> </span><span class="mi">54</span>
<span class="w">        </span><span class="nl">Header</span><span class="p">:</span><span class="w"> </span><span class="n">last</span><span class="o">-</span><span class="n">modified</span><span class="o">:</span><span class="w"> </span><span class="n">Mon</span><span class="p">,</span><span class="w"> </span><span class="mi">08</span><span class="w"> </span><span class="n">Mar</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="mi">18</span><span class="o">:</span><span class="mi">34</span><span class="o">:</span><span class="mi">18</span><span class="w"> </span><span class="n">GMT</span>
<span class="w">            </span><span class="n">Name</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">13</span>
<span class="w">            </span><span class="nl">Name</span><span class="p">:</span><span class="w"> </span><span class="n">last</span><span class="o">-</span><span class="n">modified</span>
<span class="w">            </span><span class="n">Value</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">29</span>
<span class="w">            </span><span class="nl">Value</span><span class="p">:</span><span class="w"> </span><span class="n">Mon</span><span class="p">,</span><span class="w"> </span><span class="mi">08</span><span class="w"> </span><span class="n">Mar</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="mi">18</span><span class="o">:</span><span class="mi">34</span><span class="o">:</span><span class="mi">18</span><span class="w"> </span><span class="n">GMT</span>
<span class="w">            </span><span class="n">last</span><span class="o">-</span><span class="n">modified</span><span class="o">:</span><span class="w"> </span><span class="n">Mon</span><span class="p">,</span><span class="w"> </span><span class="mi">08</span><span class="w"> </span><span class="n">Mar</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="mi">18</span><span class="o">:</span><span class="mi">34</span><span class="o">:</span><span class="mi">18</span><span class="w"> </span><span class="n">GMT</span>
<span class="w">            </span><span class="p">[</span><span class="n">Unescaped</span><span class="o">:</span><span class="w"> </span><span class="n">Mon</span><span class="p">,</span><span class="w"> </span><span class="mi">08</span><span class="w"> </span><span class="n">Mar</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="mi">18</span><span class="o">:</span><span class="mi">34</span><span class="o">:</span><span class="mi">18</span><span class="w"> </span><span class="n">GMT</span><span class="p">]</span>
<span class="w">            </span><span class="nl">Representation</span><span class="p">:</span><span class="w"> </span><span class="n">Literal</span><span class="w"> </span><span class="n">Header</span><span class="w"> </span><span class="n">Field</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">Incremental</span><span class="w"> </span><span class="n">Indexing</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Indexed</span><span class="w"> </span><span class="n">Name</span>
<span class="w">            </span><span class="nl">Index</span><span class="p">:</span><span class="w"> </span><span class="mi">44</span>
<span class="w">        </span><span class="nl">Header</span><span class="p">:</span><span class="w"> </span><span class="n">etag</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;16-5bd0aae785e80&quot;</span>
<span class="w">            </span><span class="n">Name</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">4</span>
<span class="w">            </span><span class="nl">Name</span><span class="p">:</span><span class="w"> </span><span class="n">etag</span>
<span class="w">            </span><span class="n">Value</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">18</span>
<span class="w">            </span><span class="nl">Value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;16-5bd0aae785e80&quot;</span>
<span class="w">            </span><span class="nl">etag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;16-5bd0aae785e80&quot;</span>
<span class="w">            </span><span class="p">[</span><span class="n">Unescaped</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;16-5bd0aae785e80&quot;</span><span class="p">]</span>
<span class="w">            </span><span class="nl">Representation</span><span class="p">:</span><span class="w"> </span><span class="n">Literal</span><span class="w"> </span><span class="n">Header</span><span class="w"> </span><span class="n">Field</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">Indexing</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Indexed</span><span class="w"> </span><span class="n">Name</span>
<span class="w">            </span><span class="nl">Index</span><span class="p">:</span><span class="w"> </span><span class="mi">34</span>
<span class="w">        </span><span class="nl">Header</span><span class="p">:</span><span class="w"> </span><span class="n">accept</span><span class="o">-</span><span class="n">ranges</span><span class="o">:</span><span class="w"> </span><span class="n">bytes</span>
<span class="w">            </span><span class="n">Name</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">13</span>
<span class="w">            </span><span class="nl">Name</span><span class="p">:</span><span class="w"> </span><span class="n">accept</span><span class="o">-</span><span class="n">ranges</span>
<span class="w">            </span><span class="n">Value</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">5</span>
<span class="w">            </span><span class="nl">Value</span><span class="p">:</span><span class="w"> </span><span class="n">bytes</span>
<span class="w">            </span><span class="n">accept</span><span class="o">-</span><span class="n">ranges</span><span class="o">:</span><span class="w"> </span><span class="n">bytes</span>
<span class="w">            </span><span class="p">[</span><span class="n">Unescaped</span><span class="o">:</span><span class="w"> </span><span class="n">bytes</span><span class="p">]</span>
<span class="w">            </span><span class="nl">Representation</span><span class="p">:</span><span class="w"> </span><span class="n">Literal</span><span class="w"> </span><span class="n">Header</span><span class="w"> </span><span class="n">Field</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">Incremental</span><span class="w"> </span><span class="n">Indexing</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Indexed</span><span class="w"> </span><span class="n">Name</span>
<span class="w">            </span><span class="nl">Index</span><span class="p">:</span><span class="w"> </span><span class="mi">18</span>
<span class="w">        </span><span class="nl">Header</span><span class="p">:</span><span class="w"> </span><span class="n">content</span><span class="o">-</span><span class="n">length</span><span class="o">:</span><span class="w"> </span><span class="mi">22</span>
<span class="w">            </span><span class="n">Name</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">14</span>
<span class="w">            </span><span class="nl">Name</span><span class="p">:</span><span class="w"> </span><span class="n">content</span><span class="o">-</span><span class="n">length</span>
<span class="w">            </span><span class="n">Value</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">2</span>
<span class="w">            </span><span class="nl">Value</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span>
<span class="w">            </span><span class="n">content</span><span class="o">-</span><span class="n">length</span><span class="o">:</span><span class="w"> </span><span class="mi">22</span>
<span class="w">            </span><span class="p">[</span><span class="n">Unescaped</span><span class="o">:</span><span class="w"> </span><span class="mi">22</span><span class="p">]</span>
<span class="w">            </span><span class="nl">Representation</span><span class="p">:</span><span class="w"> </span><span class="n">Literal</span><span class="w"> </span><span class="n">Header</span><span class="w"> </span><span class="n">Field</span><span class="w"> </span><span class="n">without</span><span class="w"> </span><span class="n">Indexing</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Indexed</span><span class="w"> </span><span class="n">Name</span>
<span class="w">            </span><span class="nl">Index</span><span class="p">:</span><span class="w"> </span><span class="mi">28</span>
<span class="w">        </span><span class="nl">Header</span><span class="p">:</span><span class="w"> </span><span class="n">content</span><span class="o">-</span><span class="n">type</span><span class="o">:</span><span class="w"> </span><span class="n">text</span><span class="o">/</span><span class="n">html</span><span class="p">;</span><span class="w"> </span><span class="n">charset</span><span class="o">=</span><span class="n">UTF</span><span class="mi">-8</span>
<span class="w">            </span><span class="n">Name</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">12</span>
<span class="w">            </span><span class="nl">Name</span><span class="p">:</span><span class="w"> </span><span class="n">content</span><span class="o">-</span><span class="n">type</span>
<span class="w">            </span><span class="n">Value</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">24</span>
<span class="w">            </span><span class="nl">Value</span><span class="p">:</span><span class="w"> </span><span class="n">text</span><span class="o">/</span><span class="n">html</span><span class="p">;</span><span class="w"> </span><span class="n">charset</span><span class="o">=</span><span class="n">UTF</span><span class="mi">-8</span>
<span class="w">            </span><span class="n">content</span><span class="o">-</span><span class="n">type</span><span class="o">:</span><span class="w"> </span><span class="n">text</span><span class="o">/</span><span class="n">html</span><span class="p">;</span><span class="w"> </span><span class="n">charset</span><span class="o">=</span><span class="n">UTF</span><span class="mi">-8</span>
<span class="w">            </span><span class="p">[</span><span class="n">Unescaped</span><span class="o">:</span><span class="w"> </span><span class="n">text</span><span class="o">/</span><span class="n">html</span><span class="p">;</span><span class="w"> </span><span class="n">charset</span><span class="o">=</span><span class="n">UTF</span><span class="mi">-8</span><span class="p">]</span>
<span class="w">            </span><span class="nl">Representation</span><span class="p">:</span><span class="w"> </span><span class="n">Literal</span><span class="w"> </span><span class="n">Header</span><span class="w"> </span><span class="n">Field</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">Incremental</span><span class="w"> </span><span class="n">Indexing</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Indexed</span><span class="w"> </span><span class="n">Name</span>
<span class="w">            </span><span class="nl">Index</span><span class="p">:</span><span class="w"> </span><span class="mi">31</span>
<span class="w">    </span><span class="nl">Stream</span><span class="p">:</span><span class="w"> </span><span class="n">DATA</span><span class="p">,</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="n">ID</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Length</span><span class="w"> </span><span class="mi">22</span>
<span class="w">        </span><span class="nl">Length</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span>
<span class="w">        </span><span class="nl">Type</span><span class="p">:</span><span class="w"> </span><span class="n">DATA</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="w">        </span><span class="nl">Flags</span><span class="p">:</span><span class="w"> </span><span class="mh">0x01</span><span class="p">,</span><span class="w"> </span><span class="n">End</span><span class="w"> </span><span class="n">Stream</span>
<span class="w">            </span><span class="mo">0000</span><span class="w"> </span><span class="mf">.00</span><span class="p">.</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Unused</span><span class="o">:</span><span class="w"> </span><span class="mh">0x00</span>
<span class="w">            </span><span class="p">....</span><span class="w"> </span><span class="mf">0.</span><span class="p">..</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Padded</span><span class="o">:</span><span class="w"> </span><span class="n">False</span>
<span class="w">            </span><span class="p">....</span><span class="w"> </span><span class="p">..</span><span class="mf">.1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">End</span><span class="w"> </span><span class="n">Stream</span><span class="o">:</span><span class="w"> </span><span class="n">True</span>
<span class="w">        </span><span class="mf">0.</span><span class="p">..</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reserved</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0</span>
<span class="w">        </span><span class="mf">.000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0001</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="n">Identifier</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="p">[</span><span class="n">Pad</span><span class="w"> </span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">]</span>
<span class="w">        </span><span class="nl">Data</span><span class="p">:</span><span class="w"> </span><span class="mf">485454502f3220696e7365637572652028683263290</span><span class="n">a</span>
<span class="w">    </span><span class="n">Line</span><span class="o">-</span><span class="n">based</span><span class="w"> </span><span class="n">text</span><span class="w"> </span><span class="n">data</span><span class="o">:</span><span class="w"> </span><span class="n">text</span><span class="o">/</span><span class="n">html</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="w"> </span><span class="n">lines</span><span class="p">)</span>
<span class="w">        </span><span class="n">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="n">insecure</span><span class="w"> </span><span class="p">(</span><span class="n">h2c</span><span class="p">)</span><span class="err">\</span><span class="n">n</span>
<span class="p">(...)</span>
<span class="n">HyperText</span><span class="w"> </span><span class="n">Transfer</span><span class="w"> </span><span class="n">Protocol</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="nl">Stream</span><span class="p">:</span><span class="w"> </span><span class="n">WINDOW_UPDATE</span><span class="p">,</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="n">ID</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Length</span><span class="w"> </span><span class="mi">4</span>
<span class="w">        </span><span class="nl">Length</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span>
<span class="w">        </span><span class="nl">Type</span><span class="p">:</span><span class="w"> </span><span class="n">WINDOW_UPDATE</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="w">        </span><span class="nl">Flags</span><span class="p">:</span><span class="w"> </span><span class="mh">0x00</span>
<span class="w">            </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Unused</span><span class="o">:</span><span class="w"> </span><span class="mh">0x00</span>
<span class="w">        </span><span class="mf">0.</span><span class="p">..</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reserved</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0</span>
<span class="w">        </span><span class="mf">.000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0001</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="n">Identifier</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="mf">0.</span><span class="p">..</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reserved</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0</span>
<span class="w">        </span><span class="mf">.000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0001</span><span class="w"> </span><span class="mo">0110</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Window</span><span class="w"> </span><span class="n">Size</span><span class="w"> </span><span class="n">Increment</span><span class="o">:</span><span class="w"> </span><span class="mi">22</span>
<span class="w">    </span><span class="nl">Stream</span><span class="p">:</span><span class="w"> </span><span class="n">WINDOW_UPDATE</span><span class="p">,</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="n">ID</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Length</span><span class="w"> </span><span class="mi">4</span>
<span class="w">        </span><span class="nl">Length</span><span class="p">:</span><span class="w"> </span><span class="mi">4</span>
<span class="w">        </span><span class="nl">Type</span><span class="p">:</span><span class="w"> </span><span class="n">WINDOW_UPDATE</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="p">)</span>
<span class="w">        </span><span class="nl">Flags</span><span class="p">:</span><span class="w"> </span><span class="mh">0x00</span>
<span class="w">            </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Unused</span><span class="o">:</span><span class="w"> </span><span class="mh">0x00</span>
<span class="w">        </span><span class="mf">0.</span><span class="p">..</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reserved</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0</span>
<span class="w">        </span><span class="mf">.000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="n">Identifier</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="mf">0.</span><span class="p">..</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reserved</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0</span>
<span class="w">        </span><span class="mf">.111</span><span class="w"> </span><span class="mi">1111</span><span class="w"> </span><span class="mi">1111</span><span class="w"> </span><span class="mi">1111</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0001</span><span class="w"> </span><span class="mo">0110</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Window</span><span class="w"> </span><span class="n">Size</span><span class="w"> </span><span class="n">Increment</span><span class="o">:</span><span class="w"> </span><span class="mi">2147418134</span>
<span class="p">(...)</span>
<span class="n">HyperText</span><span class="w"> </span><span class="n">Transfer</span><span class="w"> </span><span class="n">Protocol</span><span class="w"> </span><span class="mi">2</span>
<span class="w">    </span><span class="nl">Stream</span><span class="p">:</span><span class="w"> </span><span class="n">GOAWAY</span><span class="p">,</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="n">ID</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">Length</span><span class="w"> </span><span class="mi">15</span>
<span class="w">        </span><span class="nl">Length</span><span class="p">:</span><span class="w"> </span><span class="mi">15</span>
<span class="w">        </span><span class="nl">Type</span><span class="p">:</span><span class="w"> </span><span class="n">GOAWAY</span><span class="w"> </span><span class="p">(</span><span class="mi">7</span><span class="p">)</span>
<span class="w">        </span><span class="nl">Flags</span><span class="p">:</span><span class="w"> </span><span class="mh">0x00</span>
<span class="w">            </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Unused</span><span class="o">:</span><span class="w"> </span><span class="mh">0x00</span>
<span class="w">        </span><span class="mf">0.</span><span class="p">..</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reserved</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0</span>
<span class="w">        </span><span class="mf">.000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Stream</span><span class="w"> </span><span class="n">Identifier</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span>
<span class="w">        </span><span class="mf">0.</span><span class="p">..</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="p">....</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Reserved</span><span class="o">:</span><span class="w"> </span><span class="mh">0x0</span>
<span class="w">        </span><span class="mf">.000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0000</span><span class="w"> </span><span class="mo">0001</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Promised</span><span class="o">-</span><span class="n">Stream</span><span class="o">-</span><span class="n">ID</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">        </span><span class="nl">Error</span><span class="p">:</span><span class="w"> </span><span class="n">NO_ERROR</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="w">        </span><span class="n">Additional</span><span class="w"> </span><span class="n">Debug</span><span class="w"> </span><span class="n">Data</span><span class="o">:</span><span class="w"> </span><span class="mi">74696</span><span class="n">d656f7574</span>
<span class="p">(...)</span>
</code></pre></div></td></tr></table></div></p>
<h5 id="not-forcing-http2-on-the-frontend">Not forcing HTTP/2 on the frontend</h5>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code>frontend fe_h2c
    mode http
    bind *:8084 # proto h2
    default_backend be_h2c

backend be_h2c
    mode http
    server server1 10.88.0.123:8081 proto h2
</code></pre></div></td></tr></table></div>
<p>In that case, the following will yield an HTTP/1.1 answer on the frontend:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>curl http://localhost:8084 -v
</code></pre></div></td></tr></table></div></p>
<p>On the backend, however, we see the same HTTP/2 traffic as before:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@ef82916a0181 /</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">tshark</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">eth0</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">tcp</span><span class="p">.</span><span class="n">port</span><span class="o">==</span><span class="mi">8081</span><span class="p">,</span><span class="n">http</span><span class="w">  </span><span class="k">host</span><span class="w"> </span><span class="mf">10.88.0.123</span>
<span class="n">Running</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="ss">&quot;root&quot;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="ss">&quot;root&quot;</span><span class="p">.</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">dangerous</span><span class="p">.</span>
<span class="n">Capturing</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="s1">&#39;eth0&#39;</span>
<span class="w">    </span><span class="mi">1</span><span class="w"> </span><span class="mf">0.000000000</span><span class="w">  </span><span class="mf">10.88.0.128</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">74</span><span class="w"> </span><span class="mi">47690</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="o">[</span><span class="n">SYN</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">29200</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">MSS</span><span class="o">=</span><span class="mi">1460</span><span class="w"> </span><span class="n">SACK_PERM</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">281077415</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">WS</span><span class="o">=</span><span class="mi">128</span>
<span class="w">    </span><span class="mi">2</span><span class="w"> </span><span class="mf">0.000016099</span><span class="w">  </span><span class="mf">10.88.0.123</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.128</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">74</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">47690</span><span class="w"> </span><span class="o">[</span><span class="n">SYN, ACK</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">Ack</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">28960</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">MSS</span><span class="o">=</span><span class="mi">1460</span><span class="w"> </span><span class="n">SACK_PERM</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">3828088613</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">281077415</span><span class="w"> </span><span class="n">WS</span><span class="o">=</span><span class="mi">128</span>
<span class="w">    </span><span class="mi">3</span><span class="w"> </span><span class="mf">0.000021473</span><span class="w">  </span><span class="mf">10.88.0.128</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">66</span><span class="w"> </span><span class="mi">47690</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="o">[</span><span class="n">ACK</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">Ack</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">29312</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">281077415</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">3828088613</span>
<span class="w">    </span><span class="mi">4</span><span class="w"> </span><span class="mf">0.000064928</span><span class="w">  </span><span class="mf">10.88.0.128</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="n">HTTP2</span><span class="w"> </span><span class="mi">111</span><span class="w"> </span><span class="n">Magic</span><span class="p">,</span><span class="w"> </span><span class="n">SETTINGS</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>
<span class="w">    </span><span class="mi">5</span><span class="w"> </span><span class="mf">0.000092463</span><span class="w">  </span><span class="mf">10.88.0.123</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.128</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">66</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">47690</span><span class="w"> </span><span class="o">[</span><span class="n">ACK</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">Ack</span><span class="o">=</span><span class="mi">46</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">29056</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">3828088613</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">281077415</span>
<span class="w">    </span><span class="mi">6</span><span class="w"> </span><span class="mf">0.000330539</span><span class="w">  </span><span class="mf">10.88.0.123</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.128</span><span class="w">  </span><span class="n">HTTP2</span><span class="w"> </span><span class="mi">103</span><span class="w"> </span><span class="n">SETTINGS</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">SETTINGS</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">WINDOW_UPDATE</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>
<span class="w">    </span><span class="mi">7</span><span class="w"> </span><span class="mf">0.000335106</span><span class="w">  </span><span class="mf">10.88.0.128</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">66</span><span class="w"> </span><span class="mi">47690</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="o">[</span><span class="n">ACK</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">46</span><span class="w"> </span><span class="n">Ack</span><span class="o">=</span><span class="mi">38</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">29312</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">281077416</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">3828088614</span>
<span class="w">    </span><span class="mi">8</span><span class="w"> </span><span class="mf">0.000423649</span><span class="w">  </span><span class="mf">10.88.0.128</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="n">HTTP2</span><span class="w"> </span><span class="mi">75</span><span class="w"> </span><span class="n">SETTINGS</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>
<span class="w">    </span><span class="mi">9</span><span class="w"> </span><span class="mf">0.000446667</span><span class="w">  </span><span class="mf">10.88.0.128</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="n">HTTP2</span><span class="w"> </span><span class="mi">139</span><span class="w"> </span><span class="n">HEADERS</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="k">GET</span><span class="w"> </span><span class="o">/</span>
<span class="w">   </span><span class="mi">10</span><span class="w"> </span><span class="mf">0.000451488</span><span class="w">  </span><span class="mf">10.88.0.123</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.128</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">66</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">47690</span><span class="w"> </span><span class="o">[</span><span class="n">ACK</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">38</span><span class="w"> </span><span class="n">Ack</span><span class="o">=</span><span class="mi">128</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">29056</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">3828088614</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">281077416</span>
<span class="w">   </span><span class="mi">11</span><span class="w"> </span><span class="mf">0.000743338</span><span class="w">  </span><span class="mf">10.88.0.123</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.128</span><span class="w">  </span><span class="n">HTTP2</span><span class="w"> </span><span class="mi">203</span><span class="w"> </span><span class="n">HEADERS</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="n">OK</span>
<span class="w">   </span><span class="mi">12</span><span class="w"> </span><span class="mf">0.000764739</span><span class="w">  </span><span class="mf">10.88.0.123</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.128</span><span class="w">  </span><span class="n">HTTP2</span><span class="w"> </span><span class="mi">97</span><span class="w"> </span><span class="k">DATA</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w"> </span><span class="p">(</span><span class="nc">text</span><span class="o">/</span><span class="n">html</span><span class="p">)</span>
<span class="w">   </span><span class="mi">13</span><span class="w"> </span><span class="mf">0.000785449</span><span class="w">  </span><span class="mf">10.88.0.128</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">66</span><span class="w"> </span><span class="mi">47690</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="o">[</span><span class="n">ACK</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">128</span><span class="w"> </span><span class="n">Ack</span><span class="o">=</span><span class="mi">206</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">30336</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">281077416</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">3828088614</span>
<span class="w">   </span><span class="mi">14</span><span class="w"> </span><span class="mf">0.000794674</span><span class="w">  </span><span class="mf">10.88.0.128</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="n">HTTP2</span><span class="w"> </span><span class="mi">92</span><span class="w"> </span><span class="n">WINDOW_UPDATE</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">WINDOW_UPDATE</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>
<span class="w">   </span><span class="mi">15</span><span class="w"> </span><span class="mf">0.041548863</span><span class="w">  </span><span class="mf">10.88.0.123</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.128</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">66</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">47690</span><span class="w"> </span><span class="o">[</span><span class="n">ACK</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">206</span><span class="w"> </span><span class="n">Ack</span><span class="o">=</span><span class="mi">154</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">29056</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">3828088655</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">281077416</span>
</code></pre></div></td></tr></table></div></p>
<p>And the following yields HTTP/2 on the frontend:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>curl --http2-prior-knowledge http://localhost:8084 -v
</code></pre></div></td></tr></table></div></p>
<p>And HTTP/2 on the backend:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@ef82916a0181 /</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">tshark</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">eth0</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">tcp</span><span class="p">.</span><span class="n">port</span><span class="o">==</span><span class="mi">8081</span><span class="p">,</span><span class="n">http</span><span class="w">  </span><span class="k">host</span><span class="w"> </span><span class="mf">10.88.0.123</span>
<span class="n">Running</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="ss">&quot;root&quot;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="ss">&quot;root&quot;</span><span class="p">.</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">dangerous</span><span class="p">.</span>
<span class="n">Capturing</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="s1">&#39;eth0&#39;</span>
<span class="w">    </span><span class="mi">1</span><span class="w"> </span><span class="mf">0.000000000</span><span class="w">  </span><span class="mf">10.88.0.128</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">74</span><span class="w"> </span><span class="mi">47742</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="o">[</span><span class="n">SYN</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">29200</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">MSS</span><span class="o">=</span><span class="mi">1460</span><span class="w"> </span><span class="n">SACK_PERM</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">281141371</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">WS</span><span class="o">=</span><span class="mi">128</span>
<span class="w">    </span><span class="mi">2</span><span class="w"> </span><span class="mf">0.000061147</span><span class="w">  </span><span class="mf">10.88.0.123</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.128</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">74</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">47742</span><span class="w"> </span><span class="o">[</span><span class="n">SYN, ACK</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">Ack</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">28960</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">MSS</span><span class="o">=</span><span class="mi">1460</span><span class="w"> </span><span class="n">SACK_PERM</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">3828152569</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">281141371</span><span class="w"> </span><span class="n">WS</span><span class="o">=</span><span class="mi">128</span>
<span class="w">    </span><span class="mi">3</span><span class="w"> </span><span class="mf">0.000093249</span><span class="w">  </span><span class="mf">10.88.0.128</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">66</span><span class="w"> </span><span class="mi">47742</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="o">[</span><span class="n">ACK</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">Ack</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">29312</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">281141371</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">3828152569</span>
<span class="w">    </span><span class="mi">4</span><span class="w"> </span><span class="mf">0.000237410</span><span class="w">  </span><span class="mf">10.88.0.128</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="n">HTTP2</span><span class="w"> </span><span class="mi">111</span><span class="w"> </span><span class="n">Magic</span><span class="p">,</span><span class="w"> </span><span class="n">SETTINGS</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>
<span class="w">    </span><span class="mi">5</span><span class="w"> </span><span class="mf">0.000387862</span><span class="w">  </span><span class="mf">10.88.0.123</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.128</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">66</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">47742</span><span class="w"> </span><span class="o">[</span><span class="n">ACK</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">Ack</span><span class="o">=</span><span class="mi">46</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">29056</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">3828152569</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">281141371</span>
<span class="w">    </span><span class="mi">6</span><span class="w"> </span><span class="mf">0.000951782</span><span class="w">  </span><span class="mf">10.88.0.123</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.128</span><span class="w">  </span><span class="n">HTTP2</span><span class="w"> </span><span class="mi">103</span><span class="w"> </span><span class="n">SETTINGS</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">SETTINGS</span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">WINDOW_UPDATE</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>
<span class="w">    </span><span class="mi">7</span><span class="w"> </span><span class="mf">0.000967453</span><span class="w">  </span><span class="mf">10.88.0.128</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">66</span><span class="w"> </span><span class="mi">47742</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="o">[</span><span class="n">ACK</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">46</span><span class="w"> </span><span class="n">Ack</span><span class="o">=</span><span class="mi">38</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">29312</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">281141372</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">3828152570</span>
<span class="w">    </span><span class="mi">8</span><span class="w"> </span><span class="mf">0.001132627</span><span class="w">  </span><span class="mf">10.88.0.128</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="n">HTTP2</span><span class="w"> </span><span class="mi">75</span><span class="w"> </span><span class="n">SETTINGS</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>
<span class="w">    </span><span class="mi">9</span><span class="w"> </span><span class="mf">0.001202587</span><span class="w">  </span><span class="mf">10.88.0.128</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="n">HTTP2</span><span class="w"> </span><span class="mi">139</span><span class="w"> </span><span class="n">HEADERS</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="k">GET</span><span class="w"> </span><span class="o">/</span>
<span class="w">   </span><span class="mi">10</span><span class="w"> </span><span class="mf">0.001231726</span><span class="w">  </span><span class="mf">10.88.0.123</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.128</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">66</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">47742</span><span class="w"> </span><span class="o">[</span><span class="n">ACK</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">38</span><span class="w"> </span><span class="n">Ack</span><span class="o">=</span><span class="mi">128</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">29056</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">3828152570</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">281141372</span>
<span class="w">   </span><span class="mi">11</span><span class="w"> </span><span class="mf">0.002061044</span><span class="w">  </span><span class="mf">10.88.0.123</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.128</span><span class="w">  </span><span class="n">HTTP2</span><span class="w"> </span><span class="mi">203</span><span class="w"> </span><span class="n">HEADERS</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="err">:</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="n">OK</span>
<span class="w">   </span><span class="mi">12</span><span class="w"> </span><span class="mf">0.002183092</span><span class="w">  </span><span class="mf">10.88.0.123</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.128</span><span class="w">  </span><span class="n">HTTP2</span><span class="w"> </span><span class="mi">97</span><span class="w"> </span><span class="k">DATA</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="w"> </span><span class="p">(</span><span class="nc">text</span><span class="o">/</span><span class="n">html</span><span class="p">)</span>
<span class="w">   </span><span class="mi">13</span><span class="w"> </span><span class="mf">0.002425192</span><span class="w">  </span><span class="mf">10.88.0.128</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">66</span><span class="w"> </span><span class="mi">47742</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="o">[</span><span class="n">ACK</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">128</span><span class="w"> </span><span class="n">Ack</span><span class="o">=</span><span class="mi">206</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">30336</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">281141374</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">3828152571</span>
<span class="w">   </span><span class="mi">14</span><span class="w"> </span><span class="mf">0.002485282</span><span class="w">  </span><span class="mf">10.88.0.128</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="n">HTTP2</span><span class="w"> </span><span class="mi">92</span><span class="w"> </span><span class="n">WINDOW_UPDATE</span><span class="o">[</span><span class="n">1</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="n">WINDOW_UPDATE</span><span class="o">[</span><span class="n">0</span><span class="o">]</span>
<span class="w">   </span><span class="mi">15</span><span class="w"> </span><span class="mf">0.043436470</span><span class="w">  </span><span class="mf">10.88.0.123</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.128</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">66</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">47742</span><span class="w"> </span><span class="o">[</span><span class="n">ACK</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">206</span><span class="w"> </span><span class="n">Ack</span><span class="o">=</span><span class="mi">154</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">29056</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">3828152613</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">281141374</span>
</code></pre></div></td></tr></table></div></p>
<h5 id="forcing-http2-on-the-frontend-http11-on-the-backend">Forcing HTTP/2 on the frontend, HTTP/1.1 on the backend</h5>
<p>It's also possible to force HTTP/2 on the frontend and then terminate the connection with HTTP/1.1 on the backend.</p>
<p>The following is also possible:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code>frontend fe_h2c
    mode http
    bind *:8084 proto h2
    default_backend be_h2c

backend be_h2c
    mode http
    server server1 10.88.0.123:8081 # proto h2
</code></pre></div></td></tr></table></div></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">kind</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">curl</span><span class="w"> </span><span class="o">--</span><span class="nx">http2</span><span class="o">-</span><span class="nx">prior</span><span class="o">-</span><span class="nx">knowledge</span><span class="w"> </span><span class="nx">http</span><span class="p">:</span><span class="c1">//localhost:8084 -v</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Rebuilt</span><span class="w"> </span><span class="nx">URL</span><span class="w"> </span><span class="nx">to</span><span class="p">:</span><span class="w"> </span><span class="nx">http</span><span class="p">:</span><span class="c1">//localhost:8084/</span>
<span class="o">*</span><span class="w">   </span><span class="nx">Trying</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="o">...</span>
<span class="o">*</span><span class="w"> </span><span class="nx">TCP_NODELAY</span><span class="w"> </span><span class="nx">set</span>
<span class="o">*</span><span class="w"> </span><span class="nx">connect</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="mi">8084</span><span class="w"> </span><span class="nx">failed</span><span class="p">:</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="nx">refused</span>
<span class="o">*</span><span class="w">   </span><span class="nx">Trying</span><span class="w"> </span><span class="m m-Double">127.0.0.1</span><span class="o">...</span>
<span class="o">*</span><span class="w"> </span><span class="nx">TCP_NODELAY</span><span class="w"> </span><span class="nx">set</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connected</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">localhost</span><span class="w"> </span><span class="p">(</span><span class="m m-Double">127.0.0.1</span><span class="p">)</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="mi">8084</span><span class="w"> </span><span class="p">(</span><span class="err">#</span><span class="mi">0</span><span class="p">)</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Using</span><span class="w"> </span><span class="nx">HTTP2</span><span class="p">,</span><span class="w"> </span><span class="nx">server</span><span class="w"> </span><span class="nx">supports</span><span class="w"> </span><span class="nx">multi</span><span class="o">-</span><span class="nx">use</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="nx">changed</span><span class="w"> </span><span class="p">(</span><span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="nx">confirmed</span><span class="p">)</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Copying</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="nx">data</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">stream</span><span class="w"> </span><span class="nx">buffer</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">connection</span><span class="w"> </span><span class="nx">buffer</span><span class="w"> </span><span class="nx">after</span><span class="w"> </span><span class="nx">upgrade</span><span class="p">:</span><span class="w"> </span><span class="nx">len</span><span class="p">=</span><span class="mi">0</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Using</span><span class="w"> </span><span class="nx">Stream</span><span class="w"> </span><span class="nx">ID</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">(</span><span class="nx">easy</span><span class="w"> </span><span class="nx">handle</span><span class="w"> </span><span class="mh">0x557fb6d1e480</span><span class="p">)</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">GET</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">Host</span><span class="p">:</span><span class="w"> </span><span class="nx">localhost</span><span class="p">:</span><span class="mi">8084</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">User</span><span class="o">-</span><span class="nx">Agent</span><span class="p">:</span><span class="w"> </span><span class="nx">curl</span><span class="o">/</span><span class="m m-Double">7.61.1</span>
<span class="p">&gt;</span><span class="w"> </span><span class="nx">Accept</span><span class="p">:</span><span class="w"> </span><span class="o">*/*</span>
<span class="p">&gt;</span><span class="w"> </span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="nx">state</span><span class="w"> </span><span class="nx">changed</span><span class="w"> </span><span class="p">(</span><span class="nx">MAX_CONCURRENT_STREAMS</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">100</span><span class="p">)!</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">date</span><span class="p">:</span><span class="w"> </span><span class="nx">Tue</span><span class="p">,</span><span class="w"> </span><span class="mi">09</span><span class="w"> </span><span class="nx">Mar</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="mi">11</span><span class="p">:</span><span class="mi">27</span><span class="p">:</span><span class="mi">25</span><span class="w"> </span><span class="nx">GMT</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">server</span><span class="p">:</span><span class="w"> </span><span class="nx">Apache</span><span class="o">/</span><span class="m m-Double">2.4.46</span><span class="w"> </span><span class="p">(</span><span class="nx">Fedora</span><span class="p">)</span><span class="w"> </span><span class="nx">OpenSSL</span><span class="o">/</span><span class="m m-Double">1.1.1</span><span class="nx">j</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">last</span><span class="o">-</span><span class="nx">modified</span><span class="p">:</span><span class="w"> </span><span class="nx">Mon</span><span class="p">,</span><span class="w"> </span><span class="mi">08</span><span class="w"> </span><span class="nx">Mar</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="mi">18</span><span class="p">:</span><span class="mi">34</span><span class="p">:</span><span class="mi">18</span><span class="w"> </span><span class="nx">GMT</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">etag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;16-5bd0aae785e80&quot;</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">accept</span><span class="o">-</span><span class="nx">ranges</span><span class="p">:</span><span class="w"> </span><span class="nx">bytes</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">content</span><span class="o">-</span><span class="nx">length</span><span class="p">:</span><span class="w"> </span><span class="mi">22</span>
<span class="p">&lt;</span><span class="w"> </span><span class="nx">content</span><span class="o">-</span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">text</span><span class="o">/</span><span class="nx">html</span><span class="p">;</span><span class="w"> </span><span class="nx">charset</span><span class="p">=</span><span class="nx">UTF</span><span class="o">-</span><span class="mi">8</span>
<span class="p">&lt;</span><span class="w"> </span>
<span class="nx">HTTP</span><span class="o">/</span><span class="mi">2</span><span class="w"> </span><span class="nx">insecure</span><span class="w"> </span><span class="p">(</span><span class="nx">h2c</span><span class="p">)</span>
<span class="o">*</span><span class="w"> </span><span class="nx">Connection</span><span class="w"> </span><span class="err">#</span><span class="mi">0</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">host</span><span class="w"> </span><span class="nx">localhost</span><span class="w"> </span><span class="nx">left</span><span class="w"> </span><span class="nx">intact</span>
<span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">kind</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@ef82916a0181 /</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">tshark</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">eth0</span><span class="w"> </span><span class="o">-</span><span class="n">d</span><span class="w"> </span><span class="n">tcp</span><span class="p">.</span><span class="n">port</span><span class="o">==</span><span class="mi">8081</span><span class="p">,</span><span class="n">http</span><span class="w">  </span><span class="k">host</span><span class="w"> </span><span class="mf">10.88.0.123</span>
<span class="n">Running</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="ss">&quot;root&quot;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="ss">&quot;root&quot;</span><span class="p">.</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">dangerous</span><span class="p">.</span>
<span class="n">Capturing</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="s1">&#39;eth0&#39;</span>
<span class="w">    </span><span class="mi">1</span><span class="w"> </span><span class="mf">0.000000000</span><span class="w">  </span><span class="mf">10.88.0.128</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">74</span><span class="w"> </span><span class="mi">48014</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="o">[</span><span class="n">SYN</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">29200</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">MSS</span><span class="o">=</span><span class="mi">1460</span><span class="w"> </span><span class="n">SACK_PERM</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">282131294</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">WS</span><span class="o">=</span><span class="mi">128</span>
<span class="w">    </span><span class="mi">2</span><span class="w"> </span><span class="mf">0.000019888</span><span class="w">  </span><span class="mf">10.88.0.123</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.128</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">74</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">48014</span><span class="w"> </span><span class="o">[</span><span class="n">SYN, ACK</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">Ack</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">28960</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">MSS</span><span class="o">=</span><span class="mi">1460</span><span class="w"> </span><span class="n">SACK_PERM</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">3829142492</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">282131294</span><span class="w"> </span><span class="n">WS</span><span class="o">=</span><span class="mi">128</span>
<span class="w">    </span><span class="mi">3</span><span class="w"> </span><span class="mf">0.000024442</span><span class="w">  </span><span class="mf">10.88.0.128</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">66</span><span class="w"> </span><span class="mi">48014</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="o">[</span><span class="n">ACK</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">Ack</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">29312</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">282131294</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">3829142492</span>
<span class="w">    </span><span class="mi">4</span><span class="w"> </span><span class="mf">0.000063274</span><span class="w">  </span><span class="mf">10.88.0.128</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="n">HTTP</span><span class="w"> </span><span class="mi">191</span><span class="w"> </span><span class="k">GET</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span><span class="w"> </span>
<span class="w">    </span><span class="mi">5</span><span class="w"> </span><span class="mf">0.000084897</span><span class="w">  </span><span class="mf">10.88.0.123</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.128</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">66</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">48014</span><span class="w"> </span><span class="o">[</span><span class="n">ACK</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">Ack</span><span class="o">=</span><span class="mi">126</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">29056</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">3829142493</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">282131295</span>
<span class="w">    </span><span class="mi">6</span><span class="w"> </span><span class="mf">0.000532732</span><span class="w">  </span><span class="mf">10.88.0.123</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.128</span><span class="w">  </span><span class="n">HTTP</span><span class="w"> </span><span class="mi">387</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span><span class="w"> </span><span class="mi">200</span><span class="w"> </span><span class="n">OK</span><span class="w">  </span><span class="p">(</span><span class="nc">text</span><span class="o">/</span><span class="n">html</span><span class="p">)</span>
<span class="w">    </span><span class="mi">7</span><span class="w"> </span><span class="mf">0.000536368</span><span class="w">  </span><span class="mf">10.88.0.128</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">66</span><span class="w"> </span><span class="mi">48014</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="o">[</span><span class="n">ACK</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">126</span><span class="w"> </span><span class="n">Ack</span><span class="o">=</span><span class="mi">322</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">30336</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">282131295</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">3829142493</span>
<span class="w">    </span><span class="mi">8</span><span class="w"> </span><span class="mf">0.000611168</span><span class="w">  </span><span class="mf">10.88.0.123</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.128</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">66</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">48014</span><span class="w"> </span><span class="o">[</span><span class="n">FIN, ACK</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">322</span><span class="w"> </span><span class="n">Ack</span><span class="o">=</span><span class="mi">126</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">29056</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">3829142493</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">282131295</span>
<span class="w">    </span><span class="mi">9</span><span class="w"> </span><span class="mf">0.000697672</span><span class="w">  </span><span class="mf">10.88.0.128</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="n">TCP</span><span class="w"> </span><span class="mi">66</span><span class="w"> </span><span class="mi">48014</span><span class="w"> </span><span class="err">→</span><span class="w"> </span><span class="mi">8081</span><span class="w"> </span><span class="o">[</span><span class="n">RST, ACK</span><span class="o">]</span><span class="w"> </span><span class="n">Seq</span><span class="o">=</span><span class="mi">126</span><span class="w"> </span><span class="n">Ack</span><span class="o">=</span><span class="mi">323</span><span class="w"> </span><span class="n">Win</span><span class="o">=</span><span class="mi">30336</span><span class="w"> </span><span class="nf">Len</span><span class="o">=</span><span class="mi">0</span><span class="w"> </span><span class="n">TSval</span><span class="o">=</span><span class="mi">282131295</span><span class="w"> </span><span class="n">TSecr</span><span class="o">=</span><span class="mi">3829142493</span>
</code></pre></div></td></tr></table></div>
<h5 id="tlsalpn-protocol-detection-for-http2">TLS/ALPN protocol detection for HTTP/2</h5>
<p>Looking at the h2 virtual servers with TLS/ALPN in place:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code>frontend fe_h2 
    mode http 
    bind *:8085 ssl crt /etc/haproxy/certs/pem alpn h2,http/1.1 
    default_backend be_h2 

backend be_h2 
    mode http 
    server server1 10.88.0.123:8082 ssl verify none alpn h2 
</code></pre></div></td></tr></table></div></p>
<p>On the frontend, we can force the protocol to use, just as an example, to be HTTP/1.1
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="p">@</span><span class="n">kind</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="n">curl</span><span class="w"> </span><span class="o">--</span><span class="n">http1</span><span class="mf">.1</span><span class="w"> </span><span class="n">https</span><span class="o">:</span><span class="c1">//localhost:8085 -v -k</span>
<span class="o">*</span><span class="w"> </span><span class="n">Rebuilt</span><span class="w"> </span><span class="n">URL</span><span class="w"> </span><span class="n">to</span><span class="o">:</span><span class="w"> </span><span class="n">https</span><span class="o">:</span><span class="c1">//localhost:8085/</span>
<span class="o">*</span><span class="w">   </span><span class="n">Trying</span><span class="w"> </span><span class="o">::</span><span class="mf">1.</span><span class="p">..</span>
<span class="o">*</span><span class="w"> </span><span class="n">TCP_NODELAY</span><span class="w"> </span><span class="n">set</span>
<span class="o">*</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="o">::</span><span class="mi">1</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">8085</span><span class="w"> </span><span class="n">failed</span><span class="o">:</span><span class="w"> </span><span class="n">Connection</span><span class="w"> </span><span class="n">refused</span>
<span class="o">*</span><span class="w">   </span><span class="n">Trying</span><span class="w"> </span><span class="mf">127.0.0.1</span><span class="p">...</span>
<span class="o">*</span><span class="w"> </span><span class="n">TCP_NODELAY</span><span class="w"> </span><span class="n">set</span>
<span class="o">*</span><span class="w"> </span><span class="n">Connected</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">localhost</span><span class="w"> </span><span class="p">(</span><span class="mf">127.0.0.1</span><span class="p">)</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="mi">8085</span><span class="w"> </span><span class="p">(</span><span class="err">#</span><span class="mi">0</span><span class="p">)</span>
<span class="o">*</span><span class="w"> </span><span class="n">ALPN</span><span class="p">,</span><span class="w"> </span><span class="n">offering</span><span class="w"> </span><span class="n">http</span><span class="o">/</span><span class="mf">1.1</span>
<span class="o">*</span><span class="w"> </span><span class="n">successfully</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">verify</span><span class="w"> </span><span class="n">locations</span><span class="o">:</span>
<span class="o">*</span><span class="w">   </span><span class="n">CAfile</span><span class="o">:</span><span class="w"> </span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">pki</span><span class="o">/</span><span class="n">tls</span><span class="o">/</span><span class="n">certs</span><span class="o">/</span><span class="n">ca</span><span class="o">-</span><span class="n">bundle</span><span class="p">.</span><span class="n">crt</span>
<span class="w">  </span><span class="nl">CApath</span><span class="p">:</span><span class="w"> </span><span class="n">none</span>
<span class="o">*</span><span class="w"> </span><span class="n">TLSv1</span><span class="mf">.3</span><span class="w"> </span><span class="p">(</span><span class="n">OUT</span><span class="p">),</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="n">handshake</span><span class="p">,</span><span class="w"> </span><span class="n">Client</span><span class="w"> </span><span class="n">hello</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">:</span>
<span class="o">*</span><span class="w"> </span><span class="n">TLSv1</span><span class="mf">.3</span><span class="w"> </span><span class="p">(</span><span class="n">IN</span><span class="p">),</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="n">handshake</span><span class="p">,</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="n">hello</span><span class="w"> </span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">:</span>
<span class="o">*</span><span class="w"> </span><span class="n">TLSv1</span><span class="mf">.3</span><span class="w"> </span><span class="p">(</span><span class="n">IN</span><span class="p">),</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="n">handshake</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">no</span><span class="w"> </span><span class="n">content</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span>
<span class="o">*</span><span class="w"> </span><span class="n">TLSv1</span><span class="mf">.3</span><span class="w"> </span><span class="p">(</span><span class="n">IN</span><span class="p">),</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="n">handshake</span><span class="p">,</span><span class="w"> </span><span class="n">Encrypted</span><span class="w"> </span><span class="n">Extensions</span><span class="w"> </span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">:</span>
<span class="o">*</span><span class="w"> </span><span class="n">TLSv1</span><span class="mf">.3</span><span class="w"> </span><span class="p">(</span><span class="n">IN</span><span class="p">),</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="n">handshake</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">no</span><span class="w"> </span><span class="n">content</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span>
<span class="o">*</span><span class="w"> </span><span class="n">TLSv1</span><span class="mf">.3</span><span class="w"> </span><span class="p">(</span><span class="n">IN</span><span class="p">),</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="n">handshake</span><span class="p">,</span><span class="w"> </span><span class="n">Certificate</span><span class="w"> </span><span class="p">(</span><span class="mi">11</span><span class="p">)</span><span class="o">:</span>
<span class="o">*</span><span class="w"> </span><span class="n">TLSv1</span><span class="mf">.3</span><span class="w"> </span><span class="p">(</span><span class="n">IN</span><span class="p">),</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="n">handshake</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">no</span><span class="w"> </span><span class="n">content</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span>
<span class="o">*</span><span class="w"> </span><span class="n">TLSv1</span><span class="mf">.3</span><span class="w"> </span><span class="p">(</span><span class="n">IN</span><span class="p">),</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="n">handshake</span><span class="p">,</span><span class="w"> </span><span class="n">CERT</span><span class="w"> </span><span class="n">verify</span><span class="w"> </span><span class="p">(</span><span class="mi">15</span><span class="p">)</span><span class="o">:</span>
<span class="o">*</span><span class="w"> </span><span class="n">TLSv1</span><span class="mf">.3</span><span class="w"> </span><span class="p">(</span><span class="n">IN</span><span class="p">),</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="n">handshake</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">no</span><span class="w"> </span><span class="n">content</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span>
<span class="o">*</span><span class="w"> </span><span class="n">TLSv1</span><span class="mf">.3</span><span class="w"> </span><span class="p">(</span><span class="n">IN</span><span class="p">),</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="n">handshake</span><span class="p">,</span><span class="w"> </span><span class="n">Finished</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">:</span>
<span class="o">*</span><span class="w"> </span><span class="n">TLSv1</span><span class="mf">.3</span><span class="w"> </span><span class="p">(</span><span class="n">OUT</span><span class="p">),</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="n">change</span><span class="w"> </span><span class="n">cipher</span><span class="p">,</span><span class="w"> </span><span class="n">Change</span><span class="w"> </span><span class="n">cipher</span><span class="w"> </span><span class="n">spec</span><span class="w"> </span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">:</span>
<span class="o">*</span><span class="w"> </span><span class="n">TLSv1</span><span class="mf">.3</span><span class="w"> </span><span class="p">(</span><span class="n">OUT</span><span class="p">),</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="n">handshake</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">no</span><span class="w"> </span><span class="n">content</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span>
<span class="o">*</span><span class="w"> </span><span class="n">TLSv1</span><span class="mf">.3</span><span class="w"> </span><span class="p">(</span><span class="n">OUT</span><span class="p">),</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="n">handshake</span><span class="p">,</span><span class="w"> </span><span class="n">Finished</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="p">)</span><span class="o">:</span>
<span class="o">*</span><span class="w"> </span><span class="n">SSL</span><span class="w"> </span><span class="n">connection</span><span class="w"> </span><span class="n">using</span><span class="w"> </span><span class="n">TLSv1</span><span class="mf">.3</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">TLS_AES_256_GCM_SHA384</span>
<span class="o">*</span><span class="w"> </span><span class="n">ALPN</span><span class="p">,</span><span class="w"> </span><span class="n">server</span><span class="w"> </span><span class="n">accepted</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">use</span><span class="w"> </span><span class="n">http</span><span class="o">/</span><span class="mf">1.1</span>
<span class="o">*</span><span class="w"> </span><span class="n">Server</span><span class="w"> </span><span class="n">certificate</span><span class="o">:</span>
<span class="o">*</span><span class="w">  </span><span class="n">subject</span><span class="o">:</span><span class="w"> </span><span class="n">C</span><span class="o">=</span><span class="n">CA</span><span class="p">;</span><span class="w"> </span><span class="n">ST</span><span class="o">=</span><span class="n">Arctica</span><span class="p">;</span><span class="w"> </span><span class="n">L</span><span class="o">=</span><span class="n">Northpole</span><span class="p">;</span><span class="w"> </span><span class="n">O</span><span class="o">=</span><span class="n">Accme</span><span class="w"> </span><span class="n">Inc</span><span class="p">;</span><span class="w"> </span><span class="n">OU</span><span class="o">=</span><span class="n">DevOps</span><span class="p">;</span><span class="w"> </span><span class="n">CN</span><span class="o">=</span><span class="n">www</span><span class="p">.</span><span class="n">company</span><span class="p">.</span><span class="n">org</span>
<span class="o">*</span><span class="w">  </span><span class="n">start</span><span class="w"> </span><span class="n">date</span><span class="o">:</span><span class="w"> </span><span class="n">Mar</span><span class="w">  </span><span class="mi">8</span><span class="w"> </span><span class="mi">16</span><span class="o">:</span><span class="mi">56</span><span class="o">:</span><span class="mo">03</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="n">GMT</span>
<span class="o">*</span><span class="w">  </span><span class="n">expire</span><span class="w"> </span><span class="n">date</span><span class="o">:</span><span class="w"> </span><span class="n">Mar</span><span class="w"> </span><span class="mi">21</span><span class="w"> </span><span class="mi">16</span><span class="o">:</span><span class="mi">56</span><span class="o">:</span><span class="mo">03</span><span class="w"> </span><span class="mi">2049</span><span class="w"> </span><span class="n">GMT</span>
<span class="o">*</span><span class="w">  </span><span class="n">issuer</span><span class="o">:</span><span class="w"> </span><span class="n">C</span><span class="o">=</span><span class="n">CA</span><span class="p">;</span><span class="w"> </span><span class="n">ST</span><span class="o">=</span><span class="n">Arctica</span><span class="p">;</span><span class="w"> </span><span class="n">L</span><span class="o">=</span><span class="n">Northpole</span><span class="p">;</span><span class="w"> </span><span class="n">O</span><span class="o">=</span><span class="n">Accme</span><span class="w"> </span><span class="n">Inc</span><span class="p">;</span><span class="w"> </span><span class="n">OU</span><span class="o">=</span><span class="n">DevOps</span><span class="p">;</span><span class="w"> </span><span class="n">CN</span><span class="o">=</span><span class="n">www</span><span class="p">.</span><span class="n">company</span><span class="p">.</span><span class="n">org</span>
<span class="o">*</span><span class="w">  </span><span class="n">SSL</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="n">verify</span><span class="w"> </span><span class="n">result</span><span class="o">:</span><span class="w"> </span><span class="n">unable</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">get</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">issuer</span><span class="w"> </span><span class="n">certificate</span><span class="w"> </span><span class="p">(</span><span class="mi">20</span><span class="p">),</span><span class="w"> </span><span class="n">continuing</span><span class="w"> </span><span class="n">anyway</span><span class="p">.</span>
<span class="o">*</span><span class="w"> </span><span class="n">TLSv1</span><span class="mf">.3</span><span class="w"> </span><span class="p">(</span><span class="n">OUT</span><span class="p">),</span><span class="w"> </span><span class="n">TLS</span><span class="w"> </span><span class="n">app</span><span class="w"> </span><span class="n">data</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">no</span><span class="w"> </span><span class="n">content</span><span class="p">]</span><span class="w"> </span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">:</span>
<span class="o">&gt;</span><span class="w"> </span><span class="n">GET</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">HTTP</span><span class="o">/</span><span class="mf">1.1</span>
<span class="o">&gt;</span><span class="w"> </span><span class="n">Host</span><span class="o">:</span><span class="w"> </span><span class="n">localhost</span><span class="o">:</span><span class="mi">8085</span>
<span class="o">&gt;</span><span class="w"> </span><span class="n">User</span><span class="o">-</span><span class="n">Agent</span><span class="o">:</span><span class="w"> </span><span class="n">curl</span><span class="o">/</span><span class="mf">7.61.1</span>
<span class="o">&gt;</span><span class="w"> </span><span class="n">Accept</span><span class="o">:</span><span class="w"> </span><span class="o">*</span><span class="cm">/*</span>
<span class="cm">&gt; </span>
<span class="cm">* TLSv1.3 (IN), TLS handshake, [no content] (0):</span>
<span class="cm">* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):</span>
<span class="cm">* TLSv1.3 (IN), TLS handshake, [no content] (0):</span>
<span class="cm">* TLSv1.3 (IN), TLS handshake, Newsession Ticket (4):</span>
<span class="cm">* TLSv1.3 (IN), TLS app data, [no content] (0):</span>
<span class="cm">&lt; HTTP/1.1 200 </span>
<span class="cm">&lt; date: Tue, 09 Mar 2021 11:13:07 GMT</span>
<span class="cm">&lt; server: Apache/2.4.46 (Fedora) OpenSSL/1.1.1j</span>
<span class="cm">&lt; last-modified: Mon, 08 Mar 2021 18:34:18 GMT</span>
<span class="cm">&lt; etag: &quot;13-5bd0aae785e80&quot;</span>
<span class="cm">&lt; accept-ranges: bytes</span>
<span class="cm">&lt; content-length: 19</span>
<span class="cm">&lt; content-type: text/html; charset=UTF-8</span>
<span class="cm">&lt; </span>
<span class="cm">HTTP/2 secure (h2)</span>
<span class="cm">* Connection #0 to host localhost left intact</span>
</code></pre></div></td></tr></table></div></p>
<p>On the backend, we see that haproxy will negotiate and offer HTTP/2 to the server via ALPN:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@ef82916a0181 /</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">tshark</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">eth0</span><span class="w"> </span><span class="o">-</span><span class="n">O</span><span class="w"> </span><span class="n">tls</span><span class="w">  </span><span class="k">host</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">egrep</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="s1">&#39;application_layer_protocol_negotiation|alpn|Transmission Control Protocol&#39;</span>
<span class="n">Running</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="ss">&quot;root&quot;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="ss">&quot;root&quot;</span><span class="p">.</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">dangerous</span><span class="p">.</span>
<span class="n">Capturing</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="s1">&#39;eth0&#39;</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34156</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34156</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34156</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span>
<span class="mi">18</span><span class="w"> </span><span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34156</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">601</span>
<span class="w">            </span><span class="nl">Extension</span><span class="p">:</span><span class="w"> </span><span class="n">application_layer_protocol_negotiation</span><span class="w"> </span><span class="p">(</span><span class="nf">len</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="w">                </span><span class="nl">Type</span><span class="p">:</span><span class="w"> </span><span class="n">application_layer_protocol_negotiation</span><span class="w"> </span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<span class="w">                </span><span class="n">ALPN</span><span class="w"> </span><span class="n">Extension</span><span class="w"> </span><span class="nl">Length</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span>
<span class="w">                </span><span class="n">ALPN</span><span class="w"> </span><span class="n">Protocol</span>
<span class="w">                    </span><span class="n">ALPN</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="nl">length</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>
<span class="w">                    </span><span class="n">ALPN</span><span class="w"> </span><span class="k">Next</span><span class="w"> </span><span class="nl">Protocol</span><span class="p">:</span><span class="w"> </span><span class="n">h2</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34156</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">602</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34156</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">602</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">250</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34156</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">602</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">251</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34156</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">602</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">251</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">80</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34156</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">682</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">251</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">67</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34156</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">251</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">749</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">287</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34156</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">538</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">749</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">59</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34156</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">749</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">597</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34156</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">749</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">597</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">31</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34156</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">780</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">597</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">95</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34156</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">597</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">875</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34156</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">597</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">875</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">187</span>
<span class="mi">27</span><span class="w"> </span><span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34156</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">875</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">784</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">48</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34156</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">784</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">923</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34156</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">784</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">923</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">46</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34156</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">830</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">923</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">24</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34156</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">854</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">923</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34156</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">923</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">855</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span>
</code></pre></div></td></tr></table></div></p>
<p>When changing to the following:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code>frontend fe_h2 
    mode http 
    bind *:8085 ssl crt /etc/haproxy/certs/pem alpn h2,http/1.1 
    default_backend be_h2 

backend be_h2 
    mode http 
    server server1 10.88.0.123:8082 ssl verify none alpn h2,http/1.1
</code></pre></div></td></tr></table></div></p>
<p>We can see that haproxy will send both options to the server in its offer:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@ef82916a0181 /</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">tshark</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">eth0</span><span class="w"> </span><span class="o">-</span><span class="n">O</span><span class="w"> </span><span class="n">tls</span><span class="w">  </span><span class="k">host</span><span class="w"> </span><span class="mf">10.88.0.123</span><span class="w">  </span><span class="o">|</span><span class="w"> </span><span class="n">egrep</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="s1">&#39;application_layer_protocol_negotiation|alpn|Transmission Control Protocol&#39;</span>
<span class="n">Running</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="ss">&quot;root&quot;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">group</span><span class="w"> </span><span class="ss">&quot;root&quot;</span><span class="p">.</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">could</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">dangerous</span><span class="p">.</span>
<span class="n">Capturing</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="s1">&#39;eth0&#39;</span>
<span class="mi">22</span><span class="w"> </span><span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34182</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34182</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34182</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34182</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">517</span>
<span class="w">            </span><span class="nl">Extension</span><span class="p">:</span><span class="w"> </span><span class="n">application_layer_protocol_negotiation</span><span class="w"> </span><span class="p">(</span><span class="nf">len</span><span class="o">=</span><span class="mi">14</span><span class="p">)</span>
<span class="w">                </span><span class="nl">Type</span><span class="p">:</span><span class="w"> </span><span class="n">application_layer_protocol_negotiation</span><span class="w"> </span><span class="p">(</span><span class="mi">16</span><span class="p">)</span>
<span class="w">                </span><span class="n">ALPN</span><span class="w"> </span><span class="n">Extension</span><span class="w"> </span><span class="nl">Length</span><span class="p">:</span><span class="w"> </span><span class="mi">12</span>
<span class="w">                </span><span class="n">ALPN</span><span class="w"> </span><span class="n">Protocol</span>
<span class="w">                    </span><span class="n">ALPN</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="nl">length</span><span class="p">:</span><span class="w"> </span><span class="mi">2</span>
<span class="w">                    </span><span class="n">ALPN</span><span class="w"> </span><span class="k">Next</span><span class="w"> </span><span class="nl">Protocol</span><span class="p">:</span><span class="w"> </span><span class="n">h2</span>
<span class="w">                    </span><span class="n">ALPN</span><span class="w"> </span><span class="n">string</span><span class="w"> </span><span class="nl">length</span><span class="p">:</span><span class="w"> </span><span class="mi">8</span>
<span class="w">                    </span><span class="n">ALPN</span><span class="w"> </span><span class="k">Next</span><span class="w"> </span><span class="nl">Protocol</span><span class="p">:</span><span class="w"> </span><span class="n">http</span><span class="o">/</span><span class="mf">1.1</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34182</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">518</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34182</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">518</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">1521</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34182</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">518</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">1522</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34182</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">518</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">1522</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">80</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34182</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">598</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">1522</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">67</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34182</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">1522</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">665</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34182</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">1522</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">665</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">287</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34182</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">1809</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">665</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">287</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34182</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">2096</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">665</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">59</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34182</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">665</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">2155</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34182</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">665</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">2155</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">31</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34182</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">696</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">2155</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">95</span>
<span class="mi">30</span><span class="w"> </span><span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34182</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">2155</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">791</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34182</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">2155</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">791</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">159</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34182</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">2314</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">791</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">50</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34182</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">791</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">2364</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34182</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">791</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">2364</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">48</span>
<span class="n">Transmission</span><span class="w"> </span><span class="n">Control</span><span class="w"> </span><span class="n">Protocol</span><span class="p">,</span><span class="w"> </span><span class="n">Src</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">8082</span><span class="p">,</span><span class="w"> </span><span class="n">Dst</span><span class="w"> </span><span class="nl">Port</span><span class="p">:</span><span class="w"> </span><span class="mi">34182</span><span class="p">,</span><span class="w"> </span><span class="nl">Seq</span><span class="p">:</span><span class="w"> </span><span class="mi">2364</span><span class="p">,</span><span class="w"> </span><span class="nl">Ack</span><span class="p">:</span><span class="w"> </span><span class="mi">839</span><span class="p">,</span><span class="w"> </span><span class="nf">Len</span><span class="err">:</span><span class="w"> </span><span class="mi">0</span>
</code></pre></div></td></tr></table></div></p>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">March 15, 2021</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.prune", "navigation.top", "navigation.path", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.f886a092.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.d7c377c4.min.js"></script>
      
    
  </body>
</html>