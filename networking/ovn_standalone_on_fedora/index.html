
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Andreas Karis' blog about anything Kubernetes, OpenShift, Linux and Networking">
      
      
      
        <link rel="canonical" href="https://andreaskaris.github.io/blog/networking/ovn_standalone_on_fedora/">
      
      
        <link rel="prev" href="../netlink-address-fields/">
      
      
        <link rel="next" href="../ovs_recirculation/">
      
      
        <link rel="alternate" type="application/rss+xml" title="RSS feed" href="../../feed_rss_created.xml">
        <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="../../feed_rss_updated.xml">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.50">
    
    
      
        <title>OVN standalone on Fedora - Andreas Karis Blog</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.a40c8224.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <!-- RSS Feed -->
  <link rel="alternate" type="application/rss+xml" title="RSS feed of created content" href="https://andreaskaris.github.io/blog/feed_rss_created.xml">
  <link rel="alternate" type="application/rss+xml" title="RSS feed of updated content" href="https://andreaskaris.github.io/blog/feed_rss_updated.xml">

  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="pink">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ovn-standalone-on-fedora" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Andreas Karis Blog" class="md-header__button md-logo" aria-label="Andreas Karis Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Andreas Karis Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              OVN standalone on Fedora
            
          </span>
        </div>
      </div>
    </div>
    
      
    
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../ceph/" class="md-tabs__link">
          
  
    
  
  Ceph

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../linux/" class="md-tabs__link">
          
  
    
  
  Linux

        </a>
      </li>
    
  

      
        
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../" class="md-tabs__link">
          
  
    
  
  Networking

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../openshift/" class="md-tabs__link">
          
  
    
  
  OpenShift and Kubernetes

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../openstack/" class="md-tabs__link">
          
  
    
  
  OpenStack

        </a>
      </li>
    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../coding/" class="md-tabs__link">
          
  
    
  
  Coding

        </a>
      </li>
    
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
  
    
    <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner">
          


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Andreas Karis Blog" class="md-nav__button md-logo" aria-label="Andreas Karis Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Andreas Karis Blog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../ceph/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Ceph
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../linux/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Linux
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
        
        
      
      
        
      
    
    
      
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Networking
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_4" id="__nav_4_label" tabindex="">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Networking
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../accept-source-routing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accept Source Routing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../arp_and_the_neighbor_table/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ARP and the Neighbor table
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bpf-and-tcpdump/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    BPF and tcpdump
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../bonding_in_linux/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bonding in Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../juniper_x520/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Configure Juniper switch
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ovn-interconnection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Hands-on with OVN Interconnection
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../haproxy-and-h2c/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    haproxy and HTTP/2
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../install-openvswitch-on-rocky/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Install Open vSwitch on Rocky Linux 8
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../geneve_tunneling/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Geneve tunneling
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../netlink/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Netlink
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../netlink-address-fields/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Netlink and MAC addresses
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    OVN standalone on Fedora
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    OVN standalone on Fedora
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#base-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Base setup
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Base setup">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#single-node-db-on-ovn1" class="md-nav__link">
    <span class="md-ellipsis">
      Single node DB on ovn1
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-persistent-namespace-setup" class="md-nav__link">
    <span class="md-ellipsis">
      Adding persistent namespace setup
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-virtual-network-with-one-virtual-switch-s0" class="md-nav__link">
    <span class="md-ellipsis">
      Adding virtual network with one virtual switch s0
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-virtual-network-with-one-virtual-switch-s1" class="md-nav__link">
    <span class="md-ellipsis">
      Adding virtual network with one virtual switch s1
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-virtual-router-r1" class="md-nav__link">
    <span class="md-ellipsis">
      Adding virtual router r1 ##
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adding virtual router r1 ##">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduction" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup" class="md-nav__link">
    <span class="md-ellipsis">
      Setup
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#adding-external-gateway-router-non-distributed" class="md-nav__link">
    <span class="md-ellipsis">
      Adding external gateway router, non-distributed
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adding external gateway router, non-distributed">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduction_1" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#setup_1" class="md-nav__link">
    <span class="md-ellipsis">
      Setup
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#inspecting-tunnel-encapsulations" class="md-nav__link">
    <span class="md-ellipsis">
      Inspecting tunnel encapsulations
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Inspecting tunnel encapsulations">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#introduction_2" class="md-nav__link">
    <span class="md-ellipsis">
      Introduction
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#distributed-gateway-router" class="md-nav__link">
    <span class="md-ellipsis">
      Distributed gateway router
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#resources" class="md-nav__link">
    <span class="md-ellipsis">
      Resources
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ovs_recirculation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OVS packet recirculation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ovs-vxlan-tunnels-and-dscp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OVS VXLAN tunnels and DSCP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../ovs_with_gdb/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    OVS with GDB
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../packet-tracing-with-ovn/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Packet tracing with OVN
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rss-irq-affinity-and-rps/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    RSS, IRQ affinity and RPS on Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../sctp/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SCTP
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../setting-cos-on-egress/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Setting COS on outgoing packets in Linux
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../useful-commands/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Useful commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../wireguard/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Wireguard
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../openshift/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    OpenShift and Kubernetes
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../openstack/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    OpenStack
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
    
    
      
      
        
      
    
    
      
        
        
      
    
    <li class="md-nav__item md-nav__item--pruned md-nav__item--nested">
      
        
  
  
    <a href="../../coding/" class="md-nav__link">
      
  
  <span class="md-ellipsis">
    Coding
  </span>
  

      
        <span class="md-nav__icon md-icon"></span>
      
    </a>
  

      
    </li>
  

    
  </ul>
</nav>
        </div>
      </div>
    </div>
  
  

          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<h1 id="ovn-standalone-on-fedora">OVN standalone on Fedora</h1>
<h2 id="base-setup">Base setup</h2>
<h3 id="single-node-db-on-ovn1">Single node DB on ovn1</h3>
<h4 id="configuration-and-installation">Configuration and installation</h4>
<p>For this tutorial, I am using Fedora 42.</p>
<p>First, we will set up 3 virtual machines. The OVN database will be non-clustered with ovn1 as the database node, and ovn2 and ovn3 will join ovn1's DB.</p>
<p>All nodes have 2 interfaces. One management interface on enp1s0. DNS names ovn1, ovn2, ovn3 map to the IP addresses on enp1s0. Interface enp2s0 has no IP addresses and will be used for the dataplane (attached to br-provider).</p>
<p>IP address configuration:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code>declare<span class="w"> </span>-A<span class="w"> </span>hostnameIPs
hostnameIPs=(<span class="w"> </span>[&quot;ovn1&quot;]=&quot;192.168.122.182/24&quot;<span class="w"> </span>[&quot;ovn2&quot;]=&quot;192.168.122.159/24&quot;<span class="w"> </span>[&quot;ovn3&quot;]=&quot;192.168.122.107/24&quot;<span class="w"> </span>)
echo<span class="w"> </span>&quot;Setting<span class="w"> </span>IP<span class="w"> </span>address<span class="w"> </span>to<span class="w"> </span><span class="cp">${</span><span class="n">hostnameIPs</span><span class="p">[</span><span class="err">$</span><span class="p">(</span><span class="n">hostname</span><span class="p">)]</span><span class="cp">}</span>&quot;
nmcli<span class="w"> </span>conn<span class="w"> </span>mod<span class="w"> </span>&quot;Wired<span class="w"> </span>connection<span class="w"> </span>1&quot;<span class="w"> </span>connection.id<span class="w"> </span>enp1s0
nmcli<span class="w"> </span>conn<span class="w"> </span>mod<span class="w"> </span>enp1s0<span class="w"> </span>ipv4.method<span class="w"> </span>manual<span class="w"> </span>ipv4.dns<span class="w"> </span>192.168.122.1<span class="w"> </span>ipv4.gateway<span class="w"> </span>192.168.122.1<span class="w"> </span>ipv4.addresses<span class="w"> </span><span class="cp">${</span><span class="n">hostnameIPs</span><span class="p">[</span><span class="err">$</span><span class="p">(</span><span class="n">hostname</span><span class="p">)]</span><span class="cp">}</span><span class="w"> </span>ipv6.method<span class="w"> </span>disabled
nmcli<span class="w"> </span>conn<span class="w"> </span>mod<span class="w"> </span>&quot;Wired<span class="w"> </span>connection<span class="w"> </span>2&quot;<span class="w"> </span>connection.id<span class="w"> </span>enp2s0
nmcli<span class="w"> </span>conn<span class="w"> </span>mod<span class="w"> </span>enp2s0<span class="w"> </span>ipv4.method<span class="w"> </span>disabled<span class="w"> </span>ipv6.method<span class="w"> </span>disabled
systemctl<span class="w"> </span>restart<span class="w"> </span>NetworkManager
</code></pre></div></td></tr></table></div></p>
<p>Hostname to IP address mapping:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code>cat &lt;&lt;EOF &gt;&gt; /etc/hosts

192.168.122.182 ovn1
192.168.122.159 ovn2
192.168.122.107 ovn3
EOF
</code></pre></div></td></tr></table></div></p>
<p>Install Open vSwitch on all nodes. In this case, I built newest upstream from source. But it is also possible (and
easier) to use the package manager of the given distribution.
See https://docs.openvswitch.org/en/latest/intro/install/</p>
<p>Install OVN on all nodes. I built the newest upstream from source. But it is also possible (and easier) to use
the package manager of the given distribution.
See https://docs.ovn.org/en/latest/intro/install/fedora.html</p>
<p>and OVN on all nodes:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code>yum install ovn -y
yum install ovn-central -y
yum install ovn-host -y
</code></pre></div></td></tr></table></div></p>
<p>Enable Open vSwitch and ovn-controller on all hosts and start right away:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>systemctl enable --now openvswitch
systemctl enable --now ovn-controller
</code></pre></div></td></tr></table></div></p>
<p>ovn1 is going to be our control plane node for the cluster. Execute on ovn1:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nx">echo</span><span class="w"> </span><span class="err">&#39;</span><span class="nx">OVN_NORTHD_OPTS</span><span class="p">=</span><span class="s">&quot;--db-nb-addr=ovn1 --db-nb-create-insecure-remote=yes --db-sb-addr=ovn1  --db-sb-create-insecure-remote=yes  --db-nb-cluster-local-addr=ovn1 --db-sb-cluster-local-addr=ovn1 --ovn-northd-nb-db=tcp:ovn1:6641 --ovn-northd-sb-db=tcp:ovn1:6642&quot;</span><span class="err">&#39;</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="o">/</span><span class="nx">etc</span><span class="o">/</span><span class="nx">sysconfig</span><span class="o">/</span><span class="nx">ovn</span>
<span class="nx">systemctl</span><span class="w"> </span><span class="nx">enable</span><span class="w"> </span><span class="o">--</span><span class="nx">now</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="nx">northd</span>
</code></pre></div></td></tr></table></div></p>
<p>Note that the above will start a single node cluster. The OVN man page contains an example for a full 3 node clustered DB: https://www.ovn.org/support/dist-docs/ovn-ctl.8.txt</p>
<p>Now, configure OVS to connect to the OVN DBs. Note that geneve / vxlan tunnel must be set to the IP address of the respective
node itself; DNS entries do not work:</p>
<p>On control-plane node ovn1:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">ovn1</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span>
<span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">open</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="kd">external</span><span class="o">-</span><span class="nx">ids</span><span class="p">:</span><span class="nx">ovn</span><span class="o">-</span><span class="nx">remote</span><span class="p">=</span><span class="nx">tcp</span><span class="p">:</span><span class="nx">ovn1</span><span class="p">:</span><span class="mi">6642</span>
<span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">open</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="kd">external</span><span class="o">-</span><span class="nx">ids</span><span class="p">:</span><span class="nx">ovn</span><span class="o">-</span><span class="nx">encap</span><span class="o">-</span><span class="k">type</span><span class="p">=</span><span class="nx">geneve</span>
<span class="err">#</span><span class="w"> </span><span class="nx">could</span><span class="w"> </span><span class="nx">also</span><span class="w"> </span><span class="nx">be</span><span class="p">:</span><span class="w"> </span><span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">open</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="kd">external</span><span class="o">-</span><span class="nx">ids</span><span class="p">:</span><span class="nx">ovn</span><span class="o">-</span><span class="nx">encap</span><span class="o">-</span><span class="k">type</span><span class="p">=</span><span class="nx">geneve</span><span class="p">,</span><span class="nx">vxlan</span>
<span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">open</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="kd">external</span><span class="o">-</span><span class="nx">ids</span><span class="p">:</span><span class="nx">ovn</span><span class="o">-</span><span class="nx">encap</span><span class="o">-</span><span class="nx">ip</span><span class="p">=</span><span class="m m-Double">192.168.122.182</span>
<span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">open</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="kd">external</span><span class="o">-</span><span class="nx">ids</span><span class="p">:</span><span class="nx">ovn</span><span class="o">-</span><span class="nx">bridge</span><span class="p">=</span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span>
</code></pre></div></td></tr></table></div>
<p>On node ovn2:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">ovn2</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span>
<span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">open</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="kd">external</span><span class="o">-</span><span class="nx">ids</span><span class="p">:</span><span class="nx">ovn</span><span class="o">-</span><span class="nx">remote</span><span class="p">=</span><span class="nx">tcp</span><span class="p">:</span><span class="nx">ovn1</span><span class="p">:</span><span class="mi">6642</span>
<span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">open</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="kd">external</span><span class="o">-</span><span class="nx">ids</span><span class="p">:</span><span class="nx">ovn</span><span class="o">-</span><span class="nx">encap</span><span class="o">-</span><span class="k">type</span><span class="p">=</span><span class="nx">geneve</span>
<span class="err">#</span><span class="w"> </span><span class="nx">could</span><span class="w"> </span><span class="nx">also</span><span class="w"> </span><span class="nx">be</span><span class="p">:</span><span class="w"> </span><span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">open</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="kd">external</span><span class="o">-</span><span class="nx">ids</span><span class="p">:</span><span class="nx">ovn</span><span class="o">-</span><span class="nx">encap</span><span class="o">-</span><span class="k">type</span><span class="p">=</span><span class="nx">geneve</span><span class="p">,</span><span class="nx">vxlan</span>
<span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">open</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="kd">external</span><span class="o">-</span><span class="nx">ids</span><span class="p">:</span><span class="nx">ovn</span><span class="o">-</span><span class="nx">encap</span><span class="o">-</span><span class="nx">ip</span><span class="p">=</span><span class="m m-Double">192.168.122.159</span>
<span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">open</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="kd">external</span><span class="o">-</span><span class="nx">ids</span><span class="p">:</span><span class="nx">ovn</span><span class="o">-</span><span class="nx">bridge</span><span class="p">=</span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span>
</code></pre></div></td></tr></table></div>
<p>On node ovn3:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="err">#</span><span class="w"> </span><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">ovn3</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span>
<span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">open</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="kd">external</span><span class="o">-</span><span class="nx">ids</span><span class="p">:</span><span class="nx">ovn</span><span class="o">-</span><span class="nx">remote</span><span class="p">=</span><span class="nx">tcp</span><span class="p">:</span><span class="nx">ovn1</span><span class="p">:</span><span class="mi">6642</span>
<span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">open</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="kd">external</span><span class="o">-</span><span class="nx">ids</span><span class="p">:</span><span class="nx">ovn</span><span class="o">-</span><span class="nx">encap</span><span class="o">-</span><span class="k">type</span><span class="p">=</span><span class="nx">geneve</span>
<span class="err">#</span><span class="w"> </span><span class="nx">could</span><span class="w"> </span><span class="nx">also</span><span class="w"> </span><span class="nx">be</span><span class="p">:</span><span class="w"> </span><span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">open</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="kd">external</span><span class="o">-</span><span class="nx">ids</span><span class="p">:</span><span class="nx">ovn</span><span class="o">-</span><span class="nx">encap</span><span class="o">-</span><span class="k">type</span><span class="p">=</span><span class="nx">geneve</span><span class="p">,</span><span class="nx">vxlan</span>
<span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">open</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="kd">external</span><span class="o">-</span><span class="nx">ids</span><span class="p">:</span><span class="nx">ovn</span><span class="o">-</span><span class="nx">encap</span><span class="o">-</span><span class="nx">ip</span><span class="p">=</span><span class="m m-Double">192.168.122.107</span>
<span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">open</span><span class="w"> </span><span class="p">.</span><span class="w"> </span><span class="kd">external</span><span class="o">-</span><span class="nx">ids</span><span class="p">:</span><span class="nx">ovn</span><span class="o">-</span><span class="nx">bridge</span><span class="p">=</span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span>
</code></pre></div></td></tr></table></div>
<h4 id="verification">Verification</h4>
<p>Verify on ovn1 with:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nv">ovs</span><span class="o">-</span><span class="nv">vsctl</span><span class="w"> </span><span class="k">show</span>
<span class="nv">ovn</span><span class="o">-</span><span class="nv">sbctl</span><span class="w"> </span><span class="k">show</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">ovn1</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">show</span>
<span class="mi">1717</span><span class="nx">f06c</span><span class="o">-</span><span class="nx">b2be</span><span class="o">-</span><span class="mi">42</span><span class="nx">f0</span><span class="o">-</span><span class="mi">99</span><span class="nx">c2</span><span class="o">-</span><span class="mi">5081333</span><span class="nx">e6ebb</span>
<span class="w">    </span><span class="nx">Bridge</span><span class="w"> </span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span>
<span class="w">        </span><span class="nx">fail_mode</span><span class="p">:</span><span class="w"> </span><span class="nx">secure</span>
<span class="w">        </span><span class="nx">datapath_type</span><span class="p">:</span><span class="w"> </span><span class="nx">system</span>
<span class="w">        </span><span class="nx">Port</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="mi">8</span><span class="nx">de4d5</span><span class="o">-</span><span class="mi">0</span>
<span class="w">            </span><span class="nx">Interface</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="mi">8</span><span class="nx">de4d5</span><span class="o">-</span><span class="mi">0</span>
<span class="w">                </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">                </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">key</span><span class="p">=</span><span class="nx">flow</span><span class="p">,</span><span class="w"> </span><span class="nx">local_ip</span><span class="p">=</span><span class="s">&quot;192.168.122.182&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">remote_ip</span><span class="p">=</span><span class="s">&quot;192.168.122.107&quot;</span><span class="p">}</span>
<span class="w">        </span><span class="nx">Port</span><span class="w"> </span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span>
<span class="w">            </span><span class="nx">Interface</span><span class="w"> </span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span>
<span class="w">                </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">internal</span>
<span class="w">        </span><span class="nx">Port</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="mi">108</span><span class="nx">c2b</span><span class="o">-</span><span class="mi">0</span>
<span class="w">            </span><span class="nx">Interface</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="mi">108</span><span class="nx">c2b</span><span class="o">-</span><span class="mi">0</span>
<span class="w">                </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">                </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">key</span><span class="p">=</span><span class="nx">flow</span><span class="p">,</span><span class="w"> </span><span class="nx">local_ip</span><span class="p">=</span><span class="s">&quot;192.168.122.182&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">remote_ip</span><span class="p">=</span><span class="s">&quot;192.168.122.159&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="nx">ovs_version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3.5.90-1.fc42&quot;</span>
<span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">ovn1</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="nx">sbctl</span><span class="w"> </span><span class="nx">show</span>
<span class="nx">Chassis</span><span class="w"> </span><span class="s">&quot;108c2b72-5ab9-43a0-9617-55f23f16482a&quot;</span>
<span class="w">    </span><span class="nx">hostname</span><span class="p">:</span><span class="w"> </span><span class="nx">ovn2</span>
<span class="w">    </span><span class="nx">Encap</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">        </span><span class="nx">ip</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.122.159&quot;</span>
<span class="w">        </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">}</span>
<span class="nx">Chassis</span><span class="w"> </span><span class="s">&quot;8de4d500-ab50-4ecc-a6df-3b5387efdf81&quot;</span>
<span class="w">    </span><span class="nx">hostname</span><span class="p">:</span><span class="w"> </span><span class="nx">ovn3</span>
<span class="w">    </span><span class="nx">Encap</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">        </span><span class="nx">ip</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.122.107&quot;</span>
<span class="w">        </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">}</span>
<span class="nx">Chassis</span><span class="w"> </span><span class="s">&quot;dacba18d-52f9-4adb-8b3d-8ca27b700a73&quot;</span>
<span class="w">    </span><span class="nx">hostname</span><span class="p">:</span><span class="w"> </span><span class="nx">ovn1</span>
<span class="w">    </span><span class="nx">Encap</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">        </span><span class="nx">ip</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.122.182&quot;</span>
<span class="w">        </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>On ovn2 and ovn3, only chick with <code class="highlight"><span class="nv">ovs</span><span class="o">-</span><span class="nv">vsctl</span><span class="w"> </span><span class="k">show</span></code>.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">ovn2</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">show</span>
<span class="mi">5692</span><span class="nx">cb1b</span><span class="o">-</span><span class="nx">bc2c</span><span class="o">-</span><span class="mi">4</span><span class="nx">c9d</span><span class="o">-</span><span class="nx">a9c7</span><span class="o">-</span><span class="mi">9001</span><span class="nx">e293d013</span>
<span class="w">    </span><span class="nx">Bridge</span><span class="w"> </span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span>
<span class="w">        </span><span class="nx">fail_mode</span><span class="p">:</span><span class="w"> </span><span class="nx">secure</span>
<span class="w">        </span><span class="nx">datapath_type</span><span class="p">:</span><span class="w"> </span><span class="nx">system</span>
<span class="w">        </span><span class="nx">Port</span><span class="w"> </span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span>
<span class="w">            </span><span class="nx">Interface</span><span class="w"> </span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span>
<span class="w">                </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">internal</span>
<span class="w">        </span><span class="nx">Port</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="mi">8</span><span class="nx">de4d5</span><span class="o">-</span><span class="mi">0</span>
<span class="w">            </span><span class="nx">Interface</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="mi">8</span><span class="nx">de4d5</span><span class="o">-</span><span class="mi">0</span>
<span class="w">                </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">                </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">key</span><span class="p">=</span><span class="nx">flow</span><span class="p">,</span><span class="w"> </span><span class="nx">local_ip</span><span class="p">=</span><span class="s">&quot;192.168.122.159&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">remote_ip</span><span class="p">=</span><span class="s">&quot;192.168.122.107&quot;</span><span class="p">}</span>
<span class="w">        </span><span class="nx">Port</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="nx">dacba1</span><span class="o">-</span><span class="mi">0</span>
<span class="w">            </span><span class="nx">Interface</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="nx">dacba1</span><span class="o">-</span><span class="mi">0</span>
<span class="w">                </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">                </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">key</span><span class="p">=</span><span class="nx">flow</span><span class="p">,</span><span class="w"> </span><span class="nx">local_ip</span><span class="p">=</span><span class="s">&quot;192.168.122.159&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">remote_ip</span><span class="p">=</span><span class="s">&quot;192.168.122.182&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="nx">ovs_version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3.5.90-1.fc42&quot;</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">ovn3</span><span class="w"> </span><span class="nx">ovn</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">show</span>
<span class="mi">53739</span><span class="nx">cb0</span><span class="o">-</span><span class="mi">98</span><span class="nx">fa</span><span class="o">-</span><span class="mi">4173</span><span class="o">-</span><span class="nx">a81f</span><span class="o">-</span><span class="mi">547</span><span class="nx">f39528225</span>
<span class="w">    </span><span class="nx">Bridge</span><span class="w"> </span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span>
<span class="w">        </span><span class="nx">fail_mode</span><span class="p">:</span><span class="w"> </span><span class="nx">secure</span>
<span class="w">        </span><span class="nx">datapath_type</span><span class="p">:</span><span class="w"> </span><span class="nx">system</span>
<span class="w">        </span><span class="nx">Port</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="mi">108</span><span class="nx">c2b</span><span class="o">-</span><span class="mi">0</span>
<span class="w">            </span><span class="nx">Interface</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="mi">108</span><span class="nx">c2b</span><span class="o">-</span><span class="mi">0</span>
<span class="w">                </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">                </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">key</span><span class="p">=</span><span class="nx">flow</span><span class="p">,</span><span class="w"> </span><span class="nx">local_ip</span><span class="p">=</span><span class="s">&quot;192.168.122.107&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">remote_ip</span><span class="p">=</span><span class="s">&quot;192.168.122.159&quot;</span><span class="p">}</span>
<span class="w">        </span><span class="nx">Port</span><span class="w"> </span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span>
<span class="w">            </span><span class="nx">Interface</span><span class="w"> </span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span>
<span class="w">                </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">internal</span>
<span class="w">        </span><span class="nx">Port</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="nx">dacba1</span><span class="o">-</span><span class="mi">0</span>
<span class="w">            </span><span class="nx">Interface</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="nx">dacba1</span><span class="o">-</span><span class="mi">0</span>
<span class="w">                </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">                </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">key</span><span class="p">=</span><span class="nx">flow</span><span class="p">,</span><span class="w"> </span><span class="nx">local_ip</span><span class="p">=</span><span class="s">&quot;192.168.122.107&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">remote_ip</span><span class="p">=</span><span class="s">&quot;192.168.122.182&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="nx">ovs_version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3.5.90-1.fc42&quot;</span>
</code></pre></div></td></tr></table></div>
<p>You can also run <code class="highlight">ovn-appctl connection-status</code> which should yield <code class="highlight">connected</code> on each host.</p>
<h2 id="adding-persistent-namespace-setup">Adding persistent namespace setup</h2>
<p>If we want our test setup to survive reboots, we must make our namespaces persistent. The following will run namespace
setup once on a reboot.</p>
<p>Run this on all nodes:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="na">mkdir /opt/ns-setup</span>
<span class="na">cat &lt;&lt;&#39;EOF&#39; &gt; /etc/systemd/system/ns-setup.service</span>
<span class="na">[Unit]</span>
<span class="na">Description</span><span class="o">=</span><span class="s">Run all NS setup scripts inside /opt/ns-setup</span>
<span class="na">After</span><span class="o">=</span><span class="s">network-online.target</span>
<span class="na">Wants</span><span class="o">=</span><span class="s">network-online.target</span>

<span class="k">[Service]</span>
<span class="na">Type</span><span class="o">=</span><span class="s">oneshot</span>
<span class="na">ExecStart</span><span class="o">=</span><span class="s">/bin/bash -c &#39;for f in /opt/ns-setup/*; do $f; done&#39;</span>
<span class="na">RemainAfterExit</span><span class="o">=</span><span class="s">no</span>

<span class="k">[Install]</span>
<span class="na">WantedBy</span><span class="o">=</span><span class="s">multi-user.target</span>
<span class="err">EOF</span>
<span class="err">systemctl daemon-reload</span>
<span class="err">systemctl enable ns-setup</span>
</code></pre></div></td></tr></table></div>
<p>Note, if SELinux is enabled, this will fail because my scripts below create the namespace directly inside bash with
<code class="highlight">ip netns add</code>. You'd see the following:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code># journalctl -u ns-setup | grep mount
Jun 26 15:33:56 ovn3 bash[118808]: mount of /sys failed: Permission denied
</code></pre></div></td></tr></table></div>
<p>If this is the case, have it fail once (to log an error in /var/log/audit/audit.log) and then run:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">grep</span><span class="w"> </span><span class="s2">&quot;avc.*denied.*mounton.*ifconfig.*mock_var_lib_t&quot;</span><span class="w"> </span><span class="o">/</span><span class="k">var</span><span class="o">/</span><span class="nb">log</span><span class="o">/</span><span class="n">audit</span><span class="o">/</span><span class="n">audit</span><span class="o">.</span><span class="n">log</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">audit2allow</span><span class="w"> </span><span class="o">-</span><span class="n">M</span><span class="w"> </span><span class="n">netns_fix</span>
<span class="n">semodule</span><span class="w"> </span><span class="o">-</span><span class="n">i</span><span class="w"> </span><span class="n">netns_fix</span><span class="o">.</span><span class="n">pp</span>
</code></pre></div></td></tr></table></div>
<h2 id="adding-virtual-network-with-one-virtual-switch-s0">Adding virtual network with one virtual switch s0</h2>
<p>On ovn1, configure a logical switch and port:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">ls</span><span class="o">-</span><span class="nx">add</span><span class="w"> </span><span class="nx">s0</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">add</span><span class="w"> </span><span class="nx">s0</span><span class="w"> </span><span class="nx">port01</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">set</span><span class="o">-</span><span class="nx">addresses</span><span class="w"> </span><span class="nx">port01</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">add</span><span class="w"> </span><span class="nx">s0</span><span class="w"> </span><span class="nx">port02</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">set</span><span class="o">-</span><span class="nx">addresses</span><span class="w"> </span><span class="nx">port02</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">02</span>
</code></pre></div></td></tr></table></div></p>
<p>Now, "real" ports need to be wired to the above ports. Note that the logical port name has to match the <code class="highlight"><span class="n">external_ids</span><span class="o">:</span><span class="n">iface</span><span class="o">-</span><span class="n">id</span></code> identifier. If we added  <code class="highlight">ovn-nbctl lsp-add s0 foo</code> instead of <code class="highlight">port01</code> then we would have to set <code class="highlight">ovs-vsctl set Interface port01 external_ids:iface-id=foo</code> on ovn2. Note that we need to know the MAC address of that port. Therefore, when creating the veth, we are making sure to create it with the correct MAC address.</p>
<p>On ovn2, execute:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nx">cat</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="nx">EOF</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="o">/</span><span class="nx">opt</span><span class="o">/</span><span class="nx">ns</span><span class="o">-</span><span class="nx">setup</span><span class="o">/</span><span class="nx">ns0</span><span class="p">.</span><span class="nx">sh</span>
<span class="err">#</span><span class="p">!</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">bash</span><span class="w"> </span><span class="o">-</span><span class="nx">eux</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="nx">veth1</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="nx">veth</span><span class="w"> </span><span class="nx">peer</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="nx">port01</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">ns0</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">dev</span><span class="w"> </span><span class="nx">veth1</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">ns0</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">exec</span><span class="w"> </span><span class="nx">ns0</span><span class="w"> </span><span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">dev</span><span class="w"> </span><span class="nx">lo</span><span class="w"> </span><span class="nx">up</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">exec</span><span class="w"> </span><span class="nx">ns0</span><span class="w"> </span><span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">dev</span><span class="w"> </span><span class="nx">veth1</span><span class="w"> </span><span class="nx">up</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">exec</span><span class="w"> </span><span class="nx">ns0</span><span class="w"> </span><span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">veth1</span><span class="w"> </span><span class="nx">address</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">exec</span><span class="w"> </span><span class="nx">ns0</span><span class="w"> </span><span class="nx">ip</span><span class="w"> </span><span class="nx">address</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="m m-Double">10.0.0.1</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="nx">dev</span><span class="w"> </span><span class="nx">veth1</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">dev</span><span class="w"> </span><span class="nx">port01</span><span class="w"> </span><span class="nx">up</span>
<span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">add</span><span class="o">-</span><span class="nx">port</span><span class="w"> </span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span><span class="w"> </span><span class="nx">port01</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="kc">true</span>
<span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">Interface</span><span class="w"> </span><span class="nx">port01</span><span class="w"> </span><span class="nx">external_ids</span><span class="p">:</span><span class="nx">iface</span><span class="o">-</span><span class="nx">id</span><span class="p">=</span><span class="nx">port01</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="kc">true</span>
<span class="nx">EOF</span>
<span class="nx">chmod</span><span class="w"> </span><span class="o">+</span><span class="nx">x</span><span class="w"> </span><span class="o">/</span><span class="nx">opt</span><span class="o">/</span><span class="nx">ns</span><span class="o">-</span><span class="nx">setup</span><span class="o">/</span><span class="nx">ns0</span><span class="p">.</span><span class="nx">sh</span>
</code></pre></div></td></tr></table></div></p>
<p>On ovn3, execute:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nx">cat</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="nx">EOF</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="o">/</span><span class="nx">opt</span><span class="o">/</span><span class="nx">ns</span><span class="o">-</span><span class="nx">setup</span><span class="o">/</span><span class="nx">ns0</span><span class="p">.</span><span class="nx">sh</span>
<span class="err">#</span><span class="p">!</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">bash</span><span class="w"> </span><span class="o">-</span><span class="nx">eux</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="nx">veth2</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="nx">veth</span><span class="w"> </span><span class="nx">peer</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="nx">port02</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">ns0</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">dev</span><span class="w"> </span><span class="nx">veth2</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">ns0</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">exec</span><span class="w"> </span><span class="nx">ns0</span><span class="w"> </span><span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">dev</span><span class="w"> </span><span class="nx">lo</span><span class="w"> </span><span class="nx">up</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">exec</span><span class="w"> </span><span class="nx">ns0</span><span class="w"> </span><span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">dev</span><span class="w"> </span><span class="nx">veth2</span><span class="w"> </span><span class="nx">up</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">exec</span><span class="w"> </span><span class="nx">ns0</span><span class="w"> </span><span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">veth2</span><span class="w"> </span><span class="nx">address</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">02</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">exec</span><span class="w"> </span><span class="nx">ns0</span><span class="w"> </span><span class="nx">ip</span><span class="w"> </span><span class="nx">address</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="m m-Double">10.0.0.2</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="nx">dev</span><span class="w"> </span><span class="nx">veth2</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">dev</span><span class="w"> </span><span class="nx">port02</span><span class="w"> </span><span class="nx">up</span>
<span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">add</span><span class="o">-</span><span class="nx">port</span><span class="w"> </span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span><span class="w"> </span><span class="nx">port02</span><span class="w"> </span><span class="nx">external_ids</span><span class="p">:</span><span class="nx">iface</span><span class="o">-</span><span class="nx">id</span><span class="p">=</span><span class="nx">port02</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="kc">true</span>
<span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">Interface</span><span class="w"> </span><span class="nx">port02</span><span class="w"> </span><span class="nx">external_ids</span><span class="p">:</span><span class="nx">iface</span><span class="o">-</span><span class="nx">id</span><span class="p">=</span><span class="nx">port02</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="kc">true</span>
<span class="nx">EOF</span>
<span class="nx">chmod</span><span class="w"> </span><span class="o">+</span><span class="nx">x</span><span class="w"> </span><span class="o">/</span><span class="nx">opt</span><span class="o">/</span><span class="nx">ns</span><span class="o">-</span><span class="nx">setup</span><span class="o">/</span><span class="nx">ns0</span><span class="p">.</span><span class="nx">sh</span>
</code></pre></div></td></tr></table></div></p>
<p>Verify the new configuration on ovn1:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nv">ovn</span><span class="o">-</span><span class="nv">nbctl</span><span class="w"> </span><span class="k">show</span>
<span class="nv">ovn</span><span class="o">-</span><span class="nv">sbctl</span><span class="w"> </span><span class="k">show</span>
</code></pre></div></td></tr></table></div></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">ovn1</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="nx">sbctl</span><span class="w"> </span><span class="nx">show</span>
<span class="nx">Chassis</span><span class="w"> </span><span class="s">&quot;108c2b72-5ab9-43a0-9617-55f23f16482a&quot;</span>
<span class="w">    </span><span class="nx">hostname</span><span class="p">:</span><span class="w"> </span><span class="nx">ovn2</span>
<span class="w">    </span><span class="nx">Encap</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">        </span><span class="nx">ip</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.122.159&quot;</span>
<span class="w">        </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="nx">Port_Binding</span><span class="w"> </span><span class="nx">port01</span>
<span class="nx">Chassis</span><span class="w"> </span><span class="s">&quot;8de4d500-ab50-4ecc-a6df-3b5387efdf81&quot;</span>
<span class="w">    </span><span class="nx">hostname</span><span class="p">:</span><span class="w"> </span><span class="nx">ovn3</span>
<span class="w">    </span><span class="nx">Encap</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">        </span><span class="nx">ip</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.122.107&quot;</span>
<span class="w">        </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="nx">Port_Binding</span><span class="w"> </span><span class="nx">port02</span>
<span class="nx">Chassis</span><span class="w"> </span><span class="s">&quot;dacba18d-52f9-4adb-8b3d-8ca27b700a73&quot;</span>
<span class="w">    </span><span class="nx">hostname</span><span class="p">:</span><span class="w"> </span><span class="nx">ovn1</span>
<span class="w">    </span><span class="nx">Encap</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">        </span><span class="nx">ip</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.122.182&quot;</span>
<span class="w">        </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">}</span>
<span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">ovn1</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">show</span>
<span class="nx">switch</span><span class="w"> </span><span class="mi">70</span><span class="nx">a89317</span><span class="o">-</span><span class="mi">1</span><span class="nx">bc0</span><span class="o">-</span><span class="mi">4</span><span class="nx">fcb</span><span class="o">-</span><span class="mi">825</span><span class="nx">d</span><span class="o">-</span><span class="nx">c93754a5a6ca</span><span class="w"> </span><span class="p">(</span><span class="nx">s0</span><span class="p">)</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">port01</span>
<span class="w">        </span><span class="nx">addresses</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;00:00:00:00:00:01&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">port02</span>
<span class="w">        </span><span class="nx">addresses</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;00:00:00:00:00:02&quot;</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
<blockquote>
<p><strong>Note:</strong> The southbound database now shows port bindings.</p>
</blockquote>
<p>You can also check the OVN Southbound logical flows:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="o">@</span><span class="n">ovn1</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="c1"># ovn-sbctl lflow-list</span>
<span class="n">Datapath</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;s0&quot;</span><span class="w"> </span><span class="p">(</span><span class="m">49345921</span><span class="o">-</span><span class="n">e4da</span><span class="m">-4816</span><span class="o">-</span><span class="n">bf85</span><span class="o">-</span><span class="n">b092efe8eb29</span><span class="p">)</span><span class="w">  </span><span class="n">Pipeline</span><span class="o">:</span><span class="w"> </span><span class="n">ingress</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(((</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">eth.src</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">01</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">outport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;port01&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="nf">is_chassis_resident</span><span class="p">(</span><span class="s">&quot;port01&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">flags.tunnel_rx</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">inport</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(((</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">eth.src</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">02</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">outport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;port02&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="nf">is_chassis_resident</span><span class="p">(</span><span class="s">&quot;port02&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">flags.tunnel_rx</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">inport</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">105</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(((</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">flags.tunnel_rx</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.src</span><span class="p">[</span><span class="m">40</span><span class="p">]),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">vlan.present</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">15</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">check_in_port_sec</span><span class="p">();</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_apply_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">15</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_apply_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_mirror</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_lookup_fdb</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_put_fdb</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">5</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_acl</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">$</span><span class="n">svc_monitor_mac</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">5</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_acl</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_lb</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(((</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">flags.tunnel_rx</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_lb</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">$</span><span class="n">svc_monitor_mac</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_lb</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.mcast</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_lb</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_rs</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_ra</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv2</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_lb</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">16</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_lb</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">7</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_stateful</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">115</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip.is_frag</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">19</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">ct_lb_mark</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">7</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_stateful</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_lb_mark</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">7</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_stateful</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">7</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_stateful</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">8</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_acl_hint</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">65535</span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">9</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_acl_eval</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">65535</span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">9</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_acl_eval</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">65532</span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_ra</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_rs</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv2</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg8</span><span class="p">[</span><span class="m">16</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">10</span><span class="p">(</span><span class="n">ls_in_acl_sample</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">11</span><span class="p">(</span><span class="n">ls_in_acl_action</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">12</span><span class="p">(</span><span class="n">ls_in_qos</span><span class="w">          </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">13</span><span class="p">(</span><span class="n">ls_in_lb_aff_check</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">14</span><span class="p">(</span><span class="n">ls_in_lb</span><span class="w">           </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">15</span><span class="p">(</span><span class="n">ls_in_lb_aff_learn</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">16</span><span class="p">(</span><span class="n">ls_in_pre_hairpin</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">17</span><span class="p">(</span><span class="n">ls_in_nat_hairpin</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">18</span><span class="p">(</span><span class="n">ls_in_hairpin</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">19</span><span class="p">(</span><span class="n">ls_in_acl_after_lb_eval</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">65532</span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_ra</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_rs</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv2</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg8</span><span class="p">[</span><span class="m">16</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">19</span><span class="p">(</span><span class="n">ls_in_acl_after_lb_eval</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">20</span><span class="p">(</span><span class="n">ls_in_acl_after_lb_sample</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">21</span><span class="p">(</span><span class="n">ls_in_acl_after_lb_action</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">22</span><span class="p">(</span><span class="n">ls_in_stateful</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">13</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_commit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">ct_mark.blocked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">ct_mark.allow_established</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">20</span><span class="p">];</span><span class="w"> </span><span class="n">ct_label.acl_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg2</span><span class="p">[</span><span class="m">16</span><span class="kc">..31</span><span class="p">];</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">22</span><span class="p">(</span><span class="n">ls_in_stateful</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">13</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_commit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">ct_mark.blocked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">ct_mark.allow_established</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">20</span><span class="p">];</span><span class="w"> </span><span class="n">ct_mark.obs_stage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg8</span><span class="p">[</span><span class="m">19</span><span class="kc">..20</span><span class="p">];</span><span class="w"> </span><span class="n">ct_mark.obs_collector_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg8</span><span class="p">[</span><span class="m">8</span><span class="kc">..15</span><span class="p">];</span><span class="w"> </span><span class="n">ct_label.obs_point_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg9</span><span class="p">;</span><span class="w"> </span><span class="n">ct_label.acl_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg2</span><span class="p">[</span><span class="m">16</span><span class="kc">..31</span><span class="p">];</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">22</span><span class="p">(</span><span class="n">ls_in_stateful</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">23</span><span class="p">(</span><span class="n">ls_in_arp_rsp</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">24</span><span class="p">(</span><span class="n">ls_in_dhcp_options</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">25</span><span class="p">(</span><span class="n">ls_in_dhcp_response</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">26</span><span class="p">(</span><span class="n">ls_in_dns_lookup</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">27</span><span class="p">(</span><span class="n">ls_in_dns_response</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">28</span><span class="p">(</span><span class="n">ls_in_external_port</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">$</span><span class="n">svc_monitor_mac</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">tcp</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">icmp</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">icmp6</span><span class="p">)),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="nf">handle_svc_check</span><span class="p">(</span><span class="n">inport</span><span class="p">);)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">70</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.mcast</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;_MC_flood&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">01</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;port01&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">02</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;port02&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">get_fdb</span><span class="p">(</span><span class="n">eth.dst</span><span class="p">);</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">30</span><span class="p">(</span><span class="n">ls_in_l2_unknown</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;none&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">30</span><span class="p">(</span><span class="n">ls_in_l2_unknown</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">output</span><span class="p">;)</span>
<span class="n">Datapath</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;s0&quot;</span><span class="w"> </span><span class="p">(</span><span class="m">49345921</span><span class="o">-</span><span class="n">e4da</span><span class="m">-4816</span><span class="o">-</span><span class="n">bf85</span><span class="o">-</span><span class="n">b092efe8eb29</span><span class="p">)</span><span class="w">  </span><span class="n">Pipeline</span><span class="o">:</span><span class="w"> </span><span class="n">egress</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_lookup_fdb</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_put_fdb</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_acl</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.src</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">$</span><span class="n">svc_monitor_mac</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_acl</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_lb</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.mcast</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_lb</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.src</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">$</span><span class="n">svc_monitor_mac</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_lb</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_rs</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_ra</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv2</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_lb</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">16</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_lb</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_stateful</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_lb_mark</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_stateful</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_stateful</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">5</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_acl_hint</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">65535</span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_acl_eval</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">65535</span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_acl_eval</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">65532</span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_ra</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_rs</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv2</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg8</span><span class="p">[</span><span class="m">16</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">7</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_acl_sample</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">8</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_acl_action</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">9</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_mirror</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">10</span><span class="p">(</span><span class="n">ls_out_qos</span><span class="w">         </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">11</span><span class="p">(</span><span class="n">ls_out_stateful</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">13</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_commit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">ct_mark.blocked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">ct_mark.allow_established</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">20</span><span class="p">];</span><span class="w"> </span><span class="n">ct_label.acl_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg2</span><span class="p">[</span><span class="m">16</span><span class="kc">..31</span><span class="p">];</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">11</span><span class="p">(</span><span class="n">ls_out_stateful</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">13</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_commit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">ct_mark.blocked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">ct_mark.allow_established</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">20</span><span class="p">];</span><span class="w"> </span><span class="n">ct_mark.obs_stage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg8</span><span class="p">[</span><span class="m">19</span><span class="kc">..20</span><span class="p">];</span><span class="w"> </span><span class="n">ct_mark.obs_collector_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg8</span><span class="p">[</span><span class="m">8</span><span class="kc">..15</span><span class="p">];</span><span class="w"> </span><span class="n">ct_label.obs_point_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg9</span><span class="p">;</span><span class="w"> </span><span class="n">ct_label.acl_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg2</span><span class="p">[</span><span class="m">16</span><span class="kc">..31</span><span class="p">];</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">11</span><span class="p">(</span><span class="n">ls_out_stateful</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">12</span><span class="p">(</span><span class="n">ls_out_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.mcast</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">15</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">12</span><span class="p">(</span><span class="n">ls_out_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">15</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">check_out_port_sec</span><span class="p">();</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">13</span><span class="p">(</span><span class="n">ls_out_apply_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">15</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">13</span><span class="p">(</span><span class="n">ls_out_apply_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">output</span><span class="p">;)</span>
</code></pre></div></td></tr></table></div>
<p>Last but not least, run a test ping between the namespaces on both hosts:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@ovn2 ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="n">netns</span><span class="w"> </span><span class="k">exec</span><span class="w"> </span><span class="n">ns0</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="o">-</span><span class="n">c1</span><span class="w"> </span><span class="o">-</span><span class="n">W1</span><span class="w"> </span><span class="mf">10.0.0.2</span>
<span class="n">PING</span><span class="w"> </span><span class="mf">10.0.0.2</span><span class="w"> </span><span class="p">(</span><span class="mf">10.0.0.2</span><span class="p">)</span><span class="w"> </span><span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">data</span><span class="p">.</span>
<span class="mi">64</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mf">10.0.0.2</span><span class="err">:</span><span class="w"> </span><span class="n">icmp_seq</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">64</span><span class="w"> </span><span class="nc">time</span><span class="o">=</span><span class="mf">1.37</span><span class="w"> </span><span class="n">ms</span>

<span class="c1">--- 10.0.0.2 ping statistics ---</span>
<span class="mi">1</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">transmitted</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">received</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="o">%</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">loss</span><span class="p">,</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="mi">0</span><span class="n">ms</span>
<span class="n">rtt</span><span class="w"> </span><span class="nf">min</span><span class="o">/</span><span class="nf">avg</span><span class="o">/</span><span class="nf">max</span><span class="o">/</span><span class="n">mdev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">1.370</span><span class="o">/</span><span class="mf">1.370</span><span class="o">/</span><span class="mf">1.370</span><span class="o">/</span><span class="mf">0.000</span><span class="w"> </span><span class="n">ms</span>
</code></pre></div></td></tr></table></div>
<h2 id="adding-virtual-network-with-one-virtual-switch-s1">Adding virtual network with one virtual switch s1</h2>
<p>On ovn1, configure a logical switch and port:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">ls</span><span class="o">-</span><span class="nx">add</span><span class="w"> </span><span class="nx">s1</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">add</span><span class="w"> </span><span class="nx">s1</span><span class="w"> </span><span class="nx">port11</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">set</span><span class="o">-</span><span class="nx">addresses</span><span class="w"> </span><span class="nx">port11</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">01</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">add</span><span class="w"> </span><span class="nx">s1</span><span class="w"> </span><span class="nx">port12</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">set</span><span class="o">-</span><span class="nx">addresses</span><span class="w"> </span><span class="nx">port12</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">02</span>
</code></pre></div></td></tr></table></div>
<p>Now, "real" ports need to be wired to the above ports. Note that the logical port name has to match the <code class="highlight"><span class="n">external_ids</span><span class="o">:</span><span class="n">iface</span><span class="o">-</span><span class="n">id</span></code> identifier. If we added  <code class="highlight">ovn-nbctl lsp-add s1 foo</code> instead of <code class="highlight">port11</code>, then we would have to set <code class="highlight">ovs-vsctl set Interface port11 external_ids:iface-id=foo</code> on ovn2. Note that we need to know the MAC address of that port. Therefore, when creating the veth, we are making sure to create it with the correct MAC address.</p>
<p>On ovn2, execute:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nx">cat</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="nx">EOF</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="o">/</span><span class="nx">opt</span><span class="o">/</span><span class="nx">ns</span><span class="o">-</span><span class="nx">setup</span><span class="o">/</span><span class="nx">ns1</span><span class="p">.</span><span class="nx">sh</span>
<span class="err">#</span><span class="p">!</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">bash</span><span class="w"> </span><span class="o">-</span><span class="nx">eux</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="nx">veth11</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="nx">veth</span><span class="w"> </span><span class="nx">peer</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="nx">port11</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">ns1</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">dev</span><span class="w"> </span><span class="nx">veth11</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">ns1</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">exec</span><span class="w"> </span><span class="nx">ns1</span><span class="w"> </span><span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">dev</span><span class="w"> </span><span class="nx">lo</span><span class="w"> </span><span class="nx">up</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">exec</span><span class="w"> </span><span class="nx">ns1</span><span class="w"> </span><span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">dev</span><span class="w"> </span><span class="nx">veth11</span><span class="w"> </span><span class="nx">up</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">exec</span><span class="w"> </span><span class="nx">ns1</span><span class="w"> </span><span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">veth11</span><span class="w"> </span><span class="nx">address</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">01</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">exec</span><span class="w"> </span><span class="nx">ns1</span><span class="w"> </span><span class="nx">ip</span><span class="w"> </span><span class="nx">address</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="m m-Double">10.0.1.1</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="nx">dev</span><span class="w"> </span><span class="nx">veth11</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">dev</span><span class="w"> </span><span class="nx">port11</span><span class="w"> </span><span class="nx">up</span>
<span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">add</span><span class="o">-</span><span class="nx">port</span><span class="w"> </span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span><span class="w"> </span><span class="nx">port11</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="kc">true</span>
<span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">Interface</span><span class="w"> </span><span class="nx">port11</span><span class="w"> </span><span class="nx">external_ids</span><span class="p">:</span><span class="nx">iface</span><span class="o">-</span><span class="nx">id</span><span class="p">=</span><span class="nx">port11</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="kc">true</span>
<span class="nx">EOF</span>
<span class="nx">chmod</span><span class="w"> </span><span class="o">+</span><span class="nx">x</span><span class="w"> </span><span class="o">/</span><span class="nx">opt</span><span class="o">/</span><span class="nx">ns</span><span class="o">-</span><span class="nx">setup</span><span class="o">/</span><span class="nx">ns1</span><span class="p">.</span><span class="nx">sh</span>
</code></pre></div></td></tr></table></div>
<p>On ovn3, execute:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nx">cat</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="nx">EOF</span><span class="w"> </span><span class="p">&gt;</span><span class="w"> </span><span class="o">/</span><span class="nx">opt</span><span class="o">/</span><span class="nx">ns</span><span class="o">-</span><span class="nx">setup</span><span class="o">/</span><span class="nx">ns1</span><span class="p">.</span><span class="nx">sh</span>
<span class="err">#</span><span class="p">!</span><span class="o">/</span><span class="nx">bin</span><span class="o">/</span><span class="nx">bash</span><span class="w"> </span><span class="o">-</span><span class="nx">eux</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="nx">veth12</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="nx">veth</span><span class="w"> </span><span class="nx">peer</span><span class="w"> </span><span class="nx">name</span><span class="w"> </span><span class="nx">port12</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="nx">ns1</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">dev</span><span class="w"> </span><span class="nx">veth12</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">ns1</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">exec</span><span class="w"> </span><span class="nx">ns1</span><span class="w"> </span><span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">dev</span><span class="w"> </span><span class="nx">lo</span><span class="w"> </span><span class="nx">up</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">exec</span><span class="w"> </span><span class="nx">ns1</span><span class="w"> </span><span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">dev</span><span class="w"> </span><span class="nx">veth12</span><span class="w"> </span><span class="nx">up</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">exec</span><span class="w"> </span><span class="nx">ns1</span><span class="w"> </span><span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">veth12</span><span class="w"> </span><span class="nx">address</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">02</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">netns</span><span class="w"> </span><span class="nx">exec</span><span class="w"> </span><span class="nx">ns1</span><span class="w"> </span><span class="nx">ip</span><span class="w"> </span><span class="nx">address</span><span class="w"> </span><span class="nx">add</span><span class="w"> </span><span class="m m-Double">10.0.1.2</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span><span class="nx">dev</span><span class="w"> </span><span class="nx">veth12</span>
<span class="nx">ip</span><span class="w"> </span><span class="nx">link</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">dev</span><span class="w"> </span><span class="nx">port12</span><span class="w"> </span><span class="nx">up</span>
<span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">add</span><span class="o">-</span><span class="nx">port</span><span class="w"> </span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span><span class="w"> </span><span class="nx">port12</span><span class="w"> </span><span class="nx">external_ids</span><span class="p">:</span><span class="nx">iface</span><span class="o">-</span><span class="nx">id</span><span class="p">=</span><span class="nx">port12</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="kc">true</span>
<span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">set</span><span class="w"> </span><span class="nx">Interface</span><span class="w"> </span><span class="nx">port12</span><span class="w"> </span><span class="nx">external_ids</span><span class="p">:</span><span class="nx">iface</span><span class="o">-</span><span class="nx">id</span><span class="p">=</span><span class="nx">port12</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="kc">true</span>
<span class="nx">EOF</span>
<span class="nx">chmod</span><span class="w"> </span><span class="o">+</span><span class="nx">x</span><span class="w"> </span><span class="o">/</span><span class="nx">opt</span><span class="o">/</span><span class="nx">ns</span><span class="o">-</span><span class="nx">setup</span><span class="o">/</span><span class="nx">ns1</span><span class="p">.</span><span class="nx">sh</span>
</code></pre></div></td></tr></table></div>
<p>Verify the new configuration on ovn1:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nv">ovn</span><span class="o">-</span><span class="nv">nbctl</span><span class="w"> </span><span class="k">show</span>
<span class="nv">ovn</span><span class="o">-</span><span class="nv">sbctl</span><span class="w"> </span><span class="k">show</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">ovn1</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">show</span>
<span class="nx">switch</span><span class="w"> </span><span class="mi">313</span><span class="nx">fb333</span><span class="o">-</span><span class="mi">5</span><span class="nx">c33</span><span class="o">-</span><span class="mi">4</span><span class="nx">bf2</span><span class="o">-</span><span class="mi">8936</span><span class="o">-</span><span class="mi">72514</span><span class="nx">bc20de3</span><span class="w"> </span><span class="p">(</span><span class="nx">s1</span><span class="p">)</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">port11</span>
<span class="w">        </span><span class="nx">addresses</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;00:00:00:00:01:01&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">port12</span>
<span class="w">        </span><span class="nx">addresses</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;00:00:00:00:01:02&quot;</span><span class="p">]</span>
<span class="nx">switch</span><span class="w"> </span><span class="mi">70</span><span class="nx">a89317</span><span class="o">-</span><span class="mi">1</span><span class="nx">bc0</span><span class="o">-</span><span class="mi">4</span><span class="nx">fcb</span><span class="o">-</span><span class="mi">825</span><span class="nx">d</span><span class="o">-</span><span class="nx">c93754a5a6ca</span><span class="w"> </span><span class="p">(</span><span class="nx">s0</span><span class="p">)</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">port01</span>
<span class="w">        </span><span class="nx">addresses</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;00:00:00:00:00:01&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">port02</span>
<span class="w">        </span><span class="nx">addresses</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;00:00:00:00:00:02&quot;</span><span class="p">]</span>
<span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">ovn1</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="nx">sbctl</span><span class="w"> </span><span class="nx">show</span>
<span class="nx">Chassis</span><span class="w"> </span><span class="s">&quot;8de4d500-ab50-4ecc-a6df-3b5387efdf81&quot;</span>
<span class="w">    </span><span class="nx">hostname</span><span class="p">:</span><span class="w"> </span><span class="nx">ovn3</span>
<span class="w">    </span><span class="nx">Encap</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">        </span><span class="nx">ip</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.122.107&quot;</span>
<span class="w">        </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="nx">Port_Binding</span><span class="w"> </span><span class="nx">port12</span>
<span class="w">    </span><span class="nx">Port_Binding</span><span class="w"> </span><span class="nx">port02</span>
<span class="nx">Chassis</span><span class="w"> </span><span class="s">&quot;108c2b72-5ab9-43a0-9617-55f23f16482a&quot;</span>
<span class="w">    </span><span class="nx">hostname</span><span class="p">:</span><span class="w"> </span><span class="nx">ovn2</span>
<span class="w">    </span><span class="nx">Encap</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">        </span><span class="nx">ip</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.122.159&quot;</span>
<span class="w">        </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="nx">Port_Binding</span><span class="w"> </span><span class="nx">port11</span>
<span class="w">    </span><span class="nx">Port_Binding</span><span class="w"> </span><span class="nx">port01</span>
<span class="nx">Chassis</span><span class="w"> </span><span class="s">&quot;dacba18d-52f9-4adb-8b3d-8ca27b700a73&quot;</span>
<span class="w">    </span><span class="nx">hostname</span><span class="p">:</span><span class="w"> </span><span class="nx">ovn1</span>
<span class="w">    </span><span class="nx">Encap</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">        </span><span class="nx">ip</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.122.182&quot;</span>
<span class="w">        </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<blockquote>
<p><strong>Note:</strong> The southbound database now shows port bindings.</p>
</blockquote>
<p>Verify logical flows, the same as earlier.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>ovn-sbctl lflow-list
</code></pre></div></td></tr></table></div>
<p>Last but not least, run a test ping between the namespaces on both hosts:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@ovn2 ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="n">netns</span><span class="w"> </span><span class="k">exec</span><span class="w"> </span><span class="n">ns1</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="mf">10.0.1.2</span><span class="w"> </span><span class="o">-</span><span class="n">c1</span><span class="w"> </span><span class="o">-</span><span class="n">W1</span>
<span class="n">PING</span><span class="w"> </span><span class="mf">10.0.1.2</span><span class="w"> </span><span class="p">(</span><span class="mf">10.0.1.2</span><span class="p">)</span><span class="w"> </span><span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">data</span><span class="p">.</span>
<span class="mi">64</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mf">10.0.1.2</span><span class="err">:</span><span class="w"> </span><span class="n">icmp_seq</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">64</span><span class="w"> </span><span class="nc">time</span><span class="o">=</span><span class="mf">2.50</span><span class="w"> </span><span class="n">ms</span>

<span class="c1">--- 10.0.1.2 ping statistics ---</span>
<span class="mi">1</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">transmitted</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">received</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="o">%</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">loss</span><span class="p">,</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="mi">0</span><span class="n">ms</span>
<span class="n">rtt</span><span class="w"> </span><span class="nf">min</span><span class="o">/</span><span class="nf">avg</span><span class="o">/</span><span class="nf">max</span><span class="o">/</span><span class="n">mdev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">2.496</span><span class="o">/</span><span class="mf">2.496</span><span class="o">/</span><span class="mf">2.496</span><span class="o">/</span><span class="mf">0.000</span><span class="w"> </span><span class="n">ms</span>
</code></pre></div></td></tr></table></div>
<h2 id="adding-virtual-router-r1">Adding virtual router r1 ##</h2>
<h3 id="introduction">Introduction</h3>
<p>Next, we want to be able to route between the two namespaces. In order to be able to do so, we must add a virtual router
in between the two switches.</p>
<p>https://www.ovn.org/support/dist-docs/ovn-architecture.7.html
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">   </span><span class="nx">Logical</span><span class="w"> </span><span class="nx">Routers</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">Logical</span><span class="w"> </span><span class="nx">Patch</span><span class="w"> </span><span class="nx">Ports</span>
<span class="w">       </span><span class="nx">Typically</span><span class="w"> </span><span class="nx">logical</span><span class="w"> </span><span class="nx">routers</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">logical</span><span class="w"> </span><span class="nx">patch</span><span class="w"> </span><span class="nx">ports</span><span class="w"> </span><span class="nx">do</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="nx">have</span><span class="w"> </span><span class="nx">a</span><span class="w">  </span><span class="nx">physi</span><span class="err">‐</span>
<span class="w">       </span><span class="nx">cal</span><span class="w">  </span><span class="nx">location</span><span class="w">  </span><span class="k">and</span><span class="w">  </span><span class="nx">effectively</span><span class="w"> </span><span class="nx">reside</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">every</span><span class="w"> </span><span class="nx">hypervisor</span><span class="p">.</span><span class="w"> </span><span class="nx">This</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">the</span>
<span class="w">       </span><span class="k">case</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nx">logical</span><span class="w">  </span><span class="nx">patch</span><span class="w">  </span><span class="nx">ports</span><span class="w">  </span><span class="nx">between</span><span class="w">  </span><span class="nx">logical</span><span class="w">  </span><span class="nx">routers</span><span class="w">  </span><span class="k">and</span><span class="w">  </span><span class="nx">logical</span>
<span class="w">       </span><span class="nx">switches</span><span class="w"> </span><span class="nx">behind</span><span class="w"> </span><span class="nx">those</span><span class="w"> </span><span class="nx">logical</span><span class="w"> </span><span class="nx">routers</span><span class="p">,</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">which</span><span class="w"> </span><span class="nx">VMs</span><span class="w"> </span><span class="p">(</span><span class="k">and</span><span class="w"> </span><span class="nx">VIFs</span><span class="p">)</span><span class="w"> </span><span class="nx">attach</span><span class="p">.</span>

<span class="w">       </span><span class="nx">Consider</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">packet</span><span class="w"> </span><span class="nx">sent</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">one</span><span class="w"> </span><span class="kd">virtual</span><span class="w"> </span><span class="nx">machine</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="nx">container</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">another</span>
<span class="w">       </span><span class="nx">VM</span><span class="w">  </span><span class="k">or</span><span class="w">  </span><span class="nx">container</span><span class="w">  </span><span class="nx">that</span><span class="w">  </span><span class="nx">resides</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">different</span><span class="w"> </span><span class="nx">subnet</span><span class="p">.</span><span class="w"> </span><span class="nx">The</span><span class="w"> </span><span class="nx">packet</span><span class="w"> </span><span class="nx">will</span>
<span class="w">       </span><span class="nx">traverse</span><span class="w"> </span><span class="nx">tables</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="mi">65</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nx">described</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">previous</span><span class="w"> </span><span class="nx">section</span><span class="w">  </span><span class="nx">Architec</span><span class="err">‐␈‐</span>
<span class="w">       </span><span class="nx">tural</span><span class="w">  </span><span class="nx">Physical</span><span class="w"> </span><span class="nx">Life</span><span class="w"> </span><span class="nx">Cycle</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">Packet</span><span class="p">,</span><span class="w"> </span><span class="nx">using</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">logical</span><span class="w"> </span><span class="nx">datapath</span><span class="w"> </span><span class="nx">rep</span><span class="err">‐</span>
<span class="w">       </span><span class="nx">resenting</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">logical</span><span class="w"> </span><span class="nx">switch</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">sender</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">attached</span><span class="w"> </span><span class="nx">to</span><span class="p">.</span><span class="w">  </span><span class="nx">At</span><span class="w">  </span><span class="nx">table</span>
<span class="w">       </span><span class="mi">42</span><span class="p">,</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">packet</span><span class="w"> </span><span class="nx">will</span><span class="w"> </span><span class="nx">use</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">fallback</span><span class="w"> </span><span class="nx">flow</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">resubmits</span><span class="w"> </span><span class="nx">locally</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">ta</span><span class="err">‐</span>
<span class="w">       </span><span class="nx">ble</span><span class="w"> </span><span class="mi">43</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">same</span><span class="w"> </span><span class="nx">hypervisor</span><span class="p">.</span><span class="w"> </span><span class="nx">In</span><span class="w"> </span><span class="nx">this</span><span class="w"> </span><span class="k">case</span><span class="p">,</span><span class="w"> </span><span class="nx">all</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">processing</span><span class="w"> </span><span class="nx">from</span>
<span class="w">       </span><span class="nx">table</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">table</span><span class="w"> </span><span class="mi">65</span><span class="w"> </span><span class="nx">occurs</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">hypervisor</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">sender</span><span class="w"> </span><span class="nx">resides</span><span class="p">.</span>

<span class="w">       </span><span class="nx">When</span><span class="w">  </span><span class="nx">the</span><span class="w"> </span><span class="nx">packet</span><span class="w"> </span><span class="nx">reaches</span><span class="w"> </span><span class="nx">table</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">logical</span><span class="w"> </span><span class="nx">egress</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">logical</span>
<span class="w">       </span><span class="nx">patch</span><span class="w"> </span><span class="nx">port</span><span class="p">.</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="nx">controller</span><span class="w"> </span><span class="nx">implements</span><span class="w"> </span><span class="nx">output</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w">  </span><span class="nx">logical</span><span class="w">  </span><span class="nx">patch</span><span class="w">  </span><span class="k">is</span>
<span class="w">       </span><span class="nx">packet</span><span class="w">  </span><span class="nx">by</span><span class="w"> </span><span class="nx">cloning</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">resubmitting</span><span class="w"> </span><span class="nx">directly</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">first</span><span class="w"> </span><span class="nx">OpenFlow</span><span class="w"> </span><span class="nx">flow</span>
<span class="w">       </span><span class="nx">table</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">ingress</span><span class="w"> </span><span class="nx">pipeline</span><span class="p">,</span><span class="w"> </span><span class="nx">setting</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">logical</span><span class="w"> </span><span class="nx">ingress</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="nx">to</span><span class="w">  </span><span class="nx">the</span>
<span class="w">       </span><span class="nx">peer</span><span class="w">  </span><span class="nx">logical</span><span class="w"> </span><span class="nx">patch</span><span class="w"> </span><span class="nx">port</span><span class="p">,</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">using</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">peer</span><span class="w"> </span><span class="nx">logical</span><span class="w"> </span><span class="nx">patch</span><span class="w"> </span><span class="nx">port</span><span class="err">’</span><span class="nx">s</span><span class="w"> </span><span class="nx">logi</span><span class="err">‐</span>
<span class="w">       </span><span class="nx">cal</span><span class="w"> </span><span class="nx">datapath</span><span class="w"> </span><span class="p">(</span><span class="nx">that</span><span class="w"> </span><span class="nx">represents</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">logical</span><span class="w"> </span><span class="nx">router</span><span class="p">).</span>

<span class="w">       </span><span class="nx">The</span><span class="w"> </span><span class="nx">packet</span><span class="w"> </span><span class="nx">re</span><span class="o">-</span><span class="nx">enters</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">ingress</span><span class="w"> </span><span class="nx">pipeline</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">order</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">traverse</span><span class="w"> </span><span class="nx">tables</span><span class="w"> </span><span class="mi">8</span>
<span class="w">       </span><span class="nx">to</span><span class="w"> </span><span class="mi">65</span><span class="w"> </span><span class="nx">again</span><span class="p">,</span><span class="w"> </span><span class="nx">this</span><span class="w"> </span><span class="nx">time</span><span class="w"> </span><span class="nx">using</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">logical</span><span class="w"> </span><span class="nx">datapath</span><span class="w"> </span><span class="nx">representing</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">log</span><span class="err">‐</span>
<span class="w">       </span><span class="nx">ical</span><span class="w"> </span><span class="nx">router</span><span class="p">.</span><span class="w"> </span><span class="nx">The</span><span class="w"> </span><span class="nx">processing</span><span class="w"> </span><span class="nx">continues</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nx">described</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">previous</span><span class="w"> </span><span class="nx">sec</span><span class="err">‐</span>
<span class="w">       </span><span class="nx">tion</span><span class="w"> </span><span class="nx">Architectural</span><span class="w"> </span><span class="nx">Physical</span><span class="w"> </span><span class="nx">Life</span><span class="w"> </span><span class="nx">Cycle</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">a</span><span class="w">  </span><span class="nx">Packet</span><span class="p">.</span><span class="w">  </span><span class="nx">When</span><span class="w">  </span><span class="nx">the</span><span class="w">  </span><span class="nx">packet</span>
<span class="w">       </span><span class="nx">reaches</span><span class="w">  </span><span class="nx">table</span><span class="w"> </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">logical</span><span class="w"> </span><span class="nx">egress</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="nx">will</span><span class="w"> </span><span class="nx">once</span><span class="w"> </span><span class="nx">again</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">logical</span>
<span class="w">       </span><span class="nx">patch</span><span class="w"> </span><span class="nx">port</span><span class="p">.</span><span class="w"> </span><span class="nx">In</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">same</span><span class="w"> </span><span class="nx">manner</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nx">described</span><span class="w"> </span><span class="nx">above</span><span class="p">,</span><span class="w"> </span><span class="nx">this</span><span class="w">  </span><span class="nx">logical</span><span class="w">  </span><span class="nx">patch</span>
<span class="w">       </span><span class="nx">port</span><span class="w">  </span><span class="nx">will</span><span class="w">  </span><span class="nx">cause</span><span class="w">  </span><span class="nx">the</span><span class="w"> </span><span class="nx">packet</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">be</span><span class="w"> </span><span class="nx">resubmitted</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">OpenFlow</span><span class="w"> </span><span class="nx">tables</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="nx">to</span>
<span class="w">       </span><span class="mi">65</span><span class="p">,</span><span class="w"> </span><span class="nx">this</span><span class="w"> </span><span class="nx">time</span><span class="w"> </span><span class="nx">using</span><span class="w">  </span><span class="nx">the</span><span class="w">  </span><span class="nx">logical</span><span class="w">  </span><span class="nx">datapath</span><span class="w">  </span><span class="nx">representing</span><span class="w">  </span><span class="nx">the</span><span class="w">  </span><span class="nx">logical</span>
<span class="w">       </span><span class="nx">switch</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">destination</span><span class="w"> </span><span class="nx">VM</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="nx">container</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">attached</span><span class="w"> </span><span class="nx">to</span><span class="p">.</span>

<span class="w">       </span><span class="nx">The</span><span class="w"> </span><span class="nx">packet</span><span class="w"> </span><span class="nx">traverses</span><span class="w"> </span><span class="nx">tables</span><span class="w"> </span><span class="mi">8</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="mi">65</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">third</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">final</span><span class="w"> </span><span class="nx">time</span><span class="p">.</span><span class="w"> </span><span class="nx">If</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">des</span><span class="err">‐</span>
<span class="w">       </span><span class="nx">tination</span><span class="w">  </span><span class="nx">VM</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="nx">container</span><span class="w"> </span><span class="nx">resides</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">remote</span><span class="w"> </span><span class="nx">hypervisor</span><span class="p">,</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="nx">table</span><span class="w"> </span><span class="mi">39</span>
<span class="w">       </span><span class="nx">will</span><span class="w"> </span><span class="nx">send</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">packet</span><span class="w"> </span><span class="nx">on</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">tunnel</span><span class="w"> </span><span class="nx">port</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">sender</span><span class="err">’</span><span class="nx">s</span><span class="w">  </span><span class="nx">hypervisor</span><span class="w">  </span><span class="nx">to</span>
<span class="w">       </span><span class="nx">the</span><span class="w"> </span><span class="nx">remote</span><span class="w"> </span><span class="nx">hypervisor</span><span class="p">.</span><span class="w"> </span><span class="nx">Finally</span><span class="w"> </span><span class="nx">table</span><span class="w"> </span><span class="mi">65</span><span class="w"> </span><span class="nx">will</span><span class="w"> </span><span class="nx">output</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">packet</span><span class="w"> </span><span class="nx">directly</span>
<span class="w">       </span><span class="nx">to</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">destination</span><span class="w"> </span><span class="nx">VM</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="nx">container</span><span class="p">.</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="setup">Setup</h3>
<p>Configure namespace routes for virtual routing - on both hosts, run:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nv">ip</span><span class="w"> </span><span class="nv">netns</span><span class="w"> </span><span class="k">exec</span><span class="w"> </span><span class="nv">ns0</span><span class="w"> </span><span class="nv">ip</span><span class="w"> </span><span class="nv">r</span><span class="w"> </span><span class="nv">add</span><span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="nv">via</span><span class="w"> </span><span class="mi">10</span>.<span class="mi">0</span>.<span class="mi">0</span>.<span class="mi">254</span>
<span class="nv">ip</span><span class="w"> </span><span class="nv">netns</span><span class="w"> </span><span class="k">exec</span><span class="w"> </span><span class="nv">ns1</span><span class="w"> </span><span class="nv">ip</span><span class="w"> </span><span class="nv">r</span><span class="w"> </span><span class="nv">add</span><span class="w"> </span><span class="nv">default</span><span class="w"> </span><span class="nv">via</span><span class="w"> </span><span class="mi">10</span>.<span class="mi">0</span>.<span class="mi">1</span>.<span class="mi">254</span>
<span class="nv">echo</span><span class="w"> </span><span class="s2">&quot;ip netns exec ns0 ip r add default via 10.0.0.254&quot;</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="o">/</span><span class="nv">opt</span><span class="o">/</span><span class="nv">ns</span><span class="o">-</span><span class="nv">setup</span><span class="o">/</span><span class="nv">ns0</span>.<span class="nv">sh</span><span class="w"> </span>
<span class="nv">echo</span><span class="w"> </span><span class="s2">&quot;ip netns exec ns1 ip r add default via 10.0.1.254&quot;</span><span class="w"> </span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="o">/</span><span class="nv">opt</span><span class="o">/</span><span class="nv">ns</span><span class="o">-</span><span class="nv">setup</span><span class="o">/</span><span class="nv">ns1</span>.<span class="nv">sh</span>
</code></pre></div></td></tr></table></div></p>
<p>Now, set up the OVN northbound database router and router ports - run this on ovn1:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lr</span><span class="o">-</span><span class="nx">add</span><span class="w"> </span><span class="nx">r1</span>

<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lrp</span><span class="o">-</span><span class="nx">add</span><span class="w"> </span><span class="nx">r1</span><span class="w"> </span><span class="nx">r1s0</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="nx">ff</span><span class="w"> </span><span class="m m-Double">10.0.0.254</span><span class="o">/</span><span class="mi">24</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">add</span><span class="w"> </span><span class="nx">s0</span><span class="w"> </span><span class="nx">s0r1</span><span class="w"> </span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">set</span><span class="o">-</span><span class="nx">addresses</span><span class="w"> </span><span class="nx">s0r1</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="nx">ff</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">set</span><span class="o">-</span><span class="nx">options</span><span class="w"> </span><span class="nx">s0r1</span><span class="w"> </span><span class="nx">router</span><span class="o">-</span><span class="nx">port</span><span class="p">=</span><span class="nx">r1s0</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">set</span><span class="o">-</span><span class="k">type</span><span class="w"> </span><span class="nx">s0r1</span><span class="w"> </span><span class="nx">router</span>

<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lrp</span><span class="o">-</span><span class="nx">add</span><span class="w"> </span><span class="nx">r1</span><span class="w"> </span><span class="nx">r1s1</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="nx">ff</span><span class="w"> </span><span class="m m-Double">10.0.1.254</span><span class="o">/</span><span class="mi">24</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">add</span><span class="w"> </span><span class="nx">s1</span><span class="w"> </span><span class="nx">s1r1</span><span class="w"> </span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">set</span><span class="o">-</span><span class="nx">addresses</span><span class="w"> </span><span class="nx">s1r1</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="nx">ff</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">set</span><span class="o">-</span><span class="nx">options</span><span class="w"> </span><span class="nx">s1r1</span><span class="w"> </span><span class="nx">router</span><span class="o">-</span><span class="nx">port</span><span class="p">=</span><span class="nx">r1s1</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">set</span><span class="o">-</span><span class="k">type</span><span class="w"> </span><span class="nx">s1r1</span><span class="w"> </span><span class="nx">router</span>
</code></pre></div></td></tr></table></div></p>
<p>Verify the new configuration:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nv">ovn</span><span class="o">-</span><span class="nv">nbctl</span><span class="w"> </span><span class="k">show</span>
<span class="nv">ovn</span><span class="o">-</span><span class="nv">sbctl</span><span class="w"> </span><span class="k">show</span>
</code></pre></div></td></tr></table></div></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">ovn1</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">show</span>
<span class="nx">switch</span><span class="w"> </span><span class="mi">313</span><span class="nx">fb333</span><span class="o">-</span><span class="mi">5</span><span class="nx">c33</span><span class="o">-</span><span class="mi">4</span><span class="nx">bf2</span><span class="o">-</span><span class="mi">8936</span><span class="o">-</span><span class="mi">72514</span><span class="nx">bc20de3</span><span class="w"> </span><span class="p">(</span><span class="nx">s1</span><span class="p">)</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">s1r1</span>
<span class="w">        </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">router</span>
<span class="w">        </span><span class="nx">addresses</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;00:00:00:00:01:ff&quot;</span><span class="p">]</span>
<span class="w">        </span><span class="nx">router</span><span class="o">-</span><span class="nx">port</span><span class="p">:</span><span class="w"> </span><span class="nx">r1s1</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">port11</span>
<span class="w">        </span><span class="nx">addresses</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;00:00:00:00:01:01&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">port12</span>
<span class="w">        </span><span class="nx">addresses</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;00:00:00:00:01:02&quot;</span><span class="p">]</span>
<span class="nx">switch</span><span class="w"> </span><span class="mi">70</span><span class="nx">a89317</span><span class="o">-</span><span class="mi">1</span><span class="nx">bc0</span><span class="o">-</span><span class="mi">4</span><span class="nx">fcb</span><span class="o">-</span><span class="mi">825</span><span class="nx">d</span><span class="o">-</span><span class="nx">c93754a5a6ca</span><span class="w"> </span><span class="p">(</span><span class="nx">s0</span><span class="p">)</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">port01</span>
<span class="w">        </span><span class="nx">addresses</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;00:00:00:00:00:01&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">s0r1</span>
<span class="w">        </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">router</span>
<span class="w">        </span><span class="nx">addresses</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;00:00:00:00:00:ff&quot;</span><span class="p">]</span>
<span class="w">        </span><span class="nx">router</span><span class="o">-</span><span class="nx">port</span><span class="p">:</span><span class="w"> </span><span class="nx">r1s0</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">port02</span>
<span class="w">        </span><span class="nx">addresses</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;00:00:00:00:00:02&quot;</span><span class="p">]</span>
<span class="nx">router</span><span class="w"> </span><span class="nx">fb0101fd</span><span class="o">-</span><span class="mi">881</span><span class="nx">e</span><span class="o">-</span><span class="mi">4</span><span class="nx">aa2</span><span class="o">-</span><span class="nx">ae05</span><span class="o">-</span><span class="mi">16</span><span class="nx">a93428dc53</span><span class="w"> </span><span class="p">(</span><span class="nx">r1</span><span class="p">)</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">r1s1</span>
<span class="w">        </span><span class="nx">mac</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;00:00:00:00:01:ff&quot;</span>
<span class="w">        </span><span class="nx">ipv6</span><span class="o">-</span><span class="nx">lla</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;fe80::200:ff:fe00:1ff&quot;</span>
<span class="w">        </span><span class="nx">networks</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;10.0.1.254/24&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">r1s0</span>
<span class="w">        </span><span class="nx">mac</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;00:00:00:00:00:ff&quot;</span>
<span class="w">        </span><span class="nx">ipv6</span><span class="o">-</span><span class="nx">lla</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;fe80::200:ff:fe00:ff&quot;</span>
<span class="w">        </span><span class="nx">networks</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;10.0.0.254/24&quot;</span><span class="p">]</span>
<span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">ovn1</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="nx">sbctl</span><span class="w"> </span><span class="nx">show</span>
<span class="nx">Chassis</span><span class="w"> </span><span class="s">&quot;8de4d500-ab50-4ecc-a6df-3b5387efdf81&quot;</span>
<span class="w">    </span><span class="nx">hostname</span><span class="p">:</span><span class="w"> </span><span class="nx">ovn3</span>
<span class="w">    </span><span class="nx">Encap</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">        </span><span class="nx">ip</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.122.107&quot;</span>
<span class="w">        </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="nx">Port_Binding</span><span class="w"> </span><span class="nx">port12</span>
<span class="w">    </span><span class="nx">Port_Binding</span><span class="w"> </span><span class="nx">port02</span>
<span class="nx">Chassis</span><span class="w"> </span><span class="s">&quot;108c2b72-5ab9-43a0-9617-55f23f16482a&quot;</span>
<span class="w">    </span><span class="nx">hostname</span><span class="p">:</span><span class="w"> </span><span class="nx">ovn2</span>
<span class="w">    </span><span class="nx">Encap</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">        </span><span class="nx">ip</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.122.159&quot;</span>
<span class="w">        </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="nx">Port_Binding</span><span class="w"> </span><span class="nx">port01</span>
<span class="w">    </span><span class="nx">Port_Binding</span><span class="w"> </span><span class="nx">port11</span>
<span class="nx">Chassis</span><span class="w"> </span><span class="s">&quot;dacba18d-52f9-4adb-8b3d-8ca27b700a73&quot;</span>
<span class="w">    </span><span class="nx">hostname</span><span class="p">:</span><span class="w"> </span><span class="nx">ovn1</span>
<span class="w">    </span><span class="nx">Encap</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">        </span><span class="nx">ip</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.122.182&quot;</span>
<span class="w">        </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">}</span>
</code></pre></div></td></tr></table></div>
<p>Verify logical flows:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>ovn-sbctl lflow-list
</code></pre></div></td></tr></table></div></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">[</span><span class="n">root</span><span class="o">@</span><span class="n">ovn1</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="c1">#  ovn-sbctl lflow-list</span>
<span class="n">Datapath</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;r1&quot;</span><span class="w"> </span><span class="p">(</span><span class="m">1287</span><span class="n">fc2b</span><span class="m">-1e3</span><span class="n">b</span><span class="m">-4</span><span class="n">bf9</span><span class="m">-8</span><span class="n">cf8</span><span class="o">-</span><span class="n">db890e663dc3</span><span class="p">)</span><span class="w">  </span><span class="n">Pipeline</span><span class="o">:</span><span class="w"> </span><span class="n">ingress</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_admission</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(((</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">flags.tunnel_rx</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_admission</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">vlan.present</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">eth.src</span><span class="p">[</span><span class="m">40</span><span class="p">]),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_admission</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="n">ff</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">inport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;r1s0&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">xreg0</span><span class="p">[</span><span class="m">0</span><span class="kc">..47</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="n">ff</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_admission</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">01</span><span class="o">:</span><span class="n">ff</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">inport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;r1s1&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">xreg0</span><span class="p">[</span><span class="m">0</span><span class="kc">..47</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">01</span><span class="o">:</span><span class="n">ff</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_admission</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.mcast</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">inport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;r1s0&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">xreg0</span><span class="p">[</span><span class="m">0</span><span class="kc">..47</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="n">ff</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_admission</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.mcast</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">inport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;r1s1&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">xreg0</span><span class="p">[</span><span class="m">0</span><span class="kc">..47</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">01</span><span class="o">:</span><span class="n">ff</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_admission</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_lookup_neighbor</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">arp.op</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg9</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">lookup_arp</span><span class="p">(</span><span class="n">inport</span><span class="p">,</span><span class="w"> </span><span class="n">arp.spa</span><span class="p">,</span><span class="w"> </span><span class="n">arp.sha</span><span class="p">);</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_lookup_neighbor</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">inport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;r1s0&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">arp.spa</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">0.0</span><span class="o">/</span><span class="m">24</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">arp.op</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg9</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">lookup_arp</span><span class="p">(</span><span class="n">inport</span><span class="p">,</span><span class="w"> </span><span class="n">arp.spa</span><span class="p">,</span><span class="w"> </span><span class="n">arp.sha</span><span class="p">);</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_lookup_neighbor</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">inport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;r1s1&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">arp.spa</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">1.0</span><span class="o">/</span><span class="m">24</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">arp.op</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg9</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">lookup_arp</span><span class="p">(</span><span class="n">inport</span><span class="p">,</span><span class="w"> </span><span class="n">arp.spa</span><span class="p">,</span><span class="w"> </span><span class="n">arp.sha</span><span class="p">);</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_lookup_neighbor</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd_na</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg9</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">lookup_nd</span><span class="p">(</span><span class="n">inport</span><span class="p">,</span><span class="w"> </span><span class="n">nd.target</span><span class="p">,</span><span class="w"> </span><span class="n">nd.tll</span><span class="p">);</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_lookup_neighbor</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd_ns</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg9</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">lookup_nd</span><span class="p">(</span><span class="n">inport</span><span class="p">,</span><span class="w"> </span><span class="n">ip6.src</span><span class="p">,</span><span class="w"> </span><span class="n">nd.sll</span><span class="p">);</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_lookup_neighbor</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg9</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_learn_neighbor</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg9</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">mac_cache_use</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_learn_neighbor</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">95</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd_na</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nd.tll</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="nf">put_nd</span><span class="p">(</span><span class="n">inport</span><span class="p">,</span><span class="w"> </span><span class="n">nd.target</span><span class="p">,</span><span class="w"> </span><span class="n">eth.src</span><span class="p">);</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_learn_neighbor</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">95</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd_ns</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">ip6.src</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd.sll</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">)),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_learn_neighbor</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">90</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">arp</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="nf">put_arp</span><span class="p">(</span><span class="n">inport</span><span class="p">,</span><span class="w"> </span><span class="n">arp.spa</span><span class="p">,</span><span class="w"> </span><span class="n">arp.sha</span><span class="p">);</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_learn_neighbor</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">90</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd_na</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="nf">put_nd</span><span class="p">(</span><span class="n">inport</span><span class="p">,</span><span class="w"> </span><span class="n">nd.target</span><span class="p">,</span><span class="w"> </span><span class="n">nd.tll</span><span class="p">);</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_learn_neighbor</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">90</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd_ns</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="nf">put_nd</span><span class="p">(</span><span class="n">inport</span><span class="p">,</span><span class="w"> </span><span class="n">ip6.src</span><span class="p">,</span><span class="w"> </span><span class="n">nd.sll</span><span class="p">);</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_learn_neighbor</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip4.src</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">{</span><span class="m">10.0</span><span class="n">.</span><span class="m">0.254</span><span class="p">,</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">0.255</span><span class="p">}</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">reg9</span><span class="p">[</span><span class="m">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip4.src</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">{</span><span class="m">10.0</span><span class="n">.</span><span class="m">1.254</span><span class="p">,</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">1.255</span><span class="p">}</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">reg9</span><span class="p">[</span><span class="m">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip4.src_mcast</span><span class="w"> </span><span class="o">||</span><span class="n">ip4.src</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">255.255</span><span class="n">.</span><span class="m">255.255</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">ip4.src</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">127.0</span><span class="n">.</span><span class="m">0.0</span><span class="o">/</span><span class="m">8</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">127.0</span><span class="n">.</span><span class="m">0.0</span><span class="o">/</span><span class="m">8</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">ip4.src</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0.0</span><span class="n">.</span><span class="m">0.0</span><span class="o">/</span><span class="m">8</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0.0</span><span class="n">.</span><span class="m">0.0</span><span class="o">/</span><span class="m">8</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">90</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">inport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;r1s0&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">arp.op</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">arp.tpa</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">0.254</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">arp.spa</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">0.0</span><span class="o">/</span><span class="m">24</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eth.src</span><span class="p">;</span><span class="w"> </span><span class="n">eth.src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xreg0</span><span class="p">[</span><span class="m">0</span><span class="kc">..47</span><span class="p">];</span><span class="w"> </span><span class="n">arp.op</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">;</span><span class="w"> </span><span class="o">/*</span><span class="w"> </span><span class="n">ARP</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="o">*/</span><span class="w"> </span><span class="n">arp.tha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">arp.sha</span><span class="p">;</span><span class="w"> </span><span class="n">arp.sha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xreg0</span><span class="p">[</span><span class="m">0</span><span class="kc">..47</span><span class="p">];</span><span class="w"> </span><span class="n">arp.tpa</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">arp.spa</span><span class="p">;</span><span class="w"> </span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inport</span><span class="p">;</span><span class="w"> </span><span class="n">flags.loopback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">90</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">inport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;r1s0&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">{</span><span class="n">fe80</span><span class="o">::</span><span class="m">200</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">fe00</span><span class="o">:</span><span class="n">ff</span><span class="p">,</span><span class="w"> </span><span class="n">ff02</span><span class="o">::</span><span class="m">1</span><span class="o">:</span><span class="n">ff00</span><span class="o">:</span><span class="n">ff</span><span class="p">}</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nd_ns</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nd.target</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">fe80</span><span class="o">::</span><span class="m">200</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">fe00</span><span class="o">:</span><span class="n">ff</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">nd_na_router</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">eth.src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xreg0</span><span class="p">[</span><span class="m">0</span><span class="kc">..47</span><span class="p">];</span><span class="w"> </span><span class="n">ip6.src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nd.target</span><span class="p">;</span><span class="w"> </span><span class="n">nd.tll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xreg0</span><span class="p">[</span><span class="m">0</span><span class="kc">..47</span><span class="p">];</span><span class="w"> </span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inport</span><span class="p">;</span><span class="w"> </span><span class="n">flags.loopback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;</span><span class="w"> </span><span class="p">};)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">90</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">inport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;r1s1&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">arp.op</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">arp.tpa</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">1.254</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">arp.spa</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">1.0</span><span class="o">/</span><span class="m">24</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eth.src</span><span class="p">;</span><span class="w"> </span><span class="n">eth.src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xreg0</span><span class="p">[</span><span class="m">0</span><span class="kc">..47</span><span class="p">];</span><span class="w"> </span><span class="n">arp.op</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">;</span><span class="w"> </span><span class="o">/*</span><span class="w"> </span><span class="n">ARP</span><span class="w"> </span><span class="n">reply</span><span class="w"> </span><span class="o">*/</span><span class="w"> </span><span class="n">arp.tha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">arp.sha</span><span class="p">;</span><span class="w"> </span><span class="n">arp.sha</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xreg0</span><span class="p">[</span><span class="m">0</span><span class="kc">..47</span><span class="p">];</span><span class="w"> </span><span class="n">arp.tpa</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">arp.spa</span><span class="p">;</span><span class="w"> </span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inport</span><span class="p">;</span><span class="w"> </span><span class="n">flags.loopback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">90</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">inport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;r1s1&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">{</span><span class="n">fe80</span><span class="o">::</span><span class="m">200</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">fe00</span><span class="o">:</span><span class="m">1</span><span class="n">ff</span><span class="p">,</span><span class="w"> </span><span class="n">ff02</span><span class="o">::</span><span class="m">1</span><span class="o">:</span><span class="n">ff00</span><span class="o">:</span><span class="m">1</span><span class="n">ff</span><span class="p">}</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nd_ns</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nd.target</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">fe80</span><span class="o">::</span><span class="m">200</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">fe00</span><span class="o">:</span><span class="m">1</span><span class="n">ff</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">nd_na_router</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">eth.src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xreg0</span><span class="p">[</span><span class="m">0</span><span class="kc">..47</span><span class="p">];</span><span class="w"> </span><span class="n">ip6.src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nd.target</span><span class="p">;</span><span class="w"> </span><span class="n">nd.tll</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xreg0</span><span class="p">[</span><span class="m">0</span><span class="kc">..47</span><span class="p">];</span><span class="w"> </span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">inport</span><span class="p">;</span><span class="w"> </span><span class="n">flags.loopback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;</span><span class="w"> </span><span class="p">};)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">90</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">0.254</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">ip4.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip.ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">255</span><span class="p">;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">flags.loopback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">90</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">1.254</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">8</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">ip4.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip.ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">255</span><span class="p">;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">flags.loopback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">90</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">fe80</span><span class="o">::</span><span class="m">200</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">fe00</span><span class="o">:</span><span class="m">1</span><span class="n">ff</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">128</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">ip6.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip.ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">255</span><span class="p">;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">129</span><span class="p">;</span><span class="w"> </span><span class="n">flags.loopback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">90</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">fe80</span><span class="o">::</span><span class="m">200</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">fe00</span><span class="o">:</span><span class="n">ff</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">128</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">ip6.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip.ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">255</span><span class="p">;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">129</span><span class="p">;</span><span class="w"> </span><span class="n">flags.loopback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">85</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">arp</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">84</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd_rs</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_ra</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">83</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip6.mcast_rsvd</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">82</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip4.mcast</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">ip6.mcast</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">80</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">0.254</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">ip.later_frag</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">sctp</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">sctp_abort</span><span class="w"> </span><span class="p">{</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">eth.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">ip4.src</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;</span><span class="w"> </span><span class="p">};)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">80</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">0.254</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">ip.later_frag</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">tcp</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">tcp_reset</span><span class="w"> </span><span class="p">{</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">eth.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">ip4.src</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;</span><span class="w"> </span><span class="p">};)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">80</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">0.254</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">ip.later_frag</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">udp</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">icmp4</span><span class="w"> </span><span class="p">{</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">eth.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">ip4.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip.ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">255</span><span class="p">;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">;</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;</span><span class="w"> </span><span class="p">};)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">80</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">1.254</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">ip.later_frag</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">sctp</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">sctp_abort</span><span class="w"> </span><span class="p">{</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">eth.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">ip4.src</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;</span><span class="w"> </span><span class="p">};)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">80</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">1.254</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">ip.later_frag</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">tcp</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">tcp_reset</span><span class="w"> </span><span class="p">{</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">eth.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">ip4.src</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;</span><span class="w"> </span><span class="p">};)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">80</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">1.254</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">ip.later_frag</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">udp</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">icmp4</span><span class="w"> </span><span class="p">{</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">eth.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">ip4.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip.ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">255</span><span class="p">;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">;</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;</span><span class="w"> </span><span class="p">};)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">80</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">fe80</span><span class="o">::</span><span class="m">200</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">fe00</span><span class="o">:</span><span class="m">1</span><span class="n">ff</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">ip.later_frag</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">sctp</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">sctp_abort</span><span class="w"> </span><span class="p">{</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">eth.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">ip6.src</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;</span><span class="w"> </span><span class="p">};)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">80</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">fe80</span><span class="o">::</span><span class="m">200</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">fe00</span><span class="o">:</span><span class="m">1</span><span class="n">ff</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">ip.later_frag</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">tcp</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">tcp_reset</span><span class="w"> </span><span class="p">{</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">eth.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">ip6.src</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;</span><span class="w"> </span><span class="p">};)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">80</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">fe80</span><span class="o">::</span><span class="m">200</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">fe00</span><span class="o">:</span><span class="m">1</span><span class="n">ff</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">ip.later_frag</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">udp</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">icmp6</span><span class="w"> </span><span class="p">{</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">eth.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">ip6.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip.ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">255</span><span class="p">;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">icmp6.code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;</span><span class="w"> </span><span class="p">};)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">80</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">fe80</span><span class="o">::</span><span class="m">200</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">fe00</span><span class="o">:</span><span class="n">ff</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">ip.later_frag</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">sctp</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">sctp_abort</span><span class="w"> </span><span class="p">{</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">eth.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">ip6.src</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;</span><span class="w"> </span><span class="p">};)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">80</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">fe80</span><span class="o">::</span><span class="m">200</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">fe00</span><span class="o">:</span><span class="n">ff</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">ip.later_frag</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">tcp</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">tcp_reset</span><span class="w"> </span><span class="p">{</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">eth.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">ip6.src</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;</span><span class="w"> </span><span class="p">};)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">80</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">fe80</span><span class="o">::</span><span class="m">200</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">fe00</span><span class="o">:</span><span class="n">ff</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">ip.later_frag</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">udp</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">icmp6</span><span class="w"> </span><span class="p">{</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">eth.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">ip6.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip.ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">255</span><span class="p">;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">icmp6.code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">4</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;</span><span class="w"> </span><span class="p">};)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">70</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">0.254</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">ip.later_frag</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">icmp4</span><span class="w"> </span><span class="p">{</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">eth.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">ip4.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip.ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">255</span><span class="p">;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">;</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;</span><span class="w"> </span><span class="p">};)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">70</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">1.254</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">ip.later_frag</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">icmp4</span><span class="w"> </span><span class="p">{</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">eth.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">ip4.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip.ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">255</span><span class="p">;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">;</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">2</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;</span><span class="w"> </span><span class="p">};)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">70</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">fe80</span><span class="o">::</span><span class="m">200</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">fe00</span><span class="o">:</span><span class="m">1</span><span class="n">ff</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">ip.later_frag</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">icmp6</span><span class="w"> </span><span class="p">{</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">eth.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">ip6.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip.ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">255</span><span class="p">;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">icmp6.code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;</span><span class="w"> </span><span class="p">};)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">70</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">fe80</span><span class="o">::</span><span class="m">200</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">fe00</span><span class="o">:</span><span class="n">ff</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">ip.later_frag</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">icmp6</span><span class="w"> </span><span class="p">{</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">eth.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">ip6.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip.ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">255</span><span class="p">;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">icmp6.code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">3</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;</span><span class="w"> </span><span class="p">};)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">60</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">{</span><span class="m">10.0</span><span class="n">.</span><span class="m">0.254</span><span class="p">}),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">60</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">{</span><span class="m">10.0</span><span class="n">.</span><span class="m">1.254</span><span class="p">}),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">60</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">{</span><span class="n">fe80</span><span class="o">::</span><span class="m">200</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">fe00</span><span class="o">:</span><span class="m">1</span><span class="n">ff</span><span class="p">}),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">60</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">{</span><span class="n">fe80</span><span class="o">::</span><span class="m">200</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">fe00</span><span class="o">:</span><span class="n">ff</span><span class="p">}),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.bcast</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">32</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip.ttl</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">{</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">}</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">ip.later_frag</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">ip4.mcast</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">ip6.mcast</span><span class="p">)),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">31</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">inport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;r1s0&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip.ttl</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">{</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">}</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">ip.later_frag</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">icmp4</span><span class="w"> </span><span class="p">{</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">eth.src</span><span class="p">;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">11</span><span class="p">;</span><span class="w"> </span><span class="o">/*</span><span class="w"> </span><span class="n">Time</span><span class="w"> </span><span class="n">exceeded</span><span class="w"> </span><span class="o">*/</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="o">/*</span><span class="w"> </span><span class="n">TTL</span><span class="w"> </span><span class="n">exceeded</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="n">transit</span><span class="w"> </span><span class="o">*/</span><span class="w"> </span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ip4.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip4.src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">0.254</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">ip.ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">254</span><span class="p">;</span><span class="w"> </span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;r1s0&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">flags.loopback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;</span><span class="w"> </span><span class="p">};)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">31</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">inport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;r1s1&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip.ttl</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">{</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">}</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="n">ip.later_frag</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">icmp4</span><span class="w"> </span><span class="p">{</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">eth.src</span><span class="p">;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">11</span><span class="p">;</span><span class="w"> </span><span class="o">/*</span><span class="w"> </span><span class="n">Time</span><span class="w"> </span><span class="n">exceeded</span><span class="w"> </span><span class="o">*/</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="o">/*</span><span class="w"> </span><span class="n">TTL</span><span class="w"> </span><span class="n">exceeded</span><span class="w"> </span><span class="kr">in</span><span class="w"> </span><span class="n">transit</span><span class="w"> </span><span class="o">*/</span><span class="w"> </span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ip4.src</span><span class="p">;</span><span class="w"> </span><span class="n">ip4.src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">1.254</span><span class="w"> </span><span class="p">;</span><span class="w"> </span><span class="n">ip.ttl</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">254</span><span class="p">;</span><span class="w"> </span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;r1s1&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">flags.loopback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;</span><span class="w"> </span><span class="p">};)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">30</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip.ttl</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">{</span><span class="m">0</span><span class="p">,</span><span class="w"> </span><span class="m">1</span><span class="p">}),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_ip_input</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_dhcp_relay_req</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">5</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_unsnat</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_post_unsnat</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">7</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_defrag</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">8</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_lb_aff_check</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">9</span><span class="w"> </span><span class="p">(</span><span class="n">lr_in_dnat</span><span class="w">         </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">10</span><span class="p">(</span><span class="n">lr_in_lb_aff_learn</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">11</span><span class="p">(</span><span class="n">lr_in_ecmp_stateful</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">12</span><span class="p">(</span><span class="n">lr_in_nd_ra_options</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">13</span><span class="p">(</span><span class="n">lr_in_nd_ra_response</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">14</span><span class="p">(</span><span class="n">lr_in_ip_routing_pre</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg7</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">15</span><span class="p">(</span><span class="n">lr_in_ip_routing</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">10550</span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd_rs</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_ra</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">15</span><span class="p">(</span><span class="n">lr_in_ip_routing</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">518</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">inport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;r1s0&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">fe80</span><span class="o">::/</span><span class="m">64</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ip.ttl</span><span class="o">--</span><span class="p">;</span><span class="w"> </span><span class="n">reg8</span><span class="p">[</span><span class="m">0</span><span class="kc">..15</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">xxreg0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ip6.dst</span><span class="p">;</span><span class="w"> </span><span class="n">xxreg1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fe80</span><span class="o">::</span><span class="m">200</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">fe00</span><span class="o">:</span><span class="n">ff</span><span class="p">;</span><span class="w"> </span><span class="n">eth.src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="n">ff</span><span class="p">;</span><span class="w"> </span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;r1s0&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">flags.loopback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">reg9</span><span class="p">[</span><span class="m">9</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">15</span><span class="p">(</span><span class="n">lr_in_ip_routing</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">518</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">inport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;r1s1&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip6.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">fe80</span><span class="o">::/</span><span class="m">64</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ip.ttl</span><span class="o">--</span><span class="p">;</span><span class="w"> </span><span class="n">reg8</span><span class="p">[</span><span class="m">0</span><span class="kc">..15</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">xxreg0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ip6.dst</span><span class="p">;</span><span class="w"> </span><span class="n">xxreg1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fe80</span><span class="o">::</span><span class="m">200</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">fe00</span><span class="o">:</span><span class="m">1</span><span class="n">ff</span><span class="p">;</span><span class="w"> </span><span class="n">eth.src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">01</span><span class="o">:</span><span class="n">ff</span><span class="p">;</span><span class="w"> </span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;r1s1&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">flags.loopback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">reg9</span><span class="p">[</span><span class="m">9</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">15</span><span class="p">(</span><span class="n">lr_in_ip_routing</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">198</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">0.0</span><span class="o">/</span><span class="m">24</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ip.ttl</span><span class="o">--</span><span class="p">;</span><span class="w"> </span><span class="n">reg8</span><span class="p">[</span><span class="m">0</span><span class="kc">..15</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">reg0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ip4.dst</span><span class="p">;</span><span class="w"> </span><span class="n">reg5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">0.254</span><span class="p">;</span><span class="w"> </span><span class="n">eth.src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="n">ff</span><span class="p">;</span><span class="w"> </span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;r1s0&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">flags.loopback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">reg9</span><span class="p">[</span><span class="m">9</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">15</span><span class="p">(</span><span class="n">lr_in_ip_routing</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">198</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip4.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">1.0</span><span class="o">/</span><span class="m">24</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ip.ttl</span><span class="o">--</span><span class="p">;</span><span class="w"> </span><span class="n">reg8</span><span class="p">[</span><span class="m">0</span><span class="kc">..15</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">reg0</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ip4.dst</span><span class="p">;</span><span class="w"> </span><span class="n">reg5</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">1.254</span><span class="p">;</span><span class="w"> </span><span class="n">eth.src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">01</span><span class="o">:</span><span class="n">ff</span><span class="p">;</span><span class="w"> </span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;r1s1&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">flags.loopback</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">reg9</span><span class="p">[</span><span class="m">9</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">15</span><span class="p">(</span><span class="n">lr_in_ip_routing</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">16</span><span class="p">(</span><span class="n">lr_in_ip_routing_ecmp</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">150</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg8</span><span class="p">[</span><span class="m">0</span><span class="kc">..15</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">16</span><span class="p">(</span><span class="n">lr_in_ip_routing_ecmp</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">17</span><span class="p">(</span><span class="n">lr_in_policy</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg8</span><span class="p">[</span><span class="m">0</span><span class="kc">..15</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">18</span><span class="p">(</span><span class="n">lr_in_policy_ecmp</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">150</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg8</span><span class="p">[</span><span class="m">0</span><span class="kc">..15</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">18</span><span class="p">(</span><span class="n">lr_in_policy_ecmp</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">19</span><span class="p">(</span><span class="n">lr_in_dhcp_relay_resp_chk</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">20</span><span class="p">(</span><span class="n">lr_in_dhcp_relay_resp</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">21</span><span class="p">(</span><span class="n">lr_in_arp_resolve</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">500</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip4.mcast</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">ip6.mcast</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">21</span><span class="p">(</span><span class="n">lr_in_arp_resolve</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">1</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg9</span><span class="p">[</span><span class="m">9</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="nf">get_nd</span><span class="p">(</span><span class="n">outport</span><span class="p">,</span><span class="w"> </span><span class="n">xxreg0</span><span class="p">);</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">21</span><span class="p">(</span><span class="n">lr_in_arp_resolve</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">1</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg9</span><span class="p">[</span><span class="m">9</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="nf">get_arp</span><span class="p">(</span><span class="n">outport</span><span class="p">,</span><span class="w"> </span><span class="n">reg0</span><span class="p">);</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">21</span><span class="p">(</span><span class="n">lr_in_arp_resolve</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">22</span><span class="p">(</span><span class="n">lr_in_chk_pkt_len</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">23</span><span class="p">(</span><span class="n">lr_in_larger_pkts</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">24</span><span class="p">(</span><span class="n">lr_in_gw_redirect</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">25</span><span class="p">(</span><span class="n">lr_in_network_id</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;r1s0&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">reg0</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">0.254</span><span class="o">/</span><span class="m">24</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">flags.network_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">25</span><span class="p">(</span><span class="n">lr_in_network_id</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;r1s1&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">reg0</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">1.254</span><span class="o">/</span><span class="m">24</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">flags.network_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">25</span><span class="p">(</span><span class="n">lr_in_network_id</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">105</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">flags.network_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">25</span><span class="p">(</span><span class="n">lr_in_network_id</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">26</span><span class="p">(</span><span class="n">lr_in_arp_request</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">reg9</span><span class="p">[</span><span class="m">9</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">nd_ns</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">nd.target</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xxreg0</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">26</span><span class="p">(</span><span class="n">lr_in_arp_request</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">reg9</span><span class="p">[</span><span class="m">9</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">arp</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">eth.dst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="p">;</span><span class="w"> </span><span class="n">arp.spa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg5</span><span class="p">;</span><span class="w"> </span><span class="n">arp.tpa</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg0</span><span class="p">;</span><span class="w"> </span><span class="n">arp.op</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">26</span><span class="p">(</span><span class="n">lr_in_arp_request</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">output</span><span class="p">;)</span>
<span class="n">Datapath</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;r1&quot;</span><span class="w"> </span><span class="p">(</span><span class="m">1287</span><span class="n">fc2b</span><span class="m">-1e3</span><span class="n">b</span><span class="m">-4</span><span class="n">bf9</span><span class="m">-8</span><span class="n">cf8</span><span class="o">-</span><span class="n">db890e663dc3</span><span class="p">)</span><span class="w">  </span><span class="n">Pipeline</span><span class="o">:</span><span class="w"> </span><span class="n">egress</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">lr_out_chk_dnat_local</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg9</span><span class="p">[</span><span class="m">4</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="p">(</span><span class="n">lr_out_undnat</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="p">(</span><span class="n">lr_out_post_undnat</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_out_snat</span><span class="w">        </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">120</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd_ns</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">lr_out_snat</span><span class="w">        </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="p">(</span><span class="n">lr_out_post_snat</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">5</span><span class="w"> </span><span class="p">(</span><span class="n">lr_out_egr_loop</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">lr_out_delivery</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;r1s0&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">lr_out_delivery</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;r1s1&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">lr_out_delivery</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="n">Datapath</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;s0&quot;</span><span class="w"> </span><span class="p">(</span><span class="m">49345921</span><span class="o">-</span><span class="n">e4da</span><span class="m">-4816</span><span class="o">-</span><span class="n">bf85</span><span class="o">-</span><span class="n">b092efe8eb29</span><span class="p">)</span><span class="w">  </span><span class="n">Pipeline</span><span class="o">:</span><span class="w"> </span><span class="n">ingress</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">120</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(((</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="n">ff</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">flags.tunnel_rx</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">inport</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">(</span><span class="n">pipeline</span><span class="o">=</span><span class="n">ingress</span><span class="p">,</span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">);)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(((</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">eth.src</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">01</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">outport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;port01&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="nf">is_chassis_resident</span><span class="p">(</span><span class="s">&quot;port01&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">flags.tunnel_rx</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">inport</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(((</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">eth.src</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">02</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">outport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;port02&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="nf">is_chassis_resident</span><span class="p">(</span><span class="s">&quot;port02&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">flags.tunnel_rx</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">inport</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">105</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(((</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">flags.tunnel_rx</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.src</span><span class="p">[</span><span class="m">40</span><span class="p">]),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">vlan.present</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">70</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">inport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;s0r1&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">18</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">15</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">check_in_port_sec</span><span class="p">();</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_apply_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">15</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_apply_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_mirror</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_lookup_fdb</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_put_fdb</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">5</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_acl</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">$</span><span class="n">svc_monitor_mac</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">5</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_acl</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_lb</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(((</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">flags.tunnel_rx</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_lb</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">$</span><span class="n">svc_monitor_mac</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_lb</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.mcast</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_lb</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">inport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;s0r1&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_lb</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_rs</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_ra</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv2</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_lb</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">16</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_lb</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">7</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_stateful</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">115</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip.is_frag</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">19</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">ct_lb_mark</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">7</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_stateful</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_lb_mark</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">7</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_stateful</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">7</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_stateful</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">8</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_acl_hint</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">65535</span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">9</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_acl_eval</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">65535</span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">9</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_acl_eval</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">65532</span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_ra</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_rs</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv2</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg8</span><span class="p">[</span><span class="m">16</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">10</span><span class="p">(</span><span class="n">ls_in_acl_sample</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">11</span><span class="p">(</span><span class="n">ls_in_acl_action</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">12</span><span class="p">(</span><span class="n">ls_in_qos</span><span class="w">          </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">13</span><span class="p">(</span><span class="n">ls_in_lb_aff_check</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">14</span><span class="p">(</span><span class="n">ls_in_lb</span><span class="w">           </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">15</span><span class="p">(</span><span class="n">ls_in_lb_aff_learn</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">16</span><span class="p">(</span><span class="n">ls_in_pre_hairpin</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">17</span><span class="p">(</span><span class="n">ls_in_nat_hairpin</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">18</span><span class="p">(</span><span class="n">ls_in_hairpin</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">19</span><span class="p">(</span><span class="n">ls_in_acl_after_lb_eval</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">65532</span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_ra</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_rs</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv2</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg8</span><span class="p">[</span><span class="m">16</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">19</span><span class="p">(</span><span class="n">ls_in_acl_after_lb_eval</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">20</span><span class="p">(</span><span class="n">ls_in_acl_after_lb_sample</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">21</span><span class="p">(</span><span class="n">ls_in_acl_after_lb_action</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">22</span><span class="p">(</span><span class="n">ls_in_stateful</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">13</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_commit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">ct_mark.blocked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">ct_mark.allow_established</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">20</span><span class="p">];</span><span class="w"> </span><span class="n">ct_label.acl_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg2</span><span class="p">[</span><span class="m">16</span><span class="kc">..31</span><span class="p">];</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">22</span><span class="p">(</span><span class="n">ls_in_stateful</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">13</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_commit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">ct_mark.blocked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">ct_mark.allow_established</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">20</span><span class="p">];</span><span class="w"> </span><span class="n">ct_mark.obs_stage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg8</span><span class="p">[</span><span class="m">19</span><span class="kc">..20</span><span class="p">];</span><span class="w"> </span><span class="n">ct_mark.obs_collector_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg8</span><span class="p">[</span><span class="m">8</span><span class="kc">..15</span><span class="p">];</span><span class="w"> </span><span class="n">ct_label.obs_point_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg9</span><span class="p">;</span><span class="w"> </span><span class="n">ct_label.acl_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg2</span><span class="p">[</span><span class="m">16</span><span class="kc">..31</span><span class="p">];</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">22</span><span class="p">(</span><span class="n">ls_in_stateful</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">23</span><span class="p">(</span><span class="n">ls_in_arp_rsp</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">24</span><span class="p">(</span><span class="n">ls_in_dhcp_options</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">25</span><span class="p">(</span><span class="n">ls_in_dhcp_response</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">26</span><span class="p">(</span><span class="n">ls_in_dns_lookup</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">27</span><span class="p">(</span><span class="n">ls_in_dns_response</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">28</span><span class="p">(</span><span class="n">ls_in_external_port</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">$</span><span class="n">svc_monitor_mac</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">tcp</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">icmp</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">icmp6</span><span class="p">)),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="nf">handle_svc_check</span><span class="p">(</span><span class="n">inport</span><span class="p">);)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">80</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">flags</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">arp.op</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">arp.tpa</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">0.254</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">clone</span><span class="w"> </span><span class="p">{</span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;s0r1&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;_MC_flood_l2&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">80</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">flags</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nd_ns</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nd.target</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">fe80</span><span class="o">::</span><span class="m">200</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">fe00</span><span class="o">:</span><span class="n">ff</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">clone</span><span class="w"> </span><span class="p">{</span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;s0r1&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;_MC_flood_l2&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">75</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.src</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">{</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="n">ff</span><span class="p">}</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">arp.op</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">rarp.op</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_ns</span><span class="p">)),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;_MC_flood_l2&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">70</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.mcast</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;_MC_flood&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">01</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;port01&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">02</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;port02&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="n">ff</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;s0r1&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">get_fdb</span><span class="p">(</span><span class="n">eth.dst</span><span class="p">);</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">30</span><span class="p">(</span><span class="n">ls_in_l2_unknown</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;none&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">30</span><span class="p">(</span><span class="n">ls_in_l2_unknown</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">output</span><span class="p">;)</span>
<span class="n">Datapath</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;s0&quot;</span><span class="w"> </span><span class="p">(</span><span class="m">49345921</span><span class="o">-</span><span class="n">e4da</span><span class="m">-4816</span><span class="o">-</span><span class="n">bf85</span><span class="o">-</span><span class="n">b092efe8eb29</span><span class="p">)</span><span class="w">  </span><span class="n">Pipeline</span><span class="o">:</span><span class="w"> </span><span class="n">egress</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_lookup_fdb</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_put_fdb</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_acl</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.src</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">$</span><span class="n">svc_monitor_mac</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_acl</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_lb</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.mcast</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_lb</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.src</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">$</span><span class="n">svc_monitor_mac</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_lb</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">outport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;s0r1&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_clear</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_lb</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_rs</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_ra</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv2</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_lb</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">16</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_lb</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_stateful</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_lb_mark</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_stateful</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_stateful</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">5</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_acl_hint</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">65535</span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_acl_eval</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">65535</span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_acl_eval</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">65532</span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_ra</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_rs</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv2</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg8</span><span class="p">[</span><span class="m">16</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">7</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_acl_sample</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">8</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_acl_action</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">9</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_mirror</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">10</span><span class="p">(</span><span class="n">ls_out_qos</span><span class="w">         </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">11</span><span class="p">(</span><span class="n">ls_out_stateful</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">13</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_commit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">ct_mark.blocked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">ct_mark.allow_established</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">20</span><span class="p">];</span><span class="w"> </span><span class="n">ct_label.acl_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg2</span><span class="p">[</span><span class="m">16</span><span class="kc">..31</span><span class="p">];</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">11</span><span class="p">(</span><span class="n">ls_out_stateful</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">13</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_commit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">ct_mark.blocked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">ct_mark.allow_established</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">20</span><span class="p">];</span><span class="w"> </span><span class="n">ct_mark.obs_stage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg8</span><span class="p">[</span><span class="m">19</span><span class="kc">..20</span><span class="p">];</span><span class="w"> </span><span class="n">ct_mark.obs_collector_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg8</span><span class="p">[</span><span class="m">8</span><span class="kc">..15</span><span class="p">];</span><span class="w"> </span><span class="n">ct_label.obs_point_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg9</span><span class="p">;</span><span class="w"> </span><span class="n">ct_label.acl_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg2</span><span class="p">[</span><span class="m">16</span><span class="kc">..31</span><span class="p">];</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">11</span><span class="p">(</span><span class="n">ls_out_stateful</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">12</span><span class="p">(</span><span class="n">ls_out_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.mcast</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">15</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">12</span><span class="p">(</span><span class="n">ls_out_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">15</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">check_out_port_sec</span><span class="p">();</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">13</span><span class="p">(</span><span class="n">ls_out_apply_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">15</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">13</span><span class="p">(</span><span class="n">ls_out_apply_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">output</span><span class="p">;)</span>
<span class="n">Datapath</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;s1&quot;</span><span class="w"> </span><span class="p">(</span><span class="n">d0f86629</span><span class="o">-</span><span class="n">a2df</span><span class="m">-4188</span><span class="o">-</span><span class="n">a210</span><span class="m">-98</span><span class="n">fbfd4124b6</span><span class="p">)</span><span class="w">  </span><span class="n">Pipeline</span><span class="o">:</span><span class="w"> </span><span class="n">ingress</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">120</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(((</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">01</span><span class="o">:</span><span class="n">ff</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">flags.tunnel_rx</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">inport</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">(</span><span class="n">pipeline</span><span class="o">=</span><span class="n">ingress</span><span class="p">,</span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">);)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(((</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">eth.src</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">01</span><span class="o">:</span><span class="m">01</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">outport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;port11&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="nf">is_chassis_resident</span><span class="p">(</span><span class="s">&quot;port11&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">flags.tunnel_rx</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">inport</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(((</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">eth.src</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">01</span><span class="o">:</span><span class="m">02</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">outport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;port12&quot;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="o">!</span><span class="nf">is_chassis_resident</span><span class="p">(</span><span class="s">&quot;port12&quot;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">flags.tunnel_rx</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">&lt;-&gt;</span><span class="w"> </span><span class="n">inport</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">105</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(((</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">flags.tunnel_rx</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.src</span><span class="p">[</span><span class="m">40</span><span class="p">]),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">vlan.present</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">70</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">inport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;s1r1&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">18</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">15</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">check_in_port_sec</span><span class="p">();</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_apply_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">15</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_apply_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_mirror</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_lookup_fdb</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_put_fdb</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">5</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_acl</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">$</span><span class="n">svc_monitor_mac</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">5</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_acl</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_lb</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(((</span><span class="n">ip4</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp4.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">4</span><span class="p">)</span><span class="w"> </span><span class="o">||</span><span class="p">(</span><span class="n">ip6</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">2</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">icmp6.code</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">))</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">flags.tunnel_rx</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_lb</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">$</span><span class="n">svc_monitor_mac</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_lb</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.mcast</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_lb</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">inport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;s1r1&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_lb</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_rs</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_ra</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv2</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_lb</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">16</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_lb</span><span class="w">       </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">7</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_stateful</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">115</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ip.is_frag</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">19</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="n">ct_lb_mark</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">7</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_stateful</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_lb_mark</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">7</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_stateful</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">7</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_pre_stateful</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">8</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_acl_hint</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">65535</span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">9</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_acl_eval</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">65535</span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">9</span><span class="w"> </span><span class="p">(</span><span class="n">ls_in_acl_eval</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">65532</span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_ra</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_rs</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv2</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg8</span><span class="p">[</span><span class="m">16</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">10</span><span class="p">(</span><span class="n">ls_in_acl_sample</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">11</span><span class="p">(</span><span class="n">ls_in_acl_action</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">12</span><span class="p">(</span><span class="n">ls_in_qos</span><span class="w">          </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">13</span><span class="p">(</span><span class="n">ls_in_lb_aff_check</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">14</span><span class="p">(</span><span class="n">ls_in_lb</span><span class="w">           </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">15</span><span class="p">(</span><span class="n">ls_in_lb_aff_learn</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">16</span><span class="p">(</span><span class="n">ls_in_pre_hairpin</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">17</span><span class="p">(</span><span class="n">ls_in_nat_hairpin</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">18</span><span class="p">(</span><span class="n">ls_in_hairpin</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">19</span><span class="p">(</span><span class="n">ls_in_acl_after_lb_eval</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">65532</span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_ra</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_rs</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv2</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg8</span><span class="p">[</span><span class="m">16</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">19</span><span class="p">(</span><span class="n">ls_in_acl_after_lb_eval</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">20</span><span class="p">(</span><span class="n">ls_in_acl_after_lb_sample</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">21</span><span class="p">(</span><span class="n">ls_in_acl_after_lb_action</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">22</span><span class="p">(</span><span class="n">ls_in_stateful</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">13</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_commit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">ct_mark.blocked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">ct_mark.allow_established</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">20</span><span class="p">];</span><span class="w"> </span><span class="n">ct_label.acl_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg2</span><span class="p">[</span><span class="m">16</span><span class="kc">..31</span><span class="p">];</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">22</span><span class="p">(</span><span class="n">ls_in_stateful</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">13</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_commit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">ct_mark.blocked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">ct_mark.allow_established</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">20</span><span class="p">];</span><span class="w"> </span><span class="n">ct_mark.obs_stage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg8</span><span class="p">[</span><span class="m">19</span><span class="kc">..20</span><span class="p">];</span><span class="w"> </span><span class="n">ct_mark.obs_collector_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg8</span><span class="p">[</span><span class="m">8</span><span class="kc">..15</span><span class="p">];</span><span class="w"> </span><span class="n">ct_label.obs_point_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg9</span><span class="p">;</span><span class="w"> </span><span class="n">ct_label.acl_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg2</span><span class="p">[</span><span class="m">16</span><span class="kc">..31</span><span class="p">];</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">22</span><span class="p">(</span><span class="n">ls_in_stateful</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">23</span><span class="p">(</span><span class="n">ls_in_arp_rsp</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">24</span><span class="p">(</span><span class="n">ls_in_dhcp_options</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">25</span><span class="p">(</span><span class="n">ls_in_dhcp_response</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">26</span><span class="p">(</span><span class="n">ls_in_dns_lookup</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">27</span><span class="p">(</span><span class="n">ls_in_dns_response</span><span class="w"> </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">28</span><span class="p">(</span><span class="n">ls_in_external_port</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">$</span><span class="n">svc_monitor_mac</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">tcp</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">icmp</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">icmp6</span><span class="p">)),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="nf">handle_svc_check</span><span class="p">(</span><span class="n">inport</span><span class="p">);)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">80</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">flags</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">arp.op</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">arp.tpa</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">10.0</span><span class="n">.</span><span class="m">1.254</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">clone</span><span class="w"> </span><span class="p">{</span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;s1r1&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;_MC_flood_l2&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">80</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">flags</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nd_ns</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">nd.target</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">fe80</span><span class="o">::</span><span class="m">200</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">fe00</span><span class="o">:</span><span class="m">1</span><span class="n">ff</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">clone</span><span class="w"> </span><span class="p">{</span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;s1r1&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;_MC_flood_l2&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">75</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.src</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="p">{</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">01</span><span class="o">:</span><span class="n">ff</span><span class="p">}</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="o">:</span><span class="n">ff</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="p">(</span><span class="n">arp.op</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">rarp.op</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">3</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_ns</span><span class="p">)),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;_MC_flood_l2&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">70</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.mcast</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;_MC_flood&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">01</span><span class="o">:</span><span class="m">01</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;port11&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">01</span><span class="o">:</span><span class="m">02</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;port12&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.dst</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">00</span><span class="o">:</span><span class="m">01</span><span class="o">:</span><span class="n">ff</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;s1r1&quot;</span><span class="p">;</span><span class="w"> </span><span class="n">output</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">29</span><span class="p">(</span><span class="n">ls_in_l2_lkup</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">get_fdb</span><span class="p">(</span><span class="n">eth.dst</span><span class="p">);</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">30</span><span class="p">(</span><span class="n">ls_in_l2_unknown</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">outport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;none&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">30</span><span class="p">(</span><span class="n">ls_in_l2_unknown</span><span class="w">   </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">output</span><span class="p">;)</span>
<span class="n">Datapath</span><span class="o">:</span><span class="w"> </span><span class="s">&quot;s1&quot;</span><span class="w"> </span><span class="p">(</span><span class="n">d0f86629</span><span class="o">-</span><span class="n">a2df</span><span class="m">-4188</span><span class="o">-</span><span class="n">a210</span><span class="m">-98</span><span class="n">fbfd4124b6</span><span class="p">)</span><span class="w">  </span><span class="n">Pipeline</span><span class="o">:</span><span class="w"> </span><span class="n">egress</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">0</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_lookup_fdb</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">1</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_put_fdb</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_acl</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.src</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">$</span><span class="n">svc_monitor_mac</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">2</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_acl</span><span class="w">     </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_lb</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.mcast</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_lb</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.src</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="o">$</span><span class="n">svc_monitor_mac</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_lb</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">ip</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">outport</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="s">&quot;s1r1&quot;</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_clear</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_lb</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_rs</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_ra</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv2</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_lb</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">16</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">3</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_lb</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_stateful</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">110</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">2</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_lb_mark</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_stateful</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">0</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">4</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_pre_stateful</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">5</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_acl_hint</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">65535</span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_acl_eval</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">65535</span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">6</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_acl_eval</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">65532</span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">nd</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_ra</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">nd_rs</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv1</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">mldv2</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg8</span><span class="p">[</span><span class="m">16</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">1</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">7</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_acl_sample</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">8</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_acl_action</span><span class="w">  </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">9</span><span class="w"> </span><span class="p">(</span><span class="n">ls_out_mirror</span><span class="w">      </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">10</span><span class="p">(</span><span class="n">ls_out_qos</span><span class="w">         </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">11</span><span class="p">(</span><span class="n">ls_out_stateful</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">13</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">0</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_commit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">ct_mark.blocked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">ct_mark.allow_established</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">20</span><span class="p">];</span><span class="w"> </span><span class="n">ct_label.acl_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg2</span><span class="p">[</span><span class="m">16</span><span class="kc">..31</span><span class="p">];</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">11</span><span class="p">(</span><span class="n">ls_out_stateful</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">1</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">13</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">ct_commit</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="n">ct_mark.blocked</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="n">ct_mark.allow_established</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg0</span><span class="p">[</span><span class="m">20</span><span class="p">];</span><span class="w"> </span><span class="n">ct_mark.obs_stage</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg8</span><span class="p">[</span><span class="m">19</span><span class="kc">..20</span><span class="p">];</span><span class="w"> </span><span class="n">ct_mark.obs_collector_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg8</span><span class="p">[</span><span class="m">8</span><span class="kc">..15</span><span class="p">];</span><span class="w"> </span><span class="n">ct_label.obs_point_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg9</span><span class="p">;</span><span class="w"> </span><span class="n">ct_label.acl_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">reg2</span><span class="p">[</span><span class="m">16</span><span class="kc">..31</span><span class="p">];</span><span class="w"> </span><span class="p">};</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">11</span><span class="p">(</span><span class="n">ls_out_stateful</span><span class="w">    </span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">12</span><span class="p">(</span><span class="n">ls_out_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">100</span><span class="w">  </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">eth.mcast</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">15</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="m">0</span><span class="p">;</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">12</span><span class="p">(</span><span class="n">ls_out_check_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">15</span><span class="p">]</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">check_out_port_sec</span><span class="p">();</span><span class="w"> </span><span class="kr">next</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">13</span><span class="p">(</span><span class="n">ls_out_apply_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">50</span><span class="w">   </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="n">reg0</span><span class="p">[</span><span class="m">15</span><span class="p">]</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">drop</span><span class="p">;)</span>
<span class="w">  </span><span class="n">table</span><span class="o">=</span><span class="m">13</span><span class="p">(</span><span class="n">ls_out_apply_port_sec</span><span class="p">),</span><span class="w"> </span><span class="n">priority</span><span class="o">=</span><span class="m">0</span><span class="w">    </span><span class="p">,</span><span class="w"> </span><span class="n">match</span><span class="o">=</span><span class="p">(</span><span class="m">1</span><span class="p">),</span><span class="w"> </span><span class="n">action</span><span class="o">=</span><span class="p">(</span><span class="n">output</span><span class="p">;)</span>
</code></pre></div></td></tr></table></div>
<p>Last but not least, run a test ping between the namespaces on both hosts:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@ovn2 ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="n">netns</span><span class="w"> </span><span class="k">exec</span><span class="w"> </span><span class="n">ns0</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="mf">10.0.1.1</span><span class="w"> </span><span class="o">-</span><span class="n">c1</span><span class="w"> </span><span class="o">-</span><span class="n">W1</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="n">ns1</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">ovn2</span>
<span class="o">[</span><span class="n">root@ovn2 ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="n">netns</span><span class="w"> </span><span class="k">exec</span><span class="w"> </span><span class="n">ns0</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="mf">10.0.1.2</span><span class="w"> </span><span class="o">-</span><span class="n">c1</span><span class="w"> </span><span class="o">-</span><span class="n">W1</span><span class="w"> </span><span class="err">#</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="n">ns1</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">ovn3</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@ovn2 ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="n">netns</span><span class="w"> </span><span class="k">exec</span><span class="w"> </span><span class="n">ns0</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="mf">10.0.1.1</span><span class="w"> </span><span class="o">-</span><span class="n">c1</span><span class="w"> </span><span class="o">-</span><span class="n">W1</span>
<span class="n">PING</span><span class="w"> </span><span class="mf">10.0.1.1</span><span class="w"> </span><span class="p">(</span><span class="mf">10.0.1.1</span><span class="p">)</span><span class="w"> </span><span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">data</span><span class="p">.</span>
<span class="mi">64</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mf">10.0.1.1</span><span class="err">:</span><span class="w"> </span><span class="n">icmp_seq</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">63</span><span class="w"> </span><span class="nc">time</span><span class="o">=</span><span class="mf">18.3</span><span class="w"> </span><span class="n">ms</span>

<span class="c1">--- 10.0.1.1 ping statistics ---</span>
<span class="mi">1</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">transmitted</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">received</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="o">%</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">loss</span><span class="p">,</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="mi">0</span><span class="n">ms</span>
<span class="n">rtt</span><span class="w"> </span><span class="nf">min</span><span class="o">/</span><span class="nf">avg</span><span class="o">/</span><span class="nf">max</span><span class="o">/</span><span class="n">mdev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">18.334</span><span class="o">/</span><span class="mf">18.334</span><span class="o">/</span><span class="mf">18.334</span><span class="o">/</span><span class="mf">0.000</span><span class="w"> </span><span class="n">ms</span>
<span class="o">[</span><span class="n">root@ovn2 ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="n">netns</span><span class="w"> </span><span class="k">exec</span><span class="w"> </span><span class="n">ns0</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="mf">10.0.1.2</span><span class="w"> </span><span class="o">-</span><span class="n">c1</span><span class="w"> </span><span class="o">-</span><span class="n">W1</span>
<span class="n">PING</span><span class="w"> </span><span class="mf">10.0.1.2</span><span class="w"> </span><span class="p">(</span><span class="mf">10.0.1.2</span><span class="p">)</span><span class="w"> </span><span class="mi">56</span><span class="p">(</span><span class="mi">84</span><span class="p">)</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">data</span><span class="p">.</span>
<span class="mi">64</span><span class="w"> </span><span class="n">bytes</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="mf">10.0.1.2</span><span class="err">:</span><span class="w"> </span><span class="n">icmp_seq</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="n">ttl</span><span class="o">=</span><span class="mi">63</span><span class="w"> </span><span class="nc">time</span><span class="o">=</span><span class="mf">14.3</span><span class="w"> </span><span class="n">ms</span>

<span class="c1">--- 10.0.1.2 ping statistics ---</span>
<span class="mi">1</span><span class="w"> </span><span class="n">packets</span><span class="w"> </span><span class="n">transmitted</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="n">received</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="o">%</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">loss</span><span class="p">,</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="mi">0</span><span class="n">ms</span>
<span class="n">rtt</span><span class="w"> </span><span class="nf">min</span><span class="o">/</span><span class="nf">avg</span><span class="o">/</span><span class="nf">max</span><span class="o">/</span><span class="n">mdev</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mf">14.306</span><span class="o">/</span><span class="mf">14.306</span><span class="o">/</span><span class="mf">14.306</span><span class="o">/</span><span class="mf">0.000</span><span class="w"> </span><span class="n">ms</span>
<span class="o">[</span><span class="n">root@ovn2 ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span>
</code></pre></div></td></tr></table></div>
<h2 id="adding-external-gateway-router-non-distributed">Adding external gateway  router, non-distributed</h2>
<h3 id="introduction_1">Introduction</h3>
<p>Next, let's add a gateway router on ovn1 with interface enp2s0. This means that all traffic from the namespaces to the
outside world will egress from / ingress via ovn1.</p>
<p>https://www.ovn.org/support/dist-docs/ovn-architecture.7.html</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span>
<span class="normal">9</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">     </span><span class="nx">Gateway</span><span class="w"> </span><span class="nx">Routers</span>

<span class="w">       </span><span class="nx">A</span><span class="w"> </span><span class="nx">gateway</span><span class="w"> </span><span class="nx">router</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">logical</span><span class="w"> </span><span class="nx">router</span><span class="w"> </span><span class="nx">that</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="nx">bound</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">a</span><span class="w"> </span><span class="nx">physical</span><span class="w">  </span><span class="nx">loca</span><span class="err">‐</span>
<span class="w">       </span><span class="nx">tion</span><span class="p">.</span><span class="w">  </span><span class="nx">This</span><span class="w">  </span><span class="nx">includes</span><span class="w">  </span><span class="nx">all</span><span class="w">  </span><span class="nx">of</span><span class="w">  </span><span class="nx">the</span><span class="w">  </span><span class="nx">logical</span><span class="w"> </span><span class="nx">patch</span><span class="w"> </span><span class="nx">ports</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">logical</span>
<span class="w">       </span><span class="nx">router</span><span class="p">,</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nx">well</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nx">all</span><span class="w"> </span><span class="nx">of</span><span class="w"> </span><span class="nx">the</span><span class="w">  </span><span class="nx">peer</span><span class="w">  </span><span class="nx">logical</span><span class="w">  </span><span class="nx">patch</span><span class="w">  </span><span class="nx">ports</span><span class="w">  </span><span class="nx">on</span><span class="w">  </span><span class="nx">logical</span>
<span class="w">       </span><span class="nx">switches</span><span class="p">.</span><span class="w">  </span><span class="nx">In</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">OVN</span><span class="w"> </span><span class="nx">Southbound</span><span class="w"> </span><span class="nx">database</span><span class="p">,</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">Port_Binding</span><span class="w"> </span><span class="nx">entries</span><span class="w"> </span><span class="k">for</span>
<span class="w">       </span><span class="nx">these</span><span class="w"> </span><span class="nx">logical</span><span class="w"> </span><span class="nx">patch</span><span class="w"> </span><span class="nx">ports</span><span class="w"> </span><span class="nx">use</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="nx">l3gateway</span><span class="w"> </span><span class="nx">rather</span><span class="w"> </span><span class="nx">than</span><span class="w"> </span><span class="nx">patch</span><span class="p">,</span><span class="w">  </span><span class="k">in</span>
<span class="w">       </span><span class="nx">order</span><span class="w">  </span><span class="nx">to</span><span class="w">  </span><span class="nx">distinguish</span><span class="w">  </span><span class="nx">that</span><span class="w">  </span><span class="nx">these</span><span class="w">  </span><span class="nx">logical</span><span class="w"> </span><span class="nx">patch</span><span class="w"> </span><span class="nx">ports</span><span class="w"> </span><span class="nx">are</span><span class="w"> </span><span class="nx">bound</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">a</span>
<span class="w">       </span><span class="nx">chassis</span><span class="p">.</span>
</code></pre></div></td></tr></table></div>
<h3 id="setup_1">Setup</h3>
<p>Add provider bridge mapping on ovn1:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code># ovn1
ovs-vsctl set open . external-ids:ovn-bridge-mappings=provider:br-provider
ovs-vsctl --may-exist add-br br-provider
ovs-vsctl --may-exist add-port br-provider enp2s0
</code></pre></div></td></tr></table></div>
<p>Bind logical router rg (router gateway) to chassis ovn1 and assign an internal IP pointing towards the VMs: </p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code>chassis=$(ovn-sbctl --columns=name --bar find chassis hostname=ovn1)
ovn-nbctl create Logical_Router name=rg options:chassis=$chassis
ovn-nbctl lrp-add rg rgsj 00:00:00:01:00:01 10.1.0.1/30
</code></pre></div></td></tr></table></div>
<p>Create switch sj (switch join) and add the router port of rg to it:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">ls</span><span class="o">-</span><span class="nx">add</span><span class="w"> </span><span class="nx">sj</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">add</span><span class="w"> </span><span class="nx">sj</span><span class="w"> </span><span class="nx">sjrg</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">set</span><span class="o">-</span><span class="k">type</span><span class="w"> </span><span class="nx">sjrg</span><span class="w"> </span><span class="nx">router</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">set</span><span class="o">-</span><span class="nx">addresses</span><span class="w"> </span><span class="nx">sjrg</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">set</span><span class="o">-</span><span class="nx">options</span><span class="w"> </span><span class="nx">sjrg</span><span class="w"> </span><span class="nx">router</span><span class="o">-</span><span class="nx">port</span><span class="p">=</span><span class="nx">rgsj</span>
</code></pre></div></td></tr></table></div>
<p>Add r1 port to the join switch:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>ovn-nbctl lrp-add r1 r1sj 00:00:00:01:00:02 10.1.0.2/30
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">add</span><span class="w"> </span><span class="nx">sj</span><span class="w"> </span><span class="nx">sjr1</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">set</span><span class="o">-</span><span class="k">type</span><span class="w"> </span><span class="nx">sjr1</span><span class="w"> </span><span class="nx">router</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">set</span><span class="o">-</span><span class="nx">addresses</span><span class="w"> </span><span class="nx">sjr1</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">02</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">set</span><span class="o">-</span><span class="nx">options</span><span class="w"> </span><span class="nx">sjr1</span><span class="w"> </span><span class="nx">router</span><span class="o">-</span><span class="nx">port</span><span class="p">=</span><span class="nx">r1sj</span>
</code></pre></div></td></tr></table></div>
<p>Add routes - router gateway towards our 2 private subnets via r1 and r1 default route towards rg:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code>ovn-nbctl lr-route-add rg &quot;10.0.0.0/24&quot; 10.1.0.2
ovn-nbctl lr-route-add rg &quot;10.0.1.0/24&quot; 10.1.0.2
ovn-nbctl lr-route-add r1 &quot;0.0.0.0/0&quot; 10.1.0.1
</code></pre></div></td></tr></table></div>
<p>Verify routes:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span>
<span class="normal">68</span>
<span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@ovn1 ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">ovn</span><span class="o">-</span><span class="n">nbctl</span><span class="w"> </span><span class="n">lr</span><span class="o">-</span><span class="n">route</span><span class="o">-</span><span class="n">list</span><span class="w"> </span><span class="n">rg</span>
<span class="n">IPv4</span><span class="w"> </span><span class="n">Routes</span>
<span class="w">              </span><span class="mf">10.0.0.0</span><span class="o">/</span><span class="mi">24</span><span class="w">                  </span><span class="mf">10.1.0.2</span><span class="w"> </span><span class="n">dst</span><span class="o">-</span><span class="n">ip</span>
<span class="w">              </span><span class="mf">10.0.1.0</span><span class="o">/</span><span class="mi">24</span><span class="w">                  </span><span class="mf">10.1.0.2</span><span class="w"> </span><span class="n">dst</span><span class="o">-</span><span class="n">ip</span>
<span class="o">[</span><span class="n">root@ovn1 ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">ovn</span><span class="o">-</span><span class="n">nbctl</span><span class="w"> </span><span class="n">lr</span><span class="o">-</span><span class="n">route</span><span class="o">-</span><span class="n">list</span><span class="w"> </span><span class="n">r1</span>
<span class="n">IPv4</span><span class="w"> </span><span class="n">Routes</span>
<span class="w">                </span><span class="mf">0.0.0.0</span><span class="o">/</span><span class="mi">0</span><span class="w">                  </span><span class="mf">10.1.0.1</span><span class="w"> </span><span class="n">dst</span><span class="o">-</span><span class="n">ip</span>
<span class="o">[</span><span class="n">root@ovn1 ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">ovn</span><span class="o">-</span><span class="n">nbctl</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">Logical_router_Static_route</span>
<span class="n">_uuid</span><span class="w">               </span><span class="err">:</span><span class="w"> </span><span class="n">b99f6718</span><span class="o">-</span><span class="mi">0364</span><span class="o">-</span><span class="mi">4447</span><span class="o">-</span><span class="mi">8450</span><span class="o">-</span><span class="mi">0</span><span class="n">f8c71ac61fe</span>
<span class="n">bfd</span><span class="w">                 </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>
<span class="n">external_ids</span><span class="w">        </span><span class="err">:</span><span class="w"> </span><span class="err">{}</span>
<span class="n">ip_prefix</span><span class="w">           </span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;10.0.1.0/24&quot;</span>
<span class="n">nexthop</span><span class="w">             </span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;10.1.0.2&quot;</span>
<span class="n">options</span><span class="w">             </span><span class="err">:</span><span class="w"> </span><span class="err">{}</span>
<span class="n">output_port</span><span class="w">         </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>
<span class="n">policy</span><span class="w">              </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>
<span class="n">route_table</span><span class="w">         </span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;&quot;</span>
<span class="n">selection_fields</span><span class="w">    </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>

<span class="n">_uuid</span><span class="w">               </span><span class="err">:</span><span class="w"> </span><span class="n">aa67d0ac</span><span class="o">-</span><span class="mi">5</span><span class="n">b8c</span><span class="o">-</span><span class="mf">4e68</span><span class="o">-</span><span class="n">bdb1</span><span class="o">-</span><span class="mi">0</span><span class="n">a27f7fa48a6</span>
<span class="n">bfd</span><span class="w">                 </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>
<span class="n">external_ids</span><span class="w">        </span><span class="err">:</span><span class="w"> </span><span class="err">{}</span>
<span class="n">ip_prefix</span><span class="w">           </span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;0.0.0.0/0&quot;</span>
<span class="n">nexthop</span><span class="w">             </span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;10.1.0.1&quot;</span>
<span class="n">options</span><span class="w">             </span><span class="err">:</span><span class="w"> </span><span class="err">{}</span>
<span class="n">output_port</span><span class="w">         </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>
<span class="n">policy</span><span class="w">              </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>
<span class="n">route_table</span><span class="w">         </span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;&quot;</span>
<span class="n">selection_fields</span><span class="w">    </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>

<span class="n">_uuid</span><span class="w">               </span><span class="err">:</span><span class="w"> </span><span class="n">b9aad1d3</span><span class="o">-</span><span class="mi">2</span><span class="n">bb1</span><span class="o">-</span><span class="mi">4</span><span class="n">b4b</span><span class="o">-</span><span class="mi">8</span><span class="n">cc6</span><span class="o">-</span><span class="n">f0294d668c2a</span>
<span class="n">bfd</span><span class="w">                 </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>
<span class="n">external_ids</span><span class="w">        </span><span class="err">:</span><span class="w"> </span><span class="err">{}</span>
<span class="n">ip_prefix</span><span class="w">           </span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;10.0.0.0/24&quot;</span>
<span class="n">nexthop</span><span class="w">             </span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;10.1.0.2&quot;</span>
<span class="n">options</span><span class="w">             </span><span class="err">:</span><span class="w"> </span><span class="err">{}</span>
<span class="n">output_port</span><span class="w">         </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>
<span class="n">policy</span><span class="w">              </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>
<span class="n">route_table</span><span class="w">         </span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;&quot;</span>
<span class="n">selection_fields</span><span class="w">    </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>
<span class="o">[</span><span class="n">root@ovn1 ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">ovn</span><span class="o">-</span><span class="n">nbctl</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="n">Logical_router_Static_Route</span>
<span class="n">_uuid</span><span class="w">               </span><span class="err">:</span><span class="w"> </span><span class="n">b99f6718</span><span class="o">-</span><span class="mi">0364</span><span class="o">-</span><span class="mi">4447</span><span class="o">-</span><span class="mi">8450</span><span class="o">-</span><span class="mi">0</span><span class="n">f8c71ac61fe</span>
<span class="n">bfd</span><span class="w">                 </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>
<span class="n">external_ids</span><span class="w">        </span><span class="err">:</span><span class="w"> </span><span class="err">{}</span>
<span class="n">ip_prefix</span><span class="w">           </span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;10.0.1.0/24&quot;</span>
<span class="n">nexthop</span><span class="w">             </span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;10.1.0.2&quot;</span>
<span class="n">options</span><span class="w">             </span><span class="err">:</span><span class="w"> </span><span class="err">{}</span>
<span class="n">output_port</span><span class="w">         </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>
<span class="n">policy</span><span class="w">              </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>
<span class="n">route_table</span><span class="w">         </span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;&quot;</span>
<span class="n">selection_fields</span><span class="w">    </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>

<span class="n">_uuid</span><span class="w">               </span><span class="err">:</span><span class="w"> </span><span class="n">aa67d0ac</span><span class="o">-</span><span class="mi">5</span><span class="n">b8c</span><span class="o">-</span><span class="mf">4e68</span><span class="o">-</span><span class="n">bdb1</span><span class="o">-</span><span class="mi">0</span><span class="n">a27f7fa48a6</span>
<span class="n">bfd</span><span class="w">                 </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>
<span class="n">external_ids</span><span class="w">        </span><span class="err">:</span><span class="w"> </span><span class="err">{}</span>
<span class="n">ip_prefix</span><span class="w">           </span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;0.0.0.0/0&quot;</span>
<span class="n">nexthop</span><span class="w">             </span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;10.1.0.1&quot;</span>
<span class="n">options</span><span class="w">             </span><span class="err">:</span><span class="w"> </span><span class="err">{}</span>
<span class="n">output_port</span><span class="w">         </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>
<span class="n">policy</span><span class="w">              </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>
<span class="n">route_table</span><span class="w">         </span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;&quot;</span>
<span class="n">selection_fields</span><span class="w">    </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>

<span class="n">_uuid</span><span class="w">               </span><span class="err">:</span><span class="w"> </span><span class="n">b9aad1d3</span><span class="o">-</span><span class="mi">2</span><span class="n">bb1</span><span class="o">-</span><span class="mi">4</span><span class="n">b4b</span><span class="o">-</span><span class="mi">8</span><span class="n">cc6</span><span class="o">-</span><span class="n">f0294d668c2a</span>
<span class="n">bfd</span><span class="w">                 </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>
<span class="n">external_ids</span><span class="w">        </span><span class="err">:</span><span class="w"> </span><span class="err">{}</span>
<span class="n">ip_prefix</span><span class="w">           </span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;10.0.0.0/24&quot;</span>
<span class="n">nexthop</span><span class="w">             </span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;10.1.0.2&quot;</span>
<span class="n">options</span><span class="w">             </span><span class="err">:</span><span class="w"> </span><span class="err">{}</span>
<span class="n">output_port</span><span class="w">         </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>
<span class="n">policy</span><span class="w">              </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>
<span class="n">route_table</span><span class="w">         </span><span class="err">:</span><span class="w"> </span><span class="ss">&quot;&quot;</span>
<span class="n">selection_fields</span><span class="w">    </span><span class="err">:</span><span class="w"> </span><span class="err">[]</span>
</code></pre></div></td></tr></table></div></p>
<p>Add an external port to rg:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>ovn-nbctl lrp-add rg rgsp 00:00:00:02:00:ff 10.2.0.254/24
</code></pre></div></td></tr></table></div></p>
<p>Add provider network switch (sp):
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">ls</span><span class="o">-</span><span class="nx">add</span><span class="w"> </span><span class="nx">sp</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">add</span><span class="w"> </span><span class="nx">sp</span><span class="w"> </span><span class="nx">sprg</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">set</span><span class="o">-</span><span class="k">type</span><span class="w"> </span><span class="nx">sprg</span><span class="w"> </span><span class="nx">router</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">set</span><span class="o">-</span><span class="nx">addresses</span><span class="w"> </span><span class="nx">sprg</span><span class="w"> </span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="mi">02</span><span class="p">:</span><span class="mi">00</span><span class="p">:</span><span class="nx">ff</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">set</span><span class="o">-</span><span class="nx">options</span><span class="w"> </span><span class="nx">sprg</span><span class="w"> </span><span class="nx">router</span><span class="o">-</span><span class="nx">port</span><span class="p">=</span><span class="nx">rgsp</span>
</code></pre></div></td></tr></table></div></p>
<p>Add localnet port (enp2s0) to provider switch (sp):
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">add</span><span class="w"> </span><span class="nx">sp</span><span class="w"> </span><span class="nx">sp</span><span class="o">-</span><span class="nx">localnet</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">set</span><span class="o">-</span><span class="nx">addresses</span><span class="w"> </span><span class="nx">sp</span><span class="o">-</span><span class="nx">localnet</span><span class="w"> </span><span class="nx">unknown</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">set</span><span class="o">-</span><span class="k">type</span><span class="w"> </span><span class="nx">sp</span><span class="o">-</span><span class="nx">localnet</span><span class="w"> </span><span class="nx">localnet</span>
<span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">lsp</span><span class="o">-</span><span class="nx">set</span><span class="o">-</span><span class="nx">options</span><span class="w"> </span><span class="nx">sp</span><span class="o">-</span><span class="nx">localnet</span><span class="w"> </span><span class="nx">network_name</span><span class="p">=</span><span class="nx">provider</span>
</code></pre></div></td></tr></table></div></p>
<p>Verify on ovn1:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nv">ovs</span><span class="o">-</span><span class="nv">vsctl</span><span class="w"> </span><span class="k">show</span>
<span class="nv">ovn</span><span class="o">-</span><span class="nv">nbctl</span><span class="w"> </span><span class="k">show</span>
<span class="nv">ovn</span><span class="o">-</span><span class="nv">sbctl</span><span class="w"> </span><span class="k">show</span>
</code></pre></div></td></tr></table></div></p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">ovn1</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">ovs</span><span class="o">-</span><span class="nx">vsctl</span><span class="w"> </span><span class="nx">show</span>
<span class="mi">1717</span><span class="nx">f06c</span><span class="o">-</span><span class="nx">b2be</span><span class="o">-</span><span class="mi">42</span><span class="nx">f0</span><span class="o">-</span><span class="mi">99</span><span class="nx">c2</span><span class="o">-</span><span class="mi">5081333</span><span class="nx">e6ebb</span>
<span class="w">    </span><span class="nx">Bridge</span><span class="w"> </span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span>
<span class="w">        </span><span class="nx">fail_mode</span><span class="p">:</span><span class="w"> </span><span class="nx">secure</span>
<span class="w">        </span><span class="nx">datapath_type</span><span class="p">:</span><span class="w"> </span><span class="nx">system</span>
<span class="w">        </span><span class="nx">Port</span><span class="w"> </span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span>
<span class="w">            </span><span class="nx">Interface</span><span class="w"> </span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span>
<span class="w">                </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">internal</span>
<span class="w">        </span><span class="nx">Port</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="mi">108</span><span class="nx">c2b</span><span class="o">-</span><span class="mi">0</span>
<span class="w">            </span><span class="nx">Interface</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="mi">108</span><span class="nx">c2b</span><span class="o">-</span><span class="mi">0</span>
<span class="w">                </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">                </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">key</span><span class="p">=</span><span class="nx">flow</span><span class="p">,</span><span class="w"> </span><span class="nx">local_ip</span><span class="p">=</span><span class="s">&quot;192.168.122.182&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">remote_ip</span><span class="p">=</span><span class="s">&quot;192.168.122.159&quot;</span><span class="p">}</span>
<span class="w">        </span><span class="nx">Port</span><span class="w"> </span><span class="nx">patch</span><span class="o">-</span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span><span class="o">-</span><span class="nx">to</span><span class="o">-</span><span class="nx">sp</span><span class="o">-</span><span class="nx">localnet</span>
<span class="w">            </span><span class="nx">Interface</span><span class="w"> </span><span class="nx">patch</span><span class="o">-</span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span><span class="o">-</span><span class="nx">to</span><span class="o">-</span><span class="nx">sp</span><span class="o">-</span><span class="nx">localnet</span>
<span class="w">                </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">patch</span>
<span class="w">                </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">peer</span><span class="p">=</span><span class="nx">patch</span><span class="o">-</span><span class="nx">sp</span><span class="o">-</span><span class="nx">localnet</span><span class="o">-</span><span class="nx">to</span><span class="o">-</span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span><span class="p">}</span>
<span class="w">        </span><span class="nx">Port</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="mi">8</span><span class="nx">de4d5</span><span class="o">-</span><span class="mi">0</span>
<span class="w">            </span><span class="nx">Interface</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="mi">8</span><span class="nx">de4d5</span><span class="o">-</span><span class="mi">0</span>
<span class="w">                </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">                </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">key</span><span class="p">=</span><span class="nx">flow</span><span class="p">,</span><span class="w"> </span><span class="nx">local_ip</span><span class="p">=</span><span class="s">&quot;192.168.122.182&quot;</span><span class="p">,</span><span class="w"> </span><span class="nx">remote_ip</span><span class="p">=</span><span class="s">&quot;192.168.122.107&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="nx">Bridge</span><span class="w"> </span><span class="nx">br</span><span class="o">-</span><span class="nx">provider</span>
<span class="w">        </span><span class="nx">Port</span><span class="w"> </span><span class="nx">patch</span><span class="o">-</span><span class="nx">sp</span><span class="o">-</span><span class="nx">localnet</span><span class="o">-</span><span class="nx">to</span><span class="o">-</span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span>
<span class="w">            </span><span class="nx">Interface</span><span class="w"> </span><span class="nx">patch</span><span class="o">-</span><span class="nx">sp</span><span class="o">-</span><span class="nx">localnet</span><span class="o">-</span><span class="nx">to</span><span class="o">-</span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span>
<span class="w">                </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">patch</span>
<span class="w">                </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">peer</span><span class="p">=</span><span class="nx">patch</span><span class="o">-</span><span class="nx">br</span><span class="o">-</span><span class="nx">int</span><span class="o">-</span><span class="nx">to</span><span class="o">-</span><span class="nx">sp</span><span class="o">-</span><span class="nx">localnet</span><span class="p">}</span>
<span class="w">        </span><span class="nx">Port</span><span class="w"> </span><span class="nx">enp2s0</span>
<span class="w">            </span><span class="nx">Interface</span><span class="w"> </span><span class="nx">enp2s0</span>
<span class="w">        </span><span class="nx">Port</span><span class="w"> </span><span class="nx">br</span><span class="o">-</span><span class="nx">provider</span>
<span class="w">            </span><span class="nx">Interface</span><span class="w"> </span><span class="nx">br</span><span class="o">-</span><span class="nx">provider</span>
<span class="w">                </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">internal</span>
<span class="w">    </span><span class="nx">ovs_version</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3.5.90-1.fc42&quot;</span>
<span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">ovn1</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="nx">nbctl</span><span class="w"> </span><span class="nx">show</span>
<span class="nx">switch</span><span class="w"> </span><span class="nx">ecced6ae</span><span class="o">-</span><span class="mi">5</span><span class="nx">eb3</span><span class="o">-</span><span class="mi">4725</span><span class="o">-</span><span class="mi">825</span><span class="nx">a</span><span class="o">-</span><span class="nx">da4d7461b230</span><span class="w"> </span><span class="p">(</span><span class="nx">sp</span><span class="p">)</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">sp</span><span class="o">-</span><span class="nx">localnet</span>
<span class="w">        </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">localnet</span>
<span class="w">        </span><span class="nx">addresses</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;unknown&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">sprg</span>
<span class="w">        </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">router</span>
<span class="w">        </span><span class="nx">addresses</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;00:00:00:02:00:ff&quot;</span><span class="p">]</span>
<span class="w">        </span><span class="nx">router</span><span class="o">-</span><span class="nx">port</span><span class="p">:</span><span class="w"> </span><span class="nx">rgsp</span>
<span class="nx">switch</span><span class="w"> </span><span class="mi">70</span><span class="nx">a89317</span><span class="o">-</span><span class="mi">1</span><span class="nx">bc0</span><span class="o">-</span><span class="mi">4</span><span class="nx">fcb</span><span class="o">-</span><span class="mi">825</span><span class="nx">d</span><span class="o">-</span><span class="nx">c93754a5a6ca</span><span class="w"> </span><span class="p">(</span><span class="nx">s0</span><span class="p">)</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">port01</span>
<span class="w">        </span><span class="nx">addresses</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;00:00:00:00:00:01&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">s0r1</span>
<span class="w">        </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">router</span>
<span class="w">        </span><span class="nx">addresses</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;00:00:00:00:00:ff&quot;</span><span class="p">]</span>
<span class="w">        </span><span class="nx">router</span><span class="o">-</span><span class="nx">port</span><span class="p">:</span><span class="w"> </span><span class="nx">r1s0</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">port02</span>
<span class="w">        </span><span class="nx">addresses</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;00:00:00:00:00:02&quot;</span><span class="p">]</span>
<span class="nx">switch</span><span class="w"> </span><span class="mi">313</span><span class="nx">fb333</span><span class="o">-</span><span class="mi">5</span><span class="nx">c33</span><span class="o">-</span><span class="mi">4</span><span class="nx">bf2</span><span class="o">-</span><span class="mi">8936</span><span class="o">-</span><span class="mi">72514</span><span class="nx">bc20de3</span><span class="w"> </span><span class="p">(</span><span class="nx">s1</span><span class="p">)</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">s1r1</span>
<span class="w">        </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">router</span>
<span class="w">        </span><span class="nx">addresses</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;00:00:00:00:01:ff&quot;</span><span class="p">]</span>
<span class="w">        </span><span class="nx">router</span><span class="o">-</span><span class="nx">port</span><span class="p">:</span><span class="w"> </span><span class="nx">r1s1</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">port11</span>
<span class="w">        </span><span class="nx">addresses</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;00:00:00:00:01:01&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">port12</span>
<span class="w">        </span><span class="nx">addresses</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;00:00:00:00:01:02&quot;</span><span class="p">]</span>
<span class="nx">switch</span><span class="w"> </span><span class="mi">36</span><span class="nx">e27b77</span><span class="o">-</span><span class="mi">135</span><span class="nx">e</span><span class="o">-</span><span class="mi">4841</span><span class="o">-</span><span class="mi">93</span><span class="nx">b5</span><span class="o">-</span><span class="mi">013</span><span class="nx">b69da406e</span><span class="w"> </span><span class="p">(</span><span class="nx">sj</span><span class="p">)</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">sjrg</span>
<span class="w">        </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">router</span>
<span class="w">        </span><span class="nx">addresses</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;00:00:00:01:00:01&quot;</span><span class="p">]</span>
<span class="w">        </span><span class="nx">router</span><span class="o">-</span><span class="nx">port</span><span class="p">:</span><span class="w"> </span><span class="nx">rgsj</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">sjr1</span>
<span class="w">        </span><span class="k">type</span><span class="p">:</span><span class="w"> </span><span class="nx">router</span>
<span class="w">        </span><span class="nx">addresses</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;00:00:00:01:00:02&quot;</span><span class="p">]</span>
<span class="w">        </span><span class="nx">router</span><span class="o">-</span><span class="nx">port</span><span class="p">:</span><span class="w"> </span><span class="nx">r1sj</span>
<span class="nx">router</span><span class="w"> </span><span class="mi">5473</span><span class="nx">b860</span><span class="o">-</span><span class="mi">6</span><span class="nx">b45</span><span class="o">-</span><span class="mi">4190</span><span class="o">-</span><span class="nx">b88d</span><span class="o">-</span><span class="mi">070156</span><span class="nx">c4b1c3</span><span class="w"> </span><span class="p">(</span><span class="nx">rg</span><span class="p">)</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">rgsj</span>
<span class="w">        </span><span class="nx">mac</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;00:00:00:01:00:01&quot;</span>
<span class="w">        </span><span class="nx">ipv6</span><span class="o">-</span><span class="nx">lla</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;fe80::200:ff:fe01:1&quot;</span>
<span class="w">        </span><span class="nx">networks</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;10.1.0.1/30&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">rgsp</span>
<span class="w">        </span><span class="nx">mac</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;00:00:00:02:00:ff&quot;</span>
<span class="w">        </span><span class="nx">ipv6</span><span class="o">-</span><span class="nx">lla</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;fe80::200:ff:fe02:ff&quot;</span>
<span class="w">        </span><span class="nx">networks</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;10.2.0.254/24&quot;</span><span class="p">]</span>
<span class="nx">router</span><span class="w"> </span><span class="nx">fb0101fd</span><span class="o">-</span><span class="mi">881</span><span class="nx">e</span><span class="o">-</span><span class="mi">4</span><span class="nx">aa2</span><span class="o">-</span><span class="nx">ae05</span><span class="o">-</span><span class="mi">16</span><span class="nx">a93428dc53</span><span class="w"> </span><span class="p">(</span><span class="nx">r1</span><span class="p">)</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">r1s1</span>
<span class="w">        </span><span class="nx">mac</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;00:00:00:00:01:ff&quot;</span>
<span class="w">        </span><span class="nx">ipv6</span><span class="o">-</span><span class="nx">lla</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;fe80::200:ff:fe00:1ff&quot;</span>
<span class="w">        </span><span class="nx">networks</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;10.0.1.254/24&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">r1s0</span>
<span class="w">        </span><span class="nx">mac</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;00:00:00:00:00:ff&quot;</span>
<span class="w">        </span><span class="nx">ipv6</span><span class="o">-</span><span class="nx">lla</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;fe80::200:ff:fe00:ff&quot;</span>
<span class="w">        </span><span class="nx">networks</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;10.0.0.254/24&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="nx">port</span><span class="w"> </span><span class="nx">r1sj</span>
<span class="w">        </span><span class="nx">mac</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;00:00:00:01:00:02&quot;</span>
<span class="w">        </span><span class="nx">ipv6</span><span class="o">-</span><span class="nx">lla</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;fe80::200:ff:fe01:2&quot;</span>
<span class="w">        </span><span class="nx">networks</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s">&quot;10.1.0.2/30&quot;</span><span class="p">]</span>
<span class="p">[</span><span class="nx">root</span><span class="err">@</span><span class="nx">ovn1</span><span class="w"> </span><span class="o">~</span><span class="p">]</span><span class="err">#</span><span class="w"> </span><span class="nx">ovn</span><span class="o">-</span><span class="nx">sbctl</span><span class="w"> </span><span class="nx">show</span>
<span class="nx">Chassis</span><span class="w"> </span><span class="s">&quot;8de4d500-ab50-4ecc-a6df-3b5387efdf81&quot;</span>
<span class="w">    </span><span class="nx">hostname</span><span class="p">:</span><span class="w"> </span><span class="nx">ovn3</span>
<span class="w">    </span><span class="nx">Encap</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">        </span><span class="nx">ip</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.122.107&quot;</span>
<span class="w">        </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="nx">Port_Binding</span><span class="w"> </span><span class="nx">port02</span>
<span class="w">    </span><span class="nx">Port_Binding</span><span class="w"> </span><span class="nx">port12</span>
<span class="nx">Chassis</span><span class="w"> </span><span class="s">&quot;dacba18d-52f9-4adb-8b3d-8ca27b700a73&quot;</span>
<span class="w">    </span><span class="nx">hostname</span><span class="p">:</span><span class="w"> </span><span class="nx">ovn1</span>
<span class="w">    </span><span class="nx">Encap</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">        </span><span class="nx">ip</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.122.182&quot;</span>
<span class="w">        </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="nx">Port_Binding</span><span class="w"> </span><span class="nx">rgsj</span>
<span class="w">    </span><span class="nx">Port_Binding</span><span class="w"> </span><span class="nx">sprg</span>
<span class="w">    </span><span class="nx">Port_Binding</span><span class="w"> </span><span class="nx">rgsp</span>
<span class="w">    </span><span class="nx">Port_Binding</span><span class="w"> </span><span class="nx">sjrg</span>
<span class="nx">Chassis</span><span class="w"> </span><span class="s">&quot;108c2b72-5ab9-43a0-9617-55f23f16482a&quot;</span>
<span class="w">    </span><span class="nx">hostname</span><span class="p">:</span><span class="w"> </span><span class="nx">ovn2</span>
<span class="w">    </span><span class="nx">Encap</span><span class="w"> </span><span class="nx">geneve</span>
<span class="w">        </span><span class="nx">ip</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.122.159&quot;</span>
<span class="w">        </span><span class="nx">options</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="nx">csum</span><span class="p">=</span><span class="s">&quot;true&quot;</span><span class="p">}</span>
<span class="w">    </span><span class="nx">Port_Binding</span><span class="w"> </span><span class="nx">port01</span>
<span class="w">    </span><span class="nx">Port_Binding</span><span class="w"> </span><span class="nx">port11</span>
</code></pre></div></td></tr></table></div>
<p>Connect to ovn2 and simulate an external node, in the default network namespace.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="nx">nmcli</span><span class="w"> </span><span class="nx">conn</span><span class="w"> </span><span class="nx">mod</span><span class="w"> </span><span class="nx">enp2s0</span><span class="w"> </span><span class="nx">ipv4</span><span class="p">.</span><span class="nx">method</span><span class="w"> </span><span class="nx">manual</span><span class="w"> </span><span class="nx">ipv4</span><span class="p">.</span><span class="nx">address</span><span class="w"> </span><span class="m m-Double">10.2.0.10</span><span class="o">/</span><span class="mi">24</span><span class="w"> </span>\
<span class="w">  </span><span class="o">+</span><span class="nx">ipv4</span><span class="p">.</span><span class="nx">routes</span><span class="w"> </span><span class="s">&quot;10.0.1.0/24 10.2.0.254&quot;</span><span class="w"> </span>\
<span class="w">  </span><span class="o">+</span><span class="nx">ipv4</span><span class="p">.</span><span class="nx">routes</span><span class="w"> </span><span class="s">&quot;10.1.0.0/24 10.2.0.254&quot;</span><span class="w"> </span>\
<span class="w">  </span><span class="o">+</span><span class="nx">ipv4</span><span class="p">.</span><span class="nx">routes</span><span class="w"> </span><span class="s">&quot;10.0.0.0/24 10.2.0.254&quot;</span>
<span class="nx">nmcli</span><span class="w"> </span><span class="nx">conn</span><span class="w"> </span><span class="nx">up</span><span class="w"> </span><span class="nx">enp2s0</span>
</code></pre></div></td></tr></table></div>
<p>Verify:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@ovn2 ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="mf">10.0.0.1</span><span class="w"> </span><span class="o">-</span><span class="n">c1</span><span class="w"> </span><span class="o">-</span><span class="n">W1</span><span class="w"> </span><span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="k">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="ss">&quot;ok&quot;</span>
<span class="n">ok</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@ovn3 ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="n">netns</span><span class="w"> </span><span class="k">exec</span><span class="w"> </span><span class="n">ns0</span><span class="w"> </span><span class="n">ping</span><span class="w"> </span><span class="mf">10.2.0.10</span><span class="w"> </span><span class="o">-</span><span class="n">c1</span><span class="w"> </span><span class="o">-</span><span class="n">W1</span><span class="w"> </span><span class="o">&gt;/</span><span class="n">dev</span><span class="o">/</span><span class="k">null</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">echo</span><span class="w"> </span><span class="ss">&quot;ok&quot;</span>
<span class="n">ok</span>
</code></pre></div></td></tr></table></div>
<p>A tracepath should show all hops:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@ovn2 ~</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">ip</span><span class="w"> </span><span class="n">netns</span><span class="w"> </span><span class="k">exec</span><span class="w"> </span><span class="n">ns1</span><span class="w"> </span><span class="n">tracepath</span><span class="w"> </span><span class="o">-</span><span class="n">n</span><span class="w"> </span><span class="mf">10.2.0.10</span>
<span class="w"> </span><span class="mi">1</span><span class="vm">?</span><span class="err">:</span><span class="w"> </span><span class="o">[</span><span class="n">LOCALHOST</span><span class="o">]</span><span class="w">                      </span><span class="n">pmtu</span><span class="w"> </span><span class="mi">1500</span>
<span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w">  </span><span class="mf">10.0.1.254</span><span class="w">                                            </span><span class="mf">1.001</span><span class="n">ms</span><span class="w"> </span><span class="n">asymm</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span>
<span class="w"> </span><span class="mi">1</span><span class="err">:</span><span class="w">  </span><span class="mf">10.0.1.254</span><span class="w">                                            </span><span class="mf">0.696</span><span class="n">ms</span><span class="w"> </span><span class="n">asymm</span><span class="w">  </span><span class="mi">2</span><span class="w"> </span>
<span class="w"> </span><span class="mi">2</span><span class="err">:</span><span class="w">  </span><span class="k">no</span><span class="w"> </span><span class="n">reply</span>
<span class="w"> </span><span class="mi">3</span><span class="err">:</span><span class="w">  </span><span class="mf">10.2.0.10</span><span class="w">                                             </span><span class="mf">1.075</span><span class="n">ms</span><span class="w"> </span><span class="n">pmtu</span><span class="w"> </span><span class="mi">1442</span>
<span class="w"> </span><span class="mi">3</span><span class="err">:</span><span class="w">  </span><span class="mf">10.2.0.10</span><span class="w">                                             </span><span class="mf">3.760</span><span class="n">ms</span><span class="w"> </span><span class="n">reached</span>
<span class="w">     </span><span class="nl">Resume</span><span class="p">:</span><span class="w"> </span><span class="n">pmtu</span><span class="w"> </span><span class="mi">1442</span><span class="w"> </span><span class="n">hops</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span>
</code></pre></div></td></tr></table></div></p>
<h2 id="inspecting-tunnel-encapsulations">Inspecting tunnel encapsulations</h2>
<h3 id="introduction_2">Introduction</h3>
<p>For more information about OVN's VXLAN and Geneve encapsulations, see section "Tunnel Encapsulations" in
https://www.ovn.org/support/dist-docs/ovn-architecture.7.html</p>
<p>Here's an excerpt:</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="w">       </span><span class="nx">Due</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">its</span><span class="w"> </span><span class="nx">flexibility</span><span class="p">,</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">preferred</span><span class="w"> </span><span class="nx">encapsulation</span><span class="w"> </span><span class="nx">between</span><span class="w"> </span><span class="nx">hypervisors</span>
<span class="w">       </span><span class="k">is</span><span class="w"> </span><span class="nx">Geneve</span><span class="p">.</span><span class="w"> </span><span class="nx">For</span><span class="w"> </span><span class="nx">Geneve</span><span class="w"> </span><span class="nx">encapsulation</span><span class="p">,</span><span class="w"> </span><span class="nx">OVN</span><span class="w"> </span><span class="nx">transmits</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">logical</span><span class="w"> </span><span class="nx">datapath</span>
<span class="w">       </span><span class="nx">identifier</span><span class="w"> </span><span class="k">in</span><span class="w"> </span><span class="nx">the</span><span class="w"> </span><span class="nx">Geneve</span><span class="w"> </span><span class="nx">VNI</span><span class="p">.</span><span class="w"> </span><span class="nx">OVN</span><span class="w"> </span><span class="nx">transmits</span><span class="w">  </span><span class="nx">the</span><span class="w">  </span><span class="nx">logical</span><span class="w">  </span><span class="nx">ingress</span><span class="w">  </span><span class="k">and</span>
<span class="w">       </span><span class="nx">logical</span><span class="w">  </span><span class="nx">egress</span><span class="w">  </span><span class="nx">ports</span><span class="w">  </span><span class="k">in</span><span class="w">  </span><span class="nx">a</span><span class="w">  </span><span class="nx">TLV</span><span class="w">  </span><span class="nx">with</span><span class="w"> </span><span class="kd">class</span><span class="w"> </span><span class="mh">0x0102</span><span class="p">,</span><span class="w"> </span><span class="k">type</span><span class="w"> </span><span class="mh">0x80</span><span class="p">,</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="nx">a</span>
<span class="w">       </span><span class="mi">32</span><span class="o">-</span><span class="nx">bit</span><span class="w"> </span><span class="nx">value</span><span class="w"> </span><span class="nx">encoded</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nx">follows</span><span class="p">,</span><span class="w"> </span><span class="nx">from</span><span class="w"> </span><span class="nx">MSB</span><span class="w"> </span><span class="nx">to</span><span class="w"> </span><span class="nx">LSB</span><span class="p">:</span>

<span class="w">         </span><span class="mi">1</span><span class="w">       </span><span class="mi">15</span><span class="w">          </span><span class="mi">16</span>
<span class="w">       </span><span class="o">+---+------------+-----------+</span>
<span class="w">       </span><span class="o">|</span><span class="nx">rsv</span><span class="o">|</span><span class="nx">ingress</span><span class="w"> </span><span class="nx">port</span><span class="o">|</span><span class="nx">egress</span><span class="w"> </span><span class="nx">port</span><span class="o">|</span>
<span class="w">       </span><span class="o">+---+------------+-----------+</span>
<span class="w">         </span><span class="mi">0</span>
</code></pre></div></td></tr></table></div>
<h2 id="distributed-gateway-router">Distributed gateway router</h2>
<p>For more information about distributed gateway routes / ports, see the following blog post:</p>
<p><a href="https://developers.redhat.com/blog/2018/11/08/how-to-create-an-open-virtual-network-distributed-gateway-router/">https://developers.redhat.com/blog/2018/11/08/how-to-create-an-open-virtual-network-distributed-gateway-router/</a></p>
<h2 id="resources">Resources</h2>
<ul>
<li><a href="https://blog.scottlowe.org/2016/12/09/using-ovn-with-kvm-libvirt/">https://blog.scottlowe.org/2016/12/09/using-ovn-with-kvm-libvirt/</a></li>
<li><a href="https://baturin.org/docs/iproute2/">https://baturin.org/docs/iproute2/</a></li>
<li><a href="http://dani.foroselectronica.es/multinode-ovn-setup-509/">http://dani.foroselectronica.es/multinode-ovn-setup-509/</a></li>
<li><a href="https://hustcat.github.io/ovn-gateway-practice/">https://hustcat.github.io/ovn-gateway-practice/</a></li>
<li><a href="http://www.openvswitch.org/support/dist-docs/ovn-architecture.7.html">http://www.openvswitch.org/support/dist-docs/ovn-architecture.7.html</a></li>
<li><a href="https://www.redhat.com/en/blog/what-geneve">https://www.redhat.com/en/blog/what-geneve</a></li>
<li><a href="https://tools.ietf.org/html/draft-davie-stt-08">https://tools.ietf.org/html/draft-davie-stt-08</a></li>
<li><a href="https://tools.ietf.org/html/draft-ietf-nvo3-geneve-16">https://tools.ietf.org/html/draft-ietf-nvo3-geneve-16</a></li>
<li><a href="https://developers.redhat.com/blog/2018/11/08/how-to-create-an-open-virtual-network-distributed-gateway-router/">https://developers.redhat.com/blog/2018/11/08/how-to-create-an-open-virtual-network-distributed-gateway-router/</a></li>
<li><a href="http://docs.openvswitch.org/en/latest/intro/install/bash-completion/">http://docs.openvswitch.org/en/latest/intro/install/bash-completion/</a></li>
<li><a href="https://blog.russellbryant.net/2017/05/30/ovn-geneve-vs-vxlan-does-it-matter/">https://blog.russellbryant.net/2017/05/30/ovn-geneve-vs-vxlan-does-it-matter/</a></li>
</ul>







  
    
  
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">June 26, 2025</span>
  </span>

    
    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.prune", "navigation.top", "navigation.path", "navigation.indexes", "toc.follow", "toc.integrate"], "search": "../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.60a45f97.min.js"></script>
      
    
  </body>
</html>