
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>OVS packet recirculation - Andreas Karis Blog</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="pink">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ovs-packet-recirculation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Andreas Karis Blog" class="md-header__button md-logo" aria-label="Andreas Karis Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Andreas Karis Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              OVS packet recirculation
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Andreas Karis Blog" class="md-nav__button md-logo" aria-label="Andreas Karis Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Andreas Karis Blog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Ceph
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Ceph" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Ceph
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ceph/ceph-manual-test/" class="md-nav__link">
        Ceph manual test with qemu
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Containers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Containers" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Containers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/analyzing-cni/" class="md-nav__link">
        Analyzing CNI calls
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/cgroups/" class="md-nav__link">
        cgroups
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/containers/" class="md-nav__link">
        Containers in Linux
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/list_docker_registry_containers/" class="md-nav__link">
        List container images in registry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/namespaces/" class="md-nav__link">
        namespaces
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Linux
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Linux" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/cgroups/" class="md-nav__link">
        cgroups
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/containers/" class="md-nav__link">
        Containers in Linux
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/hugepages/" class="md-nav__link">
        Hugepages
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/ipxe-boot-environment/" class="md-nav__link">
        iPXE boot environment on Fedora
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/java-idrac-issues/" class="md-nav__link">
        Java Idrac Issues
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/meson/" class="md-nav__link">
        meson
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/namespaces/" class="md-nav__link">
        namespaces
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/old_java_version_with_xorgs_in_container/" class="md-nav__link">
        Old Java inside a container with xorgs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/get-process-cgroup-info-and-limits/" class="md-nav__link">
        Retrieving process cgroup resource usage and limit info
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/libvirt-uefi-without-secureboot/" class="md-nav__link">
        RHEL Booting a virtual machine with UEFI but without secure boot
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/setting-journalctl-limits/" class="md-nav__link">
        Setting journalctl limits
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" checked>
      
      <label class="md-nav__link" for="__nav_5">
        Networking
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Networking" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Networking
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../accept-source-routing/" class="md-nav__link">
        Accept Source Routing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../arp_and_the_neighbor_table/" class="md-nav__link">
        ARP and the Neighbor table
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../bpf-and-tcpdump/" class="md-nav__link">
        BPF and tcpdump
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../bonding_in_linux/" class="md-nav__link">
        Bonding in Linux
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../juniper_x520/" class="md-nav__link">
        Configure Juniper switch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../haproxy-and-h2c/" class="md-nav__link">
        haproxy and HTTP/2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../install-openvswitch-on-rocky/" class="md-nav__link">
        Install Open vSwitch on Rocky Linux 8
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../geneve_tunneling/" class="md-nav__link">
        Geneve tunneling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../netlink/" class="md-nav__link">
        Netlink
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ovn_standalone_on_fedora31/" class="md-nav__link">
        OVN standalone on Fedora 31
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        OVS packet recirculation
      </a>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ovs-vxlan-tunnels-and-dscp/" class="md-nav__link">
        OVS VXLAN tunnels and DSCP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ovs_with_gdb/" class="md-nav__link">
        OVS with GDB
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../packet-tracing-with-ovn/" class="md-nav__link">
        Packet tracing with OVN
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../sctp/" class="md-nav__link">
        SCTP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../useful-commands/" class="md-nav__link">
        Useful commands
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../wireguard/" class="md-nav__link">
        Wireguard
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" >
      
      <label class="md-nav__link" for="__nav_6">
        OpenShift
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="OpenShift" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          OpenShift
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/alertmanager/" class="md-nav__link">
        AlertManager
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/cpu-manager-with-custom-machine-config-pool/" class="md-nav__link">
        CPU manager with custom MachineConfigPool
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/crio-conmon-runc/" class="md-nav__link">
        Crio vs conmon vs runc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/etcd_perf/" class="md-nav__link">
        Etcd Performance tests
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/get-vs-list-api-calls/" class="md-nav__link">
        Get vs List API Calls
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/openshift_httpbin_tshark_sidecar/" class="md-nav__link">
        Httpbin tshark sidecar container
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/kubernetes_cluster/" class="md-nav__link">
        Hints for installing kubernetes on Fedora
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/HPA/" class="md-nav__link">
        Horizontal Pod Autoscaler
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/how_rhcos_updates_work/" class="md-nav__link">
        How RHCOS updates work
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/ocp4-infra-nodes-with-machineset-without-worker-label/" class="md-nav__link">
        Infra nodes with MachineSets without worker label
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/ingresscontroller_router_sharding_ocp_on_osp/" class="md-nav__link">
        Ingress Controller Sharding OCP on OSP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/ingress-controller-sharding-on-separate-vip/" class="md-nav__link">
        Ingress Controller Sharding on separate VIP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/openshift_mirror_registry/" class="md-nav__link">
        Installing a cluster with a mirror registry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/istio-1.6-on-ocp.4.x/" class="md-nav__link">
        Istio 1.6 on OpenShift 4.x
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/kata/" class="md-nav__link">
        kata containers and the kata operatora
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/ovn-kind-hybrid-overlay/" class="md-nav__link">
        Kind with OVN Kubernetes Hybrid Overlay
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/kind-with-private-registry/" class="md-nav__link">
        Kind with private registry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/mounting-container-image/" class="md-nav__link">
        Mount a container image
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openstack/install_openshift_on_openstack/" class="md-nav__link">
        OpenShift on OpenStack
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/patch-service-loadbalancer-ingress-ip/" class="md-nav__link">
        Patch status.loadBalancer.ingress IP manually
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/private-registry/" class="md-nav__link">
        Private container registry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/proxy-ocp-4.5/" class="md-nav__link">
        Proxy OCP 4.5
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/scc/" class="md-nav__link">
        Security Context Constraints (SCC)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/fix-selinux-labels-coreos/" class="md-nav__link">
        SElinux labels fix
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../sctp/" class="md-nav__link">
        SCTP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/openshift_troubleshooting_etcd_state/" class="md-nav__link">
        Troubleshooting etcd state
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/useful-ocp-commands/" class="md-nav__link">
        Useful commands for OpenShift
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/useful-ocp-sdn-commands/" class="md-nav__link">
        Useful commands for OpenShift SDN
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openshift/troubleshooting_openshift_on_openstack_worker_creation/" class="md-nav__link">
        Troubleshooting OpenShift on OpenStack worker creation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        OpenStack
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="OpenStack" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          OpenStack
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openstack/reattach_to_running_deployment/" class="md-nav__link">
        Reattach to running deployment
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openstack/using_clouds_yaml/" class="md-nav__link">
        Using clouds.yaml
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        OperatorSDK
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="OperatorSDK" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          OperatorSDK
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operator-sdk/operator-sdk-reconciliation/" class="md-nav__link">
        Controller Reconciliation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="ovs-packet-recirculation">OVS packet recirculation</h1>
<p>Packet recirculation means that a packet is sent back to the processing engine for another evaluation after it has already been processed. This can for example happen when an outer header is stripped off the packet such as VXLAN tunneling or MPLS. It is also important for connection tracking in OVS and is also used in OVS bonds when hashing packets to different ports.</p>
<p><a href="https://lwn.net/Articles/546476/">https://lwn.net/Articles/546476/</a>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="p">(</span><span class="o">...</span><span class="p">)</span>
<span class="n">Recirculation</span> <span class="k">is</span> <span class="n">a</span> <span class="n">technique</span> <span class="n">to</span> <span class="n">allow</span> <span class="n">a</span> <span class="n">frame</span> <span class="n">to</span> <span class="n">re</span><span class="o">-</span><span class="n">enter</span>
<span class="n">frame</span> <span class="n">processing</span><span class="o">.</span> <span class="n">This</span> <span class="k">is</span> <span class="n">intended</span> <span class="n">to</span> <span class="n">be</span> <span class="n">used</span> <span class="n">after</span> <span class="n">actions</span>
<span class="n">have</span> <span class="n">been</span> <span class="n">applied</span> <span class="n">to</span> <span class="n">the</span> <span class="n">frame</span> <span class="n">with</span> <span class="n">modify</span> <span class="n">the</span> <span class="n">frame</span> <span class="ow">in</span>
<span class="n">some</span> <span class="n">way</span> <span class="n">that</span> <span class="n">makes</span> <span class="n">it</span> <span class="n">possible</span> <span class="k">for</span> <span class="n">richer</span> <span class="n">processing</span> <span class="n">to</span> <span class="n">occur</span><span class="o">.</span>

<span class="n">An</span> <span class="n">example</span> <span class="k">is</span> <span class="ow">and</span> <span class="n">indeed</span> <span class="n">targeted</span> <span class="n">use</span> <span class="n">case</span> <span class="k">is</span> <span class="n">MPLS</span><span class="o">.</span> <span class="n">If</span> <span class="n">an</span> <span class="n">MPLS</span> <span class="n">frame</span> <span class="n">has</span> <span class="n">an</span>
<span class="n">mpls_pop</span> <span class="n">action</span> <span class="n">applied</span> <span class="n">with</span> <span class="n">the</span> <span class="n">IPv4</span> <span class="n">ethernet</span> <span class="n">type</span> <span class="n">then</span> <span class="n">it</span> <span class="n">becomes</span>
<span class="n">possible</span> <span class="n">to</span> <span class="n">decode</span> <span class="n">the</span> <span class="n">IPv4</span> <span class="n">portion</span> <span class="n">of</span> <span class="n">the</span> <span class="n">frame</span><span class="o">.</span> <span class="n">This</span> <span class="n">may</span> <span class="n">be</span> <span class="n">used</span> <span class="n">to</span>
<span class="n">construct</span> <span class="n">a</span> <span class="n">facet</span> <span class="n">that</span> <span class="n">modifies</span> <span class="n">the</span> <span class="n">IPv4</span> <span class="n">portion</span> <span class="n">of</span> <span class="n">the</span> <span class="n">frame</span><span class="o">.</span> <span class="n">This</span> <span class="k">is</span> <span class="ow">not</span>
<span class="n">possible</span> <span class="n">prior</span> <span class="n">to</span> <span class="n">the</span> <span class="n">mpls_pop</span> <span class="n">action</span> <span class="k">as</span> <span class="n">the</span> <span class="n">contents</span> <span class="n">of</span> <span class="n">the</span> <span class="n">frame</span> <span class="n">after</span>
<span class="n">the</span> <span class="n">MPLS</span> <span class="n">stack</span> <span class="k">is</span> <span class="ow">not</span> <span class="n">known</span> <span class="n">to</span> <span class="n">be</span> <span class="n">IPv4</span><span class="o">.</span>
<span class="p">(</span><span class="o">...</span><span class="p">)</span>
</code></pre></div>
</td></tr></table>
Also: <a href="https://lists.openwall.net/netdev/2013/04/16/16">https://lists.openwall.net/netdev/2013/04/16/16</a></p>
<p><a href="http://www.openvswitch.org/support/dist-docs/ovs-vswitchd.8.txt">http://www.openvswitch.org/support/dist-docs/ovs-vswitchd.8.txt</a>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>(...)
The sum of &quot;emc hits&quot;, &quot;smc hits&quot;, &quot;megaflow hits&quot; and &quot;miss&quot; is
              the  number  of packet lookups performed by the datapath. Beware
              that a recirculated packet experiences one additional lookup per
              recirculation, so there may be more lookups than forwarded pack‚Äê
              ets in the datapath.
(...)
</code></pre></div>
</td></tr></table></p>
<p><a href="https://mail.openvswitch.org/pipermail/ovs-dev/2017-March/330278.html">https://mail.openvswitch.org/pipermail/ovs-dev/2017-March/330278.html</a>
<a href="https://patchwork.ozlabs.org/patch/709823/">https://patchwork.ozlabs.org/patch/709823/</a></p>
<p><a href="https://lwn.net/Articles/679808/">https://lwn.net/Articles/679808/</a>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="ss">(</span>...<span class="ss">)</span>
<span class="nv">The</span> <span class="nv">IPv4</span> <span class="nv">traffic</span> <span class="nv">coming</span> <span class="nv">from</span> <span class="nv">port</span> <span class="mi">2</span> <span class="nv">is</span> <span class="nv">first</span> <span class="nv">matched</span> <span class="k">for</span> <span class="nv">the</span>
<span class="nv">non</span><span class="o">-</span><span class="nv">tracked</span> <span class="nv">state</span> <span class="ss">(</span><span class="o">-</span><span class="nv">trk</span><span class="ss">)</span>, <span class="nv">which</span> <span class="nv">means</span> <span class="nv">that</span> <span class="nv">the</span> <span class="nv">packet</span> <span class="nv">has</span> <span class="nv">not</span> <span class="nv">been</span>
<span class="nv">through</span> <span class="nv">a</span> <span class="nv">CT</span> <span class="nv">action</span> <span class="nv">yet</span>.  <span class="nv">Such</span> <span class="nv">traffic</span> <span class="nv">is</span> <span class="nv">run</span> <span class="nv">trough</span> <span class="nv">the</span> <span class="nv">conntrack</span> <span class="nv">in</span>
<span class="nv">zone</span> <span class="mi">1</span> <span class="nv">and</span> <span class="nv">all</span> <span class="nv">packets</span> <span class="nv">associated</span> <span class="nv">with</span> <span class="nv">a</span> <span class="nv">NATted</span> <span class="nv">connection</span> <span class="nv">are</span> <span class="nv">NATted</span>
<span class="nv">also</span> <span class="nv">in</span> <span class="nv">the</span> <span class="k">return</span> <span class="nv">direction</span>.  <span class="nv">After</span> <span class="nv">the</span> <span class="nv">packet</span> <span class="nv">has</span> <span class="nv">been</span> <span class="nv">through</span>
<span class="nv">conntrack</span> <span class="nv">it</span> <span class="nv">is</span> <span class="nv">recirculated</span> <span class="nv">back</span> <span class="nv">to</span> <span class="nv">OpenFlow</span> <span class="nv">table</span> <span class="mi">0</span> <span class="ss">(</span><span class="nv">which</span> <span class="nv">is</span> <span class="nv">the</span>
<span class="nv">default</span> <span class="nv">table</span>, <span class="nv">so</span> <span class="nv">all</span> <span class="nv">the</span> <span class="nv">rules</span> <span class="nv">above</span> <span class="nv">are</span> <span class="nv">in</span> <span class="nv">table</span> <span class="mi">0</span><span class="ss">)</span>.  <span class="nv">The</span> <span class="nv">CT</span> <span class="nv">action</span>
<span class="nv">changes</span> <span class="nv">the</span> <span class="s1">&#39;</span><span class="s">trk</span><span class="s1">&#39;</span> <span class="nv">flag</span> <span class="nv">to</span> <span class="nv">being</span> <span class="nv">set</span>, <span class="nv">so</span> <span class="nv">the</span> <span class="nv">packets</span> <span class="nv">after</span>
<span class="nv">recirculation</span> <span class="nv">no</span> <span class="nv">longer</span> <span class="nv">match</span> <span class="nv">the</span> <span class="nv">second</span> <span class="nv">rule</span>.  <span class="nv">The</span> <span class="nv">third</span> <span class="nv">rule</span> <span class="k">then</span>
<span class="nv">matches</span> <span class="nv">the</span> <span class="nv">recirculated</span> <span class="nv">packets</span> <span class="nv">that</span> <span class="nv">were</span> <span class="nv">marked</span> <span class="nv">as</span> <span class="nv">established</span> <span class="nv">by</span>
<span class="nv">conntrack</span> <span class="ss">(</span><span class="o">+</span><span class="nv">est</span><span class="ss">)</span>, <span class="nv">and</span> <span class="nv">the</span> <span class="nv">packet</span> <span class="nv">is</span> <span class="nv">output</span> <span class="nv">on</span> <span class="nv">port</span> <span class="mi">1</span>.  <span class="nv">Matching</span> <span class="nv">on</span>
<span class="nv">ct_zone</span> <span class="nv">is</span> <span class="nv">not</span> <span class="nv">strictly</span> <span class="nv">needed</span>, <span class="nv">but</span> <span class="nv">in</span> <span class="nv">this</span> <span class="nv">test</span> <span class="nv">case</span> <span class="nv">it</span> <span class="nv">verifies</span> <span class="nv">that</span>
<span class="nv">the</span> <span class="nv">ct_zone</span> <span class="nv">key</span> <span class="nv">attribute</span> <span class="nv">is</span> <span class="nv">properly</span> <span class="nv">set</span> <span class="nv">by</span> <span class="nv">the</span> <span class="nv">conntrack</span> <span class="nv">action</span>.
<span class="ss">(</span>...<span class="ss">)</span>
</code></pre></div>
</td></tr></table></p>
<p>From <code class="highlight">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h</code>:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">  1</span>
<span class="normal">  2</span>
<span class="normal">  3</span>
<span class="normal">  4</span>
<span class="normal">  5</span>
<span class="normal">  6</span>
<span class="normal">  7</span>
<span class="normal">  8</span>
<span class="normal">  9</span>
<span class="normal"> 10</span>
<span class="normal"> 11</span>
<span class="normal"> 12</span>
<span class="normal"> 13</span>
<span class="normal"> 14</span>
<span class="normal"> 15</span>
<span class="normal"> 16</span>
<span class="normal"> 17</span>
<span class="normal"> 18</span>
<span class="normal"> 19</span>
<span class="normal"> 20</span>
<span class="normal"> 21</span>
<span class="normal"> 22</span>
<span class="normal"> 23</span>
<span class="normal"> 24</span>
<span class="normal"> 25</span>
<span class="normal"> 26</span>
<span class="normal"> 27</span>
<span class="normal"> 28</span>
<span class="normal"> 29</span>
<span class="normal"> 30</span>
<span class="normal"> 31</span>
<span class="normal"> 32</span>
<span class="normal"> 33</span>
<span class="normal"> 34</span>
<span class="normal"> 35</span>
<span class="normal"> 36</span>
<span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span>
<span class="normal">134</span>
<span class="normal">135</span>
<span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span>
<span class="normal">337</span>
<span class="normal">338</span>
<span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span>
<span class="normal">511</span>
<span class="normal">512</span>
<span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="nl">h</span><span class="p">:</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Freezing</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">recirculation</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">==========================</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Freezing</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">technique</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">halting</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">checkpointing</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="k">translation</span><span class="w"> </span><span class="ow">in</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">restarted</span><span class="w"> </span><span class="n">again</span><span class="w"> </span><span class="n">later</span><span class="p">.</span><span class="w">  </span><span class="n">This</span><span class="w"> </span><span class="k">file</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">couple</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="k">data</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">structures</span><span class="w"> </span><span class="n">related</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">freezing</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">general</span><span class="p">;</span><span class="w"> </span><span class="n">their</span><span class="w"> </span><span class="k">names</span><span class="w"> </span><span class="k">begin</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="ss">&quot;frozen&quot;</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Recirculation</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">freezing</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">allow</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">frame</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="n">enter</span><span class="w"> </span><span class="n">the</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">datapath</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">processing</span><span class="w"> </span><span class="k">path</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">achieve</span><span class="w"> </span><span class="n">more</span><span class="w"> </span><span class="n">flexible</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">processing</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">modifying</span><span class="w"> </span><span class="n">header</span><span class="w"> </span><span class="n">fields</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">MPLS</span><span class="w"> </span><span class="n">POP</span><span class="w"> </span><span class="k">action</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">selecting</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">slave</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">port</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">bond</span><span class="w"> </span><span class="n">ports</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">Data</span><span class="w"> </span><span class="k">path</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="nf">space</span><span class="w"> </span><span class="n">interface</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">-----------------------------------</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Recirculation</span><span class="w"> </span><span class="n">uses</span><span class="w"> </span><span class="n">two</span><span class="w"> </span><span class="n">uint32_t</span><span class="w"> </span><span class="n">fields</span><span class="p">,</span><span class="w"> </span><span class="n">recirc_id</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">dp_hash</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">RECIRC</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">action</span><span class="p">.</span><span class="w">  </span><span class="n">recirc_id</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">used</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">select</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">next</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="n">processing</span><span class="w"> </span><span class="n">steps</span><span class="w"> </span><span class="n">among</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="nl">h</span><span class="p">:</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">multiple</span><span class="w"> </span><span class="n">instances</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">recirculation</span><span class="p">.</span><span class="w">  </span><span class="k">When</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">packet</span><span class="w"> </span><span class="k">initially</span><span class="w"> </span><span class="n">enters</span><span class="w"> </span><span class="n">the</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="nl">h</span><span class="p">:</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">datapath</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">assigned</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">recirc_id</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">indicates</span><span class="w"> </span><span class="k">no</span><span class="w"> </span><span class="n">recirculation</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Recirc_ids</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">managed</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="nf">space</span><span class="p">,</span><span class="w"> </span><span class="n">opaque</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">datapath</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">On</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">hand</span><span class="p">,</span><span class="w"> </span><span class="n">dp_hash</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">computed</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">datapath</span><span class="p">,</span><span class="w"> </span><span class="n">opaque</span><span class="w"> </span><span class="k">to</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="nf">space</span><span class="p">,</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">datapath</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">free</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="nf">choose</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">hashing</span><span class="w"> </span><span class="n">algorithm</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">without</span><span class="w"> </span><span class="n">informing</span><span class="w"> </span><span class="k">user</span><span class="w"> </span><span class="nf">space</span><span class="w"> </span><span class="n">about</span><span class="w"> </span><span class="n">it</span><span class="p">.</span><span class="w">  </span><span class="n">The</span><span class="w"> </span><span class="n">dp_hash</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">be</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">wildcarded</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">newly</span><span class="w"> </span><span class="n">received</span><span class="w"> </span><span class="n">packets</span><span class="p">.</span><span class="w">  </span><span class="n">HASH</span><span class="w"> </span><span class="k">action</span><span class="w"> </span><span class="n">specifies</span><span class="w"> </span><span class="n">whether</span><span class="w"> </span><span class="n">the</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">hash</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">computed</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">computed</span><span class="p">,</span><span class="w"> </span><span class="n">how</span><span class="w"> </span><span class="n">many</span><span class="w"> </span><span class="n">fields</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">included</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">the</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">hash</span><span class="w"> </span><span class="n">computation</span><span class="p">.</span><span class="w">  </span><span class="n">The</span><span class="w"> </span><span class="n">computed</span><span class="w"> </span><span class="n">hash</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="k">into</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">dp_hash</span><span class="w"> </span><span class="n">field</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="nl">h</span><span class="p">:</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">prior</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">recirculation</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">RECIRC</span><span class="w"> </span><span class="k">action</span><span class="w"> </span><span class="k">sets</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">recirc_id</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">reprocesses</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">packet</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">received</span><span class="w"> </span><span class="n">again</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="k">input</span><span class="w"> </span><span class="n">port</span><span class="p">.</span><span class="w">  </span><span class="n">RECIRC</span><span class="w"> </span><span class="k">action</span><span class="w"> </span><span class="n">works</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="ow">like</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">function</span><span class="w"> </span><span class="k">call</span><span class="p">;</span><span class="w"> </span><span class="n">actions</span><span class="w"> </span><span class="n">listed</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">RECIRC</span><span class="w"> </span><span class="k">action</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">be</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="nl">h</span><span class="p">:</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">executed</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">recirculation</span><span class="p">.</span><span class="w">  </span><span class="n">RECIRC</span><span class="w"> </span><span class="k">action</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">nested</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">datapath</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="nl">h</span><span class="p">:</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">implementation</span><span class="w"> </span><span class="n">limits</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">number</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">nested</span><span class="w"> </span><span class="n">recirculations</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">prevent</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">unreasonable</span><span class="w"> </span><span class="n">nesting</span><span class="w"> </span><span class="k">depth</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="n">infinite</span><span class="w"> </span><span class="n">loop</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="nl">h</span><span class="p">:</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">User</span><span class="w"> </span><span class="nf">space</span><span class="w"> </span><span class="n">recirculation</span><span class="w"> </span><span class="n">context</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">---------------------------------</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Recirculation</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">usually</span><span class="w"> </span><span class="n">hidden</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">OpenFlow</span><span class="w"> </span><span class="n">controllers</span><span class="p">.</span><span class="w">  </span><span class="k">Action</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="nl">h</span><span class="p">:</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">translation</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="n">deduces</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">recirculation</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">necessary</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">issues</span><span class="w"> </span><span class="n">a</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="nl">h</span><span class="p">:</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">datapath</span><span class="w"> </span><span class="n">recirculation</span><span class="w"> </span><span class="k">action</span><span class="p">.</span><span class="w">  </span><span class="ow">All</span><span class="w"> </span><span class="n">OpenFlow</span><span class="w"> </span><span class="n">actions</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">performed</span><span class="w"> </span><span class="k">after</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="nl">h</span><span class="p">:</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">recirculation</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">derived</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">OpenFlow</span><span class="w"> </span><span class="n">pipeline</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">stored</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">the</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="nl">h</span><span class="p">:</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">recirculation</span><span class="w"> </span><span class="n">ID</span><span class="p">.</span><span class="w">  </span><span class="k">When</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">OpenFlow</span><span class="w"> </span><span class="n">tables</span><span class="w"> </span><span class="k">are</span><span class="w"> </span><span class="n">changed</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">way</span><span class="w"> </span><span class="n">affecting</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="nl">h</span><span class="p">:</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">recirculation</span><span class="w"> </span><span class="n">flows</span><span class="p">,</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">recirculation</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">actions</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">allocated</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">old</span><span class="w"> </span><span class="n">one</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">timed</span><span class="w"> </span><span class="k">out</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Recirculation</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="n">pool</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="o">----------------------</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">Recirculation</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="n">needs</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="k">unique</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="n">datapaths</span><span class="p">.</span><span class="w">  </span><span class="n">Recirculation</span><span class="w"> </span><span class="n">ID</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="nl">h</span><span class="p">:</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">pool</span><span class="w"> </span><span class="n">keeps</span><span class="w"> </span><span class="n">track</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">recirculation</span><span class="w"> </span><span class="n">ids</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">stores</span><span class="w"> </span><span class="n">OpenFlow</span><span class="w"> </span><span class="n">pipeline</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">translation</span><span class="w"> </span><span class="n">context</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="n">processing</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="k">continue</span><span class="w"> </span><span class="k">after</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="nl">h</span><span class="p">:</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">recirculation</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">A</span><span class="w"> </span><span class="n">Recirculation</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="ow">any</span><span class="w"> </span><span class="n">uint32_t</span><span class="w"> </span><span class="k">value</span><span class="p">,</span><span class="w"> </span><span class="ow">except</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">value</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="k">is</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="nl">h</span><span class="p">:</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">reserved</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="s1">&#39;no recirculation&#39;</span><span class="w"> </span><span class="k">case</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">#include</span><span class="w"> </span><span class="ss">&quot;ofproto-dpif-mirror.h&quot;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">#include</span><span class="w"> </span><span class="ss">&quot;openvswitch/list.h&quot;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">#include</span><span class="w"> </span><span class="ss">&quot;openvswitch/ofp-actions.h&quot;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">#include</span><span class="w"> </span><span class="ss">&quot;ovs-thread.h&quot;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">#include</span><span class="w"> </span><span class="ss">&quot;uuid.h&quot;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">struct</span><span class="w"> </span><span class="n">ofproto_dpif</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">struct</span><span class="w"> </span><span class="k">rule</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="cm">/*</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * Freezing and recirculation</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * ==========================</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * Freezing is a technique for halting and checkpointing packet translation in</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * a way that it can be restarted again later.  This file has a couple of data</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * structures related to freezing in general; their names begin with &quot;frozen&quot;.</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * Recirculation is the use of freezing to allow a frame to re-enter the</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * datapath packet processing path to achieve more flexible packet processing,</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * such as modifying header fields after MPLS POP action and selecting a slave</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * port for bond ports.</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * Data path and user space interface</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * -----------------------------------</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * Recirculation uses two uint32_t fields, recirc_id and dp_hash, and a RECIRC</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * action.  recirc_id is used to select the next packet processing steps among</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * multiple instances of recirculation.  When a packet initially enters the</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * datapath it is assigned with recirc_id 0, which indicates no recirculation.</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * Recirc_ids are managed by the user space, opaque to the datapath.</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * On the other hand, dp_hash can only be computed by the datapath, opaque to</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * the user space, as the datapath is free to choose the hashing algorithm</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * without informing user space about it.  The dp_hash value should be</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * wildcarded for newly received packets.  HASH action specifies whether the</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * hash is computed, and if computed, how many fields are to be included in the</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * hash computation.  The computed hash value is stored into the dp_hash field</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * prior to recirculation.</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * The RECIRC action sets the recirc_id field and then reprocesses the packet</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * as if it was received again on the same input port.  RECIRC action works</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * like a function call; actions listed after the RECIRC action will be</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * executed after recirculation.  RECIRC action can be nested, but datapath</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * implementation limits the number of nested recirculations to prevent</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * unreasonable nesting depth or infinite loop.</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * User space recirculation context</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * ---------------------------------</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * Recirculation is usually hidden from the OpenFlow controllers.  Action</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * translation code deduces when recirculation is necessary and issues a</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * datapath recirculation action.  All OpenFlow actions to be performed after</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * recirculation are derived from the OpenFlow pipeline and are stored with the</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * recirculation ID.  When the OpenFlow tables are changed in a way affecting</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * the recirculation flows, new recirculation ID with new metadata and actions</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * is allocated and the old one is timed out.</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * Recirculation ID pool</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * ----------------------</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * Recirculation ID needs to be unique for all datapaths.  Recirculation ID</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * pool keeps track of recirculation ids and stores OpenFlow pipeline</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * translation context so that flow processing may continue after</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * recirculation.</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * A Recirculation ID can be any uint32_t value, except for that the value 0 is</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * reserved for &#39;no recirculation&#39; case.</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * Thread-safety</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * --------------</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * All APIs are thread safe.</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="nl">h</span><span class="p">:</span><span class="cm">/* Metadata for restoring pipeline context after recirculation.  Helpers</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * are inlined below to keep them together with the definition for easier</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * updates. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">BUILD_ASSERT_DECL</span><span class="p">(</span><span class="n">FLOW_WC_SEQ</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">40</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">struct</span><span class="w"> </span><span class="n">frozen_metadata</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w">    </span><span class="cm">/* Metadata in struct flow. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w">    </span><span class="n">struct</span><span class="w"> </span><span class="n">flow_tnl</span><span class="w"> </span><span class="n">tunnel</span><span class="p">;</span><span class="w">       </span><span class="cm">/* Encapsulating tunnel parameters. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w">    </span><span class="n">ovs_be64</span><span class="w"> </span><span class="n">metadata</span><span class="p">;</span><span class="w">            </span><span class="cm">/* OpenFlow Metadata. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w">    </span><span class="n">uint64_t</span><span class="w"> </span><span class="n">regs</span><span class="o">[</span><span class="n">FLOW_N_XREGS</span><span class="o">]</span><span class="p">;</span><span class="w">  </span><span class="cm">/* Registers. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w">    </span><span class="n">ofp_port_t</span><span class="w"> </span><span class="n">in_port</span><span class="p">;</span><span class="w">           </span><span class="cm">/* Incoming port. */</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="err">:#</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">verifies</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">table</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">preserved</span><span class="w"> </span><span class="n">across</span><span class="w"> </span><span class="n">recirculation</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="err">#</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">resubmit</span><span class="w"> </span><span class="k">action</span><span class="w"> </span><span class="n">requires</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="p">(</span><span class="n">because</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">action</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">relative</span><span class="w"> </span><span class="k">to</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="err">#</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">current</span><span class="w"> </span><span class="nc">table</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="k">than</span><span class="w"> </span><span class="n">specifying</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">table</span><span class="p">).</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="err">:</span><span class="n">AT_SETUP</span><span class="p">(</span><span class="o">[</span><span class="n">ofproto-dpif - resubmit with recirculation</span><span class="o">]</span><span class="p">)</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="err">#</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">verifies</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">preserved</span><span class="w"> </span><span class="n">across</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="err">:#</span><span class="w"> </span><span class="n">recirculation</span><span class="p">.</span><span class="w">  </span><span class="k">At</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">recirculation</span><span class="p">,</span><span class="w"> </span><span class="n">fields</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="ss">&quot;tun_id&quot;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="err">#</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="k">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ss">&quot;valid&quot;</span><span class="w"> </span><span class="p">(</span><span class="n">ie</span><span class="p">,</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">destination</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="err">:#</span><span class="w"> </span><span class="n">address</span><span class="p">),</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">recirculation</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="n">AT_SETUP</span><span class="p">(</span><span class="o">[</span><span class="n">ofproto-dpif - resubmit with tun_id</span><span class="o">]</span><span class="p">)</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="err">:#</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">verifies</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="ss">&quot;resubmit&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">triggers</span><span class="w"> </span><span class="n">recirculation</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="err">#</span><span class="w"> </span><span class="n">indirectly</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">recursively</span><span class="w"> </span><span class="n">invokes</span><span class="p">,</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="err">:#</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="n">executed</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">execution</span><span class="w"> </span><span class="n">continues</span><span class="w"> </span><span class="n">later</span><span class="w"> </span><span class="n">post</span><span class="o">-</span><span class="n">recirculation</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="err">:</span><span class="n">AT_SETUP</span><span class="p">(</span><span class="o">[</span><span class="n">ofproto-dpif - recirculation after resubmit</span><span class="o">]</span><span class="p">)</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="k">system</span><span class="o">-</span><span class="n">traffic</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="n">dnl</span><span class="w"> </span><span class="n">Checks</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">implementation</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">conntrack</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">FTP</span><span class="w"> </span><span class="n">ALGs</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">combination</span><span class="w"> </span><span class="k">with</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="k">system</span><span class="o">-</span><span class="n">traffic</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="n">dnl</span><span class="w"> </span><span class="n">NAT</span><span class="p">,</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="n">tables</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">implement</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">NATing</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="nf">round</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="k">system</span><span class="o">-</span><span class="n">traffic</span><span class="p">.</span><span class="k">at</span><span class="err">:</span><span class="n">dnl</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">recirculation</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">is</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="n">ct</span><span class="p">(</span><span class="nc">table</span><span class="o">=</span><span class="n">foo</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">subsequent</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="k">system</span><span class="o">-</span><span class="n">traffic</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="n">dnl</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">implement</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">NATing</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">ct</span><span class="p">(</span><span class="n">nat</span><span class="p">..),</span><span class="k">output</span><span class="err">:</span><span class="n">foo</span><span class="p">.</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="k">system</span><span class="o">-</span><span class="n">traffic</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="n">dnl</span><span class="w"> </span><span class="n">Checks</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">implementation</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">conntrack</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="n">tuple</span><span class="w"> </span><span class="n">matching</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="k">system</span><span class="o">-</span><span class="n">traffic</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="n">dnl</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">FTP</span><span class="w"> </span><span class="n">ALGs</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">combination</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">NAT</span><span class="p">,</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="n">tables</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">implement</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="k">system</span><span class="o">-</span><span class="n">traffic</span><span class="p">.</span><span class="k">at</span><span class="err">:</span><span class="n">dnl</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">NATing</span><span class="w"> </span><span class="k">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="nf">round</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">recirculation</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">is</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">first</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="k">system</span><span class="o">-</span><span class="n">traffic</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="n">dnl</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="n">ct</span><span class="p">(</span><span class="n">nat</span><span class="p">,</span><span class="w"> </span><span class="nc">table</span><span class="o">=</span><span class="n">foo</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">subsequent</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">implement</span><span class="w"> </span><span class="n">the</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="k">system</span><span class="o">-</span><span class="n">traffic</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="n">dnl</span><span class="w"> </span><span class="n">commiting</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">NATed</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">ct</span><span class="p">(</span><span class="n">nat</span><span class="p">..),</span><span class="k">output</span><span class="err">:</span><span class="n">foo</span><span class="p">.</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">packet</span><span class="o">-</span><span class="n">type</span><span class="o">-</span><span class="n">aware</span><span class="p">.</span><span class="k">at</span><span class="err">:#</span><span class="w"> </span><span class="n">Goto_table</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">pop_mpls</span><span class="w"> </span><span class="n">triggers</span><span class="w"> </span><span class="n">recirculation</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">packet</span><span class="o">-</span><span class="n">type</span><span class="o">-</span><span class="n">aware</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="n">AT_CHECK</span><span class="p">(</span><span class="o">[</span><span class="n"></span>
<span class="n">openvswitch-2.9.0/tests/packet-type-aware.at-    ovs-ofctl del-flows br0 &amp;&amp;</span>
<span class="n">openvswitch-2.9.0/tests/packet-type-aware.at-    ovs-ofctl del-flows int-br &amp;&amp;</span>
<span class="n">openvswitch-2.9.0/tests/packet-type-aware.at-    ovs-ofctl add-flow br0 &quot;actions=normal&quot;</span>
<span class="n">openvswitch-2.9.0/tests/packet-type-aware.at-    ovs-ofctl add-flow int-br &quot;table=0,in_port=tunnel,actions=pop_mpls:0x800,goto_table:20&quot; &amp;&amp;</span>
<span class="n">openvswitch-2.9.0/tests/packet-type-aware.at-    ovs-ofctl add-flow int-br &quot;table=20,actions=dec_ttl,output:LOCAL&quot;</span>
<span class="n">openvswitch-2.9.0/tests/packet-type-aware.at-</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n">ignore</span><span class="o">]</span><span class="p">)</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">packet</span><span class="o">-</span><span class="n">type</span><span class="o">-</span><span class="n">aware</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">#include</span><span class="w"> </span><span class="ss">&quot;ofproto-dpif-mirror.h&quot;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">#include</span><span class="w"> </span><span class="ss">&quot;openvswitch/list.h&quot;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">#include</span><span class="w"> </span><span class="ss">&quot;openvswitch/ofp-actions.h&quot;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">#include</span><span class="w"> </span><span class="ss">&quot;ovs-thread.h&quot;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">#include</span><span class="w"> </span><span class="ss">&quot;uuid.h&quot;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">struct</span><span class="w"> </span><span class="n">ofproto_dpif</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">struct</span><span class="w"> </span><span class="k">rule</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="cm">/*</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * Freezing and recirculation</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * ==========================</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * Freezing is a technique for halting and checkpointing packet translation in</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * a way that it can be restarted again later.  This file has a couple of data</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * structures related to freezing in general; their names begin with &quot;frozen&quot;.</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * Recirculation is the use of freezing to allow a frame to re-enter the</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * datapath packet processing path to achieve more flexible packet processing,</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * such as modifying header fields after MPLS POP action and selecting a slave</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * port for bond ports.</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * Data path and user space interface</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * -----------------------------------</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * Recirculation uses two uint32_t fields, recirc_id and dp_hash, and a RECIRC</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * action.  recirc_id is used to select the next packet processing steps among</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * multiple instances of recirculation.  When a packet initially enters the</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * datapath it is assigned with recirc_id 0, which indicates no recirculation.</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * Recirc_ids are managed by the user space, opaque to the datapath.</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * On the other hand, dp_hash can only be computed by the datapath, opaque to</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * the user space, as the datapath is free to choose the hashing algorithm</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * without informing user space about it.  The dp_hash value should be</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * wildcarded for newly received packets.  HASH action specifies whether the</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * hash is computed, and if computed, how many fields are to be included in the</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * hash computation.  The computed hash value is stored into the dp_hash field</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * prior to recirculation.</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * The RECIRC action sets the recirc_id field and then reprocesses the packet</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * as if it was received again on the same input port.  RECIRC action works</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * like a function call; actions listed after the RECIRC action will be</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * executed after recirculation.  RECIRC action can be nested, but datapath</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * implementation limits the number of nested recirculations to prevent</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * unreasonable nesting depth or infinite loop.</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * User space recirculation context</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * ---------------------------------</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * Recirculation is usually hidden from the OpenFlow controllers.  Action</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * translation code deduces when recirculation is necessary and issues a</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * datapath recirculation action.  All OpenFlow actions to be performed after</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * recirculation are derived from the OpenFlow pipeline and are stored with the</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * recirculation ID.  When the OpenFlow tables are changed in a way affecting</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * the recirculation flows, new recirculation ID with new metadata and actions</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * is allocated and the old one is timed out.</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * Recirculation ID pool</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * ----------------------</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * Recirculation ID needs to be unique for all datapaths.  Recirculation ID</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * pool keeps track of recirculation ids and stores OpenFlow pipeline</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * translation context so that flow processing may continue after</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * recirculation.</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * A Recirculation ID can be any uint32_t value, except for that the value 0 is</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h: * reserved for &#39;no recirculation&#39; case.</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * Thread-safety</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * --------------</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * All APIs are thread safe.</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="nl">h</span><span class="p">:</span><span class="cm">/* Metadata for restoring pipeline context after recirculation.  Helpers</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * are inlined below to keep them together with the definition for easier</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-rid.h- * updates. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">BUILD_ASSERT_DECL</span><span class="p">(</span><span class="n">FLOW_WC_SEQ</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="mi">40</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">struct</span><span class="w"> </span><span class="n">frozen_metadata</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w">    </span><span class="cm">/* Metadata in struct flow. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w">    </span><span class="n">struct</span><span class="w"> </span><span class="n">flow_tnl</span><span class="w"> </span><span class="n">tunnel</span><span class="p">;</span><span class="w">       </span><span class="cm">/* Encapsulating tunnel parameters. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w">    </span><span class="n">ovs_be64</span><span class="w"> </span><span class="n">metadata</span><span class="p">;</span><span class="w">            </span><span class="cm">/* OpenFlow Metadata. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w">    </span><span class="n">uint64_t</span><span class="w"> </span><span class="n">regs</span><span class="o">[</span><span class="n">FLOW_N_XREGS</span><span class="o">]</span><span class="p">;</span><span class="w">  </span><span class="cm">/* Registers. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">rid</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w">    </span><span class="n">ofp_port_t</span><span class="w"> </span><span class="n">in_port</span><span class="p">;</span><span class="w">           </span><span class="cm">/* Incoming port. */</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="err">:#</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">verifies</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">table</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">preserved</span><span class="w"> </span><span class="n">across</span><span class="w"> </span><span class="n">recirculation</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="err">#</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">resubmit</span><span class="w"> </span><span class="k">action</span><span class="w"> </span><span class="n">requires</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="p">(</span><span class="n">because</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">action</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="k">relative</span><span class="w"> </span><span class="k">to</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="err">#</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">current</span><span class="w"> </span><span class="nc">table</span><span class="w"> </span><span class="n">rather</span><span class="w"> </span><span class="k">than</span><span class="w"> </span><span class="n">specifying</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="nc">table</span><span class="p">).</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="err">:</span><span class="n">AT_SETUP</span><span class="p">(</span><span class="o">[</span><span class="n">ofproto-dpif - resubmit with recirculation</span><span class="o">]</span><span class="p">)</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="err">#</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">verifies</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="n">metadata</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">preserved</span><span class="w"> </span><span class="n">across</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="err">:#</span><span class="w"> </span><span class="n">recirculation</span><span class="p">.</span><span class="w">  </span><span class="k">At</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="nc">time</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">recirculation</span><span class="p">,</span><span class="w"> </span><span class="n">fields</span><span class="w"> </span><span class="n">such</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="ss">&quot;tun_id&quot;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="err">#</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="k">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">tunnel</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ss">&quot;valid&quot;</span><span class="w"> </span><span class="p">(</span><span class="n">ie</span><span class="p">,</span><span class="w"> </span><span class="n">has</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">destination</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="err">:#</span><span class="w"> </span><span class="n">address</span><span class="p">),</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">field</span><span class="w"> </span><span class="n">should</span><span class="w"> </span><span class="n">still</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">available</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">recirculation</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="n">AT_SETUP</span><span class="p">(</span><span class="o">[</span><span class="n">ofproto-dpif - resubmit with tun_id</span><span class="o">]</span><span class="p">)</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="err">:#</span><span class="w"> </span><span class="n">This</span><span class="w"> </span><span class="n">test</span><span class="w"> </span><span class="n">verifies</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="ss">&quot;resubmit&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">triggers</span><span class="w"> </span><span class="n">recirculation</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="err">#</span><span class="w"> </span><span class="n">indirectly</span><span class="w"> </span><span class="n">through</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">recursively</span><span class="w"> </span><span class="n">invokes</span><span class="p">,</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="err">:#</span><span class="w"> </span><span class="n">re</span><span class="o">-</span><span class="n">executed</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">execution</span><span class="w"> </span><span class="n">continues</span><span class="w"> </span><span class="n">later</span><span class="w"> </span><span class="n">post</span><span class="o">-</span><span class="n">recirculation</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="p">.</span><span class="k">at</span><span class="err">:</span><span class="n">AT_SETUP</span><span class="p">(</span><span class="o">[</span><span class="n">ofproto-dpif - recirculation after resubmit</span><span class="o">]</span><span class="p">)</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="k">system</span><span class="o">-</span><span class="n">traffic</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="n">dnl</span><span class="w"> </span><span class="n">Checks</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">implementation</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">conntrack</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">FTP</span><span class="w"> </span><span class="n">ALGs</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">combination</span><span class="w"> </span><span class="k">with</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="k">system</span><span class="o">-</span><span class="n">traffic</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="n">dnl</span><span class="w"> </span><span class="n">NAT</span><span class="p">,</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="n">tables</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">implement</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">NATing</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="nf">round</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="k">system</span><span class="o">-</span><span class="n">traffic</span><span class="p">.</span><span class="k">at</span><span class="err">:</span><span class="n">dnl</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">recirculation</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">is</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="n">ct</span><span class="p">(</span><span class="nc">table</span><span class="o">=</span><span class="n">foo</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">subsequent</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="k">system</span><span class="o">-</span><span class="n">traffic</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="n">dnl</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">implement</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">NATing</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">ct</span><span class="p">(</span><span class="n">nat</span><span class="p">..),</span><span class="k">output</span><span class="err">:</span><span class="n">foo</span><span class="p">.</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="k">system</span><span class="o">-</span><span class="n">traffic</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="n">dnl</span><span class="w"> </span><span class="n">Checks</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">implementation</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">conntrack</span><span class="w"> </span><span class="n">original</span><span class="w"> </span><span class="n">direction</span><span class="w"> </span><span class="n">tuple</span><span class="w"> </span><span class="n">matching</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="k">system</span><span class="o">-</span><span class="n">traffic</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="n">dnl</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">FTP</span><span class="w"> </span><span class="n">ALGs</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">combination</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">NAT</span><span class="p">,</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="n">tables</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">implement</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="k">system</span><span class="o">-</span><span class="n">traffic</span><span class="p">.</span><span class="k">at</span><span class="err">:</span><span class="n">dnl</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">NATing</span><span class="w"> </span><span class="k">before</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">first</span><span class="w"> </span><span class="nf">round</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">recirculation</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">is</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">first</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="k">system</span><span class="o">-</span><span class="n">traffic</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="n">dnl</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="n">ct</span><span class="p">(</span><span class="n">nat</span><span class="p">,</span><span class="w"> </span><span class="nc">table</span><span class="o">=</span><span class="n">foo</span><span class="p">)</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">subsequent</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="n">will</span><span class="w"> </span><span class="n">implement</span><span class="w"> </span><span class="n">the</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="k">system</span><span class="o">-</span><span class="n">traffic</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="n">dnl</span><span class="w"> </span><span class="n">commiting</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">NATed</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">connections</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">ct</span><span class="p">(</span><span class="n">nat</span><span class="p">..),</span><span class="k">output</span><span class="err">:</span><span class="n">foo</span><span class="p">.</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">packet</span><span class="o">-</span><span class="n">type</span><span class="o">-</span><span class="n">aware</span><span class="p">.</span><span class="k">at</span><span class="err">:#</span><span class="w"> </span><span class="n">Goto_table</span><span class="w"> </span><span class="k">after</span><span class="w"> </span><span class="n">pop_mpls</span><span class="w"> </span><span class="n">triggers</span><span class="w"> </span><span class="n">recirculation</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">packet</span><span class="o">-</span><span class="n">type</span><span class="o">-</span><span class="n">aware</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="n">AT_CHECK</span><span class="p">(</span><span class="o">[</span><span class="n"></span>
<span class="n">openvswitch-2.9.0/tests/packet-type-aware.at-    ovs-ofctl del-flows br0 &amp;&amp;</span>
<span class="n">openvswitch-2.9.0/tests/packet-type-aware.at-    ovs-ofctl del-flows int-br &amp;&amp;</span>
<span class="n">openvswitch-2.9.0/tests/packet-type-aware.at-    ovs-ofctl add-flow br0 &quot;actions=normal&quot;</span>
<span class="n">openvswitch-2.9.0/tests/packet-type-aware.at-    ovs-ofctl add-flow int-br &quot;table=0,in_port=tunnel,actions=pop_mpls:0x800,goto_table:20&quot; &amp;&amp;</span>
<span class="n">openvswitch-2.9.0/tests/packet-type-aware.at-    ovs-ofctl add-flow int-br &quot;table=20,actions=dec_ttl,output:LOCAL&quot;</span>
<span class="n">openvswitch-2.9.0/tests/packet-type-aware.at-</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n">0</span><span class="o">]</span><span class="p">,</span><span class="w"> </span><span class="o">[</span><span class="n">ignore</span><span class="o">]</span><span class="p">)</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">tests</span><span class="o">/</span><span class="n">packet</span><span class="o">-</span><span class="n">type</span><span class="o">-</span><span class="n">aware</span><span class="p">.</span><span class="k">at</span><span class="o">-</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="k">include</span><span class="o">/</span><span class="n">openvswitch</span><span class="o">/</span><span class="n">meta</span><span class="o">-</span><span class="n">flow</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w">    </span><span class="cm">/* &quot;recirc_id&quot;.</span>
<span class="cm">openvswitch-2.9.0/include/openvswitch/meta-flow.h-     *</span>
<span class="cm">openvswitch-2.9.0/include/openvswitch/meta-flow.h:     * ID for recirculation.  The value 0 is reserved for initially received</span>
<span class="cm">openvswitch-2.9.0/include/openvswitch/meta-flow.h-     * packets.  Internal use only, not programmable from controller.</span>
<span class="cm">openvswitch-2.9.0/include/openvswitch/meta-flow.h-     *</span>
<span class="cm">openvswitch-2.9.0/include/openvswitch/meta-flow.h-     * Type: be32.</span>
<span class="cm">openvswitch-2.9.0/include/openvswitch/meta-flow.h-     * Maskable: no.</span>
<span class="cm">openvswitch-2.9.0/include/openvswitch/meta-flow.h-     * Formatting: decimal.</span>
<span class="cm">openvswitch-2.9.0/include/openvswitch/meta-flow.h-     * Prerequisites: none.</span>
<span class="cm">openvswitch-2.9.0/include/openvswitch/meta-flow.h-     * Access: read-only.</span>
<span class="cm">openvswitch-2.9.0/include/openvswitch/meta-flow.h-     * NXM: NXM_NX_RECIRC_ID(36) since v2.2.</span>
<span class="cm">openvswitch-2.9.0/include/openvswitch/meta-flow.h-     * OXM: none.</span>
<span class="cm">openvswitch-2.9.0/include/openvswitch/meta-flow.h-     */</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">pmd_perf_update_counter</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pmd</span><span class="o">-&gt;</span><span class="n">perf_stats</span><span class="p">,</span><span class="w"> </span><span class="n">PMD_STAT_MASKED_HIT</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                            </span><span class="n">cnt</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">upcall_ok_cnt</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">upcall_fail_cnt</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">pmd_perf_update_counter</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pmd</span><span class="o">-&gt;</span><span class="n">perf_stats</span><span class="p">,</span><span class="w"> </span><span class="n">PMD_STAT_MASKED_LOOKUP</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                            </span><span class="n">lookup_cnt</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">pmd_perf_update_counter</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pmd</span><span class="o">-&gt;</span><span class="n">perf_stats</span><span class="p">,</span><span class="w"> </span><span class="n">PMD_STAT_MISS</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                            </span><span class="n">upcall_ok_cnt</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">pmd_perf_update_counter</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pmd</span><span class="o">-&gt;</span><span class="n">perf_stats</span><span class="p">,</span><span class="w"> </span><span class="n">PMD_STAT_LOST</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                            </span><span class="n">upcall_fail_cnt</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="err">}</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="cm">/* Packets enter the datapath from a port (or from recirculation) here.</span>
<span class="cm">openvswitch-2.9.0/lib/dpif-netdev.c- *</span>
<span class="cm">openvswitch-2.9.0/lib/dpif-netdev.c- * When &#39;md_is_valid&#39; is true the metadata in &#39;packets&#39; are already valid.</span>
<span class="cm">openvswitch-2.9.0/lib/dpif-netdev.c- * When false the metadata in &#39;packets&#39; need to be initialized. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="k">static</span><span class="w"> </span><span class="n">void</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="n">dp_netdev_input__</span><span class="p">(</span><span class="n">struct</span><span class="w"> </span><span class="n">dp_netdev_pmd_thread</span><span class="w"> </span><span class="o">*</span><span class="n">pmd</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                  </span><span class="n">struct</span><span class="w"> </span><span class="n">dp_packet_batch</span><span class="w"> </span><span class="o">*</span><span class="n">packets</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                  </span><span class="n">bool</span><span class="w"> </span><span class="n">md_is_valid</span><span class="p">,</span><span class="w"> </span><span class="n">odp_port_t</span><span class="w"> </span><span class="n">port_no</span><span class="p">)</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="err">{</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="n">#if</span><span class="w"> </span><span class="err">!</span><span class="n">defined</span><span class="p">(</span><span class="n">__CHECKER__</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="err">!</span><span class="n">defined</span><span class="p">(</span><span class="n">_WIN32</span><span class="p">)</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">const</span><span class="w"> </span><span class="n">size_t</span><span class="w"> </span><span class="n">PKT_ARRAY_SIZE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dp_packet_batch_size</span><span class="p">(</span><span class="n">packets</span><span class="p">);</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                            </span><span class="n">md_is_valid</span><span class="p">,</span><span class="w"> </span><span class="n">port_no</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="err">!</span><span class="n">dp_packet_batch_is_empty</span><span class="p">(</span><span class="n">packets</span><span class="p">))</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="cm">/* Get ingress port from first packet&#39;s metadata. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="n">in_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">packets</span><span class="o">-&gt;</span><span class="n">packets</span><span class="o">[</span><span class="n">0</span><span class="o">]-&gt;</span><span class="n">md</span><span class="p">.</span><span class="n">in_port</span><span class="p">.</span><span class="n">odp_port</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="n">fast_path_processing</span><span class="p">(</span><span class="n">pmd</span><span class="p">,</span><span class="w"> </span><span class="n">packets</span><span class="p">,</span><span class="w"> </span><span class="n">keys</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                             </span><span class="n">batches</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">n_batches</span><span class="p">,</span><span class="w"> </span><span class="n">in_port</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="err">}</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="cm">/* All the flow batches need to be reset before any call to</span>
<span class="cm">openvswitch-2.9.0/lib/dpif-netdev.c-     * packet_batch_per_flow_execute() as it could potentially trigger</span>
<span class="cm">openvswitch-2.9.0/lib/dpif-netdev.c:     * recirculation. When a packet matching flow ‚Äòj‚Äô happens to be</span>
<span class="cm">openvswitch-2.9.0/lib/dpif-netdev.c-     * recirculated, the nested call to dp_netdev_input__() could potentially</span>
<span class="cm">openvswitch-2.9.0/lib/dpif-netdev.c-     * classify the packet as matching another flow - say &#39;k&#39;. It could happen</span>
<span class="cm">openvswitch-2.9.0/lib/dpif-netdev.c-     * that in the previous call to dp_netdev_input__() that same flow &#39;k&#39; had</span>
<span class="cm">openvswitch-2.9.0/lib/dpif-netdev.c-     * already its own batches[k] still waiting to be served.  So if its</span>
<span class="cm">openvswitch-2.9.0/lib/dpif-netdev.c-     * ‚Äòbatch‚Äô member is not reset, the recirculated packet would be wrongly</span>
<span class="cm">openvswitch-2.9.0/lib/dpif-netdev.c-     * appended to batches[k] of the 1st call to dp_netdev_input__(). */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">size_t</span><span class="w"> </span><span class="n">i</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">n_batches</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="o">++</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="n">batches</span><span class="o">[</span><span class="n">i</span><span class="o">]</span><span class="p">.</span><span class="n">flow</span><span class="o">-&gt;</span><span class="n">batch</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="err">}</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                </span><span class="n">packet</span><span class="o">-&gt;</span><span class="n">md</span><span class="p">.</span><span class="n">recirc_id</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nl_attr_get_u32</span><span class="p">(</span><span class="n">a</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="err">}</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="p">(</span><span class="o">*</span><span class="k">depth</span><span class="p">)</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="n">dp_netdev_recirculate</span><span class="p">(</span><span class="n">pmd</span><span class="p">,</span><span class="w"> </span><span class="n">packets_</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="p">(</span><span class="o">*</span><span class="k">depth</span><span class="p">)</span><span class="o">--</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="k">return</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="err">}</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="w">        </span><span class="n">VLOG_WARN</span><span class="p">(</span><span class="ss">&quot;Packet dropped. Max recirculation depth exceeded.&quot;</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="k">case</span><span class="w"> </span><span class="nl">OVS_ACTION_ATTR_CT</span><span class="p">:</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="n">const</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">nlattr</span><span class="w"> </span><span class="o">*</span><span class="n">b</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="n">bool</span><span class="w"> </span><span class="n">force</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="n">bool</span><span class="w"> </span><span class="k">commit</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">false</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="n">unsigned</span><span class="w"> </span><span class="nc">int</span><span class="w"> </span><span class="nf">left</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="n">uint16_t</span><span class="w"> </span><span class="k">zone</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="n">const</span><span class="w"> </span><span class="nc">char</span><span class="w"> </span><span class="o">*</span><span class="n">helper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">dpif</span><span class="o">-</span><span class="n">netdev</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="n">const</span><span class="w"> </span><span class="n">uint32_t</span><span class="w"> </span><span class="o">*</span><span class="n">setmark</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="k">default</span><span class="err">:</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="cm">/* Only the above protocols are supported for encap.</span>
<span class="cm">openvswitch-2.9.0/lib/odp-util.c-             * The check is done at action translation. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="n">OVS_NOT_REACHED</span><span class="p">();</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="err">}</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="err">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="cm">/* This is an explicit or implicit decap case. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">pt_ns</span><span class="p">(</span><span class="n">flow</span><span class="o">-&gt;</span><span class="n">packet_type</span><span class="p">)</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">OFPHTN_ETHERTYPE</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="n">base_flow</span><span class="o">-&gt;</span><span class="n">packet_type</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">htonl</span><span class="p">(</span><span class="n">PT_ETH</span><span class="p">))</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="w">            </span><span class="cm">/* Generate pop_eth and continue without recirculation. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="n">odp_put_pop_eth_action</span><span class="p">(</span><span class="n">odp_actions</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="n">base_flow</span><span class="o">-&gt;</span><span class="n">packet_type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">flow</span><span class="o">-&gt;</span><span class="n">packet_type</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="n">base_flow</span><span class="o">-&gt;</span><span class="n">dl_src</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eth_addr_zero</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="n">base_flow</span><span class="o">-&gt;</span><span class="n">dl_dst</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">eth_addr_zero</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="err">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="w">            </span><span class="cm">/* All other decap cases require recirculation.</span>
<span class="cm">openvswitch-2.9.0/lib/odp-util.c-             * No need to update the base flow here. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="n">switch</span><span class="w"> </span><span class="p">(</span><span class="n">ntohl</span><span class="p">(</span><span class="n">base_flow</span><span class="o">-&gt;</span><span class="n">packet_type</span><span class="p">))</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="k">case</span><span class="w"> </span><span class="nl">PT_NSH</span><span class="p">:</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                </span><span class="cm">/* pop_nsh. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                </span><span class="n">odp_put_pop_nsh_action</span><span class="p">(</span><span class="n">odp_actions</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                </span><span class="k">break</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="k">default</span><span class="err">:</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                </span><span class="cm">/* Checks are done during translation. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                </span><span class="n">OVS_NOT_REACHED</span><span class="p">();</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">odp</span><span class="o">-</span><span class="n">util</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="err">}</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ovn</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">actions</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="n">nat</span><span class="o">-&gt;</span><span class="n">flags</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">NX_NAT_F_DST</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ovn</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">actions</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="err">}</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ovn</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">actions</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="err">}</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ovn</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">actions</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ovn</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">actions</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">ofpacts</span><span class="o">-&gt;</span><span class="n">header</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ofpbuf_push_uninit</span><span class="p">(</span><span class="n">ofpacts</span><span class="p">,</span><span class="w"> </span><span class="n">nat_offset</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ovn</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">actions</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">ct</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ofpacts</span><span class="o">-&gt;</span><span class="n">header</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ovn</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">actions</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cn</span><span class="o">-&gt;</span><span class="n">ip</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ovn</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">actions</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="n">ct</span><span class="o">-&gt;</span><span class="n">flags</span><span class="w"> </span><span class="o">|=</span><span class="w"> </span><span class="n">NX_CT_F_COMMIT</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ovn</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">actions</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="err">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">snat</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">ep</span><span class="o">-&gt;</span><span class="n">is_gateway_router</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ovn</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">actions</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="cm">/* For performance reasons, we try to prevent additional</span>
<span class="cm">openvswitch-2.9.0/ovn/lib/actions.c:         * recirculations.  ct_snat which is used in a gateway router</span>
<span class="cm">openvswitch-2.9.0/ovn/lib/actions.c:         * does not need a recirculation.  ct_snat(IP) does need a</span>
<span class="cm">openvswitch-2.9.0/ovn/lib/actions.c:         * recirculation.  ct_snat in a distributed router needs</span>
<span class="cm">openvswitch-2.9.0/ovn/lib/actions.c:         * recirculation regardless of whether an IP address is</span>
<span class="cm">openvswitch-2.9.0/ovn/lib/actions.c-         * specified.</span>
<span class="cm">openvswitch-2.9.0/ovn/lib/actions.c-         * XXX Should we consider a method to let the actions specify</span>
<span class="cm">openvswitch-2.9.0/ovn/lib/actions.c:         * whether an action needs recirculation if there are more use</span>
<span class="cm">openvswitch-2.9.0/ovn/lib/actions.c-         * cases?. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ovn</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">actions</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="n">ct</span><span class="o">-&gt;</span><span class="n">recirc_table</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">NX_CT_RECIRC_NONE</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ovn</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">actions</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="err">}</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ovn</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">actions</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">ofpact_finish</span><span class="p">(</span><span class="n">ofpacts</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">ct</span><span class="o">-&gt;</span><span class="n">ofpact</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ovn</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">actions</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">ofpbuf_push_uninit</span><span class="p">(</span><span class="n">ofpacts</span><span class="p">,</span><span class="w"> </span><span class="n">ct_offset</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ovn</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">actions</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="err">}</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ovn</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">actions</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ovn</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">actions</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="k">static</span><span class="w"> </span><span class="n">void</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ovn</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">actions</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="n">encode_CT_DNAT</span><span class="p">(</span><span class="n">const</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">ovnact_ct_nat</span><span class="w"> </span><span class="o">*</span><span class="n">cn</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ovn</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">actions</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">               </span><span class="n">const</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">ovnact_encode_params</span><span class="w"> </span><span class="o">*</span><span class="n">ep</span><span class="p">,</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w"> </span><span class="n">later</span><span class="p">.</span><span class="w">  </span><span class="n">We</span><span class="w"> </span><span class="k">call</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">checkpointing</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="ss">&quot;freezing&quot;</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">restarting</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="ss">&quot;thawing&quot;</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="k">use</span><span class="w"> </span><span class="n">cases</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">freezing</span><span class="w"> </span><span class="k">are</span><span class="err">:</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w">     </span><span class="o">-</span><span class="w"> </span><span class="ss">&quot;Recirculation&quot;</span><span class="p">,</span><span class="w"> </span><span class="k">where</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">translation</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">discovers</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">it</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w">       </span><span class="n">doesn</span><span class="s1">&#39;t have enough information to complete translation without</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *       actually executing the actions that have already been translated,</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *       which provides the additionally needed information.  In these</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *       situations, translation freezes translation and assigns the frozen</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c:    *       data a unique &quot;recirculation ID&quot;, which it associates with the data</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *       in a table in userspace (see ofproto-dpif-rid.h).  It also adds a</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *       OVS_ACTION_ATTR_RECIRC action specifying that ID to the datapath</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *       actions.  When a packet hits that action, the datapath looks its</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *       flow up again using the ID.  If there&#39;</span><span class="n">s</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">miss</span><span class="p">,</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">comes</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="k">to</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="w">    </span><span class="o">*</span><span class="w">       </span><span class="n">userspace</span><span class="p">,</span><span class="w"> </span><span class="n">which</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">recirculation</span><span class="w"> </span><span class="nc">table</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ID</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w">       </span><span class="n">thaws</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">associated</span><span class="w"> </span><span class="n">frozen</span><span class="w"> </span><span class="k">data</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">continues</span><span class="w"> </span><span class="k">translation</span><span class="w"> </span><span class="k">from</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w">       </span><span class="n">that</span><span class="w"> </span><span class="n">point</span><span class="w"> </span><span class="n">given</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="n">information</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">now</span><span class="w"> </span><span class="n">known</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w">       </span><span class="n">The</span><span class="w"> </span><span class="n">archetypal</span><span class="w"> </span><span class="n">example</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">MPLS</span><span class="p">.</span><span class="w">  </span><span class="k">As</span><span class="w"> </span><span class="n">MPLS</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">implemented</span><span class="w"> </span><span class="ow">in</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w">       </span><span class="n">OpenFlow</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">protocol</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">follows</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">last</span><span class="w"> </span><span class="n">MPLS</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="n">becomes</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w">       </span><span class="n">known</span><span class="w"> </span><span class="k">only</span><span class="w"> </span><span class="k">when</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">label</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="n">popped</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">OpenFlow</span><span class="w"> </span><span class="k">action</span><span class="p">.</span><span class="w">  </span><span class="n">That</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w">       </span><span class="n">means</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="k">Open</span><span class="w"> </span><span class="n">vSwitch</span><span class="w"> </span><span class="n">can</span><span class="s1">&#39;t extract the headers beyond the MPLS</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *       labels until the pop action is executed.  Thus, at that point</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c:    *       translation uses the recirculation process to extract the headers</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *       beyond the MPLS labels.</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *       (OVS also uses OVS_ACTION_ATTR_RECIRC to implement hashing for</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *       output to bonds.  OVS pre-populates all the datapath flows for bond</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *       output in the datapath, though, which means that the elaborate</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *       process of coming back to userspace for a second round of</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *       translation isn&#39;</span><span class="n">t</span><span class="w"> </span><span class="n">needed</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">bonds</span><span class="w"> </span><span class="n">don</span><span class="s1">&#39;t follow the above</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *       process.)</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *     - &quot;Continuation&quot;.  A continuation is a way for an OpenFlow controller</span>
<span class="s1">--</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    * translation process:</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    * 1. Sets &#39;</span><span class="n">freezing</span><span class="s1">&#39; to true.</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    * 2. Sets &#39;</span><span class="k">exit</span><span class="s1">&#39; to true to tell later steps that we&#39;</span><span class="n">re</span><span class="w"> </span><span class="n">exiting</span><span class="w"> </span><span class="k">from</span><span class="w"> </span><span class="n">the</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w">    </span><span class="k">translation</span><span class="w"> </span><span class="n">process</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w"> </span><span class="mf">3.</span><span class="w"> </span><span class="n">Adds</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">OFPACT_UNROLL_XLATE</span><span class="w"> </span><span class="k">action</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="s1">&#39;frozen_actions&#39;</span><span class="p">,</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">points</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w">    </span><span class="n">frozen_actions</span><span class="p">.</span><span class="n">header</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">action</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">make</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">easy</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">find</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="n">later</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w">    </span><span class="n">This</span><span class="w"> </span><span class="k">action</span><span class="w"> </span><span class="n">holds</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">current</span><span class="w"> </span><span class="nc">table</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">cookie</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="w">    </span><span class="o">*</span><span class="w">    </span><span class="n">restored</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">post</span><span class="o">-</span><span class="n">recirculation</span><span class="w"> </span><span class="n">upcall</span><span class="w"> </span><span class="k">translation</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="w">    </span><span class="o">*</span><span class="w"> </span><span class="mf">4.</span><span class="w"> </span><span class="n">Adds</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">action</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">prompted</span><span class="w"> </span><span class="n">recirculation</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="ow">any</span><span class="w"> </span><span class="n">actions</span><span class="w"> </span><span class="n">following</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w">    </span><span class="n">it</span><span class="w"> </span><span class="k">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">same</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="s1">&#39;frozen_actions&#39;</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">they</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="w">    </span><span class="o">*</span><span class="w">    </span><span class="n">executed</span><span class="w"> </span><span class="n">during</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">post</span><span class="o">-</span><span class="n">recirculation</span><span class="w"> </span><span class="n">upcall</span><span class="w"> </span><span class="k">translation</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w"> </span><span class="mf">5.</span><span class="w"> </span><span class="k">Returns</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="w">    </span><span class="o">*</span><span class="w"> </span><span class="mf">6.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="k">action</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">prompted</span><span class="w"> </span><span class="n">recirculation</span><span class="w"> </span><span class="n">might</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">nested</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">stack</span><span class="w"> </span><span class="k">of</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w">    </span><span class="n">nested</span><span class="w"> </span><span class="ss">&quot;resubmit&quot;</span><span class="n">s</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">have</span><span class="w"> </span><span class="n">actions</span><span class="w"> </span><span class="n">remaining</span><span class="p">.</span><span class="w">  </span><span class="k">Each</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">these</span><span class="w"> </span><span class="n">notices</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w">    </span><span class="n">that</span><span class="w"> </span><span class="n">we</span><span class="s1">&#39;re exiting and freezing and responds by adding more</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *    OFPACT_UNROLL_XLATE actions to &#39;</span><span class="n">frozen_actions</span><span class="s1">&#39;, as necessary,</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *    followed by any actions that were yet unprocessed.</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-    *</span>
<span class="s1">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c:    * If we&#39;</span><span class="n">re</span><span class="w"> </span><span class="n">freezing</span><span class="w"> </span><span class="n">because</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">recirculation</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">caller</span><span class="w"> </span><span class="n">generates</span><span class="w"> </span><span class="n">a</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="w">    </span><span class="o">*</span><span class="w"> </span><span class="n">recirculation</span><span class="w"> </span><span class="n">ID</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="n">associates</span><span class="w"> </span><span class="ow">all</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">state</span><span class="w"> </span><span class="n">produced</span><span class="w"> </span><span class="k">by</span><span class="w"> </span><span class="n">this</span><span class="w"> </span><span class="n">process</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="w">    </span><span class="o">*</span><span class="w"> </span><span class="k">with</span><span class="w"> </span><span class="n">it</span><span class="p">.</span><span class="w">  </span><span class="k">For</span><span class="w"> </span><span class="n">post</span><span class="o">-</span><span class="n">recirculation</span><span class="w"> </span><span class="n">upcall</span><span class="w"> </span><span class="k">translation</span><span class="p">,</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">caller</span><span class="w"> </span><span class="n">passes</span><span class="w"> </span><span class="n">it</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w"> </span><span class="n">back</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="k">translation</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="k">execute</span><span class="p">.</span><span class="w">  </span><span class="n">The</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">yielded</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="k">of</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w"> </span><span class="n">ofpacts</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">translated</span><span class="w"> </span><span class="n">directly</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">it</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">much</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">special</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*</span><span class="w"> </span><span class="k">case</span><span class="w"> </span><span class="k">at</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">point</span><span class="p">.</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="o">*/</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">bool</span><span class="w"> </span><span class="n">freezing</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="w">    </span><span class="n">bool</span><span class="w"> </span><span class="n">recirc_update_dp_hash</span><span class="p">;</span><span class="w">    </span><span class="cm">/* Generated recirculation will be preceded</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-                                    * by datapath HASH action to get an updated</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c:                                    * dp_hash after recirculation. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">uint32_t</span><span class="w"> </span><span class="n">dp_hash_alg</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">uint32_t</span><span class="w"> </span><span class="n">dp_hash_basis</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">struct</span><span class="w"> </span><span class="n">ofpbuf</span><span class="w"> </span><span class="n">frozen_actions</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">const</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">ofpact_controller</span><span class="w"> </span><span class="o">*</span><span class="n">pause</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="cm">/* True if a packet was but is no longer MPLS (due to an MPLS pop action).</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c:     * This is a trigger for recirculation in cases where translating an action</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-     * or looking up a flow requires access to the fields of the packet after</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-     * the MPLS label stack that was originally present. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">bool</span><span class="w"> </span><span class="n">was_mpls</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="cm">/* True if conntrack has been performed on this packet during processing</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-     * on the current bridge. This is used to determine whether conntrack</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-     * state from the datapath should be honored after thawing. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">bool</span><span class="w"> </span><span class="n">conntracked</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="cm">/* Pointer to an embedded NAT action in a conntrack action, or NULL. */</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="k">static</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">xvlan_put</span><span class="p">(</span><span class="n">struct</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">xvlan</span><span class="w"> </span><span class="o">*</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="k">static</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">xvlan_input_translate</span><span class="p">(</span><span class="n">const</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">xbundle</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                                  </span><span class="n">const</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">xvlan</span><span class="w"> </span><span class="o">*</span><span class="ow">in</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                                  </span><span class="n">struct</span><span class="w"> </span><span class="n">xvlan</span><span class="w"> </span><span class="o">*</span><span class="n">xvlan</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="k">static</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">xvlan_output_translate</span><span class="p">(</span><span class="n">const</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">xbundle</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                                   </span><span class="n">const</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">xvlan</span><span class="w"> </span><span class="o">*</span><span class="n">xvlan</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                                   </span><span class="n">struct</span><span class="w"> </span><span class="n">xvlan</span><span class="w"> </span><span class="o">*</span><span class="k">out</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="k">static</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">output_normal</span><span class="p">(</span><span class="n">struct</span><span class="w"> </span><span class="n">xlate_ctx</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">xbundle</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                          </span><span class="n">const</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">xvlan</span><span class="w"> </span><span class="o">*</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="cm">/* Optional bond recirculation parameter to compose_output_action(). */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="n">struct</span><span class="w"> </span><span class="n">xlate_bond_recirc</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="w">    </span><span class="n">uint32_t</span><span class="w"> </span><span class="n">recirc_id</span><span class="p">;</span><span class="w">  </span><span class="cm">/* !0 Use recirculation instead of output. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">uint8_t</span><span class="w">  </span><span class="n">hash_alg</span><span class="p">;</span><span class="w">   </span><span class="cm">/* !0 Compute hash for recirc before. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">uint32_t</span><span class="w"> </span><span class="n">hash_basis</span><span class="p">;</span><span class="w">  </span><span class="cm">/* Compute hash for recirc before. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="err">}</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="k">static</span><span class="w"> </span><span class="n">void</span><span class="w"> </span><span class="n">compose_output_action</span><span class="p">(</span><span class="n">struct</span><span class="w"> </span><span class="n">xlate_ctx</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">ofp_port_t</span><span class="w"> </span><span class="n">ofp_port</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                                  </span><span class="n">const</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">xlate_bond_recirc</span><span class="w"> </span><span class="o">*</span><span class="n">xr</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                                  </span><span class="n">bool</span><span class="w"> </span><span class="n">is_last_action</span><span class="p">,</span><span class="w"> </span><span class="n">bool</span><span class="w"> </span><span class="k">truncate</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="k">static</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">xbridge</span><span class="w"> </span><span class="o">*</span><span class="n">xbridge_lookup</span><span class="p">(</span><span class="n">struct</span><span class="w"> </span><span class="n">xlate_cfg</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                                      </span><span class="n">const</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">ofproto_dpif</span><span class="w"> </span><span class="o">*</span><span class="p">);</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="cm">/* If packet is recirculated, xport can be retrieved from frozen state. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">flow</span><span class="o">-&gt;</span><span class="n">recirc_id</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="n">const</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">recirc_id_node</span><span class="w"> </span><span class="o">*</span><span class="n">recirc_id_node</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="n">recirc_id_node</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recirc_id_node_find</span><span class="p">(</span><span class="n">flow</span><span class="o">-&gt;</span><span class="n">recirc_id</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">OVS_UNLIKELY</span><span class="p">(</span><span class="err">!</span><span class="n">recirc_id_node</span><span class="p">))</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="k">NULL</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="err">}</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="nl">c</span><span class="p">:</span><span class="w">        </span><span class="cm">/* If recirculation was initiated due to bond (in_port = OFPP_NONE)</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-         * then frozen state is static and xport_uuid is not defined, so xport</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-         * cannot be restored from frozen state. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">recirc_id_node</span><span class="o">-&gt;</span><span class="k">state</span><span class="p">.</span><span class="n">metadata</span><span class="p">.</span><span class="n">in_port</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">OFPP_NONE</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="n">struct</span><span class="w"> </span><span class="n">uuid</span><span class="w"> </span><span class="n">xport_uuid</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">recirc_id_node</span><span class="o">-&gt;</span><span class="k">state</span><span class="p">.</span><span class="n">xport_uuid</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="n">xport</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">xport_lookup_by_uuid</span><span class="p">(</span><span class="n">xcfg</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">xport_uuid</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">xport</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">xport</span><span class="o">-&gt;</span><span class="n">xbridge</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">xport</span><span class="o">-&gt;</span><span class="n">xbridge</span><span class="o">-&gt;</span><span class="n">ofproto</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                </span><span class="k">goto</span><span class="w"> </span><span class="nl">out</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">            </span><span class="err">}</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="err">}</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="err">}</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">netdev_init_tnl_build_header_params</span><span class="p">(</span><span class="o">&amp;</span><span class="n">tnl_params</span><span class="p">,</span><span class="w"> </span><span class="n">flow</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">s_ip6</span><span class="p">,</span><span class="w"> </span><span class="n">dmac</span><span class="p">,</span><span class="w"> </span><span class="n">smac</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tnl_port_build_header</span><span class="p">(</span><span class="n">xport</span><span class="o">-&gt;</span><span class="n">ofport</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tnl_push_data</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tnl_params</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">err</span><span class="p">)</span><span class="w"> </span><span class="err">{</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">err</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="err">}</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">tnl_push_data</span><span class="p">.</span><span class="n">tnl_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">tunnel_odp_port</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">tnl_push_data</span><span class="p">.</span><span class="n">out_port</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">out_dev</span><span class="o">-&gt;</span><span class="n">odp_port</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="cm">/* After tunnel header has been added, MAC and IP data of flow and</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c:     * base_flow need to be set properly, since there is not recirculation</span>
<span class="cm">openvswitch-2.9.0/ofproto/ofproto-dpif-xlate.c-     * any more when sending packet to tunnel. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">propagate_tunnel_data_to_flow</span><span class="p">(</span><span class="n">ctx</span><span class="p">,</span><span class="w"> </span><span class="n">dmac</span><span class="p">,</span><span class="w"> </span><span class="n">smac</span><span class="p">,</span><span class="w"> </span><span class="n">s_ip6</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                                  </span><span class="n">s_ip</span><span class="p">,</span><span class="w"> </span><span class="n">tnl_params</span><span class="p">.</span><span class="n">is_ipv6</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">                                  </span><span class="n">tnl_push_data</span><span class="p">.</span><span class="n">tnl_type</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">size_t</span><span class="w"> </span><span class="n">clone_ofs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">size_t</span><span class="w"> </span><span class="n">push_action_size</span><span class="p">;</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">ofproto</span><span class="o">-</span><span class="n">dpif</span><span class="o">-</span><span class="n">xlate</span><span class="p">.</span><span class="n">c</span><span class="o">-</span><span class="w">    </span><span class="n">clone_ofs</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">nl_msg_start_nested</span><span class="p">(</span><span class="n">ctx</span><span class="o">-&gt;</span><span class="n">odp_actions</span><span class="p">,</span><span class="w"> </span><span class="n">OVS_ACTION_ATTR_CLONE</span><span class="p">);</span><span class="w"></span>
<span class="o">--</span><span class="w"></span>
<span class="n">penvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">bond</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">void</span><span class="w"> </span><span class="o">*</span><span class="n">bond_choose_output_slave</span><span class="p">(</span><span class="n">struct</span><span class="w"> </span><span class="n">bond</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">bond</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w">                               </span><span class="n">struct</span><span class="w"> </span><span class="n">flow_wildcards</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">uint16_t</span><span class="w"> </span><span class="n">vlan</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">bond</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">bond</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="cm">/* Rebalancing. */</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">bond</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">void</span><span class="w"> </span><span class="n">bond_account</span><span class="p">(</span><span class="n">struct</span><span class="w"> </span><span class="n">bond</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">const</span><span class="w"> </span><span class="n">struct</span><span class="w"> </span><span class="n">flow</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">uint16_t</span><span class="w"> </span><span class="n">vlan</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">bond</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w">                  </span><span class="n">uint64_t</span><span class="w"> </span><span class="n">n_bytes</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">bond</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">void</span><span class="w"> </span><span class="n">bond_rebalance</span><span class="p">(</span><span class="n">struct</span><span class="w"> </span><span class="n">bond</span><span class="w"> </span><span class="o">*</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">bond</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">bond</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="cm">/* Recirculation</span>
<span class="cm">openvswitch-2.9.0/ofproto/bond.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/bond.h: * Only balance_tcp mode uses recirculation.</span>
<span class="cm">openvswitch-2.9.0/ofproto/bond.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/bond.h: * When recirculation is used, each bond port is assigned with a unique</span>
<span class="cm">openvswitch-2.9.0/ofproto/bond.h- * recirc_id. The output action to the bond port will be replaced by</span>
<span class="cm">openvswitch-2.9.0/ofproto/bond.h- * a Hash action, followed by a RECIRC action.</span>
<span class="cm">openvswitch-2.9.0/ofproto/bond.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/bond.h- *   ... actions= ... HASH(hash(L4)), RECIRC(recirc_id) ....</span>
<span class="cm">openvswitch-2.9.0/ofproto/bond.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/bond.h: * On handling first output packet, 256 post recirculation flows are installed:</span>
<span class="cm">openvswitch-2.9.0/ofproto/bond.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/bond.h- *  recirc_id=&lt;bond_recirc_id&gt;, dp_hash=&lt;[0..255]&gt;/0xff, actions: output&lt;slave&gt;</span>
<span class="cm">openvswitch-2.9.0/ofproto/bond.h- *</span>
<span class="cm">openvswitch-2.9.0/ofproto/bond.h: * Bond module pulls stats from those post recirculation rules. If rebalancing</span>
<span class="cm">openvswitch-2.9.0/ofproto/bond.h- * is needed, those rules are updated with new output actions.</span>
<span class="cm">openvswitch-2.9.0/ofproto/bond.h-*/</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">bond</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">void</span><span class="w"> </span><span class="n">bond_update_post_recirc_rules</span><span class="p">(</span><span class="n">struct</span><span class="w"> </span><span class="n">bond</span><span class="w"> </span><span class="o">*</span><span class="p">,</span><span class="w"> </span><span class="n">uint32_t</span><span class="w"> </span><span class="o">*</span><span class="n">recirc_id</span><span class="p">,</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">bond</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="w">                                   </span><span class="n">uint32_t</span><span class="w"> </span><span class="o">*</span><span class="n">hash_basis</span><span class="p">);</span><span class="w"></span>
<span class="n">openvswitch</span><span class="o">-</span><span class="mf">2.9.0</span><span class="o">/</span><span class="n">ofproto</span><span class="o">/</span><span class="n">bond</span><span class="p">.</span><span class="n">h</span><span class="o">-</span><span class="n">#endif</span><span class="w"> </span><span class="cm">/* bond.h */</span><span class="w"></span>
</code></pre></div>
</td></tr></table></p>
                
                  
                    

<hr>
<div class="md-source-date">
  <small>
    
      Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">September 13, 2020</span>
    
  </small>
</div>
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../ovn_standalone_on_fedora31/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              OVN standalone on Fedora 31
            </div>
          </div>
        </a>
      
      
        <a href="../ovs-vxlan-tunnels-and-dscp/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              OVS VXLAN tunnels and DSCP
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["toc.integrate"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
    
  </body>
</html>