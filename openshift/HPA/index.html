
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Andreas Karis' blog about anything Kubernetes, OpenShift, Linux and Networking">
      
      
      
        <link rel="canonical" href="https://andreaskaris.github.io/blog/openshift/HPA/">
      
      
        <link rel="prev" href="../kubernetes_cluster/">
      
      
        <link rel="next" href="../how_rhcos_updates_work/">
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.4.2, mkdocs-material-9.0.14">
    
    
      
        <title>Horizontal Pod Autoscaler - Andreas Karis Blog</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.113286f1.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.a0c5b2b5.min.css">
      
      

    
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="pink">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Andreas Karis Blog" class="md-header__button md-logo" aria-label="Andreas Karis Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Andreas Karis Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Horizontal Pod Autoscaler
            
          </span>
        </div>
      </div>
    </div>
    
    
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href="../.." class="md-tabs__link">
      Home
    </a>
  </li>

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../ceph/" class="md-tabs__link">
        Ceph
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../linux/" class="md-tabs__link">
        Linux
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../networking/" class="md-tabs__link">
        Networking
      </a>
    </li>
  

      
        
  
  
    
  


  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link md-tabs__link--active">
        OpenShift and Kubernetes
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../openstack/" class="md-tabs__link">
        OpenStack
      </a>
    </li>
  

      
        
  
  


  
  
  
    <li class="md-tabs__item">
      <a href="../../coding/" class="md-tabs__link">
        Coding
      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
  
    
    <!--
    <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner">
          

  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Andreas Karis Blog" class="md-nav__button md-logo" aria-label="Andreas Karis Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54Z"/></svg>

    </a>
    Andreas Karis Blog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
      
      
        
          
            
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../ceph/">Ceph</a>
          
            <label for="__nav_2">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Ceph
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../ceph/ceph-manual-test/" class="md-nav__link">
        Ceph manual test with qemu
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../linux/">Linux</a>
          
            <label for="__nav_3">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/cgroups/" class="md-nav__link">
        cgroups
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/containers/" class="md-nav__link">
        Containers in Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/hugepages/" class="md-nav__link">
        Hugepages
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/ipxe-boot-environment/" class="md-nav__link">
        iPXE boot environment on Fedora
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/java-idrac-issues/" class="md-nav__link">
        Java Idrac Issues
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/meson/" class="md-nav__link">
        meson
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/namespaces/" class="md-nav__link">
        namespaces
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/old_java_version_with_xorgs_in_container/" class="md-nav__link">
        Old Java inside a container with xorgs
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/get-process-cgroup-info-and-limits/" class="md-nav__link">
        Retrieving process cgroup resource usage and limit info
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/libvirt-uefi-without-secureboot/" class="md-nav__link">
        RHEL Booting a virtual machine with UEFI but without secure boot
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/setting-journalctl-limits/" class="md-nav__link">
        Setting journalctl limits
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../networking/">Networking</a>
          
            <label for="__nav_4">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Networking
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/accept-source-routing/" class="md-nav__link">
        Accept Source Routing
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/arp_and_the_neighbor_table/" class="md-nav__link">
        ARP and the Neighbor table
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/bpf-and-tcpdump/" class="md-nav__link">
        BPF and tcpdump
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/bonding_in_linux/" class="md-nav__link">
        Bonding in Linux
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/juniper_x520/" class="md-nav__link">
        Configure Juniper switch
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/haproxy-and-h2c/" class="md-nav__link">
        haproxy and HTTP/2
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/install-openvswitch-on-rocky/" class="md-nav__link">
        Install Open vSwitch on Rocky Linux 8
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/geneve_tunneling/" class="md-nav__link">
        Geneve tunneling
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/netlink/" class="md-nav__link">
        Netlink
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/ovn_standalone_on_fedora/" class="md-nav__link">
        OVN standalone on Fedora
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/ovs_recirculation/" class="md-nav__link">
        OVS packet recirculation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/ovs-vxlan-tunnels-and-dscp/" class="md-nav__link">
        OVS VXLAN tunnels and DSCP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/ovs_with_gdb/" class="md-nav__link">
        OVS with GDB
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/packet-tracing-with-ovn/" class="md-nav__link">
        Packet tracing with OVN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/sctp/" class="md-nav__link">
        SCTP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/useful-commands/" class="md-nav__link">
        Useful commands
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/wireguard/" class="md-nav__link">
        Wireguard
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" checked>
      
      
        
          
            
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../">OpenShift and Kubernetes</a>
          
            <label for="__nav_5">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="true">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          OpenShift and Kubernetes
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../alertmanager/" class="md-nav__link">
        AlertManager
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../analyzing-cni/" class="md-nav__link">
        Analyzing CNI calls
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ocp-custom-release-image/" class="md-nav__link">
        Building custom release images for OpenShift
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../cpu-manager-with-custom-machine-config-pool/" class="md-nav__link">
        CPU manager with custom MachineConfigPool
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../crio-conmon-runc/" class="md-nav__link">
        Crio vs conmon vs runc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../etcd_perf/" class="md-nav__link">
        Etcd Performance tests
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../get-vs-list-api-calls/" class="md-nav__link">
        Get vs List API Calls
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../openshift_httpbin_tshark_sidecar/" class="md-nav__link">
        Httpbin tshark sidecar container
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_cluster/" class="md-nav__link">
        Hints for installing kubernetes on Fedora
      </a>
    </li>
  

            
          
            
              
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Horizontal Pod Autoscaler
      </a>
      
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../how_rhcos_updates_work/" class="md-nav__link">
        How RHCOS updates work
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ocp4-infra-nodes-with-machineset-without-worker-label/" class="md-nav__link">
        Infra nodes with MachineSets without worker label
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ingresscontroller_router_sharding_ocp_on_osp/" class="md-nav__link">
        Ingress Controller Sharding OCP on OSP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ingress-controller-sharding-on-separate-vip/" class="md-nav__link">
        Ingress Controller Sharding on separate VIP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../openshift_mirror_registry/" class="md-nav__link">
        Installing a cluster with a mirror registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../istio-1.6-on-ocp.4.x/" class="md-nav__link">
        Istio 1.6 on OpenShift 4.x
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kata/" class="md-nav__link">
        kata containers and the kata operatora
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../ovn-kind-hybrid-overlay/" class="md-nav__link">
        Kind with OVN Kubernetes Hybrid Overlay
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../kind-with-private-registry/" class="md-nav__link">
        Kind with private registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../list_docker_registry_containers/" class="md-nav__link">
        List container images in registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../mounting-container-image/" class="md-nav__link">
        Mount a container image
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openstack/install_openshift_on_openstack/" class="md-nav__link">
        OpenShift on OpenStack
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../patch-service-loadbalancer-ingress-ip/" class="md-nav__link">
        Patch status.loadBalancer.ingress IP manually
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../private-registry/" class="md-nav__link">
        Private container registry
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../proxy-ocp-4.5/" class="md-nav__link">
        Proxy OCP 4.5
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../scc/" class="md-nav__link">
        Security Context Constraints (SCC)
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../openshift-scc-with-mutating-webhooks/" class="md-nav__link">
        SCCs and mutating webhooks - a lesson learned
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../fix-selinux-labels-coreos/" class="md-nav__link">
        SElinux labels fix
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/sctp/" class="md-nav__link">
        SCTP
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../openshift_troubleshooting_etcd_state/" class="md-nav__link">
        Troubleshooting etcd state
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../useful-ocp-commands/" class="md-nav__link">
        Useful commands for OpenShift
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../useful-ocp-sdn-commands/" class="md-nav__link">
        Useful commands for OpenShift SDN
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting_openshift_on_openstack_worker_creation/" class="md-nav__link">
        Troubleshooting OpenShift on OpenStack worker creation
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
      
      
        
          
            
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../openstack/">OpenStack</a>
          
            <label for="__nav_6">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          OpenStack
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openstack/reattach_to_running_deployment/" class="md-nav__link">
        Reattach to running deployment
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../openstack/using_clouds_yaml/" class="md-nav__link">
        Using clouds.yaml
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
      
      
      <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
      
      
        
          
            
          
        
          
        
          
        
          
        
      
      
        
        
        <div class="md-nav__link md-nav__link--index ">
          <a href="../../coding/">Coding</a>
          
            <label for="__nav_7">
              <span class="md-nav__icon md-icon"></span>
            </label>
          
        </div>
      
      <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          Coding
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../coding/operator-sdk-reconciliation/" class="md-nav__link">
        Controller Reconciliation
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../coding/vimrc/" class="md-nav__link">
        My vimrc
      </a>
    </li>
  

            
          
            
              
  
  
  
    <li class="md-nav__item">
      <a href="../../coding/golang-ip-conversion/" class="md-nav__link">
        Golang IP address conversion
      </a>
    </li>
  

            
          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
        </div>
      </div>
    </div>
    -->
  
  
    
    <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
      <div class="md-sidebar__scrollwrap">
        <div class="md-sidebar__inner">
          

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
  
</nav>
        </div>
      </div>
    </div>
  

          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  <h1>Horizontal Pod Autoscaler</h1>

<h3 id="understanding-the-horizontal-pod-autoscaler-hpa">Understanding the Horizontal Pod Autoscaler (HPA)</h3>
<p>The basics for Horiontal Pod Autoscaler (HPA) are well explained in:</p>
<ul>
<li><a href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/#support-for-metrics-apis">https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/#support-for-metrics-apis</a></li>
<li><a href="https://docs.openshift.com/container-platform/4.6/nodes/pods/nodes-pods-autoscaling.html">https://docs.openshift.com/container-platform/4.6/nodes/pods/nodes-pods-autoscaling.html</a></li>
</ul>
<p>For OpenShift 4.x, consider that there is a bug with the <code class="highlight">v1</code> API for autoscaling. However, the <code class="highlight">v2beta2</code> API works fine:</p>
<ul>
<li><a href="https://access.redhat.com/solutions/5428871">https://access.redhat.com/solutions/5428871</a></li>
</ul>
<h4 id="getting-the-examples">Getting the examples</h4>
<p>Clone the following repository. Then, go to directory <code class="highlight">hpa-test</code>:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div><pre><span></span><code>git clone https://github.com/andreaskaris/kubernetes.git
cd kubernetes/hpa-test
</code></pre></div></td></tr></table></div></p>
<p>You will find all required resources for the following steps. See <code class="highlight">REAME.md</code> in case you want to build your own <code class="highlight">hpa-tester</code> image.</p>
<h4 id="deploying-an-hpa-tester-deployment">Deploying an HPA tester deployment</h4>
<p>First, deploy the HPA-Tester deployment. The deployment runs 2 applications which simulate a cumulative load.  Meaning that <code class="highlight">COMBINED_CPU_MS</code> and <code class="highlight">COMBINED_MEMORY_MB</code> will be divided by the number of replicas for the deployment and each pod will then individually run that fraction of memory and CPU load. This check happens every <code class="highlight">SLEEP_TIME</code> seconds.</p>
<p>Deploy the deployment in a dedicated namespace with:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code>oc new-project hpa-test || oc project hpa-test
oc apply -f role-list-deployments-pods.yaml
oc apply -f role-binding-list-deployments-pods.yaml
oc apply -f deployment-hpa-tester.yaml
</code></pre></div></td></tr></table></div></p>
<p>If you change the replica count, the <code class="highlight">entrypoint.sh</code> will make sure to distribute the memory MB and CPU ms between the number of replicas.</p>
<h4 id="scaling-basics-based-on-the-average-cpu-scaler-metric">Scaling basics based on the average CPU scaler metric</h4>
<p>For the most basic example, <code class="highlight"><span class="na">.spec.template.spec.containers</span><span class="p">[</span><span class="mi">0</span><span class="p">].</span><span class="no">resources</span></code> is:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code>        resources:
          requests:
            cpu: &quot;1000m&quot;
            memory: &quot;1024Mi&quot;
</code></pre></div></td></tr></table></div></p>
<p>The Horizontal Pod Autoscaler will by default compare a pod's actual CPU usage to the pod's requested values:
<a href="https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/">https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale/</a>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">For</span><span class="w"> </span><span class="nv">per</span><span class="o">-</span><span class="nv">pod</span><span class="w"> </span><span class="nv">resource</span><span class="w"> </span><span class="nv">metrics</span><span class="w"> </span><span class="ss">(</span><span class="nv">like</span><span class="w"> </span><span class="nv">CPU</span><span class="ss">)</span>,<span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">controller</span><span class="w"> </span><span class="nv">fetches</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">metrics</span><span class="w"> </span><span class="nv">from</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">resource</span><span class="w"> </span><span class="nv">metrics</span><span class="w"> </span><span class="nv">API</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="nv">each</span><span class="w"> </span><span class="nv">Pod</span><span class="w"> </span><span class="nv">targeted</span><span class="w"> </span><span class="nv">by</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">HorizontalPodAutoscaler</span>.<span class="w"> </span><span class="k">Then</span>,<span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">target</span><span class="w"> </span><span class="nv">utilization</span><span class="w"> </span><span class="nv">value</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">set</span>,<span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">controller</span><span class="w"> </span><span class="nv">calculates</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">utilization</span><span class="w"> </span><span class="nv">value</span><span class="w"> </span><span class="nv">as</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">percentage</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">equivalent</span><span class="w"> </span><span class="nv">resource</span><span class="w"> </span><span class="nv">request</span><span class="w"> </span><span class="nv">on</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">containers</span><span class="w"> </span><span class="nv">in</span><span class="w"> </span><span class="nv">each</span><span class="w"> </span><span class="nv">Pod</span>.<span class="w"> </span><span class="k">If</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">target</span><span class="w"> </span><span class="nv">raw</span><span class="w"> </span><span class="nv">value</span><span class="w"> </span><span class="nv">is</span><span class="w"> </span><span class="nv">set</span>,<span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">raw</span><span class="w"> </span><span class="nv">metric</span><span class="w"> </span><span class="nv">values</span><span class="w"> </span><span class="nv">are</span><span class="w"> </span><span class="nv">used</span><span class="w"> </span><span class="nv">directly</span>.<span class="w"> </span><span class="nv">The</span><span class="w"> </span><span class="nv">controller</span><span class="w"> </span><span class="k">then</span><span class="w"> </span><span class="nv">takes</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">mean</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">utilization</span><span class="w"> </span><span class="nv">or</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">raw</span><span class="w"> </span><span class="nv">value</span><span class="w"> </span><span class="ss">(</span><span class="nv">depending</span><span class="w"> </span><span class="nv">on</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">type</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">target</span><span class="w"> </span><span class="nv">specified</span><span class="ss">)</span><span class="w"> </span><span class="nv">across</span><span class="w"> </span><span class="nv">all</span><span class="w"> </span><span class="nv">targeted</span><span class="w"> </span><span class="nv">Pods</span>,<span class="w"> </span><span class="nv">and</span><span class="w"> </span><span class="nv">produces</span><span class="w"> </span><span class="nv">a</span><span class="w"> </span><span class="nv">ratio</span><span class="w"> </span><span class="nv">used</span><span class="w"> </span><span class="nv">to</span><span class="w"> </span><span class="nv">scale</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">number</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">desired</span><span class="w"> </span><span class="nv">replicas</span>.

<span class="nv">Please</span><span class="w"> </span><span class="nv">note</span><span class="w"> </span><span class="nv">that</span><span class="w"> </span><span class="k">if</span><span class="w"> </span><span class="nv">some</span><span class="w"> </span><span class="nv">of</span><span class="w"> </span><span class="nv">the</span><span class="w"> </span><span class="nv">Pod</span><span class="err">&#39;s containers do not have the relevant resource request set, CPU utilization for the Pod will not be defined and the autoscaler will not take any action for that metric. See the algorithm details section below for more information about how the autoscaling algorithm works.</span>
</code></pre></div></td></tr></table></div></p>
<p>That also means that it is required to set resource requests for the containers.</p>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@openshift-jumpserver-0 hpa-test</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">pods</span>
<span class="n">NAME</span><span class="w">                          </span><span class="n">READY</span><span class="w">   </span><span class="n">STATUS</span><span class="w">    </span><span class="n">RESTARTS</span><span class="w">   </span><span class="n">AGE</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">wgmct</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">3</span><span class="n">m2s</span>
<span class="o">[</span><span class="n">root@openshift-jumpserver-0 hpa-test</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">podmetrics</span>
<span class="n">NAME</span><span class="w">                          </span><span class="n">CPU</span><span class="w">     </span><span class="n">MEMORY</span><span class="w">      </span><span class="k">WINDOW</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">wgmct</span><span class="w">   </span><span class="mi">1611</span><span class="n">m</span><span class="w">   </span><span class="mi">4218724</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
</code></pre></div></td></tr></table></div>
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@openshift-jumpserver-0 hpa-test</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">describe</span><span class="w"> </span><span class="n">pod</span><span class="w"> </span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">wgmct</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="n">Requests</span><span class="w"> </span><span class="o">-</span><span class="n">A2</span>
<span class="w">    </span><span class="nl">Requests</span><span class="p">:</span>
<span class="w">      </span><span class="nl">cpu</span><span class="p">:</span><span class="w">     </span><span class="mi">1</span>
<span class="w">      </span><span class="nl">memory</span><span class="p">:</span><span class="w">  </span><span class="mi">1</span><span class="n">Gi</span>
</code></pre></div></td></tr></table></div>
<p>When starting with the above configuration, the current CPU utilization for the pod is 1600ms / 1000ms (a request of one full CPU unit, and a cumulative load of 1600 ms), meaning the load is 160%</p>
<p>Now, deploy the following HPA resource:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">apiVersion</span><span class="o">:</span><span class="w"> </span><span class="n">autoscaling</span><span class="o">/</span><span class="n">v2beta2</span>
<span class="n">kind</span><span class="o">:</span><span class="w"> </span><span class="n">HorizontalPodAutoscaler</span>
<span class="n">metadata</span><span class="o">:</span>
<span class="w">  </span><span class="n">annotations</span><span class="o">:</span>
<span class="w">  </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span>
<span class="w">  </span><span class="kd">namespace</span><span class="o">:</span><span class="w"> </span><span class="n">test</span>
<span class="n">spec</span><span class="o">:</span>
<span class="w">  </span><span class="n">maxReplicas</span><span class="o">:</span><span class="w"> </span><span class="mi">20</span>
<span class="w">  </span><span class="n">minReplicas</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="n">scaleTargetRef</span><span class="o">:</span>
<span class="w">    </span><span class="n">apiVersion</span><span class="o">:</span><span class="w"> </span><span class="n">apps</span><span class="o">/</span><span class="n">v1</span>
<span class="w">    </span><span class="n">kind</span><span class="o">:</span><span class="w"> </span><span class="n">Deployment</span>
<span class="w">    </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span>
<span class="w">  </span><span class="n">metrics</span><span class="o">:</span><span class="w"> </span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">type</span><span class="o">:</span><span class="w"> </span><span class="n">Resource</span>
<span class="w">    </span><span class="n">resource</span><span class="o">:</span>
<span class="w">      </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">cpu</span><span class="w"> </span>
<span class="w">      </span><span class="n">target</span><span class="o">:</span>
<span class="w">        </span><span class="n">type</span><span class="o">:</span><span class="w"> </span><span class="n">Utilization</span>
<span class="w">        </span><span class="n">averageUtilization</span><span class="o">:</span><span class="w"> </span><span class="mi">60</span>
</code></pre></div></td></tr></table></div></p>
<p>The target load is 60%.</p>
<p>Looking at the algorithm data for this simple example:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div><pre><span></span><code>desiredReplicas = ceil[currentReplicas * ( currentMetricValue / desiredMetricValue )]
</code></pre></div></td></tr></table></div></p>
<p>That means <code class="highlight">ceil[1 * ( 160% / 60 % )] = 3</code></p>
<p>Let's test this:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@openshift-jumpserver-0 hpa-test</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">hpa</span><span class="p">.</span><span class="n">yaml</span><span class="w"> </span>
<span class="n">horizontalpodautoscaler</span><span class="p">.</span><span class="n">autoscaling</span><span class="o">/</span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="w"> </span><span class="n">created</span>
<span class="o">[</span><span class="n">root@openshift-jumpserver-0 hpa-test</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">hpa</span>
<span class="n">NAME</span><span class="w">         </span><span class="n">REFERENCE</span><span class="w">               </span><span class="n">TARGETS</span><span class="w">         </span><span class="n">MINPODS</span><span class="w">   </span><span class="n">MAXPODS</span><span class="w">   </span><span class="n">REPLICAS</span><span class="w">   </span><span class="n">AGE</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="w">   </span><span class="n">Deployment</span><span class="o">/</span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="w">   </span><span class="o">&lt;</span><span class="k">unknown</span><span class="o">&gt;/</span><span class="mi">60</span><span class="o">%</span><span class="w">   </span><span class="mi">1</span><span class="w">         </span><span class="mi">20</span><span class="w">        </span><span class="mi">0</span><span class="w">          </span><span class="mi">3</span><span class="n">s</span>
</code></pre></div></td></tr></table></div></p>
<p>After a while, we will see that the HPA scaled the deployment to 3 pods:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@openshift-jumpserver-0 hpa-test</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">hpa</span>
<span class="n">NAME</span><span class="w">         </span><span class="n">REFERENCE</span><span class="w">               </span><span class="n">TARGETS</span><span class="w">   </span><span class="n">MINPODS</span><span class="w">   </span><span class="n">MAXPODS</span><span class="w">   </span><span class="n">REPLICAS</span><span class="w">   </span><span class="n">AGE</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="w">   </span><span class="n">Deployment</span><span class="o">/</span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="w">   </span><span class="mi">55</span><span class="o">%/</span><span class="mi">60</span><span class="o">%</span><span class="w">   </span><span class="mi">1</span><span class="w">         </span><span class="mi">20</span><span class="w">        </span><span class="mi">3</span><span class="w">          </span><span class="mi">3</span><span class="n">m34s</span>
<span class="o">[</span><span class="n">root@openshift-jumpserver-0 hpa-test</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">pods</span>
<span class="n">NAME</span><span class="w">                          </span><span class="n">READY</span><span class="w">   </span><span class="n">STATUS</span><span class="w">    </span><span class="n">RESTARTS</span><span class="w">   </span><span class="n">AGE</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">c5hfj</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">3</span><span class="n">m20s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">lk2pv</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">3</span><span class="n">m20s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">wgmct</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">10</span><span class="n">m</span>
<span class="o">[</span><span class="n">root@openshift-jumpserver-0 hpa-test</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">podmetrics</span>
<span class="n">NAME</span><span class="w">                          </span><span class="n">CPU</span><span class="w">    </span><span class="n">MEMORY</span><span class="w">      </span><span class="k">WINDOW</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">c5hfj</span><span class="w">   </span><span class="mi">543</span><span class="n">m</span><span class="w">   </span><span class="mi">1413984</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">lk2pv</span><span class="w">   </span><span class="mi">533</span><span class="n">m</span><span class="w">   </span><span class="mi">1439692</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">wgmct</span><span class="w">   </span><span class="mi">547</span><span class="n">m</span><span class="w">   </span><span class="mi">1447412</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="scaling-based-on-absolute-cpu-values">Scaling based on absolute CPU values</h4>
<p>It is also possible to scale for a specific CPU value. First, scale back the deployment to 1 replica or delete and recreate it. Then, apply the following <code class="highlight">HorizontalPodAutoscaler</code>:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">apiVersion</span><span class="o">:</span><span class="w"> </span><span class="n">autoscaling</span><span class="o">/</span><span class="n">v2beta2</span>
<span class="n">kind</span><span class="o">:</span><span class="w"> </span><span class="n">HorizontalPodAutoscaler</span>
<span class="n">metadata</span><span class="o">:</span>
<span class="w">  </span><span class="n">annotations</span><span class="o">:</span>
<span class="w">  </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span>
<span class="w">  </span><span class="kd">namespace</span><span class="o">:</span><span class="w"> </span><span class="n">test</span>
<span class="n">spec</span><span class="o">:</span>
<span class="w">  </span><span class="n">maxReplicas</span><span class="o">:</span><span class="w"> </span><span class="mi">20</span>
<span class="w">  </span><span class="n">minReplicas</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="n">scaleTargetRef</span><span class="o">:</span>
<span class="w">    </span><span class="n">apiVersion</span><span class="o">:</span><span class="w"> </span><span class="n">apps</span><span class="o">/</span><span class="n">v1</span>
<span class="w">    </span><span class="n">kind</span><span class="o">:</span><span class="w"> </span><span class="n">Deployment</span>
<span class="w">    </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span>
<span class="w">  </span><span class="n">metrics</span><span class="o">:</span><span class="w"> </span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">type</span><span class="o">:</span><span class="w"> </span><span class="n">Resource</span>
<span class="w">    </span><span class="n">resource</span><span class="o">:</span>
<span class="w">      </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">cpu</span>
<span class="w">      </span><span class="n">target</span><span class="o">:</span>
<span class="w">        </span><span class="n">type</span><span class="o">:</span><span class="w"> </span><span class="n">AverageValue</span>
<span class="w">        </span><span class="n">averageValue</span><span class="o">:</span><span class="w"> </span><span class="mi">200</span><span class="n">m</span>
</code></pre></div></td></tr></table></div></p>
<p>And wait for 5 minutes. The result will be 9 pods - ceil [(1600ms + overhead) / 800ms]:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@openshift-jumpserver-0 hpa-test</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">hpa</span>
<span class="n">NAME</span><span class="w">         </span><span class="n">REFERENCE</span><span class="w">               </span><span class="n">TARGETS</span><span class="w">     </span><span class="n">MINPODS</span><span class="w">   </span><span class="n">MAXPODS</span><span class="w">   </span><span class="n">REPLICAS</span><span class="w">   </span><span class="n">AGE</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="w">   </span><span class="n">Deployment</span><span class="o">/</span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="w">   </span><span class="mi">199</span><span class="n">m</span><span class="o">/</span><span class="mi">200</span><span class="n">m</span><span class="w">   </span><span class="mi">1</span><span class="w">         </span><span class="mi">20</span><span class="w">        </span><span class="mi">9</span><span class="w">          </span><span class="mi">6</span><span class="n">m51s</span>
<span class="o">[</span><span class="n">root@openshift-jumpserver-0 hpa-test</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">pods</span>
<span class="n">NAME</span><span class="w">                          </span><span class="n">READY</span><span class="w">   </span><span class="n">STATUS</span><span class="w">    </span><span class="n">RESTARTS</span><span class="w">   </span><span class="n">AGE</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="mi">2</span><span class="n">dnjn</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">2</span><span class="n">m22s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="mi">5</span><span class="n">pf46</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">7</span><span class="n">m16s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">bx49l</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">2</span><span class="n">m7s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">d487n</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">2</span><span class="n">m22s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">h2kd8</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">112</span><span class="n">s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">mmk7c</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">2</span><span class="n">m22s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">n48nj</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">2</span><span class="n">m7s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">qhjtl</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">2</span><span class="n">m7s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">wx8r8</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">2</span><span class="n">m7s</span>
<span class="o">[</span><span class="n">root@openshift-jumpserver-0 hpa-test</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">podmetrics</span>
<span class="n">NAME</span><span class="w">                          </span><span class="n">CPU</span><span class="w">    </span><span class="n">MEMORY</span><span class="w">     </span><span class="k">WINDOW</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="mi">2</span><span class="n">dnjn</span><span class="w">   </span><span class="mi">192</span><span class="n">m</span><span class="w">   </span><span class="mi">478724</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="mi">5</span><span class="n">pf46</span><span class="w">   </span><span class="mi">199</span><span class="n">m</span><span class="w">   </span><span class="mi">509580</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">bx49l</span><span class="w">   </span><span class="mi">194</span><span class="n">m</span><span class="w">   </span><span class="mi">507920</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">d487n</span><span class="w">   </span><span class="mi">189</span><span class="n">m</span><span class="w">   </span><span class="mi">507564</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">h2kd8</span><span class="w">   </span><span class="mi">190</span><span class="n">m</span><span class="w">   </span><span class="mi">503232</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">mmk7c</span><span class="w">   </span><span class="mi">200</span><span class="n">m</span><span class="w">   </span><span class="mi">503428</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">n48nj</span><span class="w">   </span><span class="mi">202</span><span class="n">m</span><span class="w">   </span><span class="mi">506848</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">qhjtl</span><span class="w">   </span><span class="mi">197</span><span class="n">m</span><span class="w">   </span><span class="mi">477332</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">wx8r8</span><span class="w">   </span><span class="mi">194</span><span class="n">m</span><span class="w">   </span><span class="mi">479528</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="scaling-based-on-memory-utiliation">Scaling based on memory utiliation</h4>
<p>It is also possible to scale for a specific memory utiliation. First, scale back the deployment to 1 replica or delete and recreate i
t. Then, apply the following <code class="highlight">HorizontalPodAutoscaler</code>:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">apiVersion</span><span class="o">:</span><span class="w"> </span><span class="n">autoscaling</span><span class="o">/</span><span class="n">v2beta2</span>
<span class="n">kind</span><span class="o">:</span><span class="w"> </span><span class="n">HorizontalPodAutoscaler</span>
<span class="n">metadata</span><span class="o">:</span>
<span class="w">  </span><span class="n">annotations</span><span class="o">:</span>
<span class="w">  </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span>
<span class="w">  </span><span class="kd">namespace</span><span class="o">:</span><span class="w"> </span><span class="n">test</span>
<span class="n">spec</span><span class="o">:</span>
<span class="w">  </span><span class="n">maxReplicas</span><span class="o">:</span><span class="w"> </span><span class="mi">20</span>
<span class="w">  </span><span class="n">minReplicas</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="n">scaleTargetRef</span><span class="o">:</span>
<span class="w">    </span><span class="n">apiVersion</span><span class="o">:</span><span class="w"> </span><span class="n">apps</span><span class="o">/</span><span class="n">v1</span>
<span class="w">    </span><span class="n">kind</span><span class="o">:</span><span class="w"> </span><span class="n">Deployment</span>
<span class="w">    </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span>
<span class="w">  </span><span class="n">metrics</span><span class="o">:</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">type</span><span class="o">:</span><span class="w"> </span><span class="n">Resource</span>
<span class="w">    </span><span class="n">resource</span><span class="o">:</span>
<span class="w">      </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">memory</span>
<span class="w">      </span><span class="n">target</span><span class="o">:</span>
<span class="w">        </span><span class="n">type</span><span class="o">:</span><span class="w"> </span><span class="n">Utilization</span>
<span class="w">        </span><span class="n">averageUtilization</span><span class="o">:</span><span class="w"> </span><span class="mi">100</span>
</code></pre></div></td></tr></table></div></p>
<p>Apply the HPA and verify:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@openshift</span><span class="o">-</span><span class="n">jumpserver</span><span class="o">-</span><span class="mi">0</span><span class="w"> </span><span class="n">hpa</span><span class="o">-</span><span class="n">test</span><span class="o">]</span><span class="p">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="n">apply</span><span class="w"> </span><span class="o">-</span><span class="n">f</span><span class="w"> </span><span class="n">hpa</span><span class="p">.</span><span class="n">yaml</span><span class="w"> </span>
<span class="n">oc</span><span class="w"> </span><span class="n">ghorizontalpodautoscaler</span><span class="p">.</span><span class="n">autoscaling</span><span class="o">/</span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="w"> </span><span class="n">created</span>
<span class="o">[</span><span class="n">root@openshift</span><span class="o">-</span><span class="n">jumpserver</span><span class="o">-</span><span class="mi">0</span><span class="w"> </span><span class="n">hpa</span><span class="o">-</span><span class="n">test</span><span class="o">]</span><span class="p">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">hpa</span>
<span class="n">NAME</span><span class="w">         </span><span class="n">REFERENCE</span><span class="w">               </span><span class="n">TARGETS</span><span class="w">          </span><span class="n">MINPODS</span><span class="w">   </span><span class="n">MAXPODS</span><span class="w">   </span><span class="n">REPLICAS</span><span class="w">   </span><span class="n">AGE</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="w">   </span><span class="n">Deployment</span><span class="o">/</span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="w">   </span><span class="o">&lt;</span><span class="n">unknown</span><span class="o">&gt;/</span><span class="mi">100</span><span class="err">%</span><span class="w">   </span><span class="mi">1</span><span class="w">         </span><span class="mi">20</span><span class="w">        </span><span class="mi">0</span><span class="w">          </span><span class="mi">2s</span>
<span class="o">[</span><span class="n">root@openshift</span><span class="o">-</span><span class="n">jumpserver</span><span class="o">-</span><span class="mi">0</span><span class="w"> </span><span class="n">hpa</span><span class="o">-</span><span class="n">test</span><span class="o">]</span><span class="p">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="n">describe</span><span class="w"> </span><span class="n">hpa</span><span class="w"> </span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span>
<span class="n">Name</span><span class="p">:</span><span class="w">                                                     </span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span>
<span class="n">Namespace</span><span class="p">:</span><span class="w">                                                </span><span class="n">test</span>
<span class="n">Labels</span><span class="p">:</span><span class="w">                                                   </span><span class="o">&lt;</span><span class="n">none</span><span class="o">&gt;</span>
<span class="n">Annotations</span><span class="p">:</span><span class="w">                                              </span><span class="o">&lt;</span><span class="n">none</span><span class="o">&gt;</span>
<span class="n">CreationTimestamp</span><span class="p">:</span><span class="w">                                        </span><span class="n">Mon</span><span class="p">,</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="n">Mar</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="mi">10</span><span class="p">:</span><span class="mi">56</span><span class="p">:</span><span class="mi">02</span><span class="w"> </span><span class="o">+</span><span class="mi">0000</span>
<span class="n">Reference</span><span class="p">:</span><span class="w">                                                </span><span class="n">Deployment</span><span class="o">/</span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span>
<span class="n">Metrics</span><span class="p">:</span><span class="w">                                                  </span><span class="p">(</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="n">resource</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">pods</span><span class="w">  </span><span class="p">(</span><span class="ow">as</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">percentage</span><span class="w"> </span><span class="k">of</span><span class="w"> </span><span class="n">request</span><span class="p">):</span><span class="w">  </span><span class="o">&lt;</span><span class="n">unknown</span><span class="o">&gt;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">100</span><span class="err">%</span>
<span class="n">Min</span><span class="w"> </span><span class="n">replicas</span><span class="p">:</span><span class="w">                                             </span><span class="mi">1</span>
<span class="n">Max</span><span class="w"> </span><span class="n">replicas</span><span class="p">:</span><span class="w">                                             </span><span class="mi">20</span>
<span class="n">Deployment</span><span class="w"> </span><span class="n">pods</span><span class="p">:</span><span class="w">                                          </span><span class="mi">0</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">desired</span>
<span class="n">Events</span><span class="p">:</span><span class="w">                                                   </span><span class="o">&lt;</span><span class="n">none</span><span class="o">&gt;</span>
</code></pre></div></td></tr></table></div></p>
<p>And wait for 5 minutes. With 0 overhead inside the pods, the result be 4 pods - 4096 MB (cumulative Memory) / 1024 MB (request container spec) = 400%, then 400% / 100% = 4). Given that the cumulative memory utilization will be a bit higher than 4096 MB, HPA will scale out to 5 pods:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@openshift-jumpserver-0 hpa-test</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">hpa</span>
<span class="n">NAME</span><span class="w">         </span><span class="n">REFERENCE</span><span class="w">               </span><span class="n">TARGETS</span><span class="w">    </span><span class="n">MINPODS</span><span class="w">   </span><span class="n">MAXPODS</span><span class="w">   </span><span class="n">REPLICAS</span><span class="w">   </span><span class="n">AGE</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="w">   </span><span class="n">Deployment</span><span class="o">/</span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="w">   </span><span class="mi">83</span><span class="o">%/</span><span class="mi">100</span><span class="o">%</span><span class="w">   </span><span class="mi">1</span><span class="w">         </span><span class="mi">20</span><span class="w">        </span><span class="mi">5</span><span class="w">          </span><span class="mi">4</span><span class="n">m19s</span>
<span class="o">[</span><span class="n">root@openshift-jumpserver-0 hpa-test</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">pods</span>
<span class="n">NAME</span><span class="w">                          </span><span class="n">READY</span><span class="w">   </span><span class="n">STATUS</span><span class="w">    </span><span class="n">RESTARTS</span><span class="w">   </span><span class="n">AGE</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="mi">4</span><span class="n">dxgb</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">4</span><span class="n">m6s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="mi">7</span><span class="n">r4r8</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">3</span><span class="n">m51s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">h45s7</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">5</span><span class="n">m23s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">nxp29</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">4</span><span class="n">m6s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">trqv9</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">4</span><span class="n">m6s</span>
<span class="o">[</span><span class="n">root@openshift-jumpserver-0 hpa-test</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">podmetrics</span>
<span class="n">NAME</span><span class="w">                          </span><span class="n">CPU</span><span class="w">    </span><span class="n">MEMORY</span><span class="w">     </span><span class="k">WINDOW</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="mi">4</span><span class="n">dxgb</span><span class="w">   </span><span class="mi">338</span><span class="n">m</span><span class="w">   </span><span class="mi">878064</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="mi">7</span><span class="n">r4r8</span><span class="w">   </span><span class="mi">347</span><span class="n">m</span><span class="w">   </span><span class="mi">886932</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">h45s7</span><span class="w">   </span><span class="mi">338</span><span class="n">m</span><span class="w">   </span><span class="mi">854892</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">nxp29</span><span class="w">   </span><span class="mi">337</span><span class="n">m</span><span class="w">   </span><span class="mi">880600</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">trqv9</span><span class="w">   </span><span class="mi">342</span><span class="n">m</span><span class="w">   </span><span class="mi">878492</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
</code></pre></div></td></tr></table></div></p>
<h4 id="scaling-based-on-absolute-memory-values">Scaling based on absolute memory values</h4>
<p>It is also possible to scale for a specific CPU value. First, scale back the deployment to 1 replica or delete and recreate i
t. Then, apply the following <code class="highlight">HorizontalPodAutoscaler</code>:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">apiVersion</span><span class="o">:</span><span class="w"> </span><span class="n">autoscaling</span><span class="o">/</span><span class="n">v2beta2</span>
<span class="n">kind</span><span class="o">:</span><span class="w"> </span><span class="n">HorizontalPodAutoscaler</span>
<span class="n">metadata</span><span class="o">:</span>
<span class="w">  </span><span class="n">annotations</span><span class="o">:</span>
<span class="w">  </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span>
<span class="w">  </span><span class="kd">namespace</span><span class="o">:</span><span class="w"> </span><span class="n">test</span>
<span class="n">spec</span><span class="o">:</span>
<span class="w">  </span><span class="n">maxReplicas</span><span class="o">:</span><span class="w"> </span><span class="mi">20</span>
<span class="w">  </span><span class="n">minReplicas</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="n">scaleTargetRef</span><span class="o">:</span>
<span class="w">    </span><span class="n">apiVersion</span><span class="o">:</span><span class="w"> </span><span class="n">apps</span><span class="o">/</span><span class="n">v1</span>
<span class="w">    </span><span class="n">kind</span><span class="o">:</span><span class="w"> </span><span class="n">Deployment</span>
<span class="w">    </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span>
<span class="w">  </span><span class="n">metrics</span><span class="o">:</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">type</span><span class="o">:</span><span class="w"> </span><span class="n">Resource</span>
<span class="w">    </span><span class="n">resource</span><span class="o">:</span>
<span class="w">      </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">memory</span>
<span class="w">      </span><span class="n">target</span><span class="o">:</span>
<span class="w">        </span><span class="n">type</span><span class="o">:</span><span class="w"> </span><span class="n">AverageValue</span>
<span class="w">        </span><span class="n">averageValue</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;2048Mi&quot;</span>
</code></pre></div></td></tr></table></div></p>
<p>Verify after deploying this HPA:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@openshift</span><span class="o">-</span><span class="n">jumpserver</span><span class="o">-</span><span class="mi">0</span><span class="w"> </span><span class="n">hpa</span><span class="o">-</span><span class="n">test</span><span class="o">]</span><span class="p">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">hpa</span>
<span class="n">NAME</span><span class="w">         </span><span class="n">REFERENCE</span><span class="w">               </span><span class="n">TARGETS</span><span class="w">         </span><span class="n">MINPODS</span><span class="w">   </span><span class="n">MAXPODS</span><span class="w">   </span><span class="n">REPLICAS</span><span class="w">   </span><span class="n">AGE</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="w">   </span><span class="n">Deployment</span><span class="o">/</span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="w">   </span><span class="o">&lt;</span><span class="n">unknown</span><span class="o">&gt;/</span><span class="mi">2</span><span class="n">Gi</span><span class="w">   </span><span class="mi">1</span><span class="w">         </span><span class="mi">20</span><span class="w">        </span><span class="mi">0</span><span class="w">          </span><span class="mi">3s</span>
<span class="o">[</span><span class="n">root@openshift</span><span class="o">-</span><span class="n">jumpserver</span><span class="o">-</span><span class="mi">0</span><span class="w"> </span><span class="n">hpa</span><span class="o">-</span><span class="n">test</span><span class="o">]</span><span class="p">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="n">describe</span><span class="w"> </span><span class="n">hpa</span><span class="w"> </span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span>
<span class="n">Name</span><span class="p">:</span><span class="w">                       </span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span>
<span class="n">Namespace</span><span class="p">:</span><span class="w">                  </span><span class="n">test</span>
<span class="n">Labels</span><span class="p">:</span><span class="w">                     </span><span class="o">&lt;</span><span class="n">none</span><span class="o">&gt;</span>
<span class="n">Annotations</span><span class="p">:</span><span class="w">                </span><span class="o">&lt;</span><span class="n">none</span><span class="o">&gt;</span>
<span class="n">CreationTimestamp</span><span class="p">:</span><span class="w">          </span><span class="n">Mon</span><span class="p">,</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="n">Mar</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="mi">11</span><span class="p">:</span><span class="mi">01</span><span class="p">:</span><span class="mi">49</span><span class="w"> </span><span class="o">+</span><span class="mi">0000</span>
<span class="n">Reference</span><span class="p">:</span><span class="w">                  </span><span class="n">Deployment</span><span class="o">/</span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span>
<span class="n">Metrics</span><span class="p">:</span><span class="w">                    </span><span class="p">(</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="n">resource</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">pods</span><span class="p">:</span><span class="w">  </span><span class="o">&lt;</span><span class="n">unknown</span><span class="o">&gt;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="n">Gi</span>
<span class="n">Min</span><span class="w"> </span><span class="n">replicas</span><span class="p">:</span><span class="w">               </span><span class="mi">1</span>
<span class="n">Max</span><span class="w"> </span><span class="n">replicas</span><span class="p">:</span><span class="w">               </span><span class="mi">20</span>
<span class="n">Deployment</span><span class="w"> </span><span class="n">pods</span><span class="p">:</span><span class="w">            </span><span class="mi">0</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">0</span><span class="w"> </span><span class="n">desired</span>
<span class="n">Events</span><span class="p">:</span><span class="w">                     </span><span class="o">&lt;</span><span class="n">none</span><span class="o">&gt;</span>
</code></pre></div></td></tr></table></div></p>
<p>And wait for 5 minutes. The result will be 3 pods ceil[(4096+overhead MB / 2048 MB)]:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@openshift-jumpserver-0 hpa-test</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">hpa</span>
<span class="n">NAME</span><span class="w">         </span><span class="n">REFERENCE</span><span class="w">               </span><span class="n">TARGETS</span><span class="w">              </span><span class="n">MINPODS</span><span class="w">   </span><span class="n">MAXPODS</span><span class="w">   </span><span class="n">REPLICAS</span><span class="w">   </span><span class="n">AGE</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="w">   </span><span class="n">Deployment</span><span class="o">/</span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="w">   </span><span class="mi">1476487850666</span><span class="n">m</span><span class="o">/</span><span class="mi">2</span><span class="n">Gi</span><span class="w">   </span><span class="mi">1</span><span class="w">         </span><span class="mi">20</span><span class="w">        </span><span class="mi">3</span><span class="w">          </span><span class="mi">16</span><span class="n">m</span>
<span class="o">[</span><span class="n">root@openshift-jumpserver-0 hpa-test</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">pods</span>
<span class="n">NAME</span><span class="w">                          </span><span class="n">READY</span><span class="w">   </span><span class="n">STATUS</span><span class="w">    </span><span class="n">RESTARTS</span><span class="w">   </span><span class="n">AGE</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="mi">6</span><span class="n">mvbv</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">16</span><span class="n">m</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">mpjvb</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">17</span><span class="n">m</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">t5xc4</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">16</span><span class="n">m</span>
<span class="o">[</span><span class="n">root@openshift-jumpserver-0 hpa-test</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">podmetrics</span>
<span class="n">NAME</span><span class="w">                          </span><span class="n">CPU</span><span class="w">    </span><span class="n">MEMORY</span><span class="w">      </span><span class="k">WINDOW</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="mi">6</span><span class="n">mvbv</span><span class="w">   </span><span class="mi">552</span><span class="n">m</span><span class="w">   </span><span class="mi">1446040</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">mpjvb</span><span class="w">   </span><span class="mi">542</span><span class="n">m</span><span class="w">   </span><span class="mi">1425156</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">t5xc4</span><span class="w">   </span><span class="mi">557</span><span class="n">m</span><span class="w">   </span><span class="mi">1449152</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="combining-cpu-and-memory-metrics">Combining CPU and memory metrics</h3>
<p>It is also possible to combine CPU and memory targets. For example:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="n">apiVersion</span><span class="o">:</span><span class="w"> </span><span class="n">autoscaling</span><span class="o">/</span><span class="n">v2beta2</span>
<span class="n">kind</span><span class="o">:</span><span class="w"> </span><span class="n">HorizontalPodAutoscaler</span>
<span class="n">metadata</span><span class="o">:</span>
<span class="w">  </span><span class="n">annotations</span><span class="o">:</span>
<span class="w">  </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span>
<span class="w">  </span><span class="kd">namespace</span><span class="o">:</span><span class="w"> </span><span class="n">test</span>
<span class="n">spec</span><span class="o">:</span>
<span class="w">  </span><span class="n">maxReplicas</span><span class="o">:</span><span class="w"> </span><span class="mi">20</span>
<span class="w">  </span><span class="n">minReplicas</span><span class="o">:</span><span class="w"> </span><span class="mi">1</span>
<span class="w">  </span><span class="n">scaleTargetRef</span><span class="o">:</span>
<span class="w">    </span><span class="n">apiVersion</span><span class="o">:</span><span class="w"> </span><span class="n">apps</span><span class="o">/</span><span class="n">v1</span>
<span class="w">    </span><span class="n">kind</span><span class="o">:</span><span class="w"> </span><span class="n">Deployment</span>
<span class="w">    </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span>
<span class="w">  </span><span class="n">metrics</span><span class="o">:</span><span class="w"> </span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">type</span><span class="o">:</span><span class="w"> </span><span class="n">Resource</span>
<span class="w">    </span><span class="n">resource</span><span class="o">:</span>
<span class="w">      </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">memory</span>
<span class="w">      </span><span class="n">target</span><span class="o">:</span>
<span class="w">        </span><span class="n">type</span><span class="o">:</span><span class="w"> </span><span class="n">AverageValue</span>
<span class="w">        </span><span class="n">averageValue</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;2048Mi&quot;</span>
<span class="w">  </span><span class="o">-</span><span class="w"> </span><span class="n">type</span><span class="o">:</span><span class="w"> </span><span class="n">Resource</span>
<span class="w">    </span><span class="n">resource</span><span class="o">:</span>
<span class="w">      </span><span class="n">name</span><span class="o">:</span><span class="w"> </span><span class="n">cpu</span>
<span class="w">      </span><span class="n">target</span><span class="o">:</span>
<span class="w">        </span><span class="n">type</span><span class="o">:</span><span class="w"> </span><span class="n">AverageValue</span>
<span class="w">        </span><span class="n">averageValue</span><span class="o">:</span><span class="w"> </span><span class="s2">&quot;200m&quot;</span>
</code></pre></div></td></tr></table></div></p>
<p>Verification:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@openshift-jumpserver-0 hpa-test</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">hpa</span>
<span class="n">NAME</span><span class="w">         </span><span class="n">REFERENCE</span><span class="w">               </span><span class="n">TARGETS</span><span class="w">                         </span><span class="n">MINPODS</span><span class="w">   </span><span class="n">MAXPODS</span><span class="w">   </span><span class="n">REPLICAS</span><span class="w">   </span><span class="n">AGE</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="w">   </span><span class="n">Deployment</span><span class="o">/</span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="w">   </span><span class="o">&lt;</span><span class="k">unknown</span><span class="o">&gt;/</span><span class="mi">2</span><span class="n">Gi</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="k">unknown</span><span class="o">&gt;/</span><span class="mi">200</span><span class="n">m</span><span class="w">   </span><span class="mi">1</span><span class="w">         </span><span class="mi">20</span><span class="w">        </span><span class="mi">0</span><span class="w">          </span><span class="mi">7</span><span class="n">s</span>
</code></pre></div></td></tr></table></div></p>
<p>Wait for a short while and the memory metrics will already lead to a scale-out to 3 pods:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@openshift</span><span class="o">-</span><span class="n">jumpserver</span><span class="o">-</span><span class="mi">0</span><span class="w"> </span><span class="n">hpa</span><span class="o">-</span><span class="n">test</span><span class="o">]</span><span class="p">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">hpa</span>
<span class="n">NAME</span><span class="w">         </span><span class="n">REFERENCE</span><span class="w">               </span><span class="n">TARGETS</span><span class="w">                          </span><span class="n">MINPODS</span><span class="w">   </span><span class="n">MAXPODS</span><span class="w">   </span><span class="n">REPLICAS</span><span class="w">   </span><span class="n">AGE</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="w">   </span><span class="n">Deployment</span><span class="o">/</span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="w">   </span><span class="mi">4344119296</span><span class="o">/</span><span class="mi">2</span><span class="n">Gi</span><span class="p">,</span><span class="w"> </span><span class="o">&lt;</span><span class="n">unknown</span><span class="o">&gt;/</span><span class="mi">200</span><span class="n">m</span><span class="w">   </span><span class="mi">1</span><span class="w">         </span><span class="mi">20</span><span class="w">        </span><span class="mi">3</span><span class="w">          </span><span class="mi">48s</span>
<span class="o">[</span><span class="n">root@openshift</span><span class="o">-</span><span class="n">jumpserver</span><span class="o">-</span><span class="mi">0</span><span class="w"> </span><span class="n">hpa</span><span class="o">-</span><span class="n">test</span><span class="o">]</span><span class="p">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="n">describe</span><span class="w"> </span><span class="n">hpa</span>
<span class="n">Name</span><span class="p">:</span><span class="w">                       </span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span>
<span class="n">Namespace</span><span class="p">:</span><span class="w">                  </span><span class="n">test</span>
<span class="n">Labels</span><span class="p">:</span><span class="w">                     </span><span class="o">&lt;</span><span class="n">none</span><span class="o">&gt;</span>
<span class="n">Annotations</span><span class="p">:</span><span class="w">                </span><span class="o">&lt;</span><span class="n">none</span><span class="o">&gt;</span>
<span class="n">CreationTimestamp</span><span class="p">:</span><span class="w">          </span><span class="n">Mon</span><span class="p">,</span><span class="w"> </span><span class="mi">01</span><span class="w"> </span><span class="n">Mar</span><span class="w"> </span><span class="mi">2021</span><span class="w"> </span><span class="mi">11</span><span class="p">:</span><span class="mi">41</span><span class="p">:</span><span class="mi">03</span><span class="w"> </span><span class="o">+</span><span class="mi">0000</span>
<span class="n">Reference</span><span class="p">:</span><span class="w">                  </span><span class="n">Deployment</span><span class="o">/</span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span>
<span class="n">Metrics</span><span class="p">:</span><span class="w">                    </span><span class="p">(</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="p">)</span>
<span class="w">  </span><span class="n">resource</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">pods</span><span class="p">:</span><span class="w">  </span><span class="mi">4343648256</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">2</span><span class="n">Gi</span>
<span class="w">  </span><span class="n">resource</span><span class="w"> </span><span class="n">cpu</span><span class="w"> </span><span class="k">on</span><span class="w"> </span><span class="n">pods</span><span class="p">:</span><span class="w">     </span><span class="o">&lt;</span><span class="n">unknown</span><span class="o">&gt;</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">200</span><span class="n">m</span>
<span class="n">Min</span><span class="w"> </span><span class="n">replicas</span><span class="p">:</span><span class="w">               </span><span class="mi">1</span>
<span class="n">Max</span><span class="w"> </span><span class="n">replicas</span><span class="p">:</span><span class="w">               </span><span class="mi">20</span>
<span class="n">Deployment</span><span class="w"> </span><span class="n">pods</span><span class="p">:</span><span class="w">            </span><span class="mi">1</span><span class="w"> </span><span class="n">current</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">3</span><span class="w"> </span><span class="n">desired</span>
<span class="n">Conditions</span><span class="p">:</span>
<span class="w">  </span><span class="n">Type</span><span class="w">            </span><span class="n">Status</span><span class="w">  </span><span class="n">Reason</span><span class="w">              </span><span class="n">Message</span>
<span class="w">  </span><span class="o">----</span><span class="w">            </span><span class="o">------</span><span class="w">  </span><span class="o">------</span><span class="w">              </span><span class="o">-------</span>
<span class="w">  </span><span class="n">AbleToScale</span><span class="w">     </span><span class="k">True</span><span class="w">    </span><span class="n">SucceededRescale</span><span class="w">    </span><span class="n">the</span><span class="w"> </span><span class="n">HPA</span><span class="w"> </span><span class="n">controller</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">update</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">target</span><span class="w"> </span><span class="n">scale</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mi">3</span>
<span class="w">  </span><span class="n">ScalingActive</span><span class="w">   </span><span class="k">True</span><span class="w">    </span><span class="n">ValidMetricFound</span><span class="w">    </span><span class="n">the</span><span class="w"> </span><span class="n">HPA</span><span class="w"> </span><span class="n">was</span><span class="w"> </span><span class="n">able</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">successfully</span><span class="w"> </span><span class="n">calculate</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">replica</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="n">from</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">resource</span>
<span class="w">  </span><span class="n">ScalingLimited</span><span class="w">  </span><span class="k">False</span><span class="w">   </span><span class="n">DesiredWithinRange</span><span class="w">  </span><span class="n">the</span><span class="w"> </span><span class="n">desired</span><span class="w"> </span><span class="n">count</span><span class="w"> </span><span class="ow">is</span><span class="w"> </span><span class="n">within</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">acceptable</span><span class="w"> </span><span class="n">range</span>
<span class="n">Events</span><span class="p">:</span>
<span class="w">  </span><span class="n">Type</span><span class="w">     </span><span class="n">Reason</span><span class="w">                   </span><span class="n">Age</span><span class="w">   </span><span class="n">From</span><span class="w">                       </span><span class="n">Message</span>
<span class="w">  </span><span class="o">----</span><span class="w">     </span><span class="o">------</span><span class="w">                   </span><span class="o">----</span><span class="w">  </span><span class="o">----</span><span class="w">                       </span><span class="o">-------</span>
<span class="w">  </span><span class="n">Warning</span><span class="w">  </span><span class="n">FailedGetResourceMetric</span><span class="w">  </span><span class="mi">11s</span><span class="w">   </span><span class="n">horizontal</span><span class="o">-</span><span class="n">pod</span><span class="o">-</span><span class="n">autoscaler</span><span class="w">  </span><span class="n">did</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">receive</span><span class="w"> </span><span class="n">metrics</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">any</span><span class="w"> </span><span class="n">ready</span><span class="w"> </span><span class="n">pods</span>
<span class="w">  </span><span class="n">Normal</span><span class="w">   </span><span class="n">SuccessfulRescale</span><span class="w">        </span><span class="mi">10s</span><span class="w">   </span><span class="n">horizontal</span><span class="o">-</span><span class="n">pod</span><span class="o">-</span><span class="n">autoscaler</span><span class="w">  </span><span class="k">New</span><span class="w"> </span><span class="n">size</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="err">;</span><span class="w"> </span><span class="n">reason</span><span class="p">:</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="n">above</span><span class="w"> </span><span class="n">target</span>
<span class="o">[</span><span class="n">root@openshift</span><span class="o">-</span><span class="n">jumpserver</span><span class="o">-</span><span class="mi">0</span><span class="w"> </span><span class="n">hpa</span><span class="o">-</span><span class="n">test</span><span class="o">]</span><span class="p">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">pods</span>
<span class="n">NAME</span><span class="w">                          </span><span class="n">READY</span><span class="w">   </span><span class="n">STATUS</span><span class="w">    </span><span class="n">RESTARTS</span><span class="w">   </span><span class="n">AGE</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="mi">4</span><span class="n">mlh6</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">57s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">c7862</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">2</span><span class="n">m8s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">vm27z</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">57s</span>
</code></pre></div></td></tr></table></div></p>
<p>It will take a bit longer for the environment to calculate the CPU averages but eventually a second scale-out step will follow to 9 pods:
<div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="o">[</span><span class="n">root@openshift-jumpserver-0 hpa-test</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">hpa</span>
<span class="n">NAME</span><span class="w">         </span><span class="n">REFERENCE</span><span class="w">               </span><span class="n">TARGETS</span><span class="w">                        </span><span class="n">MINPODS</span><span class="w">   </span><span class="n">MAXPODS</span><span class="w">   </span><span class="n">REPLICAS</span><span class="w">   </span><span class="n">AGE</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="w">   </span><span class="n">Deployment</span><span class="o">/</span><span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="w">   </span><span class="mi">500336867555</span><span class="n">m</span><span class="o">/</span><span class="mi">2</span><span class="n">Gi</span><span class="p">,</span><span class="w"> </span><span class="mi">190</span><span class="n">m</span><span class="o">/</span><span class="mi">200</span><span class="n">m</span><span class="w">   </span><span class="mi">1</span><span class="w">         </span><span class="mi">20</span><span class="w">        </span><span class="mi">9</span><span class="w">          </span><span class="mi">6</span><span class="n">m37s</span>
<span class="o">[</span><span class="n">root@openshift-jumpserver-0 hpa-test</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">pods</span>
<span class="n">NAME</span><span class="w">                          </span><span class="n">READY</span><span class="w">   </span><span class="n">STATUS</span><span class="w">    </span><span class="n">RESTARTS</span><span class="w">   </span><span class="n">AGE</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="mi">4</span><span class="n">mlh6</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">6</span><span class="n">m28s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="mi">6</span><span class="n">c968</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">86</span><span class="n">s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">c7862</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">7</span><span class="n">m39s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">cj8dz</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">86</span><span class="n">s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">ngp4l</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">102</span><span class="n">s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">nwx7r</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">101</span><span class="n">s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">tg6vb</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">86</span><span class="n">s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">vm27z</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">6</span><span class="n">m28s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">xfptr</span><span class="w">   </span><span class="mi">1</span><span class="o">/</span><span class="mi">1</span><span class="w">     </span><span class="n">Running</span><span class="w">   </span><span class="mi">0</span><span class="w">          </span><span class="mi">101</span><span class="n">s</span>
<span class="o">[</span><span class="n">root@openshift-jumpserver-0 hpa-test</span><span class="o">]</span><span class="err">#</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">podmetrics</span>
<span class="n">NAME</span><span class="w">                          </span><span class="n">CPU</span><span class="w">    </span><span class="n">MEMORY</span><span class="w">     </span><span class="k">WINDOW</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="mi">4</span><span class="n">mlh6</span><span class="w">   </span><span class="mi">199</span><span class="n">m</span><span class="w">   </span><span class="mi">508864</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="mi">6</span><span class="n">c968</span><span class="w">   </span><span class="mi">185</span><span class="n">m</span><span class="w">   </span><span class="mi">478548</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">c7862</span><span class="w">   </span><span class="mi">181</span><span class="n">m</span><span class="w">   </span><span class="mi">484504</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">cj8dz</span><span class="w">   </span><span class="mi">193</span><span class="n">m</span><span class="w">   </span><span class="mi">476976</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">ngp4l</span><span class="w">   </span><span class="mi">194</span><span class="n">m</span><span class="w">   </span><span class="mi">477744</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">nwx7r</span><span class="w">   </span><span class="mi">195</span><span class="n">m</span><span class="w">   </span><span class="mi">507352</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">tg6vb</span><span class="w">   </span><span class="mi">191</span><span class="n">m</span><span class="w">   </span><span class="mi">478620</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">vm27z</span><span class="w">   </span><span class="mi">181</span><span class="n">m</span><span class="w">   </span><span class="mi">484528</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
<span class="n">hpa</span><span class="o">-</span><span class="n">tester</span><span class="o">-</span><span class="mi">7</span><span class="n">bff6856bd</span><span class="o">-</span><span class="n">xfptr</span><span class="w">   </span><span class="mi">209</span><span class="n">m</span><span class="w">   </span><span class="mi">505692</span><span class="n">Ki</span><span class="w">   </span><span class="mi">5</span><span class="n">m0s</span>
</code></pre></div></td></tr></table></div></p>
<h3 id="custom-application-metrics-for-auto-scaling-in-openshift">Custom application metrics for auto-scaling in OpenShift</h3>
<ul>
<li><a href="https://docs.openshift.com/container-platform/4.6/monitoring/exposing-custom-application-metrics-for-autoscaling.html">https://docs.openshift.com/container-platform/4.6/monitoring/exposing-custom-application-metrics-for-autoscaling.html</a></li>
</ul>

  <hr>
<div class="md-source-file">
  <small>
    
      Last update:
      <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">April 16, 2021</span>
      
    
  </small>
</div>





                
              </article>
            </div>
          
          
        </div>
        
          <a href="#" class="md-top md-icon" data-md-component="top" hidden>
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
            Back to top
          </a>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tabs", "navigation.sections", "navigation.prune", "navigation.top", "navigation.path", "navigation.indexes"], "search": "../../assets/javascripts/workers/search.208ed371.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.2a6f1dda.min.js"></script>
      
    
  </body>
</html>