
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>Infra nodes with MachineSets without worker label - Andreas Karis Blog</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#000000">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="black" data-md-color-accent="pink">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#ocp-45-infra-nodes-with-machinesets-without-worker-label" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Andreas Karis Blog" class="md-header__button md-logo" aria-label="Andreas Karis Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Andreas Karis Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Infra nodes with MachineSets without worker label
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Andreas Karis Blog" class="md-nav__button md-logo" aria-label="Andreas Karis Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Andreas Karis Blog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Ceph
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Ceph" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Ceph
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ceph/ceph-manual-test/" class="md-nav__link">
        Ceph manual test with qemu
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Containers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Containers" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Containers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../analyzing-cni/" class="md-nav__link">
        Analyzing CNI calls
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/cgroups/" class="md-nav__link">
        cgroups
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/containers/" class="md-nav__link">
        Containers in Linux
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../list_docker_registry_containers/" class="md-nav__link">
        List container images in registry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/namespaces/" class="md-nav__link">
        namespaces
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Linux
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Linux" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/cgroups/" class="md-nav__link">
        cgroups
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/containers/" class="md-nav__link">
        Containers in Linux
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/hugepages/" class="md-nav__link">
        Hugepages
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/ipxe-boot-environment/" class="md-nav__link">
        iPXE boot environment on Fedora
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/java-idrac-issues/" class="md-nav__link">
        Java Idrac Issues
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/meson/" class="md-nav__link">
        meson
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/namespaces/" class="md-nav__link">
        namespaces
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/old_java_version_with_xorgs_in_container/" class="md-nav__link">
        Old Java inside a container with xorgs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/get-process-cgroup-info-and-limits/" class="md-nav__link">
        Retrieving process cgroup resource usage and limit info
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/libvirt-uefi-without-secureboot/" class="md-nav__link">
        RHEL Booting a virtual machine with UEFI but without secure boot
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/setting-journalctl-limits/" class="md-nav__link">
        Setting journalctl limits
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        Networking
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Networking" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Networking
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/accept-source-routing/" class="md-nav__link">
        Accept Source Routing
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/arp_and_the_neighbor_table/" class="md-nav__link">
        ARP and the Neighbor table
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/bpf-and-tcpdump/" class="md-nav__link">
        BPF and tcpdump
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/bonding_in_linux/" class="md-nav__link">
        Bonding in Linux
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/juniper_x520/" class="md-nav__link">
        Configure Juniper switch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/haproxy-and-h2c/" class="md-nav__link">
        haproxy and HTTP/2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/install-openvswitch-on-rocky/" class="md-nav__link">
        Install Open vSwitch on Rocky Linux 8
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/geneve_tunneling/" class="md-nav__link">
        Geneve tunneling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/netlink/" class="md-nav__link">
        Netlink
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/ovn_standalone_on_fedora31/" class="md-nav__link">
        OVN standalone on Fedora 31
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/ovs_recirculation/" class="md-nav__link">
        OVS packet recirculation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/ovs-vxlan-tunnels-and-dscp/" class="md-nav__link">
        OVS VXLAN tunnels and DSCP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/ovs_with_gdb/" class="md-nav__link">
        OVS with GDB
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/packet-tracing-with-ovn/" class="md-nav__link">
        Packet tracing with OVN
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/sctp/" class="md-nav__link">
        SCTP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/useful-commands/" class="md-nav__link">
        Useful commands
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/wireguard/" class="md-nav__link">
        Wireguard
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      <label class="md-nav__link" for="__nav_6">
        OpenShift
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="OpenShift" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          OpenShift
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../alertmanager/" class="md-nav__link">
        AlertManager
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cpu-manager-with-custom-machine-config-pool/" class="md-nav__link">
        CPU manager with custom MachineConfigPool
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../crio-conmon-runc/" class="md-nav__link">
        Crio vs conmon vs runc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../etcd_perf/" class="md-nav__link">
        Etcd Performance tests
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../get-vs-list-api-calls/" class="md-nav__link">
        Get vs List API Calls
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../openshift_httpbin_tshark_sidecar/" class="md-nav__link">
        Httpbin tshark sidecar container
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_cluster/" class="md-nav__link">
        Hints for installing kubernetes on Fedora
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../HPA/" class="md-nav__link">
        Horizontal Pod Autoscaler
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../how_rhcos_updates_work/" class="md-nav__link">
        How RHCOS updates work
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Infra nodes with MachineSets without worker label
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Infra nodes with MachineSets without worker label
      </a>
      
        
<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#how-to-create-infra-nodes-with-machinesets-but-without-using-the-worker-label" class="md-nav__link">
    How to create Infra nodes with Machinesets but without using the worker label
  </a>
  
    <nav class="md-nav" aria-label="How to create Infra nodes with Machinesets but without using the worker label">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#step-0-switch-to-project-openshift-machine-api" class="md-nav__link">
    Step 0: Switch to project openshift-machine-api
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-1-create-kubelet-configuration-drop-in-for-infra-node" class="md-nav__link">
    Step 1: Create kubelet configuration drop-in for infra-node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-create-infra-secret" class="md-nav__link">
    Step 2: Create infra secret
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-create-machine-configuration-for-infra" class="md-nav__link">
    Step 3: Create machine configuration for infra
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-create-a-machineset-for-the-new-infra-node" class="md-nav__link">
    Step 4: Create a machineset for the new infra node
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-verify-machine-creation" class="md-nav__link">
    Step 5: Verify Machine creation
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-7-moving-resources-to-the-infra-nodes" class="md-nav__link">
    Step 7: Moving resources to the infra nodes
  </a>
  
    <nav class="md-nav" aria-label="Step 7: Moving resources to the infra nodes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#move-the-router-bits" class="md-nav__link">
    Move the router bits
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#move-the-registry-bits" class="md-nav__link">
    Move the registry bits
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#move-the-logging-bits" class="md-nav__link">
    Move the logging bits
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#issues" class="md-nav__link">
    Issues
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-6-testing-upgrades" class="md-nav__link">
    Step 6: Testing upgrades
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ingresscontroller_router_sharding_ocp_on_osp/" class="md-nav__link">
        Ingress Controller Sharding OCP on OSP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ingress-controller-sharding-on-separate-vip/" class="md-nav__link">
        Ingress Controller Sharding on separate VIP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../openshift_mirror_registry/" class="md-nav__link">
        Installing a cluster with a mirror registry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../istio-1.6-on-ocp.4.x/" class="md-nav__link">
        Istio 1.6 on OpenShift 4.x
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../kata/" class="md-nav__link">
        kata containers and the kata operatora
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ovn-kind-hybrid-overlay/" class="md-nav__link">
        Kind with OVN Kubernetes Hybrid Overlay
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../kind-with-private-registry/" class="md-nav__link">
        Kind with private registry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../mounting-container-image/" class="md-nav__link">
        Mount a container image
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openstack/install_openshift_on_openstack/" class="md-nav__link">
        OpenShift on OpenStack
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../patch-service-loadbalancer-ingress-ip/" class="md-nav__link">
        Patch status.loadBalancer.ingress IP manually
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../private-registry/" class="md-nav__link">
        Private container registry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../proxy-ocp-4.5/" class="md-nav__link">
        Proxy OCP 4.5
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../scc/" class="md-nav__link">
        Security Context Constraints (SCC)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../fix-selinux-labels-coreos/" class="md-nav__link">
        SElinux labels fix
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/sctp/" class="md-nav__link">
        SCTP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../openshift_troubleshooting_etcd_state/" class="md-nav__link">
        Troubleshooting etcd state
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../useful-ocp-commands/" class="md-nav__link">
        Useful commands for OpenShift
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../useful-ocp-sdn-commands/" class="md-nav__link">
        Useful commands for OpenShift SDN
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting_openshift_on_openstack_worker_creation/" class="md-nav__link">
        Troubleshooting OpenShift on OpenStack worker creation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        OpenStack
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="OpenStack" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          OpenStack
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openstack/reattach_to_running_deployment/" class="md-nav__link">
        Reattach to running deployment
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openstack/using_clouds_yaml/" class="md-nav__link">
        Using clouds.yaml
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        OperatorSDK
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="OperatorSDK" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          OperatorSDK
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operator-sdk/operator-sdk-reconciliation/" class="md-nav__link">
        Controller Reconciliation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="ocp-45-infra-nodes-with-machinesets-without-worker-label">OCP 4.5 Infra nodes with MachineSets without worker label</h1>
<h2 id="how-to-create-infra-nodes-with-machinesets-but-without-using-the-worker-label">How to create Infra nodes with Machinesets but without using the worker label</h2>
<p><a href="https://docs.openshift.com/container-platform/4.5/machine_management/creating-infrastructure-machinesets.html">https://docs.openshift.com/container-platform/4.5/machine_management/creating-infrastructure-machinesets.html</a> states how to create infra nodes with MachineSets. However, the "inconvenience" is that these infra nodes will show up as "infra,worker". How can one not have the "worker" label?</p>
<p>The worker label is added by kubelet configuration as part of <code class="highlight">--node-labels=node-role.kubernetes.io/worker,node.openshift.io/os_id=<span class="cp">${</span><span class="n">ID</span><span class="cp">}</span></code>. So this will require a custom systemd drop-in for the kubelet.service.</p>
<h3 id="step-0-switch-to-project-openshift-machine-api">Step 0: Switch to project openshift-machine-api</h3>
<p>Switch to the <code class="highlight">openshift-machine-api</code> project:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>oc project openshift-machine-api
</code></pre></div>
</td></tr></table></p>
<h3 id="step-1-create-kubelet-configuration-drop-in-for-infra-node">Step 1: Create kubelet configuration drop-in for infra-node</h3>
<p>To change booting node-labels a MachineConfig needs to be created as the labels are defined when the Kubelet is started with:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>                --node-labels=node-role.kubernetes.io/worker,node.openshift.io/os_id=<span class="cp">${</span><span class="n">ID</span><span class="cp">}</span> \
</code></pre></div>
</td></tr></table></p>
<p>In order to create a new kubelet, create 03-infar-kubelet.yaml:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">cat</span><span class="w"> </span><span class="o">&lt;&lt;</span><span class="s1">&#39;EOF&#39;</span><span class="w"> </span><span class="o">&gt;</span><span class="w"> </span><span class="mi">03</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">kubelet</span><span class="p">.</span><span class="n">yaml</span><span class="w"></span>
<span class="nl">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="n">machineconfiguration</span><span class="p">.</span><span class="n">openshift</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">v1</span><span class="w"></span>
<span class="nl">kind</span><span class="p">:</span><span class="w"> </span><span class="n">MachineConfig</span><span class="w"></span>
<span class="nl">metadata</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nl">labels</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="n">machineconfiguration</span><span class="p">.</span><span class="n">openshift</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="k">role</span><span class="err">:</span><span class="w"> </span><span class="n">infra</span><span class="w"></span>
<span class="w">  </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="mi">03</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">kubelet</span><span class="w"></span>
<span class="nl">spec</span><span class="p">:</span><span class="w"></span>
<span class="w">  </span><span class="nl">config</span><span class="p">:</span><span class="w"></span>
<span class="w">    </span><span class="nl">ignition</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nl">config</span><span class="p">:</span><span class="w"> </span><span class="err">{}</span><span class="w"></span>
<span class="w">      </span><span class="nl">security</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="nl">tls</span><span class="p">:</span><span class="w"> </span><span class="err">{}</span><span class="w"></span>
<span class="w">      </span><span class="nl">timeouts</span><span class="p">:</span><span class="w"> </span><span class="err">{}</span><span class="w"></span>
<span class="w">      </span><span class="nl">version</span><span class="p">:</span><span class="w"> </span><span class="mf">2.2.0</span><span class="w"></span>
<span class="w">    </span><span class="nl">systemd</span><span class="p">:</span><span class="w"></span>
<span class="w">      </span><span class="nl">units</span><span class="p">:</span><span class="w"></span>
<span class="w">        </span><span class="o">-</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="n">kubelet</span><span class="p">.</span><span class="n">service</span><span class="w"></span>
<span class="w">          </span><span class="nl">dropins</span><span class="p">:</span><span class="w"></span>
<span class="w">            </span><span class="o">-</span><span class="w"> </span><span class="nl">name</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="o">-</span><span class="n">change</span><span class="o">-</span><span class="n">label</span><span class="p">.</span><span class="n">conf</span><span class="w"></span>
<span class="w">              </span><span class="nl">contents</span><span class="p">:</span><span class="w"> </span><span class="o">|</span><span class="w"></span>
<span class="w">                </span><span class="o">[</span><span class="n">Service</span><span class="o">]</span><span class="w"></span>
<span class="w">                </span><span class="n">ExecStart</span><span class="o">=</span><span class="w"></span>
<span class="w">                </span><span class="n">ExecStart</span><span class="o">=/</span><span class="n">usr</span><span class="o">/</span><span class="n">bin</span><span class="o">/</span><span class="n">hyperkube</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="w">                    </span><span class="n">kubelet</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="w">                      </span><span class="o">--</span><span class="n">config</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">/</span><span class="n">kubelet</span><span class="p">.</span><span class="n">conf</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="w">                      </span><span class="o">--</span><span class="n">bootstrap</span><span class="o">-</span><span class="n">kubeconfig</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">/</span><span class="n">kubeconfig</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="w">                      </span><span class="o">--</span><span class="n">kubeconfig</span><span class="o">=/</span><span class="nf">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">kubelet</span><span class="o">/</span><span class="n">kubeconfig</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="w">                      </span><span class="o">--</span><span class="n">container</span><span class="o">-</span><span class="n">runtime</span><span class="o">=</span><span class="n">remote</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="w">                      </span><span class="o">--</span><span class="n">container</span><span class="o">-</span><span class="n">runtime</span><span class="o">-</span><span class="n">endpoint</span><span class="o">=/</span><span class="nf">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">crio</span><span class="o">/</span><span class="n">crio</span><span class="p">.</span><span class="n">sock</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="w">                      </span><span class="o">--</span><span class="n">runtime</span><span class="o">-</span><span class="n">cgroups</span><span class="o">=/</span><span class="k">system</span><span class="p">.</span><span class="n">slice</span><span class="o">/</span><span class="n">crio</span><span class="p">.</span><span class="n">service</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="w">                      </span><span class="o">--</span><span class="n">node</span><span class="o">-</span><span class="n">labels</span><span class="o">=</span><span class="n">node</span><span class="o">-</span><span class="k">role</span><span class="p">.</span><span class="n">kubernetes</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">infra</span><span class="p">,</span><span class="n">node</span><span class="p">.</span><span class="n">openshift</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">os_id</span><span class="o">=</span><span class="err">${</span><span class="n">ID</span><span class="err">}</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="w">                      </span><span class="o">--</span><span class="n">minimum</span><span class="o">-</span><span class="n">container</span><span class="o">-</span><span class="n">ttl</span><span class="o">-</span><span class="n">duration</span><span class="o">=</span><span class="mi">6</span><span class="n">m0s</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="w">                      </span><span class="o">--</span><span class="n">volume</span><span class="o">-</span><span class="n">plugin</span><span class="o">-</span><span class="n">dir</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">/</span><span class="n">kubelet</span><span class="o">-</span><span class="n">plugins</span><span class="o">/</span><span class="n">volume</span><span class="o">/</span><span class="k">exec</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="w">                      </span><span class="o">--</span><span class="n">cloud</span><span class="o">-</span><span class="n">provider</span><span class="o">=</span><span class="n">aws</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="w">                       </span><span class="err">\</span><span class="w"></span>
<span class="w">                      </span><span class="o">--</span><span class="n">pod</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">container</span><span class="o">-</span><span class="nc">image</span><span class="o">=</span><span class="n">quay</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">openshift</span><span class="o">-</span><span class="k">release</span><span class="o">-</span><span class="n">dev</span><span class="o">/</span><span class="n">ocp</span><span class="o">-</span><span class="n">v4</span><span class="mf">.0</span><span class="o">-</span><span class="n">art</span><span class="o">-</span><span class="n">dev</span><span class="nv">@sha256</span><span class="err">:</span><span class="n">dc0fe885d41cc4029caa3feacf71343806c81c8123abc91db90dc0e555fa5636</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="w">                      </span><span class="o">--</span><span class="n">v</span><span class="o">=</span><span class="err">${</span><span class="n">KUBELET_LOG_LEVEL</span><span class="err">}</span><span class="w"></span>
<span class="n">EOF</span><span class="w"></span>
</code></pre></div>
</td></tr></table></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>$ oc apply -f <span class="m">03</span>-infra-kubelet.yaml
</code></pre></div>
</td></tr></table>
<h3 id="step-2-create-infra-secret">Step 2: Create infra secret</h3>
<p>Create new user data for infra worker. The following takes the userdata from worker nodes (from the worker-user-data secret) and replaces any occurrence of 'worker' with 'infra':
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>oc get secret -n openshift-machine-api worker-user-data -o yaml | awk &#39;/userData:/ {print $2}&#39; | base64 -d | sed &#39;s/worker/infra/g&#39; | base64 -w0 &gt; userdata.base64 
</code></pre></div>
</td></tr></table></p>
<p>Then, create a new secret:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>cat &lt;&lt; EOF &gt; infra-user-data.yaml
apiVersion: v1
data:
  disableTemplating: dHJ1ZQo=
  userData: $(cat userdata.base64)  
kind: Secret
metadata:
  name: infra-user-data
  namespace: openshift-machine-api
type: Opaque
EOF
oc apply -f infra-user-data.yaml
</code></pre></div>
</td></tr></table></p>
<p>Verify:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>$ oc get secret -n openshift-machine-api infra-user-data -o yaml <span class="p">|</span> awk <span class="s1">&#39;/userData:/ {print $2}&#39;</span> <span class="p">|</span> base64 -d <span class="p">|</span> jq <span class="s1">&#39;.ignition.config.append[0].source&#39;</span>
<span class="s2">&quot;https://&lt;cluster URL&gt;:22623/config/infra&quot;</span>
</code></pre></div>
</td></tr></table></p>
<h3 id="step-3-create-machine-configuration-for-infra">Step 3: Create machine configuration for infra</h3>
<p>Create a machine configuration pool. This machine configuration, for simplicity, will include all machine configurations for worker nodes, as well as for infra nodes. This is why it is important to name the machine configuration for the kubelet <code class="highlight"><span class="mf">03</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">kubelet</span></code> (see above):
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>cat &lt;&lt;&#39;EOF&#39; &gt; infra-mcp.yaml
apiVersion: machineconfiguration.openshift.io/v1
kind: MachineConfigPool
metadata:
  name: infra
spec:
  machineConfigSelector:
    matchExpressions:
    - key: machineconfiguration.openshift.io/role
      operator: In
      values:
      - worker
      - infra
  maxUnavailable: 1
  nodeSelector:
    matchLabels:
      node-role.kubernetes.io/infra: &quot;&quot;
  paused: false
EOF
</code></pre></div>
</td></tr></table></p>
<p>Apply:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>oc apply -f infra-mcp.yaml
</code></pre></div>
</td></tr></table></p>
<h3 id="step-4-create-a-machineset-for-the-new-infra-node">Step 4: Create a machineset for the new infra node</h3>
<p>First, create a new machineset:
https://docs.openshift.com/container-platform/4.5/machine_management/creating-infrastructure-machinesets.html#machineset-yaml-aws_creating-infrastructure-machinesets</p>
<p>Look at an existing machineset for how to fill in some of the blank values:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">akaris@linux infra-nodes</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">machinesets</span><span class="w"> </span><span class="o">-</span><span class="n">A</span><span class="w"></span>
<span class="n">NAMESPACE</span><span class="w">               </span><span class="n">NAME</span><span class="w">                              </span><span class="n">DESIRED</span><span class="w">   </span><span class="k">CURRENT</span><span class="w">   </span><span class="n">READY</span><span class="w">   </span><span class="n">AVAILABLE</span><span class="w">   </span><span class="n">AGE</span><span class="w"></span>
<span class="n">openshift</span><span class="o">-</span><span class="n">machine</span><span class="o">-</span><span class="n">api</span><span class="w">   </span><span class="n">akaris2</span><span class="o">-</span><span class="mi">4</span><span class="n">kpk4</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="w">   </span><span class="mi">1</span><span class="w">         </span><span class="mi">1</span><span class="w">         </span><span class="mi">1</span><span class="w">       </span><span class="mi">1</span><span class="w">           </span><span class="mi">112</span><span class="n">m</span><span class="w"></span>
<span class="n">openshift</span><span class="o">-</span><span class="n">machine</span><span class="o">-</span><span class="n">api</span><span class="w">   </span><span class="n">akaris2</span><span class="o">-</span><span class="mi">4</span><span class="n">kpk4</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">b</span><span class="w">   </span><span class="mi">1</span><span class="w">         </span><span class="mi">1</span><span class="w">         </span><span class="mi">1</span><span class="w">       </span><span class="mi">1</span><span class="w">           </span><span class="mi">112</span><span class="n">m</span><span class="w"></span>
<span class="n">openshift</span><span class="o">-</span><span class="n">machine</span><span class="o">-</span><span class="n">api</span><span class="w">   </span><span class="n">akaris2</span><span class="o">-</span><span class="mi">4</span><span class="n">kpk4</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">c</span><span class="w">   </span><span class="mi">1</span><span class="w">         </span><span class="mi">1</span><span class="w">         </span><span class="mi">1</span><span class="w">       </span><span class="mi">1</span><span class="w">           </span><span class="mi">112</span><span class="n">m</span><span class="w"></span>
</code></pre></div>
</td></tr></table></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>$ oc get machineset -n openshift-machine-api akaris2-4kpk4-worker-eu-west-3a -o yaml &gt; akaris2-4kpk4-infra-eu-west-3a.yaml
</code></pre></div>
</td></tr></table>
<p>Clean up the file and modify as instructed in https://docs.openshift.com/container-platform/4.5/machine_management/creating-infrastructure-machinesets.html#machineset-yaml-aws_creating-infrastructure-machinesets</p>
<p>The example from the documentation will contain 'worker' in:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>          iamInstanceProfile:
            id: &lt;infrastructureID&gt;-worker-profile 
</code></pre></div>
</td></tr></table></p>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>          securityGroups:
            - filters:
                - name: tag:Name
                  values:
                    - &lt;infrastructureID&gt;-worker-sg 
</code></pre></div>
</td></tr></table>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>          userDataSecret:
            name: worker-user-data
</code></pre></div>
</td></tr></table>
<p>Make sure to change the userDataSecret to <code class="highlight">infra-user-data</code>, contrary to what the documentation says:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>          userDataSecret:
            name: infra-user-data
</code></pre></div>
</td></tr></table></p>
<p>The MachineSet, after modification - in this case, 3 replicas are requested, right away:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>$ cat akaris2-4kpk4-infra-eu-west-3a.yaml
apiVersion: machine.openshift.io/v1beta1
kind: MachineSet
metadata:
  labels:
    machine.openshift.io/cluster-api-cluster: akaris2-4kpk4
  name: akaris2-4kpk4-infra-eu-west-3a
  namespace: openshift-machine-api
spec:
  replicas: <span class="m">3</span>
  selector:
    matchLabels:
      machine.openshift.io/cluster-api-cluster: akaris2-4kpk4
      machine.openshift.io/cluster-api-machineset: akaris2-4kpk4-infra-eu-west-3a
  template:
    metadata:
      labels:
        machine.openshift.io/cluster-api-cluster: akaris2-4kpk4
        machine.openshift.io/cluster-api-machine-role: infra
        machine.openshift.io/cluster-api-machine-type: infra
        machine.openshift.io/cluster-api-machineset: akaris2-4kpk4-infra-eu-west-3a
    spec:
      metadata:
        labels:
          node-role.kubernetes.io/infra: <span class="s2">&quot;&quot;</span>
      providerSpec:
        value:
          ami:
            id: ami-<span class="o">(</span>...<span class="o">)</span>
          apiVersion: awsproviderconfig.openshift.io/v1beta1
          blockDevices:
          - ebs:
              iops: <span class="m">0</span>
              volumeSize: <span class="m">120</span>
              volumeType: gp2
          credentialsSecret:
            name: aws-cloud-credentials
          deviceIndex: <span class="m">0</span>
          iamInstanceProfile:
            id: akaris2-4kpk4-worker-profile
          instanceType: m5.large
          kind: AWSMachineProviderConfig
          metadata:
            creationTimestamp: null
          placement:
            availabilityZone: eu-west-3a
            region: eu-west-3
          publicIp: null
          securityGroups:
          - filters:
            - name: tag:Name
              values:
              - akaris2-4kpk4-worker-sg
          subnet:
            filters:
            - name: tag:Name
              values:
              - akaris2-4kpk4-private-eu-west-3a
          tags:
          - name: kubernetes.io/cluster/akaris2-4kpk4
            value: owned
          userDataSecret:
            name: infra-user-data
</code></pre></div>
</td></tr></table></p>
<p>Apply the MachineSet:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>$ oc apply -f akaris2-4kpk4-infra-eu-west-3a.yaml
</code></pre></div>
</td></tr></table></p>
<h3 id="step-5-verify-machine-creation">Step 5: Verify Machine creation</h3>
<p>Monitor machine configuration - right after creation of the MachineSet:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">akaris@linux infra-nodes</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">machineconfigpool</span><span class="w"></span>
<span class="n">NAME</span><span class="w">     </span><span class="n">CONFIG</span><span class="w">                                             </span><span class="n">UPDATED</span><span class="w">   </span><span class="n">UPDATING</span><span class="w">   </span><span class="n">DEGRADED</span><span class="w">   </span><span class="n">MACHINECOUNT</span><span class="w">   </span><span class="n">READYMACHINECOUNT</span><span class="w">   </span><span class="n">UPDATEDMACHINECOUNT</span><span class="w">   </span><span class="n">DEGRADEDMACHINECOUNT</span><span class="w">   </span><span class="n">AGE</span><span class="w"></span>
<span class="n">infra</span><span class="w">    </span><span class="n">rendered</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">d63625ee2cdc4637cc156a1ebf25e926</span><span class="w">    </span><span class="k">True</span><span class="w">      </span><span class="k">False</span><span class="w">      </span><span class="k">False</span><span class="w">      </span><span class="mi">0</span><span class="w">              </span><span class="mi">0</span><span class="w">                   </span><span class="mi">0</span><span class="w">                     </span><span class="mi">0</span><span class="w">                      </span><span class="mi">4</span><span class="n">m9s</span><span class="w"></span>
<span class="n">master</span><span class="w">   </span><span class="n">rendered</span><span class="o">-</span><span class="n">master</span><span class="o">-</span><span class="mi">8</span><span class="n">d007e81b9ebb00b4042722f2713f1ae</span><span class="w">   </span><span class="k">True</span><span class="w">      </span><span class="k">False</span><span class="w">      </span><span class="k">False</span><span class="w">      </span><span class="mi">3</span><span class="w">              </span><span class="mi">3</span><span class="w">                   </span><span class="mi">3</span><span class="w">                     </span><span class="mi">0</span><span class="w">                      </span><span class="mi">116</span><span class="n">m</span><span class="w"></span>
<span class="n">worker</span><span class="w">   </span><span class="n">rendered</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="mi">9</span><span class="n">d6647aa43752e0eb71a221dd8b7e32e</span><span class="w">   </span><span class="k">True</span><span class="w">      </span><span class="k">False</span><span class="w">      </span><span class="k">False</span><span class="w">      </span><span class="mi">3</span><span class="w">              </span><span class="mi">3</span><span class="w">                   </span><span class="mi">3</span><span class="w">                     </span><span class="mi">0</span><span class="w">                      </span><span class="mi">116</span><span class="n">m</span><span class="w"></span>
<span class="o">[</span><span class="n">akaris@linux infra-nodes</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">machines</span><span class="w"></span>
<span class="n">NAME</span><span class="w">                                    </span><span class="n">PHASE</span><span class="w">         </span><span class="n">TYPE</span><span class="w">        </span><span class="n">REGION</span><span class="w">      </span><span class="k">ZONE</span><span class="w">         </span><span class="n">AGE</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="o">-</span><span class="n">fctd5</span><span class="w">    </span><span class="n">Provisioned</span><span class="w">   </span><span class="n">m5</span><span class="p">.</span><span class="k">large</span><span class="w">    </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="w">   </span><span class="mi">49</span><span class="n">s</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="o">-</span><span class="n">xtpcv</span><span class="w">    </span><span class="n">Provisioned</span><span class="w">   </span><span class="n">m5</span><span class="p">.</span><span class="k">large</span><span class="w">    </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="w">   </span><span class="mi">49</span><span class="n">s</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="o">-</span><span class="n">zmvzh</span><span class="w">    </span><span class="n">Provisioned</span><span class="w">   </span><span class="n">m5</span><span class="p">.</span><span class="k">large</span><span class="w">    </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="w">   </span><span class="mi">49</span><span class="n">s</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">master</span><span class="o">-</span><span class="mi">0</span><span class="w">                  </span><span class="n">Running</span><span class="w">       </span><span class="n">m5</span><span class="p">.</span><span class="n">xlarge</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="w">   </span><span class="mi">119</span><span class="n">m</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">master</span><span class="o">-</span><span class="mi">1</span><span class="w">                  </span><span class="n">Running</span><span class="w">       </span><span class="n">m5</span><span class="p">.</span><span class="n">xlarge</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">b</span><span class="w">   </span><span class="mi">119</span><span class="n">m</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">master</span><span class="o">-</span><span class="mi">2</span><span class="w">                  </span><span class="n">Running</span><span class="w">       </span><span class="n">m5</span><span class="p">.</span><span class="n">xlarge</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">c</span><span class="w">   </span><span class="mi">119</span><span class="n">m</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="o">-</span><span class="mi">4</span><span class="n">krrd</span><span class="w">   </span><span class="n">Running</span><span class="w">       </span><span class="n">m5</span><span class="p">.</span><span class="k">large</span><span class="w">    </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="w">   </span><span class="mi">111</span><span class="n">m</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">b</span><span class="o">-</span><span class="mi">59</span><span class="n">z6n</span><span class="w">   </span><span class="n">Running</span><span class="w">       </span><span class="n">m5</span><span class="p">.</span><span class="k">large</span><span class="w">    </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">b</span><span class="w">   </span><span class="mi">111</span><span class="n">m</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">c</span><span class="o">-</span><span class="n">chst9</span><span class="w">   </span><span class="n">Running</span><span class="w">       </span><span class="n">m5</span><span class="p">.</span><span class="k">large</span><span class="w">    </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">c</span><span class="w">   </span><span class="mi">111</span><span class="n">m</span><span class="w"></span>
<span class="o">[</span><span class="n">akaris@linux infra-nodes</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">machineset</span><span class="w"></span>
<span class="n">NAME</span><span class="w">                              </span><span class="n">DESIRED</span><span class="w">   </span><span class="k">CURRENT</span><span class="w">   </span><span class="n">READY</span><span class="w">   </span><span class="n">AVAILABLE</span><span class="w">   </span><span class="n">AGE</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="w">    </span><span class="mi">3</span><span class="w">         </span><span class="mi">3</span><span class="w">                             </span><span class="mi">58</span><span class="n">s</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="w">   </span><span class="mi">1</span><span class="w">         </span><span class="mi">1</span><span class="w">         </span><span class="mi">1</span><span class="w">       </span><span class="mi">1</span><span class="w">           </span><span class="mi">119</span><span class="n">m</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">b</span><span class="w">   </span><span class="mi">1</span><span class="w">         </span><span class="mi">1</span><span class="w">         </span><span class="mi">1</span><span class="w">       </span><span class="mi">1</span><span class="w">           </span><span class="mi">119</span><span class="n">m</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">c</span><span class="w">   </span><span class="mi">1</span><span class="w">         </span><span class="mi">1</span><span class="w">         </span><span class="mi">1</span><span class="w">       </span><span class="mi">1</span><span class="w">           </span><span class="mi">119</span><span class="n">m</span><span class="w"></span>
<span class="o">[</span><span class="n">akaris@linux infra-nodes</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="n">NAME</span><span class="w">                                         </span><span class="n">STATUS</span><span class="w">   </span><span class="n">ROLES</span><span class="w">    </span><span class="n">AGE</span><span class="w">    </span><span class="n">VERSION</span><span class="w"></span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">148</span><span class="o">-</span><span class="mf">174.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="k">compute</span><span class="p">.</span><span class="n">internal</span><span class="w">   </span><span class="n">Ready</span><span class="w">    </span><span class="n">worker</span><span class="w">   </span><span class="mi">105</span><span class="n">m</span><span class="w">   </span><span class="n">v1</span><span class="mf">.17.1</span><span class="o">+</span><span class="n">b83bc57</span><span class="w"></span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">159</span><span class="o">-</span><span class="mf">35.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="k">compute</span><span class="p">.</span><span class="n">internal</span><span class="w">    </span><span class="n">Ready</span><span class="w">    </span><span class="n">master</span><span class="w">   </span><span class="mi">117</span><span class="n">m</span><span class="w">   </span><span class="n">v1</span><span class="mf">.17.1</span><span class="o">+</span><span class="n">b83bc57</span><span class="w"></span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">168</span><span class="o">-</span><span class="mf">64.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="k">compute</span><span class="p">.</span><span class="n">internal</span><span class="w">    </span><span class="n">Ready</span><span class="w">    </span><span class="n">master</span><span class="w">   </span><span class="mi">118</span><span class="n">m</span><span class="w">   </span><span class="n">v1</span><span class="mf">.17.1</span><span class="o">+</span><span class="n">b83bc57</span><span class="w"></span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">191</span><span class="o">-</span><span class="mf">238.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="k">compute</span><span class="p">.</span><span class="n">internal</span><span class="w">   </span><span class="n">Ready</span><span class="w">    </span><span class="n">worker</span><span class="w">   </span><span class="mi">105</span><span class="n">m</span><span class="w">   </span><span class="n">v1</span><span class="mf">.17.1</span><span class="o">+</span><span class="n">b83bc57</span><span class="w"></span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">208</span><span class="o">-</span><span class="mf">80.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="k">compute</span><span class="p">.</span><span class="n">internal</span><span class="w">    </span><span class="n">Ready</span><span class="w">    </span><span class="n">master</span><span class="w">   </span><span class="mi">117</span><span class="n">m</span><span class="w">   </span><span class="n">v1</span><span class="mf">.17.1</span><span class="o">+</span><span class="n">b83bc57</span><span class="w"></span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">220</span><span class="o">-</span><span class="mf">32.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="k">compute</span><span class="p">.</span><span class="n">internal</span><span class="w">    </span><span class="n">Ready</span><span class="w">    </span><span class="n">worker</span><span class="w">   </span><span class="mi">105</span><span class="n">m</span><span class="w">   </span><span class="n">v1</span><span class="mf">.17.1</span><span class="o">+</span><span class="n">b83bc57</span><span class="w"></span>
</code></pre></div>
</td></tr></table></p>
<p>Wait:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">akaris@linux infra-nodes</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">machineconfigpool</span><span class="w"></span>
<span class="n">NAME</span><span class="w">     </span><span class="n">CONFIG</span><span class="w">                                             </span><span class="n">UPDATED</span><span class="w">   </span><span class="n">UPDATING</span><span class="w">   </span><span class="n">DEGRADED</span><span class="w">   </span><span class="n">MACHINECOUNT</span><span class="w">   </span><span class="n">READYMACHINECOUNT</span><span class="w">   </span><span class="n">UPDATEDMACHINECOUNT</span><span class="w">   </span><span class="n">DEGRADEDMACHINECOUNT</span><span class="w">   </span><span class="n">AGE</span><span class="w"></span>
<span class="n">infra</span><span class="w">    </span><span class="n">rendered</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">d63625ee2cdc4637cc156a1ebf25e926</span><span class="w">    </span><span class="k">True</span><span class="w">      </span><span class="k">False</span><span class="w">      </span><span class="k">False</span><span class="w">      </span><span class="mi">3</span><span class="w">              </span><span class="mi">3</span><span class="w">                   </span><span class="mi">3</span><span class="w">                     </span><span class="mi">0</span><span class="w">                      </span><span class="mi">10</span><span class="n">m</span><span class="w"></span>
<span class="n">master</span><span class="w">   </span><span class="n">rendered</span><span class="o">-</span><span class="n">master</span><span class="o">-</span><span class="mi">8</span><span class="n">d007e81b9ebb00b4042722f2713f1ae</span><span class="w">   </span><span class="k">True</span><span class="w">      </span><span class="k">False</span><span class="w">      </span><span class="k">False</span><span class="w">      </span><span class="mi">3</span><span class="w">              </span><span class="mi">3</span><span class="w">                   </span><span class="mi">3</span><span class="w">                     </span><span class="mi">0</span><span class="w">                      </span><span class="mi">122</span><span class="n">m</span><span class="w"></span>
<span class="n">worker</span><span class="w">   </span><span class="n">rendered</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="mi">9</span><span class="n">d6647aa43752e0eb71a221dd8b7e32e</span><span class="w">   </span><span class="k">True</span><span class="w">      </span><span class="k">False</span><span class="w">      </span><span class="k">False</span><span class="w">      </span><span class="mi">3</span><span class="w">              </span><span class="mi">3</span><span class="w">                   </span><span class="mi">3</span><span class="w">                     </span><span class="mi">0</span><span class="w">                      </span><span class="mi">122</span><span class="n">m</span><span class="w"></span>
<span class="o">[</span><span class="n">akaris@linux infra-nodes</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">machineset</span><span class="w"></span>
<span class="n">NAME</span><span class="w">                              </span><span class="n">DESIRED</span><span class="w">   </span><span class="k">CURRENT</span><span class="w">   </span><span class="n">READY</span><span class="w">   </span><span class="n">AVAILABLE</span><span class="w">   </span><span class="n">AGE</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="w">    </span><span class="mi">3</span><span class="w">         </span><span class="mi">3</span><span class="w">         </span><span class="mi">3</span><span class="w">       </span><span class="mi">3</span><span class="w">           </span><span class="mi">7</span><span class="n">m15s</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="w">   </span><span class="mi">1</span><span class="w">         </span><span class="mi">1</span><span class="w">         </span><span class="mi">1</span><span class="w">       </span><span class="mi">1</span><span class="w">           </span><span class="mi">125</span><span class="n">m</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">b</span><span class="w">   </span><span class="mi">1</span><span class="w">         </span><span class="mi">1</span><span class="w">         </span><span class="mi">1</span><span class="w">       </span><span class="mi">1</span><span class="w">           </span><span class="mi">125</span><span class="n">m</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">c</span><span class="w">   </span><span class="mi">1</span><span class="w">         </span><span class="mi">1</span><span class="w">         </span><span class="mi">1</span><span class="w">       </span><span class="mi">1</span><span class="w">           </span><span class="mi">125</span><span class="n">m</span><span class="w"></span>
<span class="o">[</span><span class="n">akaris@linux infra-nodes</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">machines</span><span class="w"></span>
<span class="n">NAME</span><span class="w">                                    </span><span class="n">PHASE</span><span class="w">     </span><span class="n">TYPE</span><span class="w">        </span><span class="n">REGION</span><span class="w">      </span><span class="k">ZONE</span><span class="w">         </span><span class="n">AGE</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="o">-</span><span class="n">fctd5</span><span class="w">    </span><span class="n">Running</span><span class="w">   </span><span class="n">m5</span><span class="p">.</span><span class="k">large</span><span class="w">    </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="w">   </span><span class="mi">7</span><span class="n">m17s</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="o">-</span><span class="n">xtpcv</span><span class="w">    </span><span class="n">Running</span><span class="w">   </span><span class="n">m5</span><span class="p">.</span><span class="k">large</span><span class="w">    </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="w">   </span><span class="mi">7</span><span class="n">m17s</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="o">-</span><span class="n">zmvzh</span><span class="w">    </span><span class="n">Running</span><span class="w">   </span><span class="n">m5</span><span class="p">.</span><span class="k">large</span><span class="w">    </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="w">   </span><span class="mi">7</span><span class="n">m17s</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">master</span><span class="o">-</span><span class="mi">0</span><span class="w">                  </span><span class="n">Running</span><span class="w">   </span><span class="n">m5</span><span class="p">.</span><span class="n">xlarge</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="w">   </span><span class="mi">125</span><span class="n">m</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">master</span><span class="o">-</span><span class="mi">1</span><span class="w">                  </span><span class="n">Running</span><span class="w">   </span><span class="n">m5</span><span class="p">.</span><span class="n">xlarge</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">b</span><span class="w">   </span><span class="mi">125</span><span class="n">m</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">master</span><span class="o">-</span><span class="mi">2</span><span class="w">                  </span><span class="n">Running</span><span class="w">   </span><span class="n">m5</span><span class="p">.</span><span class="n">xlarge</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">c</span><span class="w">   </span><span class="mi">125</span><span class="n">m</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="o">-</span><span class="mi">4</span><span class="n">krrd</span><span class="w">   </span><span class="n">Running</span><span class="w">   </span><span class="n">m5</span><span class="p">.</span><span class="k">large</span><span class="w">    </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="w">   </span><span class="mi">117</span><span class="n">m</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">b</span><span class="o">-</span><span class="mi">59</span><span class="n">z6n</span><span class="w">   </span><span class="n">Running</span><span class="w">   </span><span class="n">m5</span><span class="p">.</span><span class="k">large</span><span class="w">    </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">b</span><span class="w">   </span><span class="mi">117</span><span class="n">m</span><span class="w"></span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">c</span><span class="o">-</span><span class="n">chst9</span><span class="w">   </span><span class="n">Running</span><span class="w">   </span><span class="n">m5</span><span class="p">.</span><span class="k">large</span><span class="w">    </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="w">   </span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">c</span><span class="w">   </span><span class="mi">117</span><span class="n">m</span><span class="w"></span>
<span class="o">[</span><span class="n">akaris@linux infra-nodes</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">nodes</span><span class="w"></span>
<span class="n">NAME</span><span class="w">                                         </span><span class="n">STATUS</span><span class="w">   </span><span class="n">ROLES</span><span class="w">    </span><span class="n">AGE</span><span class="w">     </span><span class="n">VERSION</span><span class="w"></span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">128</span><span class="o">-</span><span class="mf">80.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="k">compute</span><span class="p">.</span><span class="n">internal</span><span class="w">    </span><span class="n">Ready</span><span class="w">    </span><span class="n">infra</span><span class="w">    </span><span class="mi">2</span><span class="n">m39s</span><span class="w">   </span><span class="n">v1</span><span class="mf">.17.1</span><span class="o">+</span><span class="n">b83bc57</span><span class="w"></span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">145</span><span class="o">-</span><span class="mf">35.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="k">compute</span><span class="p">.</span><span class="n">internal</span><span class="w">    </span><span class="n">Ready</span><span class="w">    </span><span class="n">infra</span><span class="w">    </span><span class="mi">2</span><span class="n">m43s</span><span class="w">   </span><span class="n">v1</span><span class="mf">.17.1</span><span class="o">+</span><span class="n">b83bc57</span><span class="w"></span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">148</span><span class="o">-</span><span class="mf">174.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="k">compute</span><span class="p">.</span><span class="n">internal</span><span class="w">   </span><span class="n">Ready</span><span class="w">    </span><span class="n">worker</span><span class="w">   </span><span class="mi">111</span><span class="n">m</span><span class="w">    </span><span class="n">v1</span><span class="mf">.17.1</span><span class="o">+</span><span class="n">b83bc57</span><span class="w"></span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">159</span><span class="o">-</span><span class="mf">154.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="k">compute</span><span class="p">.</span><span class="n">internal</span><span class="w">   </span><span class="n">Ready</span><span class="w">    </span><span class="n">infra</span><span class="w">    </span><span class="mi">2</span><span class="n">m7s</span><span class="w">    </span><span class="n">v1</span><span class="mf">.17.1</span><span class="o">+</span><span class="n">b83bc57</span><span class="w"></span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">159</span><span class="o">-</span><span class="mf">35.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="k">compute</span><span class="p">.</span><span class="n">internal</span><span class="w">    </span><span class="n">Ready</span><span class="w">    </span><span class="n">master</span><span class="w">   </span><span class="mi">124</span><span class="n">m</span><span class="w">    </span><span class="n">v1</span><span class="mf">.17.1</span><span class="o">+</span><span class="n">b83bc57</span><span class="w"></span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">168</span><span class="o">-</span><span class="mf">64.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="k">compute</span><span class="p">.</span><span class="n">internal</span><span class="w">    </span><span class="n">Ready</span><span class="w">    </span><span class="n">master</span><span class="w">   </span><span class="mi">124</span><span class="n">m</span><span class="w">    </span><span class="n">v1</span><span class="mf">.17.1</span><span class="o">+</span><span class="n">b83bc57</span><span class="w"></span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">191</span><span class="o">-</span><span class="mf">238.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="k">compute</span><span class="p">.</span><span class="n">internal</span><span class="w">   </span><span class="n">Ready</span><span class="w">    </span><span class="n">worker</span><span class="w">   </span><span class="mi">111</span><span class="n">m</span><span class="w">    </span><span class="n">v1</span><span class="mf">.17.1</span><span class="o">+</span><span class="n">b83bc57</span><span class="w"></span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">208</span><span class="o">-</span><span class="mf">80.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="k">compute</span><span class="p">.</span><span class="n">internal</span><span class="w">    </span><span class="n">Ready</span><span class="w">    </span><span class="n">master</span><span class="w">   </span><span class="mi">124</span><span class="n">m</span><span class="w">    </span><span class="n">v1</span><span class="mf">.17.1</span><span class="o">+</span><span class="n">b83bc57</span><span class="w"></span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">220</span><span class="o">-</span><span class="mf">32.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="k">compute</span><span class="p">.</span><span class="n">internal</span><span class="w">    </span><span class="n">Ready</span><span class="w">    </span><span class="n">worker</span><span class="w">   </span><span class="mi">111</span><span class="n">m</span><span class="w">    </span><span class="n">v1</span><span class="mf">.17.1</span><span class="o">+</span><span class="n">b83bc57</span><span class="w"></span>
</code></pre></div>
</td></tr></table></p>
<h3 id="step-7-moving-resources-to-the-infra-nodes">Step 7: Moving resources to the infra nodes</h3>
<p>The following steps are from:
https://github.com/lbohnsac/OCP4/tree/master/infrastructure-node-setup</p>
<p>Also see steps from:
https://docs.openshift.com/container-platform/4.5/machine_management/creating-infrastructure-machinesets.html</p>
<h4 id="move-the-router-bits">Move the router bits</h4>
<p>Move the internal routers to the infra nodes
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>oc patch ingresscontrollers.operator.openshift.io default -n openshift-ingress-operator --type=merge \
  --patch &#39;{&quot;spec&quot;:{&quot;nodePlacement&quot;:{&quot;nodeSelector&quot;:{&quot;matchLabels&quot;:{&quot;node-role.kubernetes.io/infra&quot;:&quot;&quot;}}}}}&#39;
</code></pre></div>
</td></tr></table></p>
<p>Define 3 routers (default are 2!)
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>oc patch ingresscontrollers.operator.openshift.io default -n openshift-ingress-operator --type=merge \
  --patch &#39;{&quot;spec&quot;:{&quot;replicas&quot;: 3}}&#39;
</code></pre></div>
</td></tr></table></p>
<h4 id="move-the-registry-bits">Move the registry bits</h4>
<p>Move the internal image registry to the infra nodes
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">oc</span> <span class="n">patch</span> <span class="n">configs</span><span class="p">.</span><span class="n">imageregistry</span><span class="p">.</span><span class="n">operator</span><span class="p">.</span><span class="n">openshift</span><span class="p">.</span><span class="n">io</span> <span class="n">cluster</span> <span class="o">--</span><span class="k">type</span><span class="o">=</span><span class="n">merge</span> \
  <span class="o">--</span><span class="n">patch</span> <span class="p">&#39;{</span><span class="s">&quot;spec&quot;</span><span class="o">:</span><span class="p">{</span><span class="s">&quot;nodeSelector&quot;</span><span class="o">:</span><span class="p">{</span><span class="s">&quot;node-role.kubernetes.io/infra&quot;</span><span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">}}}&#39;</span>
</code></pre></div>
</td></tr></table></p>
<p>Move the registry image pruner (from 4.4) to the infra nodes
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="n">oc</span> <span class="n">patch</span> <span class="n">imagepruners</span><span class="p">.</span><span class="n">imageregistry</span><span class="p">.</span><span class="n">operator</span><span class="p">.</span><span class="n">openshift</span><span class="p">.</span><span class="n">io</span> <span class="n">cluster</span> <span class="o">--</span><span class="k">type</span><span class="o">=</span><span class="n">merge</span> \
  <span class="o">--</span><span class="n">patch</span> <span class="p">&#39;{</span><span class="s">&quot;spec&quot;</span><span class="o">:</span><span class="p">{</span><span class="s">&quot;nodeSelector&quot;</span><span class="o">:</span> <span class="p">{</span><span class="s">&quot;node-role.kubernetes.io/infra&quot;</span><span class="o">:</span> <span class="s">&quot;&quot;</span><span class="p">}}}&#39;</span>
</code></pre></div>
</td></tr></table></p>
<h4 id="move-the-logging-bits">Move the logging bits</h4>
<p>Move the Kibana pod to the infras
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>oc patch clusterloggings.logging.openshift.io instance -n openshift-logging --type=merge \
  --patch &#39;{&quot;spec&quot;:{&quot;visualization&quot;:{&quot;kibana&quot;:{&quot;nodeSelector&quot;:{&quot;node-role.kubernetes.io/infra&quot;:&quot;&quot;}}}}}&#39;
</code></pre></div>
</td></tr></table></p>
<p>Move the curator pod to the infras
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>oc patch clusterloggings.logging.openshift.io instance -n openshift-logging --type=merge \
  --patch &#39;{&quot;spec&quot;:{&quot;curation&quot;:{&quot;curator&quot;:{&quot;nodeSelector&quot;:{&quot;node-role.kubernetes.io/infra&quot;:&quot;&quot;}}}}}&#39;
</code></pre></div>
</td></tr></table></p>
<p>Move the elasticsearch pods to the infras
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>oc patch clusterloggings.logging.openshift.io instance -n openshift-logging --type=merge \
  --patch &#39;{&quot;spec&quot;:{&quot;logStore&quot;:{&quot;elasticsearch&quot;:{&quot;nodeSelector&quot;:{&quot;node-role.kubernetes.io/infra&quot;:&quot;&quot;}}}}}&#39;
</code></pre></div>
</td></tr></table></p>
<h3 id="issues">Issues</h3>
<p>The inconvenience with this is that the ExecStart of the dropin is now "hardcoded" and will not be updated / changed by the installer upon upgrade.</p>
<h3 id="step-6-testing-upgrades">Step 6: Testing upgrades</h3>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">akaris@linux infra-nodes</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">clusterversion</span><span class="w"></span>
<span class="n">NAME</span><span class="w">      </span><span class="n">VERSION</span><span class="w">   </span><span class="n">AVAILABLE</span><span class="w">   </span><span class="n">PROGRESSING</span><span class="w">   </span><span class="n">SINCE</span><span class="w">   </span><span class="n">STATUS</span><span class="w"></span>
<span class="n">version</span><span class="w">   </span><span class="mf">4.4.16</span><span class="w">    </span><span class="k">True</span><span class="w">        </span><span class="k">False</span><span class="w">         </span><span class="mi">123</span><span class="n">m</span><span class="w">    </span><span class="n">Cluster</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="mf">4.4.16</span><span class="w"></span>
<span class="o">[</span><span class="n">akaris@linux infra-nodes</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="n">adm</span><span class="w"> </span><span class="n">upgrade</span><span class="w"></span>
<span class="n">Cluster</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="mf">4.4.16</span><span class="w"></span>

<span class="k">No</span><span class="w"> </span><span class="n">updates</span><span class="w"> </span><span class="n">available</span><span class="p">.</span><span class="w"> </span><span class="n">You</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">force</span><span class="w"> </span><span class="n">an</span><span class="w"> </span><span class="n">upgrade</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="k">specific</span><span class="w"> </span><span class="k">release</span><span class="w"> </span><span class="nc">image</span><span class="p">,</span><span class="w"> </span><span class="n">but</span><span class="w"> </span><span class="n">doing</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">supported</span><span class="w"> </span><span class="ow">and</span><span class="w"> </span><span class="k">result</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">downtime</span><span class="w"> </span><span class="ow">or</span><span class="w"> </span><span class="k">data</span><span class="w"> </span><span class="n">loss</span><span class="p">.</span><span class="w"></span>

<span class="err">#############################</span><span class="w"></span>
<span class="err">#</span><span class="w"> </span><span class="k">set</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="mf">4.5</span><span class="o">-</span><span class="n">stable</span><span class="w"> </span><span class="n">channel</span><span class="w"></span>
<span class="err">#############################</span><span class="w"></span>
<span class="o">[</span><span class="n">akaris@linux infra-nodes</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="n">edit</span><span class="w"> </span><span class="n">clusterversion</span><span class="w"></span>
<span class="n">clusterversion</span><span class="p">.</span><span class="n">config</span><span class="p">.</span><span class="n">openshift</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">version</span><span class="w"> </span><span class="n">edited</span><span class="w"></span>


<span class="o">[</span><span class="n">akaris@linux infra-nodes</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="n">adm</span><span class="w"> </span><span class="n">upgrade</span><span class="w"></span>
<span class="n">Cluster</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="k">is</span><span class="w"> </span><span class="mf">4.4.16</span><span class="w"></span>

<span class="nl">Updates</span><span class="p">:</span><span class="w"></span>

<span class="n">VERSION</span><span class="w"> </span><span class="nc">IMAGE</span><span class="w"></span>
<span class="mf">4.5.5</span><span class="w">   </span><span class="n">quay</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">openshift</span><span class="o">-</span><span class="k">release</span><span class="o">-</span><span class="n">dev</span><span class="o">/</span><span class="n">ocp</span><span class="o">-</span><span class="k">release</span><span class="nv">@sha256</span><span class="err">:</span><span class="n">a58573e1c92f5258219022ec104ec254ded0a70370ee8ed2aceea52525639bd4</span><span class="w"></span>
<span class="o">[</span><span class="n">akaris@linux infra-nodes</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="n">adm</span><span class="w"> </span><span class="n">upgrade</span><span class="w"> </span><span class="o">--</span><span class="k">to</span><span class="o">-</span><span class="n">latest</span><span class="w"></span>
<span class="n">Updating</span><span class="w"> </span><span class="k">to</span><span class="w"> </span><span class="n">latest</span><span class="w"> </span><span class="n">version</span><span class="w"> </span><span class="mf">4.5.5</span><span class="w"></span>
</code></pre></div>
</td></tr></table>
<p>The upgrade succeeds:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span>
<span class="normal">37</span>
<span class="normal">38</span>
<span class="normal">39</span>
<span class="normal">40</span>
<span class="normal">41</span>
<span class="normal">42</span>
<span class="normal">43</span>
<span class="normal">44</span>
<span class="normal">45</span>
<span class="normal">46</span>
<span class="normal">47</span>
<span class="normal">48</span>
<span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">akaris</span><span class="err">@</span><span class="n">linux</span> <span class="n">ipi</span><span class="p">]</span><span class="o">$</span> <span class="k">export</span> <span class="n">KUBECONFIG</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">akaris</span><span class="o">/</span><span class="n">cases</span><span class="o">/</span><span class="mi">02729138</span><span class="o">/</span><span class="n">ipi</span><span class="o">/</span><span class="n">install</span><span class="o">-</span><span class="n">config</span><span class="o">/</span><span class="n">auth</span><span class="o">/</span><span class="n">kubeconfig</span>
<span class="p">[</span><span class="n">akaris</span><span class="err">@</span><span class="n">linux</span> <span class="n">ipi</span><span class="p">]</span><span class="o">$</span> <span class="n">oc</span> <span class="n">get</span> <span class="n">nodes</span>
<span class="n">NAME</span>                                         <span class="n">STATUS</span>   <span class="n">ROLES</span>    <span class="n">AGE</span>   <span class="n">VERSION</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">128</span><span class="o">-</span><span class="mf">80.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="n">infra</span>    <span class="mi">17</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">145</span><span class="o">-</span><span class="mf">35.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="n">infra</span>    <span class="mi">17</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">148</span><span class="o">-</span><span class="mf">174.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>   <span class="n">Ready</span>    <span class="n">worker</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">159</span><span class="o">-</span><span class="mf">154.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>   <span class="n">Ready</span>    <span class="n">infra</span>    <span class="mi">17</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">159</span><span class="o">-</span><span class="mf">35.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="k">master</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">168</span><span class="o">-</span><span class="mf">64.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="k">master</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">191</span><span class="o">-</span><span class="mf">238.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>   <span class="n">Ready</span>    <span class="n">worker</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">208</span><span class="o">-</span><span class="mf">80.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="k">master</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">220</span><span class="o">-</span><span class="mf">32.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="n">worker</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="p">[</span><span class="n">akaris</span><span class="err">@</span><span class="n">linux</span> <span class="n">ipi</span><span class="p">]</span><span class="o">$</span> <span class="n">oc</span> <span class="n">get</span> <span class="n">clusterversion</span>
<span class="n">NAME</span>      <span class="n">VERSION</span>   <span class="n">AVAILABLE</span>   <span class="n">PROGRESSING</span>   <span class="n">SINCE</span>   <span class="n">STATUS</span>
<span class="n">version</span>   <span class="mf">4.5</span><span class="o">.</span><span class="mi">5</span>     <span class="n">True</span>        <span class="n">False</span>         <span class="mi">16</span><span class="n">h</span>     <span class="n">Cluster</span> <span class="n">version</span> <span class="k">is</span> <span class="mf">4.5</span><span class="o">.</span><span class="mi">5</span>
<span class="p">[</span><span class="n">akaris</span><span class="err">@</span><span class="n">linux</span> <span class="n">ipi</span><span class="p">]</span><span class="o">$</span> <span class="n">oc</span> <span class="n">get</span> <span class="n">machinesets</span>
<span class="n">NAME</span>                              <span class="n">DESIRED</span>   <span class="n">CURRENT</span>   <span class="n">READY</span>   <span class="n">AVAILABLE</span>   <span class="n">AGE</span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span>    <span class="mi">3</span>         <span class="mi">3</span>         <span class="mi">3</span>       <span class="mi">3</span>           <span class="mi">17</span><span class="n">h</span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span>   <span class="mi">1</span>         <span class="mi">1</span>         <span class="mi">1</span>       <span class="mi">1</span>           <span class="mi">19</span><span class="n">h</span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">b</span>   <span class="mi">1</span>         <span class="mi">1</span>         <span class="mi">1</span>       <span class="mi">1</span>           <span class="mi">19</span><span class="n">h</span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">c</span>   <span class="mi">1</span>         <span class="mi">1</span>         <span class="mi">1</span>       <span class="mi">1</span>           <span class="mi">19</span><span class="n">h</span>
<span class="p">[</span><span class="n">akaris</span><span class="err">@</span><span class="n">linux</span> <span class="n">ipi</span><span class="p">]</span><span class="o">$</span> <span class="n">oc</span> <span class="n">get</span> <span class="n">machines</span>
<span class="n">NAME</span>                                    <span class="n">PHASE</span>     <span class="n">TYPE</span>        <span class="n">REGION</span>      <span class="n">ZONE</span>         <span class="n">AGE</span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="o">-</span><span class="n">fctd5</span>    <span class="n">Running</span>   <span class="n">m5</span><span class="o">.</span><span class="n">large</span>    <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span>   <span class="mi">17</span><span class="n">h</span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="o">-</span><span class="n">xtpcv</span>    <span class="n">Running</span>   <span class="n">m5</span><span class="o">.</span><span class="n">large</span>    <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span>   <span class="mi">17</span><span class="n">h</span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="o">-</span><span class="n">zmvzh</span>    <span class="n">Running</span>   <span class="n">m5</span><span class="o">.</span><span class="n">large</span>    <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span>   <span class="mi">17</span><span class="n">h</span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="k">master</span><span class="o">-</span><span class="mi">0</span>                  <span class="n">Running</span>   <span class="n">m5</span><span class="o">.</span><span class="n">xlarge</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span>   <span class="mi">19</span><span class="n">h</span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="k">master</span><span class="o">-</span><span class="mi">1</span>                  <span class="n">Running</span>   <span class="n">m5</span><span class="o">.</span><span class="n">xlarge</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">b</span>   <span class="mi">19</span><span class="n">h</span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="k">master</span><span class="o">-</span><span class="mi">2</span>                  <span class="n">Running</span>   <span class="n">m5</span><span class="o">.</span><span class="n">xlarge</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">c</span>   <span class="mi">19</span><span class="n">h</span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="o">-</span><span class="mi">4</span><span class="n">krrd</span>   <span class="n">Running</span>   <span class="n">m5</span><span class="o">.</span><span class="n">large</span>    <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span>   <span class="mi">19</span><span class="n">h</span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">b</span><span class="o">-</span><span class="mi">59</span><span class="n">z6n</span>   <span class="n">Running</span>   <span class="n">m5</span><span class="o">.</span><span class="n">large</span>    <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">b</span>   <span class="mi">19</span><span class="n">h</span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">c</span><span class="o">-</span><span class="n">chst9</span>   <span class="n">Running</span>   <span class="n">m5</span><span class="o">.</span><span class="n">large</span>    <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">c</span>   <span class="mi">19</span><span class="n">h</span>
<span class="p">[</span><span class="n">akaris</span><span class="err">@</span><span class="n">linux</span> <span class="n">ipi</span><span class="p">]</span><span class="o">$</span> <span class="n">oc</span> <span class="n">get</span> <span class="n">machineconfigpool</span>
<span class="n">NAME</span>     <span class="n">CONFIG</span>                                             <span class="n">UPDATED</span>   <span class="n">UPDATING</span>   <span class="n">DEGRADED</span>   <span class="n">MACHINECOUNT</span>   <span class="n">READYMACHINECOUNT</span>   <span class="n">UPDATEDMACHINECOUNT</span>   <span class="n">DEGRADEDMACHINECOUNT</span>   <span class="n">AGE</span>
<span class="n">infra</span>    <span class="n">rendered</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">aa17b9b35abf210691d268dd4c7449d3</span>    <span class="n">True</span>      <span class="n">False</span>      <span class="n">False</span>      <span class="mi">3</span>              <span class="mi">3</span>                   <span class="mi">3</span>                     <span class="mi">0</span>                      <span class="mi">17</span><span class="n">h</span>
<span class="k">master</span>   <span class="n">rendered</span><span class="o">-</span><span class="k">master</span><span class="o">-</span><span class="mi">2</span><span class="n">cc3abe4c49c6db04d9456744d0079f9</span>   <span class="n">True</span>      <span class="n">False</span>      <span class="n">False</span>      <span class="mi">3</span>              <span class="mi">3</span>                   <span class="mi">3</span>                     <span class="mi">0</span>                      <span class="mi">19</span><span class="n">h</span>
<span class="n">worker</span>   <span class="n">rendered</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">d65740ba72e305c96782a27b8255dd89</span>   <span class="n">True</span>      <span class="n">False</span>      <span class="n">False</span>      <span class="mi">3</span>              <span class="mi">3</span>                   <span class="mi">3</span>                     <span class="mi">0</span>                      <span class="mi">19</span><span class="n">h</span>
<span class="p">[</span><span class="n">akaris</span><span class="err">@</span><span class="n">linux</span> <span class="n">ipi</span><span class="p">]</span><span class="o">$</span> <span class="n">oc</span> <span class="n">get</span> <span class="n">machineconfig</span>
<span class="n">NAME</span>                                                        <span class="n">GENERATEDBYCONTROLLER</span>                      <span class="n">IGNITIONVERSION</span>   <span class="n">AGE</span>
<span class="mi">00</span><span class="o">-</span><span class="k">master</span>                                                   <span class="mi">807</span><span class="n">abb900cf9976a1baad66eab17c6d76016e7b7</span>   <span class="mf">2.2</span><span class="o">.</span><span class="mi">0</span>             <span class="mi">19</span><span class="n">h</span>
<span class="mi">00</span><span class="o">-</span><span class="n">worker</span>                                                   <span class="mi">807</span><span class="n">abb900cf9976a1baad66eab17c6d76016e7b7</span>   <span class="mf">2.2</span><span class="o">.</span><span class="mi">0</span>             <span class="mi">19</span><span class="n">h</span>
<span class="mi">01</span><span class="o">-</span><span class="k">master</span><span class="o">-</span><span class="n">container</span><span class="o">-</span><span class="n">runtime</span>                                 <span class="mi">807</span><span class="n">abb900cf9976a1baad66eab17c6d76016e7b7</span>   <span class="mf">2.2</span><span class="o">.</span><span class="mi">0</span>             <span class="mi">19</span><span class="n">h</span>
<span class="mi">01</span><span class="o">-</span><span class="k">master</span><span class="o">-</span><span class="n">kubelet</span>                                           <span class="mi">807</span><span class="n">abb900cf9976a1baad66eab17c6d76016e7b7</span>   <span class="mf">2.2</span><span class="o">.</span><span class="mi">0</span>             <span class="mi">19</span><span class="n">h</span>
<span class="mi">01</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">container</span><span class="o">-</span><span class="n">runtime</span>                                 <span class="mi">807</span><span class="n">abb900cf9976a1baad66eab17c6d76016e7b7</span>   <span class="mf">2.2</span><span class="o">.</span><span class="mi">0</span>             <span class="mi">19</span><span class="n">h</span>
<span class="mi">01</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">kubelet</span>                                           <span class="mi">807</span><span class="n">abb900cf9976a1baad66eab17c6d76016e7b7</span>   <span class="mf">2.2</span><span class="o">.</span><span class="mi">0</span>             <span class="mi">19</span><span class="n">h</span>
<span class="mi">03</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">kubelet</span>                                                                                       <span class="mf">2.2</span><span class="o">.</span><span class="mi">0</span>             <span class="mi">17</span><span class="n">h</span>
<span class="mi">99</span><span class="o">-</span><span class="k">master</span><span class="o">-</span><span class="n">d32a1dcd</span><span class="o">-</span><span class="mi">1</span><span class="n">b7b</span><span class="o">-</span><span class="mi">4999</span><span class="o">-</span><span class="mi">8919</span><span class="o">-</span><span class="mi">3</span><span class="n">bd59c24fdae</span><span class="o">-</span><span class="n">registries</span>   <span class="mi">807</span><span class="n">abb900cf9976a1baad66eab17c6d76016e7b7</span>   <span class="mf">2.2</span><span class="o">.</span><span class="mi">0</span>             <span class="mi">19</span><span class="n">h</span>
<span class="mi">99</span><span class="o">-</span><span class="k">master</span><span class="o">-</span><span class="n">ssh</span>                                                                                          <span class="mf">2.2</span><span class="o">.</span><span class="mi">0</span>             <span class="mi">19</span><span class="n">h</span>
<span class="mi">99</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">f569c8d2</span><span class="o">-</span><span class="mi">84</span><span class="n">df</span><span class="o">-</span><span class="mi">4</span><span class="n">a5b</span><span class="o">-</span><span class="mi">846</span><span class="n">a</span><span class="o">-</span><span class="mf">9e090</span><span class="n">b9fb68d</span><span class="o">-</span><span class="n">registries</span>   <span class="mi">807</span><span class="n">abb900cf9976a1baad66eab17c6d76016e7b7</span>   <span class="mf">2.2</span><span class="o">.</span><span class="mi">0</span>             <span class="mi">19</span><span class="n">h</span>
<span class="mi">99</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">ssh</span>                                                                                          <span class="mf">2.2</span><span class="o">.</span><span class="mi">0</span>             <span class="mi">19</span><span class="n">h</span>
<span class="n">rendered</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">aa17b9b35abf210691d268dd4c7449d3</span>             <span class="mi">807</span><span class="n">abb900cf9976a1baad66eab17c6d76016e7b7</span>   <span class="mf">2.2</span><span class="o">.</span><span class="mi">0</span>             <span class="mi">16</span><span class="n">h</span>
<span class="n">rendered</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">d63625ee2cdc4637cc156a1ebf25e926</span>             <span class="mi">601</span><span class="n">c2285f497bf7c73d84737b9977a0e697cb86a</span>   <span class="mf">2.2</span><span class="o">.</span><span class="mi">0</span>             <span class="mi">17</span><span class="n">h</span>
<span class="n">rendered</span><span class="o">-</span><span class="k">master</span><span class="o">-</span><span class="mi">2</span><span class="n">cc3abe4c49c6db04d9456744d0079f9</span>            <span class="mi">807</span><span class="n">abb900cf9976a1baad66eab17c6d76016e7b7</span>   <span class="mf">2.2</span><span class="o">.</span><span class="mi">0</span>             <span class="mi">16</span><span class="n">h</span>
<span class="n">rendered</span><span class="o">-</span><span class="k">master</span><span class="o">-</span><span class="mi">8</span><span class="n">d007e81b9ebb00b4042722f2713f1ae</span>            <span class="mi">601</span><span class="n">c2285f497bf7c73d84737b9977a0e697cb86a</span>   <span class="mf">2.2</span><span class="o">.</span><span class="mi">0</span>             <span class="mi">19</span><span class="n">h</span>
<span class="n">rendered</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="mi">9</span><span class="n">d6647aa43752e0eb71a221dd8b7e32e</span>            <span class="mi">601</span><span class="n">c2285f497bf7c73d84737b9977a0e697cb86a</span>   <span class="mf">2.2</span><span class="o">.</span><span class="mi">0</span>             <span class="mi">19</span><span class="n">h</span>
<span class="n">rendered</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">d65740ba72e305c96782a27b8255dd89</span>            <span class="mi">807</span><span class="n">abb900cf9976a1baad66eab17c6d76016e7b7</span>   <span class="mf">2.2</span><span class="o">.</span><span class="mi">0</span>             <span class="mi">16</span><span class="n">h</span>
<span class="p">[</span><span class="n">akaris</span><span class="err">@</span><span class="n">linux</span> <span class="n">ipi</span><span class="p">]</span><span class="o">$</span> 
</code></pre></div>
</td></tr></table></p>
<p>The one problem is the pod version on the infra nodes:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">akaris</span><span class="err">@</span><span class="n">linux</span> <span class="n">ipi</span><span class="p">]</span><span class="o">$</span> <span class="n">oc</span> <span class="n">get</span> <span class="n">nodes</span>
<span class="n">NAME</span>                                         <span class="n">STATUS</span>   <span class="n">ROLES</span>    <span class="n">AGE</span>   <span class="n">VERSION</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">128</span><span class="o">-</span><span class="mf">80.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="n">infra</span>    <span class="mi">17</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">145</span><span class="o">-</span><span class="mf">35.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="n">infra</span>    <span class="mi">17</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">148</span><span class="o">-</span><span class="mf">174.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>   <span class="n">Ready</span>    <span class="n">worker</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">159</span><span class="o">-</span><span class="mf">154.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>   <span class="n">Ready</span>    <span class="n">infra</span>    <span class="mi">17</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">159</span><span class="o">-</span><span class="mf">35.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="k">master</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">168</span><span class="o">-</span><span class="mf">64.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="k">master</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">191</span><span class="o">-</span><span class="mf">238.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>   <span class="n">Ready</span>    <span class="n">worker</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">208</span><span class="o">-</span><span class="mf">80.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="k">master</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">220</span><span class="o">-</span><span class="mf">32.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="n">worker</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="p">[</span><span class="n">akaris</span><span class="err">@</span><span class="n">linux</span> <span class="n">ipi</span><span class="p">]</span><span class="o">$</span> <span class="n">oc</span> <span class="n">debug</span> <span class="n">node</span><span class="o">/</span><span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">128</span><span class="o">-</span><span class="mf">80.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>
<span class="n">Starting</span> <span class="n">pod</span><span class="o">/</span><span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">128</span><span class="o">-</span><span class="mi">80</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">computeinternal</span><span class="o">-</span><span class="n">debug</span> <span class="o">...</span>
<span class="n">To</span> <span class="n">use</span> <span class="n">host</span> <span class="n">binaries</span><span class="p">,</span> <span class="n">run</span> <span class="err">`</span><span class="n">chroot</span> <span class="o">/</span><span class="n">host</span><span class="err">`</span>
<span class="n">Pod</span> <span class="n">IP</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">128.80</span>
<span class="n">If</span> <span class="n">you</span> <span class="n">don</span><span class="s1">&#39;t see a command prompt, try pressing enter.</span>
<span class="n">sh</span><span class="o">-</span><span class="mf">4.2</span><span class="c1"># chroot /host</span>
<span class="n">sh</span><span class="o">-</span><span class="mf">4.4</span><span class="c1"># cat /etc/redhat-release </span>
<span class="n">Red</span> <span class="n">Hat</span> <span class="n">Enterprise</span> <span class="n">Linux</span> <span class="n">CoreOS</span> <span class="n">release</span> <span class="mf">4.5</span>
<span class="n">sh</span><span class="o">-</span><span class="mf">4.4</span><span class="c1"># ps aux | grep kubelet</span>
<span class="n">root</span>        <span class="mi">1422</span>  <span class="mf">3.3</span>  <span class="mf">2.0</span> <span class="mi">1461696</span> <span class="mi">161600</span> <span class="err">?</span>      <span class="n">Ssl</span>  <span class="n">Aug19</span>  <span class="mi">33</span><span class="p">:</span><span class="mi">46</span> <span class="n">kubelet</span> <span class="o">--</span><span class="n">config</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">/</span><span class="n">kubelet</span><span class="o">.</span><span class="n">conf</span> <span class="o">--</span><span class="n">bootstrap</span><span class="o">-</span><span class="n">kubeconfig</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">/</span><span class="n">kubeconfig</span> <span class="o">--</span><span class="n">kubeconfig</span><span class="o">=/</span><span class="k">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">kubelet</span><span class="o">/</span><span class="n">kubeconfig</span> <span class="o">--</span><span class="n">container</span><span class="o">-</span><span class="n">runtime</span><span class="o">=</span><span class="k">remote</span> <span class="o">--</span><span class="n">container</span><span class="o">-</span><span class="n">runtime</span><span class="o">-</span><span class="n">endpoint</span><span class="o">=/</span><span class="k">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">crio</span><span class="o">/</span><span class="n">crio</span><span class="o">.</span><span class="n">sock</span> <span class="o">--</span><span class="n">runtime</span><span class="o">-</span><span class="n">cgroups</span><span class="o">=/</span><span class="n">system</span><span class="o">.</span><span class="n">slice</span><span class="o">/</span><span class="n">crio</span><span class="o">.</span><span class="n">service</span> <span class="o">--</span><span class="n">node</span><span class="o">-</span><span class="n">labels</span><span class="o">=</span><span class="n">node</span><span class="o">-</span><span class="n">role</span><span class="o">.</span><span class="n">kubernetes</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">infra</span><span class="p">,</span><span class="n">node</span><span class="o">.</span><span class="n">openshift</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">os_id</span><span class="o">=</span><span class="n">rhcos</span> <span class="o">--</span><span class="n">minimum</span><span class="o">-</span><span class="n">container</span><span class="o">-</span><span class="n">ttl</span><span class="o">-</span><span class="n">duration</span><span class="o">=</span><span class="mi">6</span><span class="n">m0s</span> <span class="o">--</span><span class="n">volume</span><span class="o">-</span><span class="n">plugin</span><span class="o">-</span><span class="n">dir</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">/</span><span class="n">kubelet</span><span class="o">-</span><span class="n">plugins</span><span class="o">/</span><span class="n">volume</span><span class="o">/</span><span class="n">exec</span> <span class="o">--</span><span class="n">cloud</span><span class="o">-</span><span class="n">provider</span><span class="o">=</span><span class="n">aws</span> <span class="o">--</span><span class="n">pod</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">container</span><span class="o">-</span><span class="n">image</span><span class="o">=</span><span class="n">quay</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">openshift</span><span class="o">-</span><span class="n">release</span><span class="o">-</span><span class="n">dev</span><span class="o">/</span><span class="n">ocp</span><span class="o">-</span><span class="n">v4</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">art</span><span class="o">-</span><span class="n">dev</span><span class="err">@</span><span class="n">sha256</span><span class="p">:</span><span class="n">dc0fe885d41cc4029caa3feacf71343806c81c8123abc91db90dc0e555fa5636</span> <span class="o">--</span><span class="n">v</span><span class="o">=</span><span class="mi">4</span>
<span class="n">root</span>     <span class="mi">1232029</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>   <span class="mi">9180</span>  <span class="mi">1032</span> <span class="err">?</span>        <span class="n">S</span><span class="o">+</span>   <span class="mi">10</span><span class="p">:</span><span class="mi">02</span>   <span class="mi">0</span><span class="p">:</span><span class="mi">00</span> <span class="n">grep</span> <span class="n">kubelet</span>
<span class="n">sh</span><span class="o">-</span><span class="mf">4.4</span><span class="c1"># </span>
<span class="n">sh</span><span class="o">-</span><span class="mf">4.4</span><span class="c1"># grep pause /etc/crio/ -R</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">crio</span><span class="o">/</span><span class="n">seccomp</span><span class="o">.</span><span class="n">json</span><span class="p">:</span>             <span class="s2">&quot;pause&quot;</span><span class="p">,</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">crio</span><span class="o">/</span><span class="n">crio</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="mi">00</span><span class="o">-</span><span class="n">default</span><span class="p">:</span><span class="n">pause_image</span> <span class="o">=</span> <span class="s2">&quot;quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:6e8bcc9c91267283f8b0edf1af0cb0d310c54d4f73905d9bcfb2a103a664fcb0&quot;</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">crio</span><span class="o">/</span><span class="n">crio</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="mi">00</span><span class="o">-</span><span class="n">default</span><span class="p">:</span><span class="n">pause_image_auth_file</span> <span class="o">=</span> <span class="s2">&quot;/var/lib/kubelet/config.json&quot;</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">crio</span><span class="o">/</span><span class="n">crio</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="mi">00</span><span class="o">-</span><span class="n">default</span><span class="p">:</span><span class="n">pause_command</span> <span class="o">=</span> <span class="s2">&quot;/usr/bin/pod&quot;</span>
<span class="n">sh</span><span class="o">-</span><span class="mf">4.4</span><span class="c1"># </span>
</code></pre></div>
</td></tr></table></p>
<p>Compare that to the version on the worker nodes:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">akaris</span><span class="err">@</span><span class="n">linux</span> <span class="n">ipi</span><span class="p">]</span><span class="o">$</span> <span class="n">oc</span> <span class="n">get</span> <span class="n">nodes</span>
<span class="n">NAME</span>                                         <span class="n">STATUS</span>   <span class="n">ROLES</span>    <span class="n">AGE</span>   <span class="n">VERSION</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">128</span><span class="o">-</span><span class="mf">80.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="n">infra</span>    <span class="mi">17</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">145</span><span class="o">-</span><span class="mf">35.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="n">infra</span>    <span class="mi">17</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">148</span><span class="o">-</span><span class="mf">174.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>   <span class="n">Ready</span>    <span class="n">worker</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">159</span><span class="o">-</span><span class="mf">154.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>   <span class="n">Ready</span>    <span class="n">infra</span>    <span class="mi">17</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">159</span><span class="o">-</span><span class="mf">35.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="k">master</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">168</span><span class="o">-</span><span class="mf">64.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="k">master</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">191</span><span class="o">-</span><span class="mf">238.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>   <span class="n">Ready</span>    <span class="n">worker</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">208</span><span class="o">-</span><span class="mf">80.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="k">master</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">220</span><span class="o">-</span><span class="mf">32.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="n">worker</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="p">[</span><span class="n">akaris</span><span class="err">@</span><span class="n">linux</span> <span class="n">ipi</span><span class="p">]</span><span class="o">$</span> <span class="n">oc</span> <span class="n">debug</span> <span class="n">node</span><span class="o">/</span><span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">148</span><span class="o">-</span><span class="mf">174.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>
<span class="n">Starting</span> <span class="n">pod</span><span class="o">/</span><span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">148</span><span class="o">-</span><span class="mi">174</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">computeinternal</span><span class="o">-</span><span class="n">debug</span> <span class="o">...</span>
<span class="n">To</span> <span class="n">use</span> <span class="n">host</span> <span class="n">binaries</span><span class="p">,</span> <span class="n">run</span> <span class="err">`</span><span class="n">chroot</span> <span class="o">/</span><span class="n">host</span><span class="err">`</span>
<span class="n">Pod</span> <span class="n">IP</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">148.174</span>
<span class="n">If</span> <span class="n">you</span> <span class="n">don</span><span class="s1">&#39;t see a command prompt, try pressing enter.</span>
<span class="n">sh</span><span class="o">-</span><span class="mf">4.2</span><span class="c1"># chroot /host</span>
<span class="n">sh</span><span class="o">-</span><span class="mf">4.4</span><span class="c1"># cat /etc/redhat-release</span>
<span class="n">Red</span> <span class="n">Hat</span> <span class="n">Enterprise</span> <span class="n">Linux</span> <span class="n">CoreOS</span> <span class="n">release</span> <span class="mf">4.5</span>
<span class="n">sh</span><span class="o">-</span><span class="mf">4.4</span><span class="c1"># ps aux | grep kubelet</span>
<span class="n">root</span>        <span class="mi">1421</span>  <span class="mf">5.5</span>  <span class="mf">2.5</span> <span class="mi">1454268</span> <span class="mi">196984</span> <span class="err">?</span>      <span class="n">Ssl</span>  <span class="n">Aug19</span>  <span class="mi">56</span><span class="p">:</span><span class="mi">01</span> <span class="n">kubelet</span> <span class="o">--</span><span class="n">config</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">/</span><span class="n">kubelet</span><span class="o">.</span><span class="n">conf</span> <span class="o">--</span><span class="n">bootstrap</span><span class="o">-</span><span class="n">kubeconfig</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">/</span><span class="n">kubeconfig</span> <span class="o">--</span><span class="n">kubeconfig</span><span class="o">=/</span><span class="k">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">kubelet</span><span class="o">/</span><span class="n">kubeconfig</span> <span class="o">--</span><span class="n">container</span><span class="o">-</span><span class="n">runtime</span><span class="o">=</span><span class="k">remote</span> <span class="o">--</span><span class="n">container</span><span class="o">-</span><span class="n">runtime</span><span class="o">-</span><span class="n">endpoint</span><span class="o">=/</span><span class="k">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">crio</span><span class="o">/</span><span class="n">crio</span><span class="o">.</span><span class="n">sock</span> <span class="o">--</span><span class="n">runtime</span><span class="o">-</span><span class="n">cgroups</span><span class="o">=/</span><span class="n">system</span><span class="o">.</span><span class="n">slice</span><span class="o">/</span><span class="n">crio</span><span class="o">.</span><span class="n">service</span> <span class="o">--</span><span class="n">node</span><span class="o">-</span><span class="n">labels</span><span class="o">=</span><span class="n">node</span><span class="o">-</span><span class="n">role</span><span class="o">.</span><span class="n">kubernetes</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">worker</span><span class="p">,</span><span class="n">node</span><span class="o">.</span><span class="n">openshift</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">os_id</span><span class="o">=</span><span class="n">rhcos</span> <span class="o">--</span><span class="n">minimum</span><span class="o">-</span><span class="n">container</span><span class="o">-</span><span class="n">ttl</span><span class="o">-</span><span class="n">duration</span><span class="o">=</span><span class="mi">6</span><span class="n">m0s</span> <span class="o">--</span><span class="n">volume</span><span class="o">-</span><span class="n">plugin</span><span class="o">-</span><span class="n">dir</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">/</span><span class="n">kubelet</span><span class="o">-</span><span class="n">plugins</span><span class="o">/</span><span class="n">volume</span><span class="o">/</span><span class="n">exec</span> <span class="o">--</span><span class="n">cloud</span><span class="o">-</span><span class="n">provider</span><span class="o">=</span><span class="n">aws</span> <span class="o">--</span><span class="n">pod</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">container</span><span class="o">-</span><span class="n">image</span><span class="o">=</span><span class="n">quay</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">openshift</span><span class="o">-</span><span class="n">release</span><span class="o">-</span><span class="n">dev</span><span class="o">/</span><span class="n">ocp</span><span class="o">-</span><span class="n">v4</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">art</span><span class="o">-</span><span class="n">dev</span><span class="err">@</span><span class="n">sha256</span><span class="p">:</span><span class="mf">6e8</span><span class="n">bcc9c91267283f8b0edf1af0cb0d310c54d4f73905d9bcfb2a103a664fcb0</span> <span class="o">--</span><span class="n">v</span><span class="o">=</span><span class="mi">4</span>
<span class="n">root</span>     <span class="mi">2138381</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>   <span class="mi">9180</span>  <span class="mi">1060</span> <span class="err">?</span>        <span class="n">S</span><span class="o">+</span>   <span class="mi">10</span><span class="p">:</span><span class="mi">02</span>   <span class="mi">0</span><span class="p">:</span><span class="mi">00</span> <span class="n">grep</span> <span class="n">kubelet</span>
<span class="n">sh</span><span class="o">-</span><span class="mf">4.4</span><span class="c1"># grep pause /etc/crio/ -R</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">crio</span><span class="o">/</span><span class="n">seccomp</span><span class="o">.</span><span class="n">json</span><span class="p">:</span>             <span class="s2">&quot;pause&quot;</span><span class="p">,</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">crio</span><span class="o">/</span><span class="n">crio</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="mi">00</span><span class="o">-</span><span class="n">default</span><span class="p">:</span><span class="n">pause_image</span> <span class="o">=</span> <span class="s2">&quot;quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:6e8bcc9c91267283f8b0edf1af0cb0d310c54d4f73905d9bcfb2a103a664fcb0&quot;</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">crio</span><span class="o">/</span><span class="n">crio</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="mi">00</span><span class="o">-</span><span class="n">default</span><span class="p">:</span><span class="n">pause_image_auth_file</span> <span class="o">=</span> <span class="s2">&quot;/var/lib/kubelet/config.json&quot;</span>
<span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">crio</span><span class="o">/</span><span class="n">crio</span><span class="o">.</span><span class="n">conf</span><span class="o">.</span><span class="n">d</span><span class="o">/</span><span class="mi">00</span><span class="o">-</span><span class="n">default</span><span class="p">:</span><span class="n">pause_command</span> <span class="o">=</span> <span class="s2">&quot;/usr/bin/pod&quot;</span>
</code></pre></div>
</td></tr></table></p>
<p>That <code class="highlight">--pod-infra-container-image=</code> pod version is for the pause container; although as you can see above, the pause_image in crio.conf.d is always updated: 
<a href="https://stackoverflow.com/questions/46630377/what-is-pod-infra-container-image-meant-for">https://stackoverflow.com/questions/46630377/what-is-pod-infra-container-image-meant-for</a>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nv">The</span> <span class="k">pause</span> <span class="nv">container</span>, <span class="nv">which</span> <span class="nv">image</span> <span class="nv">the</span> <span class="o">--</span><span class="nv">pod</span><span class="o">-</span><span class="nv">infra</span><span class="o">-</span><span class="nv">container</span> <span class="nv">flag</span> <span class="nv">selects</span>, <span class="nv">is</span> <span class="nv">used</span> <span class="nv">so</span> <span class="nv">that</span> <span class="nv">multiple</span> <span class="nv">containers</span> <span class="nv">can</span> <span class="nv">be</span> <span class="nv">launched</span> <span class="nv">in</span> <span class="nv">a</span> <span class="nv">pod</span>, <span class="k">while</span> <span class="nv">sharing</span> <span class="nv">resources</span>. <span class="nv">It</span> <span class="nv">mostly</span> <span class="nv">does</span> <span class="nv">nothing</span>, <span class="nv">and</span> <span class="nv">unless</span> <span class="nv">you</span> <span class="nv">have</span> <span class="nv">a</span> <span class="nv">very</span> <span class="nv">good</span> <span class="nv">reason</span> <span class="nv">to</span> <span class="nv">replace</span> <span class="nv">it</span> <span class="nv">with</span> <span class="nv">something</span> <span class="nv">custom</span>, <span class="nv">you</span> <span class="nv">shouldn</span><span class="s1">&#39;</span><span class="s">t. It mostly invokes the pause system call (hence its name) but it also performs the important function of having PID 1 and making sure no zombie processes are kept around.</span>

<span class="nv">An</span> <span class="nv">extremely</span> <span class="nv">complete</span> <span class="nv">article</span> <span class="nv">on</span> <span class="nv">the</span> <span class="nv">subject</span> <span class="nv">can</span> <span class="nv">be</span> <span class="nv">found</span> <span class="nv">here</span>, <span class="nv">from</span> <span class="nv">where</span> <span class="nv">I</span> <span class="nv">also</span> <span class="nv">shamelessly</span> <span class="nv">stole</span> <span class="nv">the</span> <span class="nv">following</span> <span class="nv">picture</span> <span class="nv">which</span> <span class="nv">illustrates</span> <span class="nv">where</span> <span class="nv">the</span> <span class="k">pause</span> <span class="nv">container</span> <span class="nv">lives</span>:
</code></pre></div>
</td></tr></table></p>
<p>According to <a href="https://github.com/kubernetes/kubernetes/pull/70603">https://github.com/kubernetes/kubernetes/pull/70603</a> (although that comment is from 2018):
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nv">The</span> <span class="nv">kubelet</span> <span class="nv">allows</span> <span class="nv">you</span> <span class="nv">to</span> <span class="nv">set</span> <span class="o">--</span><span class="nv">pod</span><span class="o">-</span><span class="nv">infra</span><span class="o">-</span><span class="nv">container</span><span class="o">-</span><span class="nv">image</span>
<span class="ss">(</span><span class="nv">also</span> <span class="nv">called</span> <span class="nv">PodSandboxImage</span> <span class="nv">in</span> <span class="nv">the</span> <span class="nv">kubelet</span> <span class="nv">config</span><span class="ss">)</span>,
<span class="nv">which</span> <span class="nv">can</span> <span class="nv">be</span> <span class="nv">a</span> <span class="nv">custom</span> <span class="nv">location</span> <span class="nv">to</span> <span class="nv">the</span> <span class="s2">&quot;</span><span class="s">pause</span><span class="s2">&quot;</span> <span class="nv">image</span> <span class="nv">in</span> <span class="nv">the</span> <span class="nv">case</span>
<span class="nv">of</span> <span class="nv">Docker</span>. <span class="nv">Other</span> <span class="nv">CRIs</span> <span class="nv">are</span> <span class="nv">not</span> <span class="nv">supported</span>.
</code></pre></div>
</td></tr></table></p>
<p>And according to <a href="https://github.com/kubernetes/kubernetes/issues/86081">https://github.com/kubernetes/kubernetes/issues/86081</a> (from November 2019):
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code>Kubelet flag &quot;pod-infra-container-image&quot; is invalid when using CRI-O
</code></pre></div>
</td></tr></table></p>
<p>And according to the kubelet help, this only affects docker and doesn't affect us:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="nv">sh</span><span class="o">-</span><span class="mi">4</span>.<span class="mi">4</span># <span class="nv">kubelet</span> <span class="o">--</span><span class="nv">help</span> <span class="o">|</span> <span class="nv">grep</span> <span class="nv">infra</span>
      <span class="o">--</span><span class="nv">pod</span><span class="o">-</span><span class="nv">infra</span><span class="o">-</span><span class="nv">container</span><span class="o">-</span><span class="nv">image</span> <span class="nv">string</span>                                                                          <span class="nv">The</span> <span class="nv">image</span> <span class="nv">whose</span> <span class="nv">network</span><span class="o">/</span><span class="nv">ipc</span> <span class="nv">namespaces</span> <span class="nv">containers</span> <span class="nv">in</span> <span class="nv">each</span> <span class="nv">pod</span> <span class="nv">will</span> <span class="nv">use</span>. <span class="nv">This</span> <span class="nv">docker</span><span class="o">-</span><span class="nv">specific</span> <span class="nv">flag</span> <span class="nv">only</span> <span class="nv">works</span> <span class="nv">when</span> <span class="nv">container</span><span class="o">-</span><span class="nv">runtime</span> <span class="nv">is</span> <span class="nv">set</span> <span class="nv">to</span> <span class="nv">docker</span>. <span class="ss">(</span><span class="nv">default</span> <span class="s2">&quot;</span><span class="s">k8s.gcr.io/pause:3.2</span><span class="s2">&quot;</span><span class="ss">)</span>
</code></pre></div>
</td></tr></table></p>
<p>As an additional step just to bring the infra nodes in line with the workers and the rest of the cluster, we could update that by inspecting the current worker kubelet configuration and then modify this post-upgrade:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1</span>
<span class="normal">2</span>
<span class="normal">3</span>
<span class="normal">4</span>
<span class="normal">5</span>
<span class="normal">6</span>
<span class="normal">7</span>
<span class="normal">8</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">akaris@linux ipi</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">machineconfig</span><span class="w"> </span><span class="mi">01</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">kubelet</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">yaml</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="n">pod</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">container</span><span class="o">-</span><span class="nc">image</span><span class="w"></span>
<span class="w">                </span><span class="o">--</span><span class="n">pod</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">container</span><span class="o">-</span><span class="nc">image</span><span class="o">=</span><span class="n">quay</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">openshift</span><span class="o">-</span><span class="k">release</span><span class="o">-</span><span class="n">dev</span><span class="o">/</span><span class="n">ocp</span><span class="o">-</span><span class="n">v4</span><span class="mf">.0</span><span class="o">-</span><span class="n">art</span><span class="o">-</span><span class="n">dev</span><span class="nv">@sha256</span><span class="err">:</span><span class="mf">6e8</span><span class="n">bcc9c91267283f8b0edf1af0cb0d310c54d4f73905d9bcfb2a103a664fcb0</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="o">[</span><span class="n">akaris@linux ipi</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">machineconfig</span><span class="w"> </span><span class="mi">03</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">kubelet</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">yaml</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="n">pod</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">container</span><span class="o">-</span><span class="nc">image</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="n">apiVersion</span><span class="w"></span>
<span class="w">                  </span><span class="o">--</span><span class="n">pod</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">container</span><span class="o">-</span><span class="nc">image</span><span class="o">=</span><span class="n">quay</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="n">openshift</span><span class="o">-</span><span class="k">release</span><span class="o">-</span><span class="n">dev</span><span class="o">/</span><span class="n">ocp</span><span class="o">-</span><span class="n">v4</span><span class="mf">.0</span><span class="o">-</span><span class="n">art</span><span class="o">-</span><span class="n">dev</span><span class="nv">@sha256</span><span class="err">:</span><span class="n">dc0fe885d41cc4029caa3feacf71343806c81c8123abc91db90dc0e555fa5636</span><span class="w"> </span><span class="err">\</span><span class="w"></span>
<span class="o">[</span><span class="n">akaris@linux ipi</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="n">edit</span><span class="w"> </span><span class="n">machineconfig</span><span class="w"> </span><span class="mi">03</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">kubelet</span><span class="w"></span>
<span class="n">machineconfig</span><span class="p">.</span><span class="n">machineconfiguration</span><span class="p">.</span><span class="n">openshift</span><span class="p">.</span><span class="n">io</span><span class="o">/</span><span class="mi">03</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">kubelet</span><span class="w"> </span><span class="n">edited</span><span class="w"></span>
<span class="o">[</span><span class="n">akaris@linux ipi</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">machineconfig</span><span class="w"> </span><span class="mi">03</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">kubelet</span><span class="w"> </span><span class="o">-</span><span class="n">o</span><span class="w"> </span><span class="n">yaml</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="n">pod</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">container</span><span class="o">-</span><span class="nc">image</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="o">-</span><span class="n">v</span><span class="w"> </span><span class="n">apiVersion</span><span class="w"></span>
<span class="w">                  </span><span class="c1">--pod-infra-container-image=quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:6e8bcc9c91267283f8b0edf1af0cb0d310c54d4f73905d9bcfb2a103a664fcb0 \</span>
</code></pre></div>
</td></tr></table></p>
<p>Which will then trigger a restart of the infra nodes:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="o">[</span><span class="n">akaris@linux ipi</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">machineconfigpool</span><span class="w"></span>
<span class="n">NAME</span><span class="w">     </span><span class="n">CONFIG</span><span class="w">                                             </span><span class="n">UPDATED</span><span class="w">   </span><span class="n">UPDATING</span><span class="w">   </span><span class="n">DEGRADED</span><span class="w">   </span><span class="n">MACHINECOUNT</span><span class="w">   </span><span class="n">READYMACHINECOUNT</span><span class="w">   </span><span class="n">UPDATEDMACHINECOUNT</span><span class="w">   </span><span class="n">DEGRADEDMACHINECOUNT</span><span class="w">   </span><span class="n">AGE</span><span class="w"></span>
<span class="n">infra</span><span class="w">    </span><span class="n">rendered</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">aa17b9b35abf210691d268dd4c7449d3</span><span class="w">    </span><span class="k">False</span><span class="w">     </span><span class="k">True</span><span class="w">       </span><span class="k">False</span><span class="w">      </span><span class="mi">3</span><span class="w">              </span><span class="mi">0</span><span class="w">                   </span><span class="mi">0</span><span class="w">                     </span><span class="mi">0</span><span class="w">                      </span><span class="mi">17</span><span class="n">h</span><span class="w"></span>
<span class="n">master</span><span class="w">   </span><span class="n">rendered</span><span class="o">-</span><span class="n">master</span><span class="o">-</span><span class="mi">2</span><span class="n">cc3abe4c49c6db04d9456744d0079f9</span><span class="w">   </span><span class="k">True</span><span class="w">      </span><span class="k">False</span><span class="w">      </span><span class="k">False</span><span class="w">      </span><span class="mi">3</span><span class="w">              </span><span class="mi">3</span><span class="w">                   </span><span class="mi">3</span><span class="w">                     </span><span class="mi">0</span><span class="w">                      </span><span class="mi">19</span><span class="n">h</span><span class="w"></span>
<span class="n">worker</span><span class="w">   </span><span class="n">rendered</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">d65740ba72e305c96782a27b8255dd89</span><span class="w">   </span><span class="k">True</span><span class="w">      </span><span class="k">False</span><span class="w">      </span><span class="k">False</span><span class="w">      </span><span class="mi">3</span><span class="w">              </span><span class="mi">3</span><span class="w">                   </span><span class="mi">3</span><span class="w">                     </span><span class="mi">0</span><span class="w">                      </span><span class="mi">19</span><span class="n">h</span><span class="w"></span>
<span class="o">[</span><span class="n">akaris@linux ipi</span><span class="o">]</span><span class="err">$</span><span class="w"> </span><span class="n">oc</span><span class="w"> </span><span class="k">get</span><span class="w"> </span><span class="n">machineconfig</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">grep</span><span class="w"> </span><span class="n">infra</span><span class="w"></span>
<span class="mi">03</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">kubelet</span><span class="w">                                                                                       </span><span class="mf">2.2.0</span><span class="w">             </span><span class="mi">17</span><span class="n">h</span><span class="w"></span>
<span class="n">rendered</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">aa17b9b35abf210691d268dd4c7449d3</span><span class="w">             </span><span class="mi">807</span><span class="n">abb900cf9976a1baad66eab17c6d76016e7b7</span><span class="w">   </span><span class="mf">2.2.0</span><span class="w">             </span><span class="mi">17</span><span class="n">h</span><span class="w"></span>
<span class="n">rendered</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">d63625ee2cdc4637cc156a1ebf25e926</span><span class="w">             </span><span class="mi">601</span><span class="n">c2285f497bf7c73d84737b9977a0e697cb86a</span><span class="w">   </span><span class="mf">2.2.0</span><span class="w">             </span><span class="mi">17</span><span class="n">h</span><span class="w"></span>
<span class="n">rendered</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">f3df01ebf7429a29582f3c46132fcf88</span><span class="w">             </span><span class="mi">807</span><span class="n">abb900cf9976a1baad66eab17c6d76016e7b7</span><span class="w">   </span><span class="mf">2.2.0</span><span class="w">             </span><span class="mi">44</span><span class="n">s</span><span class="w"></span>
<span class="o">[</span><span class="n">akaris@linux ipi</span><span class="o">]</span><span class="err">$</span><span class="w"> </span>
</code></pre></div>
</td></tr></table></p>
<p>And then eventually:
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 1</span>
<span class="normal"> 2</span>
<span class="normal"> 3</span>
<span class="normal"> 4</span>
<span class="normal"> 5</span>
<span class="normal"> 6</span>
<span class="normal"> 7</span>
<span class="normal"> 8</span>
<span class="normal"> 9</span>
<span class="normal">10</span>
<span class="normal">11</span>
<span class="normal">12</span>
<span class="normal">13</span>
<span class="normal">14</span>
<span class="normal">15</span>
<span class="normal">16</span>
<span class="normal">17</span>
<span class="normal">18</span>
<span class="normal">19</span>
<span class="normal">20</span>
<span class="normal">21</span>
<span class="normal">22</span>
<span class="normal">23</span>
<span class="normal">24</span>
<span class="normal">25</span>
<span class="normal">26</span>
<span class="normal">27</span>
<span class="normal">28</span>
<span class="normal">29</span>
<span class="normal">30</span>
<span class="normal">31</span>
<span class="normal">32</span>
<span class="normal">33</span>
<span class="normal">34</span>
<span class="normal">35</span>
<span class="normal">36</span></pre></div></td><td class="code"><div class="highlight"><pre><span></span><code><span class="p">[</span><span class="n">akaris</span><span class="err">@</span><span class="n">linux</span> <span class="n">ipi</span><span class="p">]</span><span class="o">$</span> <span class="n">oc</span> <span class="n">get</span> <span class="n">nodes</span>
<span class="n">NAME</span>                                         <span class="n">STATUS</span>   <span class="n">ROLES</span>    <span class="n">AGE</span>   <span class="n">VERSION</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">128</span><span class="o">-</span><span class="mf">80.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="n">infra</span>    <span class="mi">17</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">145</span><span class="o">-</span><span class="mf">35.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="n">infra</span>    <span class="mi">17</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">148</span><span class="o">-</span><span class="mf">174.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>   <span class="n">Ready</span>    <span class="n">worker</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">159</span><span class="o">-</span><span class="mf">154.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>   <span class="n">Ready</span>    <span class="n">infra</span>    <span class="mi">17</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">159</span><span class="o">-</span><span class="mf">35.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="k">master</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">168</span><span class="o">-</span><span class="mf">64.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="k">master</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">191</span><span class="o">-</span><span class="mf">238.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>   <span class="n">Ready</span>    <span class="n">worker</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">208</span><span class="o">-</span><span class="mf">80.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="k">master</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">220</span><span class="o">-</span><span class="mf">32.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>    <span class="n">Ready</span>    <span class="n">worker</span>   <span class="mi">19</span><span class="n">h</span>   <span class="n">v1</span><span class="o">.</span><span class="mf">18.3</span><span class="o">+</span><span class="mi">08</span><span class="n">c38ef</span>
<span class="p">[</span><span class="n">akaris</span><span class="err">@</span><span class="n">linux</span> <span class="n">ipi</span><span class="p">]</span><span class="o">$</span> <span class="n">oc</span> <span class="n">get</span> <span class="n">machineconfigpool</span>
<span class="n">NAME</span>     <span class="n">CONFIG</span>                                             <span class="n">UPDATED</span>   <span class="n">UPDATING</span>   <span class="n">DEGRADED</span>   <span class="n">MACHINECOUNT</span>   <span class="n">READYMACHINECOUNT</span>   <span class="n">UPDATEDMACHINECOUNT</span>   <span class="n">DEGRADEDMACHINECOUNT</span>   <span class="n">AGE</span>
<span class="n">infra</span>    <span class="n">rendered</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">f3df01ebf7429a29582f3c46132fcf88</span>    <span class="n">True</span>      <span class="n">False</span>      <span class="n">False</span>      <span class="mi">3</span>              <span class="mi">3</span>                   <span class="mi">3</span>                     <span class="mi">0</span>                      <span class="mi">18</span><span class="n">h</span>
<span class="k">master</span>   <span class="n">rendered</span><span class="o">-</span><span class="k">master</span><span class="o">-</span><span class="mi">2</span><span class="n">cc3abe4c49c6db04d9456744d0079f9</span>   <span class="n">True</span>      <span class="n">False</span>      <span class="n">False</span>      <span class="mi">3</span>              <span class="mi">3</span>                   <span class="mi">3</span>                     <span class="mi">0</span>                      <span class="mi">19</span><span class="n">h</span>
<span class="n">worker</span>   <span class="n">rendered</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">d65740ba72e305c96782a27b8255dd89</span>   <span class="n">True</span>      <span class="n">False</span>      <span class="n">False</span>      <span class="mi">3</span>              <span class="mi">3</span>                   <span class="mi">3</span>                     <span class="mi">0</span>                      <span class="mi">19</span><span class="n">h</span>
<span class="p">[</span><span class="n">akaris</span><span class="err">@</span><span class="n">linux</span> <span class="n">ipi</span><span class="p">]</span><span class="o">$</span> <span class="n">oc</span> <span class="n">get</span> <span class="n">machines</span>
<span class="n">NAME</span>                                    <span class="n">PHASE</span>     <span class="n">TYPE</span>        <span class="n">REGION</span>      <span class="n">ZONE</span>         <span class="n">AGE</span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="o">-</span><span class="n">fctd5</span>    <span class="n">Running</span>   <span class="n">m5</span><span class="o">.</span><span class="n">large</span>    <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span>   <span class="mi">18</span><span class="n">h</span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="o">-</span><span class="n">xtpcv</span>    <span class="n">Running</span>   <span class="n">m5</span><span class="o">.</span><span class="n">large</span>    <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span>   <span class="mi">18</span><span class="n">h</span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="o">-</span><span class="n">zmvzh</span>    <span class="n">Running</span>   <span class="n">m5</span><span class="o">.</span><span class="n">large</span>    <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span>   <span class="mi">18</span><span class="n">h</span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="k">master</span><span class="o">-</span><span class="mi">0</span>                  <span class="n">Running</span>   <span class="n">m5</span><span class="o">.</span><span class="n">xlarge</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span>   <span class="mi">19</span><span class="n">h</span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="k">master</span><span class="o">-</span><span class="mi">1</span>                  <span class="n">Running</span>   <span class="n">m5</span><span class="o">.</span><span class="n">xlarge</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">b</span>   <span class="mi">19</span><span class="n">h</span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="k">master</span><span class="o">-</span><span class="mi">2</span>                  <span class="n">Running</span>   <span class="n">m5</span><span class="o">.</span><span class="n">xlarge</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">c</span>   <span class="mi">19</span><span class="n">h</span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span><span class="o">-</span><span class="mi">4</span><span class="n">krrd</span>   <span class="n">Running</span>   <span class="n">m5</span><span class="o">.</span><span class="n">large</span>    <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">a</span>   <span class="mi">19</span><span class="n">h</span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">b</span><span class="o">-</span><span class="mi">59</span><span class="n">z6n</span>   <span class="n">Running</span>   <span class="n">m5</span><span class="o">.</span><span class="n">large</span>    <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">b</span>   <span class="mi">19</span><span class="n">h</span>
<span class="n">akaris2</span><span class="o">-</span><span class="n">f74ht</span><span class="o">-</span><span class="n">worker</span><span class="o">-</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">c</span><span class="o">-</span><span class="n">chst9</span>   <span class="n">Running</span>   <span class="n">m5</span><span class="o">.</span><span class="n">large</span>    <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span>   <span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">c</span>   <span class="mi">19</span><span class="n">h</span>
<span class="p">[</span><span class="n">akaris</span><span class="err">@</span><span class="n">linux</span> <span class="n">ipi</span><span class="p">]</span><span class="o">$</span> <span class="n">oc</span> <span class="n">debug</span> <span class="n">node</span><span class="o">/</span><span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">128</span><span class="o">-</span><span class="mf">80.</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mf">3.</span><span class="n">compute</span><span class="o">.</span><span class="n">internal</span>
<span class="n">Starting</span> <span class="n">pod</span><span class="o">/</span><span class="n">ip</span><span class="o">-</span><span class="mi">10</span><span class="o">-</span><span class="mi">0</span><span class="o">-</span><span class="mi">128</span><span class="o">-</span><span class="mi">80</span><span class="n">eu</span><span class="o">-</span><span class="n">west</span><span class="o">-</span><span class="mi">3</span><span class="n">computeinternal</span><span class="o">-</span><span class="n">debug</span> <span class="o">...</span>
<span class="n">To</span> <span class="n">use</span> <span class="n">host</span> <span class="n">binaries</span><span class="p">,</span> <span class="n">run</span> <span class="err">`</span><span class="n">chroot</span> <span class="o">/</span><span class="n">host</span><span class="err">`</span>
<span class="n">Pod</span> <span class="n">IP</span><span class="p">:</span> <span class="mf">10.0</span><span class="o">.</span><span class="mf">128.80</span>
<span class="n">If</span> <span class="n">you</span> <span class="n">don</span><span class="s1">&#39;t see a command prompt, try pressing enter.</span>
<span class="n">sh</span><span class="o">-</span><span class="mf">4.2</span><span class="c1"># chroot /host</span>
<span class="n">sh</span><span class="o">-</span><span class="mf">4.4</span><span class="c1"># ps aux | grep kubelet</span>
<span class="n">root</span>        <span class="mi">1411</span>  <span class="mf">3.5</span>  <span class="mf">1.8</span> <span class="mi">1484684</span> <span class="mi">147368</span> <span class="err">?</span>      <span class="n">Ssl</span>  <span class="mi">10</span><span class="p">:</span><span class="mi">16</span>   <span class="mi">0</span><span class="p">:</span><span class="mi">23</span> <span class="n">kubelet</span> <span class="o">--</span><span class="n">config</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">/</span><span class="n">kubelet</span><span class="o">.</span><span class="n">conf</span> <span class="o">--</span><span class="n">bootstrap</span><span class="o">-</span><span class="n">kubeconfig</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">/</span><span class="n">kubeconfig</span> <span class="o">--</span><span class="n">kubeconfig</span><span class="o">=/</span><span class="k">var</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">kubelet</span><span class="o">/</span><span class="n">kubeconfig</span> <span class="o">--</span><span class="n">container</span><span class="o">-</span><span class="n">runtime</span><span class="o">=</span><span class="k">remote</span> <span class="o">--</span><span class="n">container</span><span class="o">-</span><span class="n">runtime</span><span class="o">-</span><span class="n">endpoint</span><span class="o">=/</span><span class="k">var</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">crio</span><span class="o">/</span><span class="n">crio</span><span class="o">.</span><span class="n">sock</span> <span class="o">--</span><span class="n">runtime</span><span class="o">-</span><span class="n">cgroups</span><span class="o">=/</span><span class="n">system</span><span class="o">.</span><span class="n">slice</span><span class="o">/</span><span class="n">crio</span><span class="o">.</span><span class="n">service</span> <span class="o">--</span><span class="n">node</span><span class="o">-</span><span class="n">labels</span><span class="o">=</span><span class="n">node</span><span class="o">-</span><span class="n">role</span><span class="o">.</span><span class="n">kubernetes</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">infra</span><span class="p">,</span><span class="n">node</span><span class="o">.</span><span class="n">openshift</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">os_id</span><span class="o">=</span><span class="n">rhcos</span> <span class="o">--</span><span class="n">minimum</span><span class="o">-</span><span class="n">container</span><span class="o">-</span><span class="n">ttl</span><span class="o">-</span><span class="n">duration</span><span class="o">=</span><span class="mi">6</span><span class="n">m0s</span> <span class="o">--</span><span class="n">volume</span><span class="o">-</span><span class="n">plugin</span><span class="o">-</span><span class="n">dir</span><span class="o">=/</span><span class="n">etc</span><span class="o">/</span><span class="n">kubernetes</span><span class="o">/</span><span class="n">kubelet</span><span class="o">-</span><span class="n">plugins</span><span class="o">/</span><span class="n">volume</span><span class="o">/</span><span class="n">exec</span> <span class="o">--</span><span class="n">cloud</span><span class="o">-</span><span class="n">provider</span><span class="o">=</span><span class="n">aws</span> <span class="o">--</span><span class="n">pod</span><span class="o">-</span><span class="n">infra</span><span class="o">-</span><span class="n">container</span><span class="o">-</span><span class="n">image</span><span class="o">=</span><span class="n">quay</span><span class="o">.</span><span class="n">io</span><span class="o">/</span><span class="n">openshift</span><span class="o">-</span><span class="n">release</span><span class="o">-</span><span class="n">dev</span><span class="o">/</span><span class="n">ocp</span><span class="o">-</span><span class="n">v4</span><span class="o">.</span><span class="mi">0</span><span class="o">-</span><span class="n">art</span><span class="o">-</span><span class="n">dev</span><span class="err">@</span><span class="n">sha256</span><span class="p">:</span><span class="mf">6e8</span><span class="n">bcc9c91267283f8b0edf1af0cb0d310c54d4f73905d9bcfb2a103a664fcb0</span> <span class="o">--</span><span class="n">v</span><span class="o">=</span><span class="mi">4</span>
<span class="n">root</span>       <span class="mi">17471</span>  <span class="mf">0.0</span>  <span class="mf">0.0</span>   <span class="mi">9180</span>  <span class="mi">1052</span> <span class="err">?</span>        <span class="n">S</span><span class="o">+</span>   <span class="mi">10</span><span class="p">:</span><span class="mi">27</span>   <span class="mi">0</span><span class="p">:</span><span class="mi">00</span> <span class="n">grep</span> <span class="n">kubelet</span>
</code></pre></div>
</td></tr></table></p>
                
                  
                    

<hr>
<div class="md-source-date">
  <small>
    
      Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">September 13, 2020</span>
    
  </small>
</div>
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../how_rhcos_updates_work/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              How RHCOS updates work
            </div>
          </div>
        </a>
      
      
        <a href="../ingresscontroller_router_sharding_ocp_on_osp/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Ingress Controller Sharding OCP on OSP
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["toc.integrate"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
    
  </body>
</html>