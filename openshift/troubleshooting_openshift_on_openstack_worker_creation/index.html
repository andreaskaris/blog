
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.1.2, mkdocs-material-7.0.6">
    
    
      
        <title>Troubleshooting OpenShift on OpenStack worker creation - Andreas Karis Blog</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2c0c5eaf.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.7fa14f5b.min.css">
        
          
          
          <meta name="theme-color" content="#546d78">
        
      
    
    
    
      
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&display=fallback">
        <style>:root{--md-text-font-family:"Roboto";--md-code-font-family:"Roboto Mono"}</style>
      
    
    
    
    
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="blue-grey" data-md-color-accent="red">
      
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#troubleshooting-openshift-on-openstack-worker-creation" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Andreas Karis Blog" class="md-header__button md-logo" aria-label="Andreas Karis Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Andreas Karis Blog
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Troubleshooting OpenShift on OpenStack worker creation
            
          </span>
        </div>
      </div>
    </div>
    <div class="md-header__options">
      
    </div>
    
    
  </nav>
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  

<nav class="md-nav md-nav--primary md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Andreas Karis Blog" class="md-nav__button md-logo" aria-label="Andreas Karis Blog" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54z"/></svg>

    </a>
    Andreas Karis Blog
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        Home
      </a>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_2" type="checkbox" id="__nav_2" >
      
      <label class="md-nav__link" for="__nav_2">
        Ceph
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Ceph" data-md-level="1">
        <label class="md-nav__title" for="__nav_2">
          <span class="md-nav__icon md-icon"></span>
          Ceph
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../ceph/ceph-manual-test/" class="md-nav__link">
        Ceph manual test with qemu
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_3" type="checkbox" id="__nav_3" >
      
      <label class="md-nav__link" for="__nav_3">
        Containers
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Containers" data-md-level="1">
        <label class="md-nav__title" for="__nav_3">
          <span class="md-nav__icon md-icon"></span>
          Containers
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/cgroups/" class="md-nav__link">
        cgroups
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/containers/" class="md-nav__link">
        Containers in Linux
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../list_docker_registry_containers/" class="md-nav__link">
        List container images in registry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/namespaces/" class="md-nav__link">
        namespaces
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_4" type="checkbox" id="__nav_4" >
      
      <label class="md-nav__link" for="__nav_4">
        Linux
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Linux" data-md-level="1">
        <label class="md-nav__title" for="__nav_4">
          <span class="md-nav__icon md-icon"></span>
          Linux
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/cgroups/" class="md-nav__link">
        cgroups
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/containers/" class="md-nav__link">
        Containers in Linux
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/java-idrac-issues/" class="md-nav__link">
        Java Idrac Issues
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/hugepages/" class="md-nav__link">
        Hugepages
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/meson/" class="md-nav__link">
        meson
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/namespaces/" class="md-nav__link">
        namespaces
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/old_java_version_with_xorgs_in_container/" class="md-nav__link">
        Old Java inside a container with xorgs
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../linux/setting-journalctl-limits/" class="md-nav__link">
        Setting journalctl limits
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_5" type="checkbox" id="__nav_5" >
      
      <label class="md-nav__link" for="__nav_5">
        Networking
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="Networking" data-md-level="1">
        <label class="md-nav__title" for="__nav_5">
          <span class="md-nav__icon md-icon"></span>
          Networking
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/arp_and_the_neighbor_table/" class="md-nav__link">
        ARP and the Neighbor table
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/bpf-and-tcpdump/" class="md-nav__link">
        BPF and tcpdump
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/bonding_in_linux/" class="md-nav__link">
        Bonding in Linux
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/juniper_x520/" class="md-nav__link">
        Configure Juniper switch
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/haproxy-and-h2c/" class="md-nav__link">
        haproxy and HTTP/2
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/geneve_tunneling/" class="md-nav__link">
        Geneve tunneling
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/netlink/" class="md-nav__link">
        Netlink
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/ovn-kind/" class="md-nav__link">
        OVN kind
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/ovn_standalone_on_fedora31/" class="md-nav__link">
        OVN standalone on Fedora 31
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/ovs_recirculation/" class="md-nav__link">
        OVS packet recirculation
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/ovs-vxlan-tunnels-and-dscp/" class="md-nav__link">
        OVS VXLAN tunnels and DSCP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/ovs_with_gdb/" class="md-nav__link">
        OVS with GDB
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/sctp/" class="md-nav__link">
        SCTP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/wireguard/" class="md-nav__link">
        Wireguard
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
    
  
  
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_6" type="checkbox" id="__nav_6" checked>
      
      <label class="md-nav__link" for="__nav_6">
        OpenShift
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="OpenShift" data-md-level="1">
        <label class="md-nav__title" for="__nav_6">
          <span class="md-nav__icon md-icon"></span>
          OpenShift
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../alertmanager/" class="md-nav__link">
        AlertManager
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../cpu-manager-with-custom-machine-config-pool/" class="md-nav__link">
        CPU manager with custom MachineConfigPool
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../crio-conmon-runc/" class="md-nav__link">
        Crio vs conmon vs runc
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../etcd_perf/" class="md-nav__link">
        Etcd Performance tests
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../openshift_httpbin_tshark_sidecar/" class="md-nav__link">
        Httpbin tshark sidecar container
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../kubernetes_cluster/" class="md-nav__link">
        Hints for installing kubernetes on Fedora
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../HPA/" class="md-nav__link">
        Horizontal Pod Autoscaler
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../how_rhcos_updates_work/" class="md-nav__link">
        How RHCOS updates work
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ocp4-infra-nodes-with-machineset-without-worker-label/" class="md-nav__link">
        Infra nodes with MachineSets without worker label
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ingresscontroller_router_sharding_ocp_on_osp/" class="md-nav__link">
        Ingress Controller Sharding OCP on OSP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../ingress-controller-sharding-on-separate-vip/" class="md-nav__link">
        Ingress Controller Sharding on separate VIP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../openshift_mirror_registry/" class="md-nav__link">
        Installing a cluster with a mirror registry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../istio-1.6-on-ocp.4.x/" class="md-nav__link">
        Istio 1.6 on OpenShift 4.x
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../kata/" class="md-nav__link">
        kata containers and the kata operatora
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../kind-with-private-registry/" class="md-nav__link">
        Kind with private registry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../mounting-container-image/" class="md-nav__link">
        Mount a container image
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openstack/install_openshift_on_openstack/" class="md-nav__link">
        OpenShift on OpenStack
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../private-registry/" class="md-nav__link">
        Private container registry
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../proxy-ocp-4.5/" class="md-nav__link">
        Proxy OCP 4.5
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../scc/" class="md-nav__link">
        Security Context Constraints (SCC)
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../fix-selinux-labels-coreos/" class="md-nav__link">
        SElinux labels fix
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../networking/sctp/" class="md-nav__link">
        SCTP
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../openshift_troubleshooting_etcd_state/" class="md-nav__link">
        Troubleshooting etcd state
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../useful-ocp-curl/" class="md-nav__link">
        Querying the OCP 4.x upgrades info API
      </a>
    </li>
  

          
            
  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
        
      
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Troubleshooting OpenShift on OpenStack worker creation
      </a>
      
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_7" type="checkbox" id="__nav_7" >
      
      <label class="md-nav__link" for="__nav_7">
        OpenStack
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="OpenStack" data-md-level="1">
        <label class="md-nav__title" for="__nav_7">
          <span class="md-nav__icon md-icon"></span>
          OpenStack
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openstack/reattach_to_running_deployment/" class="md-nav__link">
        Reattach to running deployment
      </a>
    </li>
  

          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../openstack/using_clouds_yaml/" class="md-nav__link">
        Using clouds.yaml
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
      
      
      

  
  
  
    
    <li class="md-nav__item md-nav__item--nested">
      
      
        <input class="md-nav__toggle md-toggle" data-md-toggle="__nav_8" type="checkbox" id="__nav_8" >
      
      <label class="md-nav__link" for="__nav_8">
        OperatorSDK
        <span class="md-nav__icon md-icon"></span>
      </label>
      <nav class="md-nav" aria-label="OperatorSDK" data-md-level="1">
        <label class="md-nav__title" for="__nav_8">
          <span class="md-nav__icon md-icon"></span>
          OperatorSDK
        </label>
        <ul class="md-nav__list" data-md-scrollfix>
          
            
  
  
  
    <li class="md-nav__item">
      <a href="../../operator-sdk/operator-sdk-reconciliation/" class="md-nav__link">
        Controller Reconciliation
      </a>
    </li>
  

          
        </ul>
      </nav>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="troubleshooting-openshift-on-openstack-worker-creation">Troubleshooting OpenShift on OpenStack worker creation</h1>
<p>See <a href="https://bugzilla.redhat.com/show_bug.cgi?id=1785705">https://bugzilla.redhat.com/show_bug.cgi?id=1785705</a> for the bugzilla.</p>
<p>The following are steps which I executed in my lab to troubleshoot issues with worker creation for OpenShift on OpenStack.</p>
<pre><code>(overcloud) [stack@undercloud-0 clouds]$ oc describe machine -n openshift-machine-api osc-c5r5c-worker-bgt9b
Name:         osc-c5r5c-worker-bgt9b
Namespace:    openshift-machine-api
Labels:       machine.openshift.io/cluster-api-cluster=osc-c5r5c
              machine.openshift.io/cluster-api-machine-role=worker
              machine.openshift.io/cluster-api-machine-type=worker
              machine.openshift.io/cluster-api-machineset=osc-c5r5c-worker
Annotations:  &lt;none&gt;
API Version:  machine.openshift.io/v1beta1
Kind:         Machine
Metadata:
  Creation Timestamp:  2019-12-20T10:23:14Z
  Finalizers:
    machine.machine.openshift.io
  Generate Name:  osc-c5r5c-worker-
  Generation:     1
  Owner References:
    API Version:           machine.openshift.io/v1beta1
    Block Owner Deletion:  true
    Controller:            true
    Kind:                  MachineSet
    Name:                  osc-c5r5c-worker
    UID:                   9077b6df-2312-11ea-9b6c-fa163e431263
  Resource Version:        3455
  Self Link:               /apis/machine.openshift.io/v1beta1/namespaces/openshift-machine-api/machines/osc-c5r5c-worker-bgt9b
  UID:                     bb0af782-2312-11ea-9b6c-fa163e431263
Spec:
  Metadata:
    Creation Timestamp:  &lt;nil&gt;
  Provider Spec:
    Value:
      API Version:  openstackproviderconfig.openshift.io/v1alpha1
      Cloud Name:   openstack
      Clouds Secret:
        Name:       openstack-cloud-credentials
        Namespace:  openshift-machine-api
      Flavor:       m1.openshift
      Image:        rhcos
      Kind:         OpenstackProviderSpec
      Metadata:
        Creation Timestamp:  &lt;nil&gt;
      Networks:
        Filter:
        Subnets:
          Filter:
            Name:  osc-c5r5c-nodes
            Tags:  openshiftClusterID=osc-c5r5c
      Security Groups:
        Filter:
        Name:  osc-c5r5c-worker
      Server Metadata:
        Name:                  osc-c5r5c-worker
        Openshift Cluster ID:  osc-c5r5c
      Tags:
        openshiftClusterID=osc-c5r5c
      Trunk:  true
      User Data Secret:
        Name:  worker-user-data
Events:        &lt;none&gt;
(overcloud) [stack@undercloud-0 clouds]$ oc get machine -n openshift-machine-api 
NAME                     STATE   TYPE   REGION   ZONE   AGE
osc-c5r5c-master-0                                      4h52m
osc-c5r5c-master-1                                      4h52m
osc-c5r5c-master-2                                      4h52m
osc-c5r5c-worker-bgt9b                                  4h51m
osc-c5r5c-worker-qphk7                                  4h51m
osc-c5r5c-worker-vs85h                                  4h51m
(overcloud) [stack@undercloud-0 clouds]$ oc get machineset -n openshift-machine-api 
NAME               DESIRED   CURRENT   READY   AVAILABLE   AGE
osc-c5r5c-worker   3         3                             4h54m
(overcloud) [stack@undercloud-0 clouds]$ 
</code></pre>

<pre><code>(overcloud) [stack@undercloud-0 clouds]$ kubectl get machineset -n openshift-machine-api osc-c5r5c-worker -o yaml
apiVersion: machine.openshift.io/v1beta1
kind: MachineSet
metadata:
  creationTimestamp: &quot;2019-12-20T10:22:02Z&quot;
  generation: 1
  labels:
    machine.openshift.io/cluster-api-cluster: osc-c5r5c
    machine.openshift.io/cluster-api-machine-role: worker
    machine.openshift.io/cluster-api-machine-type: worker
  name: osc-c5r5c-worker
  namespace: openshift-machine-api
  resourceVersion: &quot;3448&quot;
  selfLink: /apis/machine.openshift.io/v1beta1/namespaces/openshift-machine-api/machinesets/osc-c5r5c-worker
  uid: 9077b6df-2312-11ea-9b6c-fa163e431263
spec:
  replicas: 3
  selector:
    matchLabels:
      machine.openshift.io/cluster-api-cluster: osc-c5r5c
      machine.openshift.io/cluster-api-machineset: osc-c5r5c-worker
  template:
    metadata:
      creationTimestamp: null
      labels:
        machine.openshift.io/cluster-api-cluster: osc-c5r5c
        machine.openshift.io/cluster-api-machine-role: worker
        machine.openshift.io/cluster-api-machine-type: worker
        machine.openshift.io/cluster-api-machineset: osc-c5r5c-worker
    spec:
      metadata:
        creationTimestamp: null
      providerSpec:
        value:
          apiVersion: openstackproviderconfig.openshift.io/v1alpha1
          cloudName: openstack
          cloudsSecret:
            name: openstack-cloud-credentials
            namespace: openshift-machine-api
          flavor: m1.openshift
          image: rhcos
          kind: OpenstackProviderSpec
          metadata:
            creationTimestamp: null
          networks:
          - filter: {}
            subnets:
            - filter:
                name: osc-c5r5c-nodes
                tags: openshiftClusterID=osc-c5r5c
          securityGroups:
          - filter: {}
            name: osc-c5r5c-worker
          serverMetadata:
            Name: osc-c5r5c-worker
            openshiftClusterID: osc-c5r5c
          tags:
          - openshiftClusterID=osc-c5r5c
          trunk: true
          userDataSecret:
            name: worker-user-data
status:
  fullyLabeledReplicas: 3
  observedGeneration: 1
  replicas: 3
</code></pre>

<pre><code>/var/log/pods/openshift-machine-api_machine-api-controllers-f64b7f7b8-tm7qc_b1f05af2-2312-11ea-9b6c-fa163e431263/machine-controller/0.log
(...)
2019-12-20T10:23:14.635223358+00:00 stderr F E1220 10:23:14.635191       1 controller.go:239] Failed to check if machine &quot;osc-c5r5c-worker-bgt9b&quot; exists: Error checking if instance exists (machine/actuator.go 346): 
2019-12-20T10:23:14.635223358+00:00 stderr F Error getting a new instance service from the machine (machine/actuator.go 467): Create providerClient err: You must provide exactly one of DomainID or DomainName in a Scope with ProjectName
2019-12-20T10:23:15.636135623+00:00 stderr F I1220 10:23:15.635874       1 controller.go:133] Reconciling Machine &quot;osc-c5r5c-master-0&quot;
2019-12-20T10:23:15.636215058+00:00 stderr F I1220 10:23:15.636192       1 controller.go:304] Machine &quot;osc-c5r5c-master-0&quot; in namespace &quot;openshift-machine-api&quot; doesn't specify &quot;cluster.k8s.io/cluster-name&quot; label, assuming nil cluster
2019-12-20T10:23:15.641348382+00:00 stderr F E1220 10:23:15.641317       1 controller.go:239] Failed to check if machine &quot;osc-c5r5c-master-0&quot; exists: Error checking if instance exists (machine/actuator.go 346): 
2019-12-20T10:23:15.641348382+00:00 stderr F Error getting a new instance service from the machine (machine/actuator.go 467): Create providerClient err: You must provide exactly one of DomainID or DomainName in a Scope with ProjectName
2019-12-20T10:23:16.641614350+00:00 stderr F I1220 10:23:16.641562       1 controller.go:133] Reconciling Machine &quot;osc-c5r5c-master-1&quot;
2019-12-20T10:23:16.641614350+00:00 stderr F I1220 10:23:16.641591       1 controller.go:304] Machine &quot;osc-c5r5c-master-1&quot; in namespace &quot;openshift-machine-api&quot; doesn't specify &quot;cluster.k8s.io/cluster-name&quot; label, assuming nil cluster
2019-12-20T10:23:16.647323379+00:00 stderr F E1220 10:23:16.647295       1 controller.go:239] Failed to check if machine &quot;osc-c5r5c-master-1&quot; exists: Error checking if instance exists (machine/actuator.go 346): 
2019-12-20T10:23:16.647323379+00:00 stderr F Error getting a new instance service from the machine (machine/actuator.go 467): Create providerClient err: You must provide exactly one of DomainID or DomainName in a Scope with ProjectName
2019-12-20T10:23:17.647630531+00:00 stderr F I1220 10:23:17.647587       1 controller.go:133] Reconciling Machine &quot;osc-c5r5c-master-2&quot;
2019-12-20T10:23:17.647695173+00:00 stderr F I1220 10:23:17.647677       1 controller.go:304] Machine &quot;osc-c5r5c-master-2&quot; in namespace &quot;openshift-machine-api&quot; doesn't specify &quot;cluster.k8s.io/cluster-name&quot; label, assuming nil cluster
2019-12-20T10:23:17.652613228+00:00 stderr F E1220 10:23:17.652551       1 controller.go:239] Failed to check if machine &quot;osc-c5r5c-master-2&quot; exists: Error checking if instance exists (machine/actuator.go 346): 
2019-12-20T10:23:17.652613228+00:00 stderr F Error getting a new instance service from the machine (machine/actuator.go 467): Create providerClient err: You must provide exactly one of DomainID or DomainName in a Scope with ProjectName
2019-12-20T10:23:18.652945792+00:00 stderr F I1220 10:23:18.652884       1 controller.go:133] Reconciling Machine &quot;osc-c5r5c-worker-qphk7&quot;
</code></pre>

<p>Looking at the secret:</p>
<pre><code>(overcloud) [stack@undercloud-0 clouds]$ kubectl get secrets -n openshift-machine-api openstack-cloud-credentials -o yaml
apiVersion: v1
data:
  clouds.yaml: Y2xvdWRzOgogIG9wZW5zdGFjazoKICAgIGF1dGg6CiAgICAgIGFwcGxpY2F0aW9uX2NyZWRlbnRpYWxfaWQ6ICIiCiAgICAgIGFwcGxpY2F0aW9uX2NyZWRlbnRpYWxfbmFtZTogIiIKICAgICAgYXBwbGljYXRpb25fY3JlZGVudGlhbF9zZWNyZXQ6ICIiCiAgICAgIGF1dGhfdXJsOiBodHRwOi8vMTcyLjE2LjAuMTMwOjUwMDAvL3YzCiAgICAgIGRlZmF1bHRfZG9tYWluOiAiIgogICAgICBkb21haW5faWQ6ICIiCiAgICAgIGRvbWFpbl9uYW1lOiAiIgogICAgICBwYXNzd29yZDogelA0YmUydWtocENrajR6cVJmVWs4WGpRYgogICAgICBwcm9qZWN0X2RvbWFpbl9pZDogIiIKICAgICAgcHJvamVjdF9kb21haW5fbmFtZTogIiIKICAgICAgcHJvamVjdF9pZDogIiIKICAgICAgcHJvamVjdF9uYW1lOiBhZG1pbgogICAgICB0b2tlbjogIiIKICAgICAgdXNlcl9kb21haW5faWQ6ICIiCiAgICAgIHVzZXJfZG9tYWluX25hbWU6IERlZmF1bHQKICAgICAgdXNlcl9pZDogIiIKICAgICAgdXNlcm5hbWU6IGFkbWluCiAgICBhdXRoX3R5cGU6ICIiCiAgICBjYWNlcnQ6ICIiCiAgICBjZXJ0OiAiIgogICAgY2xvdWQ6ICIiCiAgICBpZGVudGl0eV9hcGlfdmVyc2lvbjogIjMiCiAgICBrZXk6ICIiCiAgICBwcm9maWxlOiAiIgogICAgcmVnaW9uX25hbWU6IHJlZ2lvbk9uZQogICAgcmVnaW9uczogbnVsbAogICAgdmVyaWZ5OiB0cnVlCiAgICB2b2x1bWVfYXBpX3ZlcnNpb246ICIiCg==
kind: Secret
metadata:
  annotations:
    cloudcredential.openshift.io/credentials-request: openshift-cloud-credential-operator/openshift-machine-api-openstack
  creationTimestamp: &quot;2019-12-20T10:23:00Z&quot;
  name: openstack-cloud-credentials
  namespace: openshift-machine-api
  resourceVersion: &quot;2525&quot;
  selfLink: /api/v1/namespaces/openshift-machine-api/secrets/openstack-cloud-credentials
  uid: b2bded52-2312-11ea-9b6c-fa163e431263
type: Opaque
</code></pre>

<pre><code>(overcloud) [stack@undercloud-0 clouds]$ base64 -d &lt;(echo 'Y2xvdWRzOgogIG9wZW5zdGFjazoKICAgIGF1dGg6CiAgICAgIGFwcGxpY2F0aW9uX2NyZWRlbnRpYWxfaWQ6ICIiCiAgICAgIGFwcGxpY2F0aW9uX2NyZWRlbnRpYWxfbmFtZTogIiIKICAgICAgYXBwbGljYXRpb25fY3JlZGVudGlhbF9zZWNyZXQ6ICIiCiAgICAgIGF1dGhfdXJsOiBodHRwOi8vMTcyLjE2LjAuMTMwOjUwMDAvL3YzCiAgICAgIGRlZmF1bHRfZG9tYWluOiAiIgogICAgICBkb21haW5faWQ6ICIiCiAgICAgIGRvbWFpbl9uYW1lOiAiIgogICAgICBwYXNzd29yZDogelA0YmUydWtocENrajR6cVJmVWs4WGpRYgogICAgICBwcm9qZWN0X2RvbWFpbl9pZDogIiIKICAgICAgcHJvamVjdF9kb21haW5fbmFtZTogIiIKICAgICAgcHJvamVjdF9pZDogIiIKICAgICAgcHJvamVjdF9uYW1lOiBhZG1pbgogICAgICB0b2tlbjogIiIKICAgICAgdXNlcl9kb21haW5faWQ6ICIiCiAgICAgIHVzZXJfZG9tYWluX25hbWU6IERlZmF1bHQKICAgICAgdXNlcl9pZDogIiIKICAgICAgdXNlcm5hbWU6IGFkbWluCiAgICBhdXRoX3R5cGU6ICIiCiAgICBjYWNlcnQ6ICIiCiAgICBjZXJ0OiAiIgogICAgY2xvdWQ6ICIiCiAgICBpZGVudGl0eV9hcGlfdmVyc2lvbjogIjMiCiAgICBrZXk6ICIiCiAgICBwcm9maWxlOiAiIgogICAgcmVnaW9uX25hbWU6IHJlZ2lvbk9uZQogICAgcmVnaW9uczogbnVsbAogICAgdmVyaWZ5OiB0cnVlCiAgICB2b2x1bWVfYXBpX3ZlcnNpb246ICIiCg==')
clouds:
  openstack:
    auth:
      application_credential_id: &quot;&quot;
      application_credential_name: &quot;&quot;
      application_credential_secret: &quot;&quot;
      auth_url: http://172.16.0.130:5000//v3
      default_domain: &quot;&quot;
      domain_id: &quot;&quot;
      domain_name: &quot;&quot;
      password: zP4be2ukhpCkj4zqRfUk8XjQb
      project_domain_id: &quot;&quot;
      project_domain_name: &quot;&quot;
      project_id: &quot;&quot;
      project_name: admin
      token: &quot;&quot;
      user_domain_id: &quot;&quot;
      user_domain_name: Default
      user_id: &quot;&quot;
      username: admin
    auth_type: &quot;&quot;
    cacert: &quot;&quot;
    cert: &quot;&quot;
    cloud: &quot;&quot;
    identity_api_version: &quot;3&quot;
    key: &quot;&quot;
    profile: &quot;&quot;
    region_name: regionOne
    regions: null
    verify: true
    volume_api_version: &quot;&quot;
</code></pre>

<pre><code>(overcloud) [stack@undercloud-0 clouds]$ cat clouds.yaml 
clouds:
  overcloud:
    auth:
      auth_url: http://172.16.0.130:5000//v3
      username: &quot;admin&quot;
      password: zP4be2ukhpCkj4zqRfUk8XjQb
      project_name: &quot;admin&quot;
      user_domain_name: &quot;Default&quot;
    region_name: &quot;regionOne&quot;
    interface: &quot;public&quot;
    identity_api_version: 3
</code></pre>

<p>The problem is in the generated secret:</p>
<pre><code>Error getting a new instance service from the machine (machine/actuator.go 467): Create providerClient err: You must provide exactly one of DomainID or DomainName in a Scope with ProjectName
</code></pre>

<p><a href="https://github.com/terraform-providers/terraform-provider-openstack/issues/267">https://github.com/terraform-providers/terraform-provider-openstack/issues/267</a></p>
<p>Whereas when I check here: <a href="https://egallen.com/openshift-42-on-openstack-13-gpu/">https://egallen.com/openshift-42-on-openstack-13-gpu/</a>  This blog article uses project_id, too.</p>
<pre><code>
clouds:
  openstack:
    auth:
      auth_url: http://192.168.168.54:5000/v3
      username: &quot;admin&quot;
      password: XXXXXXXXXXXXXX
      project_id: XXXXXXXXX
      project_name: &quot;admin&quot;
      user_domain_name: &quot;Default&quot;
    region_name: &quot;regionOne&quot;
    interface: &quot;public&quot;
    identity_api_version: 3
</code></pre>

<p>However, my clouds.yaml file is actually completely correct:</p>
<pre><code>[stack@undercloud-0 clouds]$ openstack --os-cloud overcloud token issue
+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Field      | Value                                                                                                                                                                                   |
+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| expires    | 2019-12-20T16:24:40+0000                                                                                                                                                                |
| id         | gAAAAABd_Oe4sLSSjwQiCPFhVK9PUFBehqVXbj-r96GdFvRieT51YZQUdm5lc5ic5VKYRFPg4jhPat4ZIdyow1QL-vZnxSK8MUAqUMQnc6xjs80JD-ibCNIg1Gac14Idp1CGIutsaUMS-Ms33LDgEw32S2qomv7LRUCLVcEBwrqwYLHXYE2ohyk |
| project_id | 1bb14f515f0945a4891fe3fa2372a795                                                                                                                                                        |
| user_id    | 0d3f5ab158c64c11b57d58c76d9675f0                                                                                                                                                        |
+------------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
</code></pre>

<p>I then tried with:</p>
<pre><code>clouds:
  openstack:
    auth:
      auth_url: http://172.16.0.130:5000//v3
      username: &quot;admin&quot;
      password: zP4be2ukhpCkj4zqRfUk8XjQb
      project_id: 1bb14f515f0945a4891fe3fa2372a795
      project_name: &quot;admin&quot;
      user_domain_name: &quot;Default&quot;
    region_name: &quot;regionOne&quot;
    interface: &quot;public&quot;
    identity_api_version: 3
</code></pre>

<blockquote>
<p>Note that I made 2 changes: project_id which I got from <code>openstack project list | grep admin</code> ; and I renamed the cloud credential to name <code>openstack</code>.</p>
</blockquote>
<p>This actually worked:</p>
<pre><code>(overcloud) [stack@undercloud-0 ~]$ openstack server list
+--------------------------------------+------------------------+--------+-------------------------------------------------------------------------+-------+--------------+
| ID                                   | Name                   | Status | Networks                                                                | Image | Flavor       |
+--------------------------------------+------------------------+--------+-------------------------------------------------------------------------+-------+--------------+
| 6726f1d5-977f-48da-9554-acf710d459fe | osc-6gzh2-worker-shw2w | ACTIVE | osc-6gzh2-openshift=172.31.0.28                                         | rhcos | m1.openshift |
| 37af5d51-bc08-4002-bb5b-380061d9efbf | osc-6gzh2-master-0     | ACTIVE | osc-6gzh2-openshift=172.31.0.24                                         | rhcos | m1.openshift |
| 4b52d095-e174-47ea-a699-85286f899f67 | osc-6gzh2-master-1     | ACTIVE | osc-6gzh2-openshift=172.31.0.16                                         | rhcos | m1.openshift |
| 73bb2012-d9ff-46e4-8e62-c6d723ca5711 | osc-6gzh2-master-2     | ACTIVE | osc-6gzh2-openshift=172.31.0.15                                         | rhcos | m1.openshift |
| 53e2da7f-1398-45d3-94e3-0008d8e209d9 | rhel-test1             | ACTIVE | private1=2000:192:168:0:f816:3eff:fe13:275, 192.168.0.113, 172.16.0.110 | rhel  | m1.small     |
+--------------------------------------+------------------------+--------+-------------------------------------------------------------------------+-------+--------------+
</code></pre>

<p>The cluster deployed:</p>
<pre><code>(overcloud) [stack@undercloud-0 clouds]$ ./openshift-install create cluster --dir=install-config/ --log-level=info
INFO Consuming &quot;Install Config&quot; from target directory 
INFO Creating infrastructure resources...         
INFO Waiting up to 30m0s for the Kubernetes API at https://api.osc.redhat.local:6443... 
INFO API v1.14.6+17b1cc6 up                       
INFO Waiting up to 30m0s for bootstrapping to complete... 
INFO Destroying the bootstrap resources...        
INFO Waiting up to 30m0s for the cluster at https://api.osc.redhat.local:6443 to initialize... 
INFO Waiting up to 10m0s for the openshift-console route to be created... 
INFO Install complete!                            
INFO To access the cluster as the system:admin user when using 'oc', run 'export KUBECONFIG=/home/stack/clouds/install-config/auth/kubeconfig' 
INFO Access the OpenShift web-console here: https://console-openshift-console.apps.osc.redhat.local 
INFO Login to the console with user: kubeadmin, password: vFKnm-d43eY-aMMBB-52xcU 
</code></pre>

<p>Now, there was an issue with 2 of the machines:</p>
<pre><code>(overcloud) [stack@undercloud-0 clouds]$ oc get machineset -A
NAMESPACE               NAME               DESIRED   CURRENT   READY   AVAILABLE   AGE
openshift-machine-api   osc-6gzh2-worker   3         3         1       1           97m
(overcloud) [stack@undercloud-0 clouds]$ oc get machine -A
NAMESPACE               NAME                     STATE    TYPE           REGION      ZONE   AGE
openshift-machine-api   osc-6gzh2-master-0       ACTIVE   m1.openshift   regionOne   nova   97m
openshift-machine-api   osc-6gzh2-master-1       ACTIVE   m1.openshift   regionOne   nova   97m
openshift-machine-api   osc-6gzh2-master-2       ACTIVE   m1.openshift   regionOne   nova   97m
openshift-machine-api   osc-6gzh2-worker-5d627   ERROR                                      96m
openshift-machine-api   osc-6gzh2-worker-j6j78   ERROR                                      96m
openshift-machine-api   osc-6gzh2-worker-shw2w   ACTIVE   m1.openshift   regionOne   nova   96m
(overcloud) [stack@undercloud-0 clouds]$ oc get machineconfig -A
NAME                                                        GENERATEDBYCONTROLLER                      IGNITIONVERSION   CREATED
00-master                                                   d780d197a9c5848ba786982c0c4aaa7487297046   2.2.0             96m
00-worker                                                   d780d197a9c5848ba786982c0c4aaa7487297046   2.2.0             96m
01-master-container-runtime                                 d780d197a9c5848ba786982c0c4aaa7487297046   2.2.0             96m
01-master-kubelet                                           d780d197a9c5848ba786982c0c4aaa7487297046   2.2.0             96m
01-worker-container-runtime                                 d780d197a9c5848ba786982c0c4aaa7487297046   2.2.0             96m
01-worker-kubelet                                           d780d197a9c5848ba786982c0c4aaa7487297046   2.2.0             96m
99-master-51c90b92-2340-11ea-baab-fa163e272495-registries   d780d197a9c5848ba786982c0c4aaa7487297046   2.2.0             96m
99-master-ssh                                                                                          2.2.0             96m
99-worker-51ca001b-2340-11ea-baab-fa163e272495-registries   d780d197a9c5848ba786982c0c4aaa7487297046   2.2.0             96m
99-worker-ssh                                                                                          2.2.0             96m
rendered-master-8e766b361a127ddfebde5802f36b90ce            d780d197a9c5848ba786982c0c4aaa7487297046   2.2.0             96m
rendered-worker-74267811bebab086ede643b9c9b2ba66            d780d197a9c5848ba786982c0c4aaa7487297046   2.2.0             96m
</code></pre>

<p>And it fails with:</p>
<pre><code>(overcloud) [stack@undercloud-0 clouds]$ oc describe machine -n openshift-machine-api osc-6gzh2-worker-5d627 | tail
        Openshift Cluster ID:  osc-6gzh2
      Tags:
        openshiftClusterID=osc-6gzh2
      Trunk:  true
      User Data Secret:
        Name:  worker-user-data
Events:
  Type     Reason        Age                   From                  Message
  ----     ------        ----                  ----                  -------
  Warning  FailedCreate  2m30s (x23 over 95m)  openstack_controller  CreateError
(overcloud) [stack@undercloud-0 clouds]$ 
</code></pre>

<pre><code>vercloud) [stack@undercloud-0 clouds]$ oc get events -n openshift-machine-api
LAST SEEN   TYPE      REASON              OBJECT                                              MESSAGE
95m         Normal    Scheduled           pod/cluster-autoscaler-operator-65dfcc75bb-gv8mg    Successfully assigned openshift-machine-api/cluster-autoscaler-operator-65dfcc75bb-gv8mg to osc-6gzh2-master-1
95m         Warning   FailedMount         pod/cluster-autoscaler-operator-65dfcc75bb-gv8mg    MountVolume.SetUp failed for volume &quot;cert&quot; : couldn't propagate object cache: timed out waiting for the condition
95m         Warning   FailedMount         pod/cluster-autoscaler-operator-65dfcc75bb-gv8mg    MountVolume.SetUp failed for volume &quot;cluster-autoscaler-operator-token-gtb48&quot; : couldn't propagate object cache: timed out waiting for the condition
95m         Warning   FailedMount         pod/cluster-autoscaler-operator-65dfcc75bb-gv8mg    MountVolume.SetUp failed for volume &quot;ca-cert&quot; : couldn't propagate object cache: timed out waiting for the condition
94m         Normal    Pulling             pod/cluster-autoscaler-operator-65dfcc75bb-gv8mg    Pulling image &quot;quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:e6ea0a063874ff9169ef1e0e58c6399a42e163c49321018fa34c838faec99cb4&quot;
94m         Normal    Pulled              pod/cluster-autoscaler-operator-65dfcc75bb-gv8mg    Successfully pulled image &quot;quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:e6ea0a063874ff9169ef1e0e58c6399a42e163c49321018fa34c838faec99cb4&quot;
94m         Normal    Created             pod/cluster-autoscaler-operator-65dfcc75bb-gv8mg    Created container cluster-autoscaler-operator
94m         Normal    Started             pod/cluster-autoscaler-operator-65dfcc75bb-gv8mg    Started container cluster-autoscaler-operator
95m         Normal    SuccessfulCreate    replicaset/cluster-autoscaler-operator-65dfcc75bb   Created pod: cluster-autoscaler-operator-65dfcc75bb-gv8mg
94m         Normal    LeaderElection      configmap/cluster-autoscaler-operator-leader        cluster-autoscaler-operator-65dfcc75bb-gv8mg_40da4183-2341-11ea-8630-0a58ac150025 became leader
95m         Normal    ScalingReplicaSet   deployment/cluster-autoscaler-operator              Scaled up replica set cluster-autoscaler-operator-65dfcc75bb to 1
101m        Normal    Scheduled           pod/machine-api-controllers-f64b7f7b8-xb7qn         Successfully assigned openshift-machine-api/machine-api-controllers-f64b7f7b8-xb7qn to osc-6gzh2-master-2
101m        Normal    Pulling             pod/machine-api-controllers-f64b7f7b8-xb7qn         Pulling image &quot;quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:fad6250c0e717515d4caf35d6e6e006f7154e2a7bd9d4fec73f0540e155e3119&quot;
101m        Normal    Pulled              pod/machine-api-controllers-f64b7f7b8-xb7qn         Successfully pulled image &quot;quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:fad6250c0e717515d4caf35d6e6e006f7154e2a7bd9d4fec73f0540e155e3119&quot;
101m        Normal    Created             pod/machine-api-controllers-f64b7f7b8-xb7qn         Created container controller-manager
101m        Normal    Started             pod/machine-api-controllers-f64b7f7b8-xb7qn         Started container controller-manager
101m        Normal    Pulled              pod/machine-api-controllers-f64b7f7b8-xb7qn         Container image &quot;quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:fad6250c0e717515d4caf35d6e6e006f7154e2a7bd9d4fec73f0540e155e3119&quot; already present on machine
101m        Normal    Created             pod/machine-api-controllers-f64b7f7b8-xb7qn         Created container machine-controller
101m        Normal    Started             pod/machine-api-controllers-f64b7f7b8-xb7qn         Started container machine-controller
101m        Normal    Pulled              pod/machine-api-controllers-f64b7f7b8-xb7qn         Container image &quot;quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:8f1a9c01710f09ad1d1c105cbc4f4ff88d7c0f5916a628f9414d3a7905fbced8&quot; already present on machine
101m        Normal    Created             pod/machine-api-controllers-f64b7f7b8-xb7qn         Created container nodelink-controller
101m        Normal    Started             pod/machine-api-controllers-f64b7f7b8-xb7qn         Started container nodelink-controller
101m        Normal    SuccessfulCreate    replicaset/machine-api-controllers-f64b7f7b8        Created pod: machine-api-controllers-f64b7f7b8-xb7qn
101m        Normal    ScalingReplicaSet   deployment/machine-api-controllers                  Scaled up replica set machine-api-controllers-f64b7f7b8 to 1
101m        Warning   FailedScheduling    pod/machine-api-operator-655d94c8fd-6vrqg           0/3 nodes are available: 3 node(s) had taints that the pod didn't tolerate.
101m        Normal    Scheduled           pod/machine-api-operator-655d94c8fd-6vrqg           Successfully assigned openshift-machine-api/machine-api-operator-655d94c8fd-6vrqg to osc-6gzh2-master-2
101m        Normal    Pulling             pod/machine-api-operator-655d94c8fd-6vrqg           Pulling image &quot;quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:8f1a9c01710f09ad1d1c105cbc4f4ff88d7c0f5916a628f9414d3a7905fbced8&quot;
101m        Normal    Pulled              pod/machine-api-operator-655d94c8fd-6vrqg           Successfully pulled image &quot;quay.io/openshift-release-dev/ocp-v4.0-art-dev@sha256:8f1a9c01710f09ad1d1c105cbc4f4ff88d7c0f5916a628f9414d3a7905fbced8&quot;
101m        Normal    Created             pod/machine-api-operator-655d94c8fd-6vrqg           Created container machine-api-operator
101m        Normal    Started             pod/machine-api-operator-655d94c8fd-6vrqg           Started container machine-api-operator
102m        Normal    SuccessfulCreate    replicaset/machine-api-operator-655d94c8fd          Created pod: machine-api-operator-655d94c8fd-6vrqg
102m        Normal    ScalingReplicaSet   deployment/machine-api-operator                     Scaled up replica set machine-api-operator-655d94c8fd to 1
6m55s       Warning   FailedCreate        machine/osc-6gzh2-worker-5d627                      CreateError
7m29s       Warning   FailedCreate        machine/osc-6gzh2-worker-j6j78                      CreateError
98m         Warning   FailedCreate        machine/osc-6gzh2-worker-shw2w                      CreateError
97m         Normal    Created             machine/osc-6gzh2-worker-shw2w                      Created Machine osc-6gzh2-worker-shw2w
</code></pre>

<p>I connected to master 2 via master 1:</p>
<pre><code>[stack@undercloud-0 ~]$ eval $(ssh-agent)
[stack@undercloud-0 ~]$ ssh-add  ~/.ssh/id_rsa
[stack@undercloud-0 ~]$ ssh core@api.osc.redhat.local -A
[stack@undercloud-0 ~]$ ssh core@api.osc.redhat.local -A
Warning: Permanently added 'api.osc.redhat.local,172.16.0.108' (ECDSA) to the list of known hosts.
Red Hat Enterprise Linux CoreOS 42.81.20191203.0
WARNING: Direct SSH access to machines is not recommended.

---
Last login: Fri Dec 20 17:27:11 2019 from 172.16.0.65
[core@osc-6gzh2-master-1 ~]$ ssh core@osc-6gzh2-master-0
Red Hat Enterprise Linux CoreOS 42.81.20191203.0
WARNING: Direct SSH access to machines is not recommended.

---
Last login: Fri Dec 20 17:27:13 2019 from 172.31.0.16
sud[core@osc-6gzh2-master-0 ~]$ sudo -i
[root@osc-6gzh2-master-0 ~]# 
</code></pre>

<p>And then got:</p>
<pre><code>[root@osc-6gzh2-master-2 ~]# grep osc-6gzh2-worker-5d627 /var/log -R
/var/log/pods/openshift-machine-api_machine-api-controllers-f64b7f7b8-xb7qn_4d35a879-2340-11ea-baab-fa163e272495/machine-controller/0.log:2019-12-20T15:49:41.304368389+00:00 stderr F I1220 15:49:41.304339       1 controller.go:133] Reconciling Machine &quot;osc-6gzh2-worker-5d627&quot;
/var/log/pods/openshift-machine-api_machine-api-controllers-f64b7f7b8-xb7qn_4d35a879-2340-11ea-baab-fa163e272495/machine-controller/0.log:2019-12-20T15:49:41.304368389+00:00 stderr F I1220 15:49:41.304356       1 controller.go:304] Machine &quot;osc-6gzh2-worker-5d627&quot; in namespace &quot;openshift-machine-api&quot; doesn't specify &quot;cluster.k8s.io/cluster-name&quot; label, assuming nil cluster
/var/log/pods/openshift-machine-api_machine-api-controllers-f64b7f7b8-xb7qn_4d35a879-2340-11ea-baab-fa163e272495/machine-controller/0.log:2019-12-20T15:50:37.383723384+00:00 stderr F I1220 15:50:37.383397       1 controller.go:133] Reconciling Machine &quot;osc-6gzh2-worker-5d627&quot;
/var/log/pods/openshift-machine-api_machine-api-controllers-f64b7f7b8-xb7qn_4d35a879-2340-11ea-baab-fa163e272495/machine-controller/0.log:2019-12-20T15:50:37.383835414+00:00 stderr F I1220 15:50:37.383814       1 controller.go:304] Machine &quot;osc-6gzh2-worker-5d627&quot; in namespace &quot;openshift-machine-api&quot; doesn't specify &quot;cluster.k8s.io/cluster-name&quot; label, assuming nil cluster
/var/log/pods/openshift-machine-api_machine-api-controllers-f64b7f7b8-xb7qn_4d35a879-2340-11ea-baab-fa163e272495/machine-controller/0.log:2019-12-20T15:50:38.552995792+00:00 stderr F I1220 15:50:38.552954       1 controller.go:253] Reconciling machine object osc-6gzh2-worker-5d627 triggers idempotent create.
/var/log/pods/openshift-machine-api_machine-api-controllers-f64b7f7b8-xb7qn_4d35a879-2340-11ea-baab-fa163e272495/machine-controller/0.log:2019-12-20T15:50:52.700244622+00:00 stderr F E1220 15:50:52.698880       1 actuator.go:470] Machine error osc-6gzh2-worker-5d627: error creating Openstack instance: Create new server err: Request forbidden: [POST http://172.16.0.130:8774/v2.1/servers], error message: {&quot;forbidden&quot;: {&quot;message&quot;: &quot;Quota exceeded for ram: Requested 32768, but already used 132096 of 153600 ram&quot;, &quot;code&quot;: 403}}
/var/log/pods/openshift-machine-api_machine-api-controllers-f64b7f7b8-xb7qn_4d35a879-2340-11ea-baab-fa163e272495/machine-controller/0.log:2019-12-20T15:50:52.700244622+00:00 stderr F W1220 15:50:52.698926       1 controller.go:255] Failed to create machine &quot;osc-6gzh2-worker-5d627&quot;: error creating Openstack instance: Create new server err: Request forbidden: [POST http://172.16.0.130:8774/v2.1/servers], error message: {&quot;forbidden&quot;: {&quot;message&quot;: &quot;Quota exceeded for ram: Requested 32768, but already used 132096 of 153600 ram&quot;, &quot;code&quot;: 403}}
/var/log/pods/openshift-machine-api_machine-api-controllers-f64b7f7b8-xb7qn_4d35a879-2340-11ea-baab-fa163e272495/machine-controller/0.log:2019-12-20T15:51:38.126016932+00:00 stderr F I1220 15:51:38.125931       1 controller.go:133] Reconciling Machine &quot;osc-6gzh2-worker-5d627&quot;
/var/log/pods/openshift-machine-api_machine-api-controllers-f64b7f7b8-xb7qn_4d35a879-2340-11ea-baab-fa163e272495/machine-controller/0.log:2019-12-20T15:51:38.126016932+00:00 stderr F I1220 15:51:38.125971       1 controller.go:304] Machine &quot;osc-6gzh2-worker-5d627&quot; in namespace &quot;openshift-machine-api&quot; doesn't specify &quot;cluster.k8s.io/cluster-name&quot; label, assuming nil cluster
/var/log/pods/openshift-machine-api_machine-api-controllers-f64b7f7b8-xb7qn_4d35a879-2340-11ea-baab-fa163e272495/machine-controller/0.log:2019-12-20T15:51:39.076618133+00:00 stderr F I1220 15:51:39.076540       1 controller.go:253] Reconciling machine object osc-6gzh2-worker-5d627 triggers idempotent create.
/var/log/pods/openshift-machine-api_machine-api-controllers-f64b7f7b8-xb7qn_4d35a879-2340-11ea-baab-fa163e272495/machine-controller/0.log:2019-12-20T15:51:48.625264976+00:00 stderr F E1220 15:51:48.625215       1 actuator.go:470] Machine error osc-6gzh2-worker-5d627: error creating Openstack instance: Create new server err: Request forbidden: [POST http://172.16.0.130:8774/v2.1/servers], error message: {&quot;forbidden&quot;: {&quot;message&quot;: &quot;Quota exceeded for ram: Requested 32768, but already used 132096 of 153600 ram&quot;, &quot;code&quot;: 403}}
/var/log/pods/openshift-machine-api_machine-api-controllers-f64b7f7b8-xb7qn_4d35a879-2340-11ea-baab-fa163e272495/machine-controller/0.log:2019-12-20T15:51:48.625264976+00:00 stderr F W1220 15:51:48.625239       1 controller.go:255] Failed to create machine &quot;osc-6gzh2-worker-5d627&quot;: error creating Openstack instance: Create new server err: Request forbidden: [POST http://172.16.0.130:8774/v2.1/servers], error message: {&quot;forbidden&quot;: {&quot;message&quot;: &quot;Quota exceeded for ram: Requested 32768, but already used 132096 of 153600 ram&quot;, &quot;code&quot;: 403}}
</code></pre>
                
                  
                    

<hr>
<div class="md-source-date">
  <small>
    
      Last update: <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">September 13, 2020</span>
    
  </small>
</div>
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        <a href="../useful-ocp-curl/" class="md-footer__link md-footer__link--prev" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Querying the OCP 4.x upgrades info API
            </div>
          </div>
        </a>
      
      
        <a href="../../openstack/reattach_to_running_deployment/" class="md-footer__link md-footer__link--next" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Reattach to running deployment
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
          Material for MkDocs
        </a>
        
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "../..", "features": ["toc.integrate"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing"}, "search": "../../assets/javascripts/workers/search.fb4a9340.min.js", "version": null}</script>
    
    
      <script src="../../assets/javascripts/bundle.a1c7c35e.min.js"></script>
      
    
  </body>
</html>